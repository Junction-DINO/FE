var Cw=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var H=(t,e,n)=>(Cw(t,e,"read from private field"),n?n.call(t):e.get(t)),Ve=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Ie=(t,e,n,s)=>(Cw(t,e,"write to private field"),s?s.call(t,n):e.set(t,n),n);var Vg=(t,e,n,s)=>({set _(r){Ie(t,e,r,n)},get _(){return H(t,e,s)}}),gt=(t,e,n)=>(Cw(t,e,"access private method"),n);function uC(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const o=Object.getOwnPropertyDescriptor(s,r);o&&Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();var yu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ub(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function EU(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),n}var nA={exports:{}},cb={},sA={exports:{}},mt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lp=Symbol.for("react.element"),RU=Symbol.for("react.portal"),_U=Symbol.for("react.fragment"),AU=Symbol.for("react.strict_mode"),DU=Symbol.for("react.profiler"),OU=Symbol.for("react.provider"),FU=Symbol.for("react.context"),LU=Symbol.for("react.forward_ref"),PU=Symbol.for("react.suspense"),MU=Symbol.for("react.memo"),zU=Symbol.for("react.lazy"),OI=Symbol.iterator;function BU(t){return t===null||typeof t!="object"?null:(t=OI&&t[OI]||t["@@iterator"],typeof t=="function"?t:null)}var rA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},oA=Object.assign,iA={};function gd(t,e,n){this.props=t,this.context=e,this.refs=iA,this.updater=n||rA}gd.prototype.isReactComponent={};gd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};gd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function aA(){}aA.prototype=gd.prototype;function cC(t,e,n){this.props=t,this.context=e,this.refs=iA,this.updater=n||rA}var dC=cC.prototype=new aA;dC.constructor=cC;oA(dC,gd.prototype);dC.isPureReactComponent=!0;var FI=Array.isArray,lA=Object.prototype.hasOwnProperty,hC={current:null},uA={key:!0,ref:!0,__self:!0,__source:!0};function cA(t,e,n){var s,r={},o=null,i=null;if(e!=null)for(s in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)lA.call(e,s)&&!uA.hasOwnProperty(s)&&(r[s]=e[s]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:Lp,type:t,key:o,ref:i,props:r,_owner:hC.current}}function VU(t,e){return{$$typeof:Lp,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function fC(t){return typeof t=="object"&&t!==null&&t.$$typeof===Lp}function UU(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var LI=/\/+/g;function Nw(t,e){return typeof t=="object"&&t!==null&&t.key!=null?UU(""+t.key):e.toString(36)}function Iy(t,e,n,s,r){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Lp:case RU:i=!0}}if(i)return i=t,r=r(i),t=s===""?"."+Nw(i,0):s,FI(r)?(n="",t!=null&&(n=t.replace(LI,"$&/")+"/"),Iy(r,e,n,"",function(u){return u})):r!=null&&(fC(r)&&(r=VU(r,n+(!r.key||i&&i.key===r.key?"":(""+r.key).replace(LI,"$&/")+"/")+t)),e.push(r)),1;if(i=0,s=s===""?".":s+":",FI(t))for(var a=0;a<t.length;a++){o=t[a];var l=s+Nw(o,a);i+=Iy(o,e,n,l,r)}else if(l=BU(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=s+Nw(o,a++),i+=Iy(o,e,n,l,r);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function Ug(t,e,n){if(t==null)return t;var s=[],r=0;return Iy(t,s,"","",function(o){return e.call(n,o,r++)}),s}function WU(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ms={current:null},Ey={transition:null},jU={ReactCurrentDispatcher:Ms,ReactCurrentBatchConfig:Ey,ReactCurrentOwner:hC};mt.Children={map:Ug,forEach:function(t,e,n){Ug(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ug(t,function(){e++}),e},toArray:function(t){return Ug(t,function(e){return e})||[]},only:function(t){if(!fC(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};mt.Component=gd;mt.Fragment=_U;mt.Profiler=DU;mt.PureComponent=cC;mt.StrictMode=AU;mt.Suspense=PU;mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jU;mt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=oA({},t.props),r=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=hC.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)lA.call(e,l)&&!uA.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];s.children=a}return{$$typeof:Lp,type:t.type,key:r,ref:o,props:s,_owner:i}};mt.createContext=function(t){return t={$$typeof:FU,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:OU,_context:t},t.Consumer=t};mt.createElement=cA;mt.createFactory=function(t){var e=cA.bind(null,t);return e.type=t,e};mt.createRef=function(){return{current:null}};mt.forwardRef=function(t){return{$$typeof:LU,render:t}};mt.isValidElement=fC;mt.lazy=function(t){return{$$typeof:zU,_payload:{_status:-1,_result:t},_init:WU}};mt.memo=function(t,e){return{$$typeof:MU,type:t,compare:e===void 0?null:e}};mt.startTransition=function(t){var e=Ey.transition;Ey.transition={};try{t()}finally{Ey.transition=e}};mt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};mt.useCallback=function(t,e){return Ms.current.useCallback(t,e)};mt.useContext=function(t){return Ms.current.useContext(t)};mt.useDebugValue=function(){};mt.useDeferredValue=function(t){return Ms.current.useDeferredValue(t)};mt.useEffect=function(t,e){return Ms.current.useEffect(t,e)};mt.useId=function(){return Ms.current.useId()};mt.useImperativeHandle=function(t,e,n){return Ms.current.useImperativeHandle(t,e,n)};mt.useInsertionEffect=function(t,e){return Ms.current.useInsertionEffect(t,e)};mt.useLayoutEffect=function(t,e){return Ms.current.useLayoutEffect(t,e)};mt.useMemo=function(t,e){return Ms.current.useMemo(t,e)};mt.useReducer=function(t,e,n){return Ms.current.useReducer(t,e,n)};mt.useRef=function(t){return Ms.current.useRef(t)};mt.useState=function(t){return Ms.current.useState(t)};mt.useSyncExternalStore=function(t,e,n){return Ms.current.useSyncExternalStore(t,e,n)};mt.useTransition=function(){return Ms.current.useTransition()};mt.version="18.2.0";sA.exports=mt;var R=sA.exports;const lt=ub(R),GU=uC({__proto__:null,default:lt},[R]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HU=R,qU=Symbol.for("react.element"),KU=Symbol.for("react.fragment"),XU=Object.prototype.hasOwnProperty,YU=HU.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,QU={key:!0,ref:!0,__self:!0,__source:!0};function dA(t,e,n){var s,r={},o=null,i=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(s in e)XU.call(e,s)&&!QU.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:qU,type:t,key:o,ref:i,props:r,_owner:YU.current}}cb.Fragment=KU;cb.jsx=dA;cb.jsxs=dA;nA.exports=cb;var se=nA.exports,Pp=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},zc=typeof window>"u"||"Deno"in globalThis;function Lr(){}function ZU(t,e){return typeof t=="function"?t(e):t}function P1(t){return typeof t=="number"&&t>=0&&t!==1/0}function hA(t,e){return Math.max(t+(e||0)-Date.now(),0)}function PI(t,e){const{type:n="all",exact:s,fetchStatus:r,predicate:o,queryKey:i,stale:a}=t;if(i){if(s){if(e.queryHash!==pC(i,e.options))return!1}else if(!Pf(e.queryKey,i))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||r&&r!==e.state.fetchStatus||o&&!o(e))}function MI(t,e){const{exact:n,status:s,predicate:r,mutationKey:o}=t;if(o){if(!e.options.mutationKey)return!1;if(n){if(Lf(e.options.mutationKey)!==Lf(o))return!1}else if(!Pf(e.options.mutationKey,o))return!1}return!(s&&e.state.status!==s||r&&!r(e))}function pC(t,e){return((e==null?void 0:e.queryKeyHashFn)||Lf)(t)}function Lf(t){return JSON.stringify(t,(e,n)=>z1(n)?Object.keys(n).sort().reduce((s,r)=>(s[r]=n[r],s),{}):n)}function Pf(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?!Object.keys(e).some(n=>!Pf(t[n],e[n])):!1}function fA(t,e){if(t===e)return t;const n=zI(t)&&zI(e);if(n||z1(t)&&z1(e)){const s=n?t:Object.keys(t),r=s.length,o=n?e:Object.keys(e),i=o.length,a=n?[]:{};let l=0;for(let u=0;u<i;u++){const c=n?u:o[u];!n&&t[c]===void 0&&e[c]===void 0&&s.includes(c)?(a[c]=void 0,l++):(a[c]=fA(t[c],e[c]),a[c]===t[c]&&t[c]!==void 0&&l++)}return r===i&&l===r?t:a}return e}function M1(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function zI(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function z1(t){if(!BI(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!BI(n)||!n.hasOwnProperty("isPrototypeOf"))}function BI(t){return Object.prototype.toString.call(t)==="[object Object]"}function JU(t){return new Promise(e=>{setTimeout(e,t)})}function B1(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?fA(t,e):e}function eW(t,e,n=0){const s=[...t,e];return n&&s.length>n?s.slice(1):s}function tW(t,e,n=0){const s=[e,...t];return n&&s.length>n?s.slice(0,-1):s}var mC=Symbol(),Dl,ua,Nc,q_,nW=(q_=class extends Pp{constructor(){super();Ve(this,Dl,void 0);Ve(this,ua,void 0);Ve(this,Nc,void 0);Ie(this,Nc,e=>{if(!zc&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){H(this,ua)||this.setEventListener(H(this,Nc))}onUnsubscribe(){var e;this.hasListeners()||((e=H(this,ua))==null||e.call(this),Ie(this,ua,void 0))}setEventListener(e){var n;Ie(this,Nc,e),(n=H(this,ua))==null||n.call(this),Ie(this,ua,e(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(e){H(this,Dl)!==e&&(Ie(this,Dl,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof H(this,Dl)=="boolean"?H(this,Dl):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Dl=new WeakMap,ua=new WeakMap,Nc=new WeakMap,q_),gC=new nW,Tc,ca,$c,K_,sW=(K_=class extends Pp{constructor(){super();Ve(this,Tc,!0);Ve(this,ca,void 0);Ve(this,$c,void 0);Ie(this,$c,e=>{if(!zc&&window.addEventListener){const n=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){H(this,ca)||this.setEventListener(H(this,$c))}onUnsubscribe(){var e;this.hasListeners()||((e=H(this,ca))==null||e.call(this),Ie(this,ca,void 0))}setEventListener(e){var n;Ie(this,$c,e),(n=H(this,ca))==null||n.call(this),Ie(this,ca,e(this.setOnline.bind(this)))}setOnline(e){H(this,Tc)!==e&&(Ie(this,Tc,e),this.listeners.forEach(s=>{s(e)}))}isOnline(){return H(this,Tc)}},Tc=new WeakMap,ca=new WeakMap,$c=new WeakMap,K_),Qy=new sW;function rW(t){return Math.min(1e3*2**t,3e4)}function yC(t){return(t??"online")==="online"?Qy.isOnline():!0}var pA=class{constructor(t){this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function Tw(t){return t instanceof pA}function mA(t){let e=!1,n=0,s=!1,r,o,i;const a=new Promise((g,y)=>{o=g,i=y}),l=g=>{var y;s||(f(new pA(g)),(y=t.abort)==null||y.call(t))},u=()=>{e=!0},c=()=>{e=!1},d=()=>!gC.isFocused()||t.networkMode!=="always"&&!Qy.isOnline(),h=g=>{var y;s||(s=!0,(y=t.onSuccess)==null||y.call(t,g),r==null||r(),o(g))},f=g=>{var y;s||(s=!0,(y=t.onError)==null||y.call(t,g),r==null||r(),i(g))},p=()=>new Promise(g=>{var y;r=b=>{const v=s||!d();return v&&g(b),v},(y=t.onPause)==null||y.call(t)}).then(()=>{var g;r=void 0,s||(g=t.onContinue)==null||g.call(t)}),m=()=>{if(s)return;let g;try{g=t.fn()}catch(y){g=Promise.reject(y)}Promise.resolve(g).then(h).catch(y=>{var S;if(s)return;const b=t.retry??(zc?0:3),v=t.retryDelay??rW,x=typeof v=="function"?v(n,y):v,w=b===!0||typeof b=="number"&&n<b||typeof b=="function"&&b(n,y);if(e||!w){f(y);return}n++,(S=t.onFail)==null||S.call(t,n,y),JU(x).then(()=>{if(d())return p()}).then(()=>{e?f(y):m()})})};return yC(t.networkMode)?m():p().then(m),{promise:a,cancel:l,continue:()=>(r==null?void 0:r())?a:Promise.resolve(),cancelRetry:u,continueRetry:c}}function oW(){let t=[],e=0,n=h=>{h()},s=h=>{h()},r=h=>setTimeout(h,0);const o=h=>{r=h},i=h=>{let f;e++;try{f=h()}finally{e--,e||u()}return f},a=h=>{e?t.push(h):r(()=>{n(h)})},l=h=>(...f)=>{a(()=>{h(...f)})},u=()=>{const h=t;t=[],h.length&&r(()=>{s(()=>{h.forEach(f=>{n(f)})})})};return{batch:i,batchCalls:l,schedule:a,setNotifyFunction:h=>{n=h},setBatchNotifyFunction:h=>{s=h},setScheduler:o}}var as=oW(),Ol,X_,gA=(X_=class{constructor(){Ve(this,Ol,void 0)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),P1(this.gcTime)&&Ie(this,Ol,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(zc?1/0:5*60*1e3))}clearGcTimeout(){H(this,Ol)&&(clearTimeout(H(this,Ol)),Ie(this,Ol,void 0))}},Ol=new WeakMap,X_),Ic,Ec,Or,Ns,Un,Cp,Fl,uo,ui,Y_,iW=(Y_=class extends gA{constructor(e){super();Ve(this,uo);Ve(this,Ic,void 0);Ve(this,Ec,void 0);Ve(this,Or,void 0);Ve(this,Ns,void 0);Ve(this,Un,void 0);Ve(this,Cp,void 0);Ve(this,Fl,void 0);Ie(this,Fl,!1),Ie(this,Cp,e.defaultOptions),this.setOptions(e.options),Ie(this,Un,[]),Ie(this,Or,e.cache),this.queryKey=e.queryKey,this.queryHash=e.queryHash,Ie(this,Ic,e.state||aW(this.options)),this.state=H(this,Ic),this.scheduleGc()}get meta(){return this.options.meta}setOptions(e){this.options={...H(this,Cp),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!H(this,Un).length&&this.state.fetchStatus==="idle"&&H(this,Or).remove(this)}setData(e,n){const s=B1(this.state.data,e,this.options);return gt(this,uo,ui).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(e,n){gt(this,uo,ui).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var s,r;const n=(s=H(this,Ns))==null?void 0:s.promise;return(r=H(this,Ns))==null||r.cancel(e),n?n.then(Lr).catch(Lr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(H(this,Ic))}isActive(){return H(this,Un).some(e=>e.options.enabled!==!1)}isDisabled(){return this.getObserversCount()>0&&!this.isActive()}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?H(this,Un).some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!hA(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=H(this,Un).find(s=>s.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=H(this,Ns))==null||n.continue()}onOnline(){var n;const e=H(this,Un).find(s=>s.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=H(this,Ns))==null||n.continue()}addObserver(e){H(this,Un).includes(e)||(H(this,Un).push(e),this.clearGcTimeout(),H(this,Or).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){H(this,Un).includes(e)&&(Ie(this,Un,H(this,Un).filter(n=>n!==e)),H(this,Un).length||(H(this,Ns)&&(H(this,Fl)?H(this,Ns).cancel({revert:!0}):H(this,Ns).cancelRetry()),this.scheduleGc()),H(this,Or).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return H(this,Un).length}invalidate(){this.state.isInvalidated||gt(this,uo,ui).call(this,{type:"invalidate"})}fetch(e,n){var u,c,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(H(this,Ns))return H(this,Ns).continueRetry(),H(this,Ns).promise}if(e&&this.setOptions(e),!this.options.queryFn){const h=H(this,Un).find(f=>f.options.queryFn);h&&this.setOptions(h.options)}const s=new AbortController,r={queryKey:this.queryKey,meta:this.meta},o=h=>{Object.defineProperty(h,"signal",{enumerable:!0,get:()=>(Ie(this,Fl,!0),s.signal)})};o(r);const i=()=>!this.options.queryFn||this.options.queryFn===mC?Promise.reject(new Error(`Missing queryFn: '${this.options.queryHash}'`)):(Ie(this,Fl,!1),this.options.persister?this.options.persister(this.options.queryFn,r,this):this.options.queryFn(r)),a={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:i};o(a),(u=this.options.behavior)==null||u.onFetch(a,this),Ie(this,Ec,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=a.fetchOptions)==null?void 0:c.meta))&&gt(this,uo,ui).call(this,{type:"fetch",meta:(d=a.fetchOptions)==null?void 0:d.meta});const l=h=>{var f,p,m,g;Tw(h)&&h.silent||gt(this,uo,ui).call(this,{type:"error",error:h}),Tw(h)||((p=(f=H(this,Or).config).onError)==null||p.call(f,h,this),(g=(m=H(this,Or).config).onSettled)==null||g.call(m,this.state.data,h,this)),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1};return Ie(this,Ns,mA({fn:a.fetchFn,abort:s.abort.bind(s),onSuccess:h=>{var f,p,m,g;if(h===void 0){l(new Error(`${this.queryHash} data is undefined`));return}this.setData(h),(p=(f=H(this,Or).config).onSuccess)==null||p.call(f,h,this),(g=(m=H(this,Or).config).onSettled)==null||g.call(m,h,this.state.error,this),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1},onError:l,onFail:(h,f)=>{gt(this,uo,ui).call(this,{type:"failed",failureCount:h,error:f})},onPause:()=>{gt(this,uo,ui).call(this,{type:"pause"})},onContinue:()=>{gt(this,uo,ui).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode})),H(this,Ns).promise}},Ic=new WeakMap,Ec=new WeakMap,Or=new WeakMap,Ns=new WeakMap,Un=new WeakMap,Cp=new WeakMap,Fl=new WeakMap,uo=new WeakSet,ui=function(e){const n=s=>{switch(e.type){case"failed":return{...s,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...yA(s.data,this.options),fetchMeta:e.meta??null};case"success":return{...s,data:e.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const r=e.error;return Tw(r)&&r.revert&&H(this,Ec)?{...H(this,Ec),fetchStatus:"idle"}:{...s,error:r,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:r,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...e.state}}};this.state=n(this.state),as.batch(()=>{H(this,Un).forEach(s=>{s.onQueryUpdate()}),H(this,Or).notify({query:this,type:"updated",action:e})})},Y_);function yA(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:yC(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function aW(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,s=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Ao,Q_,lW=(Q_=class extends Pp{constructor(e={}){super();Ve(this,Ao,void 0);this.config=e,Ie(this,Ao,new Map)}build(e,n,s){const r=n.queryKey,o=n.queryHash??pC(r,n);let i=this.get(o);return i||(i=new iW({cache:this,queryKey:r,queryHash:o,options:e.defaultQueryOptions(n),state:s,defaultOptions:e.getQueryDefaults(r)}),this.add(i)),i}add(e){H(this,Ao).has(e.queryHash)||(H(this,Ao).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=H(this,Ao).get(e.queryHash);n&&(e.destroy(),n===e&&H(this,Ao).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){as.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return H(this,Ao).get(e)}getAll(){return[...H(this,Ao).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(s=>PI(n,s))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(s=>PI(e,s)):n}notify(e){as.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){as.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){as.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Ao=new WeakMap,Q_),Do,Np,dr,Rc,Oo,ta,Z_,uW=(Z_=class extends gA{constructor(e){super();Ve(this,Oo);Ve(this,Do,void 0);Ve(this,Np,void 0);Ve(this,dr,void 0);Ve(this,Rc,void 0);this.mutationId=e.mutationId,Ie(this,Np,e.defaultOptions),Ie(this,dr,e.mutationCache),Ie(this,Do,[]),this.state=e.state||cW(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options={...H(this,Np),...e},this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){H(this,Do).includes(e)||(H(this,Do).push(e),this.clearGcTimeout(),H(this,dr).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){Ie(this,Do,H(this,Do).filter(n=>n!==e)),this.scheduleGc(),H(this,dr).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){H(this,Do).length||(this.state.status==="pending"?this.scheduleGc():H(this,dr).remove(this))}continue(){var e;return((e=H(this,Rc))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var r,o,i,a,l,u,c,d,h,f,p,m,g,y,b,v,x,w,S,C;const n=()=>(Ie(this,Rc,mA({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(N,I)=>{gt(this,Oo,ta).call(this,{type:"failed",failureCount:N,error:I})},onPause:()=>{gt(this,Oo,ta).call(this,{type:"pause"})},onContinue:()=>{gt(this,Oo,ta).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode})),H(this,Rc).promise),s=this.state.status==="pending";try{if(!s){gt(this,Oo,ta).call(this,{type:"pending",variables:e}),await((o=(r=H(this,dr).config).onMutate)==null?void 0:o.call(r,e,this));const I=await((a=(i=this.options).onMutate)==null?void 0:a.call(i,e));I!==this.state.context&&gt(this,Oo,ta).call(this,{type:"pending",context:I,variables:e})}const N=await n();return await((u=(l=H(this,dr).config).onSuccess)==null?void 0:u.call(l,N,e,this.state.context,this)),await((d=(c=this.options).onSuccess)==null?void 0:d.call(c,N,e,this.state.context)),await((f=(h=H(this,dr).config).onSettled)==null?void 0:f.call(h,N,null,this.state.variables,this.state.context,this)),await((m=(p=this.options).onSettled)==null?void 0:m.call(p,N,null,e,this.state.context)),gt(this,Oo,ta).call(this,{type:"success",data:N}),N}catch(N){try{throw await((y=(g=H(this,dr).config).onError)==null?void 0:y.call(g,N,e,this.state.context,this)),await((v=(b=this.options).onError)==null?void 0:v.call(b,N,e,this.state.context)),await((w=(x=H(this,dr).config).onSettled)==null?void 0:w.call(x,void 0,N,this.state.variables,this.state.context,this)),await((C=(S=this.options).onSettled)==null?void 0:C.call(S,void 0,N,e,this.state.context)),N}finally{gt(this,Oo,ta).call(this,{type:"error",error:N})}}}},Do=new WeakMap,Np=new WeakMap,dr=new WeakMap,Rc=new WeakMap,Oo=new WeakSet,ta=function(e){const n=s=>{switch(e.type){case"failed":return{...s,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:!yC(this.options.networkMode),status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...s,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:e.error,failureCount:s.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),as.batch(()=>{H(this,Do).forEach(s=>{s.onMutationUpdate(e)}),H(this,dr).notify({mutation:this,type:"updated",action:e})})},Z_);function cW(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Fr,Tp,Ll,J_,dW=(J_=class extends Pp{constructor(e={}){super();Ve(this,Fr,void 0);Ve(this,Tp,void 0);Ve(this,Ll,void 0);this.config=e,Ie(this,Fr,[]),Ie(this,Tp,0)}build(e,n,s){const r=new uW({mutationCache:this,mutationId:++Vg(this,Tp)._,options:e.defaultMutationOptions(n),state:s});return this.add(r),r}add(e){H(this,Fr).push(e),this.notify({type:"added",mutation:e})}remove(e){Ie(this,Fr,H(this,Fr).filter(n=>n!==e)),this.notify({type:"removed",mutation:e})}clear(){as.batch(()=>{H(this,Fr).forEach(e=>{this.remove(e)})})}getAll(){return H(this,Fr)}find(e){const n={exact:!0,...e};return H(this,Fr).find(s=>MI(n,s))}findAll(e={}){return H(this,Fr).filter(n=>MI(e,n))}notify(e){as.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){return Ie(this,Ll,(H(this,Ll)??Promise.resolve()).then(()=>{const e=H(this,Fr).filter(n=>n.state.isPaused);return as.batch(()=>e.reduce((n,s)=>n.then(()=>s.continue().catch(Lr)),Promise.resolve()))}).then(()=>{Ie(this,Ll,void 0)})),H(this,Ll)}},Fr=new WeakMap,Tp=new WeakMap,Ll=new WeakMap,J_);function hW(t){return{onFetch:(e,n)=>{const s=async()=>{var p,m,g,y,b;const r=e.options,o=(g=(m=(p=e.fetchOptions)==null?void 0:p.meta)==null?void 0:m.fetchMore)==null?void 0:g.direction,i=((y=e.state.data)==null?void 0:y.pages)||[],a=((b=e.state.data)==null?void 0:b.pageParams)||[],l={pages:[],pageParams:[]};let u=!1;const c=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(e.signal.aborted?u=!0:e.signal.addEventListener("abort",()=>{u=!0}),e.signal)})},d=e.options.queryFn&&e.options.queryFn!==mC?e.options.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${e.options.queryHash}'`)),h=async(v,x,w)=>{if(u)return Promise.reject();if(x==null&&v.pages.length)return Promise.resolve(v);const S={queryKey:e.queryKey,pageParam:x,direction:w?"backward":"forward",meta:e.options.meta};c(S);const C=await d(S),{maxPages:N}=e.options,I=w?tW:eW;return{pages:I(v.pages,C,N),pageParams:I(v.pageParams,x,N)}};let f;if(o&&i.length){const v=o==="backward",x=v?fW:VI,w={pages:i,pageParams:a},S=x(r,w);f=await h(w,S,v)}else{f=await h(l,a[0]??r.initialPageParam);const v=t??i.length;for(let x=1;x<v;x++){const w=VI(r,f);f=await h(f,w)}}return f};e.options.persister?e.fetchFn=()=>{var r,o;return(o=(r=e.options).persister)==null?void 0:o.call(r,s,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=s}}}function VI(t,{pages:e,pageParams:n}){const s=e.length-1;return t.getNextPageParam(e[s],e,n[s],n)}function fW(t,{pages:e,pageParams:n}){var s;return(s=t.getPreviousPageParam)==null?void 0:s.call(t,e[0],e,n[0],n)}var an,da,ha,_c,Ac,fa,Dc,Oc,eA,pW=(eA=class{constructor(t={}){Ve(this,an,void 0);Ve(this,da,void 0);Ve(this,ha,void 0);Ve(this,_c,void 0);Ve(this,Ac,void 0);Ve(this,fa,void 0);Ve(this,Dc,void 0);Ve(this,Oc,void 0);Ie(this,an,t.queryCache||new lW),Ie(this,da,t.mutationCache||new dW),Ie(this,ha,t.defaultOptions||{}),Ie(this,_c,new Map),Ie(this,Ac,new Map),Ie(this,fa,0)}mount(){Vg(this,fa)._++,H(this,fa)===1&&(Ie(this,Dc,gC.subscribe(async t=>{t&&(await this.resumePausedMutations(),H(this,an).onFocus())})),Ie(this,Oc,Qy.subscribe(async t=>{t&&(await this.resumePausedMutations(),H(this,an).onOnline())})))}unmount(){var t,e;Vg(this,fa)._--,H(this,fa)===0&&((t=H(this,Dc))==null||t.call(this),Ie(this,Dc,void 0),(e=H(this,Oc))==null||e.call(this),Ie(this,Oc,void 0))}isFetching(t){return H(this,an).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return H(this,da).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=H(this,an).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.getQueryData(t.queryKey);if(e===void 0)return this.fetchQuery(t);{const n=this.defaultQueryOptions(t),s=H(this,an).build(this,n);return t.revalidateIfStale&&s.isStaleByTime(n.staleTime)&&this.prefetchQuery(n),Promise.resolve(e)}}getQueriesData(t){return H(this,an).findAll(t).map(({queryKey:e,state:n})=>{const s=n.data;return[e,s]})}setQueryData(t,e,n){const s=this.defaultQueryOptions({queryKey:t}),r=H(this,an).get(s.queryHash),o=r==null?void 0:r.state.data,i=ZU(e,o);if(i!==void 0)return H(this,an).build(this,s).setData(i,{...n,manual:!0})}setQueriesData(t,e,n){return as.batch(()=>H(this,an).findAll(t).map(({queryKey:s})=>[s,this.setQueryData(s,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=H(this,an).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=H(this,an);as.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=H(this,an),s={type:"active",...t};return as.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries(s,e)))}cancelQueries(t={},e={}){const n={revert:!0,...e},s=as.batch(()=>H(this,an).findAll(t).map(r=>r.cancel(n)));return Promise.all(s).then(Lr).catch(Lr)}invalidateQueries(t={},e={}){return as.batch(()=>{if(H(this,an).findAll(t).forEach(s=>{s.invalidate()}),t.refetchType==="none")return Promise.resolve();const n={...t,type:t.refetchType??t.type??"active"};return this.refetchQueries(n,e)})}refetchQueries(t={},e){const n={...e,cancelRefetch:(e==null?void 0:e.cancelRefetch)??!0},s=as.batch(()=>H(this,an).findAll(t).filter(r=>!r.isDisabled()).map(r=>{let o=r.fetch(void 0,n);return n.throwOnError||(o=o.catch(Lr)),r.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(s).then(Lr)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=H(this,an).build(this,e);return n.isStaleByTime(e.staleTime)?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Lr).catch(Lr)}fetchInfiniteQuery(t){return t.behavior=hW(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Lr).catch(Lr)}resumePausedMutations(){return Qy.isOnline()?H(this,da).resumePausedMutations():Promise.resolve()}getQueryCache(){return H(this,an)}getMutationCache(){return H(this,da)}getDefaultOptions(){return H(this,ha)}setDefaultOptions(t){Ie(this,ha,t)}setQueryDefaults(t,e){H(this,_c).set(Lf(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...H(this,_c).values()];let n={};return e.forEach(s=>{Pf(t,s.queryKey)&&(n={...n,...s.defaultOptions})}),n}setMutationDefaults(t,e){H(this,Ac).set(Lf(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...H(this,Ac).values()];let n={};return e.forEach(s=>{Pf(t,s.mutationKey)&&(n={...n,...s.defaultOptions})}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...H(this,ha).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=pC(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.enabled!==!0&&e.queryFn===mC&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...H(this,ha).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){H(this,an).clear(),H(this,da).clear()}},an=new WeakMap,da=new WeakMap,ha=new WeakMap,_c=new WeakMap,Ac=new WeakMap,fa=new WeakMap,Dc=new WeakMap,Oc=new WeakMap,eA),js,Lt,$p,Ts,Pl,Fc,Fo,Ip,Lc,Pc,Ml,zl,pa,Mc,Bl,uf,Ep,V1,Rp,U1,_p,W1,Ap,j1,Dp,G1,Op,H1,Fp,q1,lb,bA,tA,mW=(tA=class extends Pp{constructor(e,n){super();Ve(this,Bl);Ve(this,Ep);Ve(this,Rp);Ve(this,_p);Ve(this,Ap);Ve(this,Dp);Ve(this,Op);Ve(this,Fp);Ve(this,lb);Ve(this,js,void 0);Ve(this,Lt,void 0);Ve(this,$p,void 0);Ve(this,Ts,void 0);Ve(this,Pl,void 0);Ve(this,Fc,void 0);Ve(this,Fo,void 0);Ve(this,Ip,void 0);Ve(this,Lc,void 0);Ve(this,Pc,void 0);Ve(this,Ml,void 0);Ve(this,zl,void 0);Ve(this,pa,void 0);Ve(this,Mc,new Set);this.options=n,Ie(this,js,e),Ie(this,Fo,null),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(H(this,Lt).addObserver(this),UI(H(this,Lt),this.options)?gt(this,Bl,uf).call(this):this.updateResult(),gt(this,Ap,j1).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return K1(H(this,Lt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return K1(H(this,Lt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,gt(this,Dp,G1).call(this),gt(this,Op,H1).call(this),H(this,Lt).removeObserver(this)}setOptions(e,n){const s=this.options,r=H(this,Lt);if(this.options=H(this,js).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");gt(this,Fp,q1).call(this),H(this,Lt).setOptions(this.options),s._defaulted&&!M1(this.options,s)&&H(this,js).getQueryCache().notify({type:"observerOptionsUpdated",query:H(this,Lt),observer:this});const o=this.hasListeners();o&&WI(H(this,Lt),r,this.options,s)&&gt(this,Bl,uf).call(this),this.updateResult(n),o&&(H(this,Lt)!==r||this.options.enabled!==s.enabled||this.options.staleTime!==s.staleTime)&&gt(this,Ep,V1).call(this);const i=gt(this,Rp,U1).call(this);o&&(H(this,Lt)!==r||this.options.enabled!==s.enabled||i!==H(this,pa))&&gt(this,_p,W1).call(this,i)}getOptimisticResult(e){const n=H(this,js).getQueryCache().build(H(this,js),e),s=this.createResult(n,e);return yW(this,s)&&(Ie(this,Ts,s),Ie(this,Fc,this.options),Ie(this,Pl,H(this,Lt).state)),s}getCurrentResult(){return H(this,Ts)}trackResult(e,n){const s={};return Object.keys(e).forEach(r=>{Object.defineProperty(s,r,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(r),n==null||n(r),e[r])})}),s}trackProp(e){H(this,Mc).add(e)}getCurrentQuery(){return H(this,Lt)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=H(this,js).defaultQueryOptions(e),s=H(this,js).getQueryCache().build(H(this,js),n);return s.isFetchingOptimistic=!0,s.fetch().then(()=>this.createResult(s,n))}fetch(e){return gt(this,Bl,uf).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),H(this,Ts)))}createResult(e,n){var C;const s=H(this,Lt),r=this.options,o=H(this,Ts),i=H(this,Pl),a=H(this,Fc),u=e!==s?e.state:H(this,$p),{state:c}=e;let d={...c},h=!1,f;if(n._optimisticResults){const N=this.hasListeners(),I=!N&&UI(e,n),E=N&&WI(e,s,n,r);(I||E)&&(d={...d,...yA(c.data,e.options)}),n._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:p,errorUpdatedAt:m,status:g}=d;if(n.select&&d.data!==void 0)if(o&&d.data===(i==null?void 0:i.data)&&n.select===H(this,Ip))f=H(this,Lc);else try{Ie(this,Ip,n.select),f=n.select(d.data),f=B1(o==null?void 0:o.data,f,n),Ie(this,Lc,f),Ie(this,Fo,null)}catch(N){Ie(this,Fo,N)}else f=d.data;if(n.placeholderData!==void 0&&f===void 0&&g==="pending"){let N;if(o!=null&&o.isPlaceholderData&&n.placeholderData===(a==null?void 0:a.placeholderData))N=o.data;else if(N=typeof n.placeholderData=="function"?n.placeholderData((C=H(this,Pc))==null?void 0:C.state.data,H(this,Pc)):n.placeholderData,n.select&&N!==void 0)try{N=n.select(N),Ie(this,Fo,null)}catch(I){Ie(this,Fo,I)}N!==void 0&&(g="success",f=B1(o==null?void 0:o.data,N,n),h=!0)}H(this,Fo)&&(p=H(this,Fo),f=H(this,Lc),m=Date.now(),g="error");const y=d.fetchStatus==="fetching",b=g==="pending",v=g==="error",x=b&&y,w=f!==void 0;return{status:g,fetchStatus:d.fetchStatus,isPending:b,isSuccess:g==="success",isError:v,isInitialLoading:x,isLoading:x,data:f,dataUpdatedAt:d.dataUpdatedAt,error:p,errorUpdatedAt:m,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>u.dataUpdateCount||d.errorUpdateCount>u.errorUpdateCount,isFetching:y,isRefetching:y&&!b,isLoadingError:v&&!w,isPaused:d.fetchStatus==="paused",isPlaceholderData:h,isRefetchError:v&&w,isStale:bC(e,n),refetch:this.refetch}}updateResult(e){const n=H(this,Ts),s=this.createResult(H(this,Lt),this.options);if(Ie(this,Pl,H(this,Lt).state),Ie(this,Fc,this.options),H(this,Pl).data!==void 0&&Ie(this,Pc,H(this,Lt)),M1(s,n))return;Ie(this,Ts,s);const r={},o=()=>{if(!n)return!0;const{notifyOnChangeProps:i}=this.options,a=typeof i=="function"?i():i;if(a==="all"||!a&&!H(this,Mc).size)return!0;const l=new Set(a??H(this,Mc));return this.options.throwOnError&&l.add("error"),Object.keys(H(this,Ts)).some(u=>{const c=u;return H(this,Ts)[c]!==n[c]&&l.has(c)})};(e==null?void 0:e.listeners)!==!1&&o()&&(r.listeners=!0),gt(this,lb,bA).call(this,{...r,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&gt(this,Ap,j1).call(this)}},js=new WeakMap,Lt=new WeakMap,$p=new WeakMap,Ts=new WeakMap,Pl=new WeakMap,Fc=new WeakMap,Fo=new WeakMap,Ip=new WeakMap,Lc=new WeakMap,Pc=new WeakMap,Ml=new WeakMap,zl=new WeakMap,pa=new WeakMap,Mc=new WeakMap,Bl=new WeakSet,uf=function(e){gt(this,Fp,q1).call(this);let n=H(this,Lt).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(Lr)),n},Ep=new WeakSet,V1=function(){if(gt(this,Dp,G1).call(this),zc||H(this,Ts).isStale||!P1(this.options.staleTime))return;const n=hA(H(this,Ts).dataUpdatedAt,this.options.staleTime)+1;Ie(this,Ml,setTimeout(()=>{H(this,Ts).isStale||this.updateResult()},n))},Rp=new WeakSet,U1=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(H(this,Lt)):this.options.refetchInterval)??!1},_p=new WeakSet,W1=function(e){gt(this,Op,H1).call(this),Ie(this,pa,e),!(zc||this.options.enabled===!1||!P1(H(this,pa))||H(this,pa)===0)&&Ie(this,zl,setInterval(()=>{(this.options.refetchIntervalInBackground||gC.isFocused())&&gt(this,Bl,uf).call(this)},H(this,pa)))},Ap=new WeakSet,j1=function(){gt(this,Ep,V1).call(this),gt(this,_p,W1).call(this,gt(this,Rp,U1).call(this))},Dp=new WeakSet,G1=function(){H(this,Ml)&&(clearTimeout(H(this,Ml)),Ie(this,Ml,void 0))},Op=new WeakSet,H1=function(){H(this,zl)&&(clearInterval(H(this,zl)),Ie(this,zl,void 0))},Fp=new WeakSet,q1=function(){const e=H(this,js).getQueryCache().build(H(this,js),this.options);if(e===H(this,Lt))return;const n=H(this,Lt);Ie(this,Lt,e),Ie(this,$p,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},lb=new WeakSet,bA=function(e){as.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(H(this,Ts))}),H(this,js).getQueryCache().notify({query:H(this,Lt),type:"observerResultsUpdated"})})},tA);function gW(t,e){return e.enabled!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function UI(t,e){return gW(t,e)||t.state.data!==void 0&&K1(t,e,e.refetchOnMount)}function K1(t,e,n){if(e.enabled!==!1){const s=typeof n=="function"?n(t):n;return s==="always"||s!==!1&&bC(t,e)}return!1}function WI(t,e,n,s){return(t!==e||s.enabled===!1)&&(!n.suspense||t.state.status!=="error")&&bC(t,n)}function bC(t,e){return e.enabled!==!1&&t.isStaleByTime(e.staleTime)}function yW(t,e){return!M1(t.getCurrentResult(),e)}var vA=R.createContext(void 0),bW=t=>{const e=R.useContext(vA);if(t)return t;if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},vW=({client:t,children:e})=>(R.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),se.jsx(vA.Provider,{value:t,children:e})),xA=R.createContext(!1),xW=()=>R.useContext(xA);xA.Provider;function wW(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var SW=R.createContext(wW()),kW=()=>R.useContext(SW);function CW(t,e){return typeof t=="function"?t(...e):!!t}var NW=(t,e)=>{(t.suspense||t.throwOnError)&&(e.isReset()||(t.retryOnMount=!1))},TW=t=>{R.useEffect(()=>{t.clearReset()},[t])},$W=({result:t,errorResetBoundary:e,throwOnError:n,query:s})=>t.isError&&!e.isReset()&&!t.isFetching&&s&&CW(n,[t.error,s]),IW=t=>{t.suspense&&typeof t.staleTime!="number"&&(t.staleTime=1e3)},EW=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,RW=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function _W(t,e,n){const s=bW(n),r=xW(),o=kW(),i=s.defaultQueryOptions(t);i._optimisticResults=r?"isRestoring":"optimistic",IW(i),NW(i,o),TW(o);const[a]=R.useState(()=>new e(s,i)),l=a.getOptimisticResult(i);if(R.useSyncExternalStore(R.useCallback(u=>{const c=r?()=>{}:a.subscribe(as.batchCalls(u));return a.updateResult(),c},[a,r]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),R.useEffect(()=>{a.setOptions(i,{listeners:!1})},[i,a]),EW(i,l))throw RW(i,a,o);if($W({result:l,errorResetBoundary:o,throwOnError:i.throwOnError,query:s.getQueryCache().get(i.queryHash)}))throw l.error;return i.notifyOnChangeProps?l:a.trackResult(l)}function wA(t,e){return _W(t,mW,e)}var X1={},SA={exports:{}},Tr={},kA={exports:{}},CA={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,j){var q=F.length;F.push(j);e:for(;0<q;){var J=q-1>>>1,_=F[J];if(0<r(_,j))F[J]=j,F[q]=_,q=J;else break e}}function n(F){return F.length===0?null:F[0]}function s(F){if(F.length===0)return null;var j=F[0],q=F.pop();if(q!==j){F[0]=q;e:for(var J=0,_=F.length,W=_>>>1;J<W;){var Z=2*(J+1)-1,ie=F[Z],re=Z+1,fe=F[re];if(0>r(ie,q))re<_&&0>r(fe,ie)?(F[J]=fe,F[re]=q,J=re):(F[J]=ie,F[Z]=q,J=Z);else if(re<_&&0>r(fe,q))F[J]=fe,F[re]=q,J=re;else break e}}return j}function r(F,j){var q=F.sortIndex-j.sortIndex;return q!==0?q:F.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();t.unstable_now=function(){return i.now()-a}}var l=[],u=[],c=1,d=null,h=3,f=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(F){for(var j=n(u);j!==null;){if(j.callback===null)s(u);else if(j.startTime<=F)s(u),j.sortIndex=j.expirationTime,e(l,j);else break;j=n(u)}}function x(F){if(m=!1,v(F),!p)if(n(l)!==null)p=!0,Y(w);else{var j=n(u);j!==null&&te(x,j.startTime-F)}}function w(F,j){p=!1,m&&(m=!1,y(N),N=-1),f=!0;var q=h;try{for(v(j),d=n(l);d!==null&&(!(d.expirationTime>j)||F&&!A());){var J=d.callback;if(typeof J=="function"){d.callback=null,h=d.priorityLevel;var _=J(d.expirationTime<=j);j=t.unstable_now(),typeof _=="function"?d.callback=_:d===n(l)&&s(l),v(j)}else s(l);d=n(l)}if(d!==null)var W=!0;else{var Z=n(u);Z!==null&&te(x,Z.startTime-j),W=!1}return W}finally{d=null,h=q,f=!1}}var S=!1,C=null,N=-1,I=5,E=-1;function A(){return!(t.unstable_now()-E<I)}function z(){if(C!==null){var F=t.unstable_now();E=F;var j=!0;try{j=C(!0,F)}finally{j?V():(S=!1,C=null)}}else S=!1}var V;if(typeof b=="function")V=function(){b(z)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,K=P.port2;P.port1.onmessage=z,V=function(){K.postMessage(null)}}else V=function(){g(z,0)};function Y(F){C=F,S||(S=!0,V())}function te(F,j){N=g(function(){F(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,Y(w))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(F){switch(h){case 1:case 2:case 3:var j=3;break;default:j=h}var q=h;h=j;try{return F()}finally{h=q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,j){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var q=h;h=F;try{return j()}finally{h=q}},t.unstable_scheduleCallback=function(F,j,q){var J=t.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?J+q:J):q=J,F){case 1:var _=-1;break;case 2:_=250;break;case 5:_=1073741823;break;case 4:_=1e4;break;default:_=5e3}return _=q+_,F={id:c++,callback:j,priorityLevel:F,startTime:q,expirationTime:_,sortIndex:-1},q>J?(F.sortIndex=q,e(u,F),n(l)===null&&F===n(u)&&(m?(y(N),N=-1):m=!0,te(x,q-J))):(F.sortIndex=_,e(l,F),p||f||(p=!0,Y(w))),F},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(F){var j=h;return function(){var q=h;h=j;try{return F.apply(this,arguments)}finally{h=q}}}})(CA);kA.exports=CA;var AW=kA.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NA=R,kr=AW;function ge(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var TA=new Set,Mf={};function bu(t,e){Bc(t,e),Bc(t+"Capture",e)}function Bc(t,e){for(Mf[t]=e,t=0;t<e.length;t++)TA.add(e[t])}var Si=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Y1=Object.prototype.hasOwnProperty,DW=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,jI={},GI={};function OW(t){return Y1.call(GI,t)?!0:Y1.call(jI,t)?!1:DW.test(t)?GI[t]=!0:(jI[t]=!0,!1)}function FW(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function LW(t,e,n,s){if(e===null||typeof e>"u"||FW(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function zs(t,e,n,s,r,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var us={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){us[t]=new zs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];us[e]=new zs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){us[t]=new zs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){us[t]=new zs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){us[t]=new zs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){us[t]=new zs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){us[t]=new zs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){us[t]=new zs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){us[t]=new zs(t,5,!1,t.toLowerCase(),null,!1,!1)});var vC=/[\-:]([a-z])/g;function xC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(vC,xC);us[e]=new zs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(vC,xC);us[e]=new zs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(vC,xC);us[e]=new zs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){us[t]=new zs(t,1,!1,t.toLowerCase(),null,!1,!1)});us.xlinkHref=new zs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){us[t]=new zs(t,1,!1,t.toLowerCase(),null,!0,!0)});function wC(t,e,n,s){var r=us.hasOwnProperty(e)?us[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(LW(e,n,r,s)&&(n=null),s||r===null?OW(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var Di=NA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wg=Symbol.for("react.element"),Ju=Symbol.for("react.portal"),ec=Symbol.for("react.fragment"),SC=Symbol.for("react.strict_mode"),Q1=Symbol.for("react.profiler"),$A=Symbol.for("react.provider"),IA=Symbol.for("react.context"),kC=Symbol.for("react.forward_ref"),Z1=Symbol.for("react.suspense"),J1=Symbol.for("react.suspense_list"),CC=Symbol.for("react.memo"),sa=Symbol.for("react.lazy"),EA=Symbol.for("react.offscreen"),HI=Symbol.iterator;function Ph(t){return t===null||typeof t!="object"?null:(t=HI&&t[HI]||t["@@iterator"],typeof t=="function"?t:null)}var on=Object.assign,$w;function cf(t){if($w===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);$w=e&&e[1]||""}return`
`+$w+t}var Iw=!1;function Ew(t,e){if(!t||Iw)return"";Iw=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){s=u}t.call(e.prototype)}else{try{throw Error()}catch(u){s=u}t()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),o=s.stack.split(`
`),i=r.length-1,a=o.length-1;1<=i&&0<=a&&r[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(r[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||r[i]!==o[a]){var l=`
`+r[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=a);break}}}finally{Iw=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?cf(t):""}function PW(t){switch(t.tag){case 5:return cf(t.type);case 16:return cf("Lazy");case 13:return cf("Suspense");case 19:return cf("SuspenseList");case 0:case 2:case 15:return t=Ew(t.type,!1),t;case 11:return t=Ew(t.type.render,!1),t;case 1:return t=Ew(t.type,!0),t;default:return""}}function eS(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ec:return"Fragment";case Ju:return"Portal";case Q1:return"Profiler";case SC:return"StrictMode";case Z1:return"Suspense";case J1:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case IA:return(t.displayName||"Context")+".Consumer";case $A:return(t._context.displayName||"Context")+".Provider";case kC:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case CC:return e=t.displayName||null,e!==null?e:eS(t.type)||"Memo";case sa:e=t._payload,t=t._init;try{return eS(t(e))}catch{}}return null}function MW(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return eS(e);case 8:return e===SC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Da(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function RA(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function zW(t){var e=RA(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(i){s=""+i,o.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(i){s=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function jg(t){t._valueTracker||(t._valueTracker=zW(t))}function _A(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=RA(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function Zy(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function tS(t,e){var n=e.checked;return on({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function qI(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=Da(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function AA(t,e){e=e.checked,e!=null&&wC(t,"checked",e,!1)}function nS(t,e){AA(t,e);var n=Da(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?sS(t,e.type,n):e.hasOwnProperty("defaultValue")&&sS(t,e.type,Da(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function KI(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function sS(t,e,n){(e!=="number"||Zy(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var df=Array.isArray;function pc(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+Da(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function rS(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ge(91));return on({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function XI(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ge(92));if(df(n)){if(1<n.length)throw Error(ge(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Da(n)}}function DA(t,e){var n=Da(e.value),s=Da(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function YI(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function OA(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function oS(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?OA(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Gg,FA=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Gg=Gg||document.createElement("div"),Gg.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Gg.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function zf(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var wf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},BW=["Webkit","ms","Moz","O"];Object.keys(wf).forEach(function(t){BW.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),wf[e]=wf[t]})});function LA(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||wf.hasOwnProperty(t)&&wf[t]?(""+e).trim():e+"px"}function PA(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=LA(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var VW=on({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function iS(t,e){if(e){if(VW[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ge(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ge(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ge(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ge(62))}}function aS(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lS=null;function NC(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var uS=null,mc=null,gc=null;function QI(t){if(t=Bp(t)){if(typeof uS!="function")throw Error(ge(280));var e=t.stateNode;e&&(e=mb(e),uS(t.stateNode,t.type,e))}}function MA(t){mc?gc?gc.push(t):gc=[t]:mc=t}function zA(){if(mc){var t=mc,e=gc;if(gc=mc=null,QI(t),e)for(t=0;t<e.length;t++)QI(e[t])}}function BA(t,e){return t(e)}function VA(){}var Rw=!1;function UA(t,e,n){if(Rw)return t(e,n);Rw=!0;try{return BA(t,e,n)}finally{Rw=!1,(mc!==null||gc!==null)&&(VA(),zA())}}function Bf(t,e){var n=t.stateNode;if(n===null)return null;var s=mb(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ge(231,e,typeof n));return n}var cS=!1;if(Si)try{var Mh={};Object.defineProperty(Mh,"passive",{get:function(){cS=!0}}),window.addEventListener("test",Mh,Mh),window.removeEventListener("test",Mh,Mh)}catch{cS=!1}function UW(t,e,n,s,r,o,i,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var Sf=!1,Jy=null,e0=!1,dS=null,WW={onError:function(t){Sf=!0,Jy=t}};function jW(t,e,n,s,r,o,i,a,l){Sf=!1,Jy=null,UW.apply(WW,arguments)}function GW(t,e,n,s,r,o,i,a,l){if(jW.apply(this,arguments),Sf){if(Sf){var u=Jy;Sf=!1,Jy=null}else throw Error(ge(198));e0||(e0=!0,dS=u)}}function vu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function WA(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ZI(t){if(vu(t)!==t)throw Error(ge(188))}function HW(t){var e=t.alternate;if(!e){if(e=vu(t),e===null)throw Error(ge(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var o=r.alternate;if(o===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return ZI(r),t;if(o===s)return ZI(r),e;o=o.sibling}throw Error(ge(188))}if(n.return!==s.return)n=r,s=o;else{for(var i=!1,a=r.child;a;){if(a===n){i=!0,n=r,s=o;break}if(a===s){i=!0,s=r,n=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===n){i=!0,n=o,s=r;break}if(a===s){i=!0,s=o,n=r;break}a=a.sibling}if(!i)throw Error(ge(189))}}if(n.alternate!==s)throw Error(ge(190))}if(n.tag!==3)throw Error(ge(188));return n.stateNode.current===n?t:e}function jA(t){return t=HW(t),t!==null?GA(t):null}function GA(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=GA(t);if(e!==null)return e;t=t.sibling}return null}var HA=kr.unstable_scheduleCallback,JI=kr.unstable_cancelCallback,qW=kr.unstable_shouldYield,KW=kr.unstable_requestPaint,vn=kr.unstable_now,XW=kr.unstable_getCurrentPriorityLevel,TC=kr.unstable_ImmediatePriority,qA=kr.unstable_UserBlockingPriority,t0=kr.unstable_NormalPriority,YW=kr.unstable_LowPriority,KA=kr.unstable_IdlePriority,db=null,Wo=null;function QW(t){if(Wo&&typeof Wo.onCommitFiberRoot=="function")try{Wo.onCommitFiberRoot(db,t,void 0,(t.current.flags&128)===128)}catch{}}var go=Math.clz32?Math.clz32:ej,ZW=Math.log,JW=Math.LN2;function ej(t){return t>>>=0,t===0?32:31-(ZW(t)/JW|0)|0}var Hg=64,qg=4194304;function hf(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function n0(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,o=t.pingedLanes,i=n&268435455;if(i!==0){var a=i&~r;a!==0?s=hf(a):(o&=i,o!==0&&(s=hf(o)))}else i=n&~r,i!==0?s=hf(i):o!==0&&(s=hf(o));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,o=e&-e,r>=o||r===16&&(o&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-go(e),r=1<<n,s|=t[n],e&=~r;return s}function tj(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nj(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,o=t.pendingLanes;0<o;){var i=31-go(o),a=1<<i,l=r[i];l===-1?(!(a&n)||a&s)&&(r[i]=tj(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function hS(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function XA(){var t=Hg;return Hg<<=1,!(Hg&4194240)&&(Hg=64),t}function _w(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Mp(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-go(e),t[e]=n}function sj(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-go(n),o=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~o}}function $C(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-go(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var $t=0;function YA(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var QA,IC,ZA,JA,eD,fS=!1,Kg=[],xa=null,wa=null,Sa=null,Vf=new Map,Uf=new Map,aa=[],rj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function eE(t,e){switch(t){case"focusin":case"focusout":xa=null;break;case"dragenter":case"dragleave":wa=null;break;case"mouseover":case"mouseout":Sa=null;break;case"pointerover":case"pointerout":Vf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uf.delete(e.pointerId)}}function zh(t,e,n,s,r,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:o,targetContainers:[r]},e!==null&&(e=Bp(e),e!==null&&IC(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function oj(t,e,n,s,r){switch(e){case"focusin":return xa=zh(xa,t,e,n,s,r),!0;case"dragenter":return wa=zh(wa,t,e,n,s,r),!0;case"mouseover":return Sa=zh(Sa,t,e,n,s,r),!0;case"pointerover":var o=r.pointerId;return Vf.set(o,zh(Vf.get(o)||null,t,e,n,s,r)),!0;case"gotpointercapture":return o=r.pointerId,Uf.set(o,zh(Uf.get(o)||null,t,e,n,s,r)),!0}return!1}function tD(t){var e=Cl(t.target);if(e!==null){var n=vu(e);if(n!==null){if(e=n.tag,e===13){if(e=WA(n),e!==null){t.blockedOn=e,eD(t.priority,function(){ZA(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ry(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=pS(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);lS=s,n.target.dispatchEvent(s),lS=null}else return e=Bp(n),e!==null&&IC(e),t.blockedOn=n,!1;e.shift()}return!0}function tE(t,e,n){Ry(t)&&n.delete(e)}function ij(){fS=!1,xa!==null&&Ry(xa)&&(xa=null),wa!==null&&Ry(wa)&&(wa=null),Sa!==null&&Ry(Sa)&&(Sa=null),Vf.forEach(tE),Uf.forEach(tE)}function Bh(t,e){t.blockedOn===e&&(t.blockedOn=null,fS||(fS=!0,kr.unstable_scheduleCallback(kr.unstable_NormalPriority,ij)))}function Wf(t){function e(r){return Bh(r,t)}if(0<Kg.length){Bh(Kg[0],t);for(var n=1;n<Kg.length;n++){var s=Kg[n];s.blockedOn===t&&(s.blockedOn=null)}}for(xa!==null&&Bh(xa,t),wa!==null&&Bh(wa,t),Sa!==null&&Bh(Sa,t),Vf.forEach(e),Uf.forEach(e),n=0;n<aa.length;n++)s=aa[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<aa.length&&(n=aa[0],n.blockedOn===null);)tD(n),n.blockedOn===null&&aa.shift()}var yc=Di.ReactCurrentBatchConfig,s0=!0;function aj(t,e,n,s){var r=$t,o=yc.transition;yc.transition=null;try{$t=1,EC(t,e,n,s)}finally{$t=r,yc.transition=o}}function lj(t,e,n,s){var r=$t,o=yc.transition;yc.transition=null;try{$t=4,EC(t,e,n,s)}finally{$t=r,yc.transition=o}}function EC(t,e,n,s){if(s0){var r=pS(t,e,n,s);if(r===null)Vw(t,e,s,r0,n),eE(t,s);else if(oj(r,t,e,n,s))s.stopPropagation();else if(eE(t,s),e&4&&-1<rj.indexOf(t)){for(;r!==null;){var o=Bp(r);if(o!==null&&QA(o),o=pS(t,e,n,s),o===null&&Vw(t,e,s,r0,n),o===r)break;r=o}r!==null&&s.stopPropagation()}else Vw(t,e,s,null,n)}}var r0=null;function pS(t,e,n,s){if(r0=null,t=NC(s),t=Cl(t),t!==null)if(e=vu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=WA(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return r0=t,null}function nD(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(XW()){case TC:return 1;case qA:return 4;case t0:case YW:return 16;case KA:return 536870912;default:return 16}default:return 16}}var ma=null,RC=null,_y=null;function sD(){if(_y)return _y;var t,e=RC,n=e.length,s,r="value"in ma?ma.value:ma.textContent,o=r.length;for(t=0;t<n&&e[t]===r[t];t++);var i=n-t;for(s=1;s<=i&&e[n-s]===r[o-s];s++);return _y=r.slice(t,1<s?1-s:void 0)}function Ay(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Xg(){return!0}function nE(){return!1}function $r(t){function e(n,s,r,o,i){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Xg:nE,this.isPropagationStopped=nE,this}return on(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Xg)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Xg)},persist:function(){},isPersistent:Xg}),e}var yd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_C=$r(yd),zp=on({},yd,{view:0,detail:0}),uj=$r(zp),Aw,Dw,Vh,hb=on({},zp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:AC,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Vh&&(Vh&&t.type==="mousemove"?(Aw=t.screenX-Vh.screenX,Dw=t.screenY-Vh.screenY):Dw=Aw=0,Vh=t),Aw)},movementY:function(t){return"movementY"in t?t.movementY:Dw}}),sE=$r(hb),cj=on({},hb,{dataTransfer:0}),dj=$r(cj),hj=on({},zp,{relatedTarget:0}),Ow=$r(hj),fj=on({},yd,{animationName:0,elapsedTime:0,pseudoElement:0}),pj=$r(fj),mj=on({},yd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),gj=$r(mj),yj=on({},yd,{data:0}),rE=$r(yj),bj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wj(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=xj[t])?!!e[t]:!1}function AC(){return wj}var Sj=on({},zp,{key:function(t){if(t.key){var e=bj[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ay(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?vj[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:AC,charCode:function(t){return t.type==="keypress"?Ay(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ay(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),kj=$r(Sj),Cj=on({},hb,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),oE=$r(Cj),Nj=on({},zp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:AC}),Tj=$r(Nj),$j=on({},yd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ij=$r($j),Ej=on({},hb,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Rj=$r(Ej),_j=[9,13,27,32],DC=Si&&"CompositionEvent"in window,kf=null;Si&&"documentMode"in document&&(kf=document.documentMode);var Aj=Si&&"TextEvent"in window&&!kf,rD=Si&&(!DC||kf&&8<kf&&11>=kf),iE=" ",aE=!1;function oD(t,e){switch(t){case"keyup":return _j.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function iD(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var tc=!1;function Dj(t,e){switch(t){case"compositionend":return iD(e);case"keypress":return e.which!==32?null:(aE=!0,iE);case"textInput":return t=e.data,t===iE&&aE?null:t;default:return null}}function Oj(t,e){if(tc)return t==="compositionend"||!DC&&oD(t,e)?(t=sD(),_y=RC=ma=null,tc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return rD&&e.locale!=="ko"?null:e.data;default:return null}}var Fj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Fj[t.type]:e==="textarea"}function aD(t,e,n,s){MA(s),e=o0(e,"onChange"),0<e.length&&(n=new _C("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Cf=null,jf=null;function Lj(t){bD(t,0)}function fb(t){var e=rc(t);if(_A(e))return t}function Pj(t,e){if(t==="change")return e}var lD=!1;if(Si){var Fw;if(Si){var Lw="oninput"in document;if(!Lw){var uE=document.createElement("div");uE.setAttribute("oninput","return;"),Lw=typeof uE.oninput=="function"}Fw=Lw}else Fw=!1;lD=Fw&&(!document.documentMode||9<document.documentMode)}function cE(){Cf&&(Cf.detachEvent("onpropertychange",uD),jf=Cf=null)}function uD(t){if(t.propertyName==="value"&&fb(jf)){var e=[];aD(e,jf,t,NC(t)),UA(Lj,e)}}function Mj(t,e,n){t==="focusin"?(cE(),Cf=e,jf=n,Cf.attachEvent("onpropertychange",uD)):t==="focusout"&&cE()}function zj(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return fb(jf)}function Bj(t,e){if(t==="click")return fb(e)}function Vj(t,e){if(t==="input"||t==="change")return fb(e)}function Uj(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var wo=typeof Object.is=="function"?Object.is:Uj;function Gf(t,e){if(wo(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!Y1.call(e,r)||!wo(t[r],e[r]))return!1}return!0}function dE(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function hE(t,e){var n=dE(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=dE(n)}}function cD(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?cD(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function dD(){for(var t=window,e=Zy();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Zy(t.document)}return e}function OC(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Wj(t){var e=dD(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&cD(n.ownerDocument.documentElement,n)){if(s!==null&&OC(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,o=Math.min(s.start,r);s=s.end===void 0?o:Math.min(s.end,r),!t.extend&&o>s&&(r=s,s=o,o=r),r=hE(n,o);var i=hE(n,s);r&&i&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),o>s?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var jj=Si&&"documentMode"in document&&11>=document.documentMode,nc=null,mS=null,Nf=null,gS=!1;function fE(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;gS||nc==null||nc!==Zy(s)||(s=nc,"selectionStart"in s&&OC(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Nf&&Gf(Nf,s)||(Nf=s,s=o0(mS,"onSelect"),0<s.length&&(e=new _C("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=nc)))}function Yg(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var sc={animationend:Yg("Animation","AnimationEnd"),animationiteration:Yg("Animation","AnimationIteration"),animationstart:Yg("Animation","AnimationStart"),transitionend:Yg("Transition","TransitionEnd")},Pw={},hD={};Si&&(hD=document.createElement("div").style,"AnimationEvent"in window||(delete sc.animationend.animation,delete sc.animationiteration.animation,delete sc.animationstart.animation),"TransitionEvent"in window||delete sc.transitionend.transition);function pb(t){if(Pw[t])return Pw[t];if(!sc[t])return t;var e=sc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in hD)return Pw[t]=e[n];return t}var fD=pb("animationend"),pD=pb("animationiteration"),mD=pb("animationstart"),gD=pb("transitionend"),yD=new Map,pE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qa(t,e){yD.set(t,e),bu(e,[t])}for(var Mw=0;Mw<pE.length;Mw++){var zw=pE[Mw],Gj=zw.toLowerCase(),Hj=zw[0].toUpperCase()+zw.slice(1);qa(Gj,"on"+Hj)}qa(fD,"onAnimationEnd");qa(pD,"onAnimationIteration");qa(mD,"onAnimationStart");qa("dblclick","onDoubleClick");qa("focusin","onFocus");qa("focusout","onBlur");qa(gD,"onTransitionEnd");Bc("onMouseEnter",["mouseout","mouseover"]);Bc("onMouseLeave",["mouseout","mouseover"]);Bc("onPointerEnter",["pointerout","pointerover"]);Bc("onPointerLeave",["pointerout","pointerover"]);bu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));bu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));bu("onBeforeInput",["compositionend","keypress","textInput","paste"]);bu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));bu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));bu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ff="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qj=new Set("cancel close invalid load scroll toggle".split(" ").concat(ff));function mE(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,GW(s,e,void 0,t),t.currentTarget=null}function bD(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var o=void 0;if(e)for(var i=s.length-1;0<=i;i--){var a=s[i],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==o&&r.isPropagationStopped())break e;mE(r,a,u),o=l}else for(i=0;i<s.length;i++){if(a=s[i],l=a.instance,u=a.currentTarget,a=a.listener,l!==o&&r.isPropagationStopped())break e;mE(r,a,u),o=l}}}if(e0)throw t=dS,e0=!1,dS=null,t}function Vt(t,e){var n=e[wS];n===void 0&&(n=e[wS]=new Set);var s=t+"__bubble";n.has(s)||(vD(e,t,2,!1),n.add(s))}function Bw(t,e,n){var s=0;e&&(s|=4),vD(n,t,s,e)}var Qg="_reactListening"+Math.random().toString(36).slice(2);function Hf(t){if(!t[Qg]){t[Qg]=!0,TA.forEach(function(n){n!=="selectionchange"&&(qj.has(n)||Bw(n,!1,t),Bw(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Qg]||(e[Qg]=!0,Bw("selectionchange",!1,e))}}function vD(t,e,n,s){switch(nD(e)){case 1:var r=aj;break;case 4:r=lj;break;default:r=EC}n=r.bind(null,e,n,t),r=void 0,!cS||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Vw(t,e,n,s,r){var o=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var i=s.tag;if(i===3||i===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(i===4)for(i=s.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;i=i.return}for(;a!==null;){if(i=Cl(a),i===null)return;if(l=i.tag,l===5||l===6){s=o=i;continue e}a=a.parentNode}}s=s.return}UA(function(){var u=o,c=NC(n),d=[];e:{var h=yD.get(t);if(h!==void 0){var f=_C,p=t;switch(t){case"keypress":if(Ay(n)===0)break e;case"keydown":case"keyup":f=kj;break;case"focusin":p="focus",f=Ow;break;case"focusout":p="blur",f=Ow;break;case"beforeblur":case"afterblur":f=Ow;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=sE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=dj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Tj;break;case fD:case pD:case mD:f=pj;break;case gD:f=Ij;break;case"scroll":f=uj;break;case"wheel":f=Rj;break;case"copy":case"cut":case"paste":f=gj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=oE}var m=(e&4)!==0,g=!m&&t==="scroll",y=m?h!==null?h+"Capture":null:h;m=[];for(var b=u,v;b!==null;){v=b;var x=v.stateNode;if(v.tag===5&&x!==null&&(v=x,y!==null&&(x=Bf(b,y),x!=null&&m.push(qf(b,x,v)))),g)break;b=b.return}0<m.length&&(h=new f(h,p,null,n,c),d.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==lS&&(p=n.relatedTarget||n.fromElement)&&(Cl(p)||p[ki]))break e;if((f||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=u,p=p?Cl(p):null,p!==null&&(g=vu(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=u),f!==p)){if(m=sE,x="onMouseLeave",y="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(m=oE,x="onPointerLeave",y="onPointerEnter",b="pointer"),g=f==null?h:rc(f),v=p==null?h:rc(p),h=new m(x,b+"leave",f,n,c),h.target=g,h.relatedTarget=v,x=null,Cl(c)===u&&(m=new m(y,b+"enter",p,n,c),m.target=v,m.relatedTarget=g,x=m),g=x,f&&p)t:{for(m=f,y=p,b=0,v=m;v;v=Wu(v))b++;for(v=0,x=y;x;x=Wu(x))v++;for(;0<b-v;)m=Wu(m),b--;for(;0<v-b;)y=Wu(y),v--;for(;b--;){if(m===y||y!==null&&m===y.alternate)break t;m=Wu(m),y=Wu(y)}m=null}else m=null;f!==null&&gE(d,h,f,m,!1),p!==null&&g!==null&&gE(d,g,p,m,!0)}}e:{if(h=u?rc(u):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var w=Pj;else if(lE(h))if(lD)w=Vj;else{w=zj;var S=Mj}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(w=Bj);if(w&&(w=w(t,u))){aD(d,w,n,c);break e}S&&S(t,h,u),t==="focusout"&&(S=h._wrapperState)&&S.controlled&&h.type==="number"&&sS(h,"number",h.value)}switch(S=u?rc(u):window,t){case"focusin":(lE(S)||S.contentEditable==="true")&&(nc=S,mS=u,Nf=null);break;case"focusout":Nf=mS=nc=null;break;case"mousedown":gS=!0;break;case"contextmenu":case"mouseup":case"dragend":gS=!1,fE(d,n,c);break;case"selectionchange":if(jj)break;case"keydown":case"keyup":fE(d,n,c)}var C;if(DC)e:{switch(t){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else tc?oD(t,n)&&(N="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(rD&&n.locale!=="ko"&&(tc||N!=="onCompositionStart"?N==="onCompositionEnd"&&tc&&(C=sD()):(ma=c,RC="value"in ma?ma.value:ma.textContent,tc=!0)),S=o0(u,N),0<S.length&&(N=new rE(N,t,null,n,c),d.push({event:N,listeners:S}),C?N.data=C:(C=iD(n),C!==null&&(N.data=C)))),(C=Aj?Dj(t,n):Oj(t,n))&&(u=o0(u,"onBeforeInput"),0<u.length&&(c=new rE("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=C))}bD(d,e)})}function qf(t,e,n){return{instance:t,listener:e,currentTarget:n}}function o0(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,o=r.stateNode;r.tag===5&&o!==null&&(r=o,o=Bf(t,n),o!=null&&s.unshift(qf(t,o,r)),o=Bf(t,e),o!=null&&s.push(qf(t,o,r))),t=t.return}return s}function Wu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function gE(t,e,n,s,r){for(var o=e._reactName,i=[];n!==null&&n!==s;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&u!==null&&(a=u,r?(l=Bf(n,o),l!=null&&i.unshift(qf(n,l,a))):r||(l=Bf(n,o),l!=null&&i.push(qf(n,l,a)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var Kj=/\r\n?/g,Xj=/\u0000|\uFFFD/g;function yE(t){return(typeof t=="string"?t:""+t).replace(Kj,`
`).replace(Xj,"")}function Zg(t,e,n){if(e=yE(e),yE(t)!==e&&n)throw Error(ge(425))}function i0(){}var yS=null,bS=null;function vS(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var xS=typeof setTimeout=="function"?setTimeout:void 0,Yj=typeof clearTimeout=="function"?clearTimeout:void 0,bE=typeof Promise=="function"?Promise:void 0,Qj=typeof queueMicrotask=="function"?queueMicrotask:typeof bE<"u"?function(t){return bE.resolve(null).then(t).catch(Zj)}:xS;function Zj(t){setTimeout(function(){throw t})}function Uw(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),Wf(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);Wf(e)}function ka(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function vE(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var bd=Math.random().toString(36).slice(2),zo="__reactFiber$"+bd,Kf="__reactProps$"+bd,ki="__reactContainer$"+bd,wS="__reactEvents$"+bd,Jj="__reactListeners$"+bd,eG="__reactHandles$"+bd;function Cl(t){var e=t[zo];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ki]||n[zo]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=vE(t);t!==null;){if(n=t[zo])return n;t=vE(t)}return e}t=n,n=t.parentNode}return null}function Bp(t){return t=t[zo]||t[ki],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function rc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ge(33))}function mb(t){return t[Kf]||null}var SS=[],oc=-1;function Ka(t){return{current:t}}function Wt(t){0>oc||(t.current=SS[oc],SS[oc]=null,oc--)}function Pt(t,e){oc++,SS[oc]=t.current,t.current=e}var Oa={},xs=Ka(Oa),Ys=Ka(!1),Kl=Oa;function Vc(t,e){var n=t.type.contextTypes;if(!n)return Oa;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},o;for(o in n)r[o]=e[o];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Qs(t){return t=t.childContextTypes,t!=null}function a0(){Wt(Ys),Wt(xs)}function xE(t,e,n){if(xs.current!==Oa)throw Error(ge(168));Pt(xs,e),Pt(Ys,n)}function xD(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(ge(108,MW(t)||"Unknown",r));return on({},n,s)}function l0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Oa,Kl=xs.current,Pt(xs,t),Pt(Ys,Ys.current),!0}function wE(t,e,n){var s=t.stateNode;if(!s)throw Error(ge(169));n?(t=xD(t,e,Kl),s.__reactInternalMemoizedMergedChildContext=t,Wt(Ys),Wt(xs),Pt(xs,t)):Wt(Ys),Pt(Ys,n)}var di=null,gb=!1,Ww=!1;function wD(t){di===null?di=[t]:di.push(t)}function tG(t){gb=!0,wD(t)}function Xa(){if(!Ww&&di!==null){Ww=!0;var t=0,e=$t;try{var n=di;for($t=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}di=null,gb=!1}catch(r){throw di!==null&&(di=di.slice(t+1)),HA(TC,Xa),r}finally{$t=e,Ww=!1}}return null}var ic=[],ac=0,u0=null,c0=0,zr=[],Br=0,Xl=null,yi=1,bi="";function fl(t,e){ic[ac++]=c0,ic[ac++]=u0,u0=t,c0=e}function SD(t,e,n){zr[Br++]=yi,zr[Br++]=bi,zr[Br++]=Xl,Xl=t;var s=yi;t=bi;var r=32-go(s)-1;s&=~(1<<r),n+=1;var o=32-go(e)+r;if(30<o){var i=r-r%5;o=(s&(1<<i)-1).toString(32),s>>=i,r-=i,yi=1<<32-go(e)+r|n<<r|s,bi=o+t}else yi=1<<o|n<<r|s,bi=t}function FC(t){t.return!==null&&(fl(t,1),SD(t,1,0))}function LC(t){for(;t===u0;)u0=ic[--ac],ic[ac]=null,c0=ic[--ac],ic[ac]=null;for(;t===Xl;)Xl=zr[--Br],zr[Br]=null,bi=zr[--Br],zr[Br]=null,yi=zr[--Br],zr[Br]=null}var xr=null,gr=null,Yt=!1,fo=null;function kD(t,e){var n=Vr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function SE(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,xr=t,gr=ka(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,xr=t,gr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Xl!==null?{id:yi,overflow:bi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Vr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,xr=t,gr=null,!0):!1;default:return!1}}function kS(t){return(t.mode&1)!==0&&(t.flags&128)===0}function CS(t){if(Yt){var e=gr;if(e){var n=e;if(!SE(t,e)){if(kS(t))throw Error(ge(418));e=ka(n.nextSibling);var s=xr;e&&SE(t,e)?kD(s,n):(t.flags=t.flags&-4097|2,Yt=!1,xr=t)}}else{if(kS(t))throw Error(ge(418));t.flags=t.flags&-4097|2,Yt=!1,xr=t}}}function kE(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;xr=t}function Jg(t){if(t!==xr)return!1;if(!Yt)return kE(t),Yt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!vS(t.type,t.memoizedProps)),e&&(e=gr)){if(kS(t))throw CD(),Error(ge(418));for(;e;)kD(t,e),e=ka(e.nextSibling)}if(kE(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ge(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){gr=ka(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}gr=null}}else gr=xr?ka(t.stateNode.nextSibling):null;return!0}function CD(){for(var t=gr;t;)t=ka(t.nextSibling)}function Uc(){gr=xr=null,Yt=!1}function PC(t){fo===null?fo=[t]:fo.push(t)}var nG=Di.ReactCurrentBatchConfig;function ao(t,e){if(t&&t.defaultProps){e=on({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var d0=Ka(null),h0=null,lc=null,MC=null;function zC(){MC=lc=h0=null}function BC(t){var e=d0.current;Wt(d0),t._currentValue=e}function NS(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function bc(t,e){h0=t,MC=lc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ks=!0),t.firstContext=null)}function Yr(t){var e=t._currentValue;if(MC!==t)if(t={context:t,memoizedValue:e,next:null},lc===null){if(h0===null)throw Error(ge(308));lc=t,h0.dependencies={lanes:0,firstContext:t}}else lc=lc.next=t;return e}var Nl=null;function VC(t){Nl===null?Nl=[t]:Nl.push(t)}function ND(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,VC(e)):(n.next=r.next,r.next=n),e.interleaved=n,Ci(t,s)}function Ci(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ra=!1;function UC(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function TD(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function vi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ca(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,wt&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,Ci(t,n)}return r=s.interleaved,r===null?(e.next=e,VC(s)):(e.next=r.next,r.next=e),s.interleaved=e,Ci(t,n)}function Dy(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,$C(t,n)}}function CE(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?r=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?r=o=e:o=o.next=e}else r=o=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function f0(t,e,n,s){var r=t.updateQueue;ra=!1;var o=r.firstBaseUpdate,i=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,i===null?o=u:i.next=u,i=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==i&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(o!==null){var d=r.baseState;i=0,c=u=l=null,a=o;do{var h=a.lane,f=a.eventTime;if((s&h)===h){c!==null&&(c=c.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(h=e,f=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=on({},d,h);break e;case 2:ra=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=r.effects,h===null?r.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=f,l=d):c=c.next=f,i|=h;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;h=a,a=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(!0);if(c===null&&(l=d),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,e=r.shared.interleaved,e!==null){r=e;do i|=r.lane,r=r.next;while(r!==e)}else o===null&&(r.shared.lanes=0);Ql|=i,t.lanes=i,t.memoizedState=d}}function NE(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(ge(191,r));r.call(s)}}}var $D=new NA.Component().refs;function TS(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:on({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var yb={isMounted:function(t){return(t=t._reactInternals)?vu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=Rs(),r=Ta(t),o=vi(s,r);o.payload=e,n!=null&&(o.callback=n),e=Ca(t,o,r),e!==null&&(yo(e,t,r,s),Dy(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=Rs(),r=Ta(t),o=vi(s,r);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Ca(t,o,r),e!==null&&(yo(e,t,r,s),Dy(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Rs(),s=Ta(t),r=vi(n,s);r.tag=2,e!=null&&(r.callback=e),e=Ca(t,r,s),e!==null&&(yo(e,t,s,n),Dy(e,t,s))}};function TE(t,e,n,s,r,o,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,o,i):e.prototype&&e.prototype.isPureReactComponent?!Gf(n,s)||!Gf(r,o):!0}function ID(t,e,n){var s=!1,r=Oa,o=e.contextType;return typeof o=="object"&&o!==null?o=Yr(o):(r=Qs(e)?Kl:xs.current,s=e.contextTypes,o=(s=s!=null)?Vc(t,r):Oa),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=yb,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=o),e}function $E(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&yb.enqueueReplaceState(e,e.state,null)}function $S(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=$D,UC(t);var o=e.contextType;typeof o=="object"&&o!==null?r.context=Yr(o):(o=Qs(e)?Kl:xs.current,r.context=Vc(t,o)),r.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(TS(t,e,o,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&yb.enqueueReplaceState(r,r.state,null),f0(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Uh(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ge(309));var s=n.stateNode}if(!s)throw Error(ge(147,t));var r=s,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var a=r.refs;a===$D&&(a=r.refs={}),i===null?delete a[o]:a[o]=i},e._stringRef=o,e)}if(typeof t!="string")throw Error(ge(284));if(!n._owner)throw Error(ge(290,t))}return t}function ey(t,e){throw t=Object.prototype.toString.call(e),Error(ge(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function IE(t){var e=t._init;return e(t._payload)}function ED(t){function e(y,b){if(t){var v=y.deletions;v===null?(y.deletions=[b],y.flags|=16):v.push(b)}}function n(y,b){if(!t)return null;for(;b!==null;)e(y,b),b=b.sibling;return null}function s(y,b){for(y=new Map;b!==null;)b.key!==null?y.set(b.key,b):y.set(b.index,b),b=b.sibling;return y}function r(y,b){return y=$a(y,b),y.index=0,y.sibling=null,y}function o(y,b,v){return y.index=v,t?(v=y.alternate,v!==null?(v=v.index,v<b?(y.flags|=2,b):v):(y.flags|=2,b)):(y.flags|=1048576,b)}function i(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,b,v,x){return b===null||b.tag!==6?(b=Yw(v,y.mode,x),b.return=y,b):(b=r(b,v),b.return=y,b)}function l(y,b,v,x){var w=v.type;return w===ec?c(y,b,v.props.children,x,v.key):b!==null&&(b.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===sa&&IE(w)===b.type)?(x=r(b,v.props),x.ref=Uh(y,b,v),x.return=y,x):(x=zy(v.type,v.key,v.props,null,y.mode,x),x.ref=Uh(y,b,v),x.return=y,x)}function u(y,b,v,x){return b===null||b.tag!==4||b.stateNode.containerInfo!==v.containerInfo||b.stateNode.implementation!==v.implementation?(b=Qw(v,y.mode,x),b.return=y,b):(b=r(b,v.children||[]),b.return=y,b)}function c(y,b,v,x,w){return b===null||b.tag!==7?(b=Ul(v,y.mode,x,w),b.return=y,b):(b=r(b,v),b.return=y,b)}function d(y,b,v){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Yw(""+b,y.mode,v),b.return=y,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Wg:return v=zy(b.type,b.key,b.props,null,y.mode,v),v.ref=Uh(y,null,b),v.return=y,v;case Ju:return b=Qw(b,y.mode,v),b.return=y,b;case sa:var x=b._init;return d(y,x(b._payload),v)}if(df(b)||Ph(b))return b=Ul(b,y.mode,v,null),b.return=y,b;ey(y,b)}return null}function h(y,b,v,x){var w=b!==null?b.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return w!==null?null:a(y,b,""+v,x);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Wg:return v.key===w?l(y,b,v,x):null;case Ju:return v.key===w?u(y,b,v,x):null;case sa:return w=v._init,h(y,b,w(v._payload),x)}if(df(v)||Ph(v))return w!==null?null:c(y,b,v,x,null);ey(y,v)}return null}function f(y,b,v,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return y=y.get(v)||null,a(b,y,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Wg:return y=y.get(x.key===null?v:x.key)||null,l(b,y,x,w);case Ju:return y=y.get(x.key===null?v:x.key)||null,u(b,y,x,w);case sa:var S=x._init;return f(y,b,v,S(x._payload),w)}if(df(x)||Ph(x))return y=y.get(v)||null,c(b,y,x,w,null);ey(b,x)}return null}function p(y,b,v,x){for(var w=null,S=null,C=b,N=b=0,I=null;C!==null&&N<v.length;N++){C.index>N?(I=C,C=null):I=C.sibling;var E=h(y,C,v[N],x);if(E===null){C===null&&(C=I);break}t&&C&&E.alternate===null&&e(y,C),b=o(E,b,N),S===null?w=E:S.sibling=E,S=E,C=I}if(N===v.length)return n(y,C),Yt&&fl(y,N),w;if(C===null){for(;N<v.length;N++)C=d(y,v[N],x),C!==null&&(b=o(C,b,N),S===null?w=C:S.sibling=C,S=C);return Yt&&fl(y,N),w}for(C=s(y,C);N<v.length;N++)I=f(C,y,N,v[N],x),I!==null&&(t&&I.alternate!==null&&C.delete(I.key===null?N:I.key),b=o(I,b,N),S===null?w=I:S.sibling=I,S=I);return t&&C.forEach(function(A){return e(y,A)}),Yt&&fl(y,N),w}function m(y,b,v,x){var w=Ph(v);if(typeof w!="function")throw Error(ge(150));if(v=w.call(v),v==null)throw Error(ge(151));for(var S=w=null,C=b,N=b=0,I=null,E=v.next();C!==null&&!E.done;N++,E=v.next()){C.index>N?(I=C,C=null):I=C.sibling;var A=h(y,C,E.value,x);if(A===null){C===null&&(C=I);break}t&&C&&A.alternate===null&&e(y,C),b=o(A,b,N),S===null?w=A:S.sibling=A,S=A,C=I}if(E.done)return n(y,C),Yt&&fl(y,N),w;if(C===null){for(;!E.done;N++,E=v.next())E=d(y,E.value,x),E!==null&&(b=o(E,b,N),S===null?w=E:S.sibling=E,S=E);return Yt&&fl(y,N),w}for(C=s(y,C);!E.done;N++,E=v.next())E=f(C,y,N,E.value,x),E!==null&&(t&&E.alternate!==null&&C.delete(E.key===null?N:E.key),b=o(E,b,N),S===null?w=E:S.sibling=E,S=E);return t&&C.forEach(function(z){return e(y,z)}),Yt&&fl(y,N),w}function g(y,b,v,x){if(typeof v=="object"&&v!==null&&v.type===ec&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Wg:e:{for(var w=v.key,S=b;S!==null;){if(S.key===w){if(w=v.type,w===ec){if(S.tag===7){n(y,S.sibling),b=r(S,v.props.children),b.return=y,y=b;break e}}else if(S.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===sa&&IE(w)===S.type){n(y,S.sibling),b=r(S,v.props),b.ref=Uh(y,S,v),b.return=y,y=b;break e}n(y,S);break}else e(y,S);S=S.sibling}v.type===ec?(b=Ul(v.props.children,y.mode,x,v.key),b.return=y,y=b):(x=zy(v.type,v.key,v.props,null,y.mode,x),x.ref=Uh(y,b,v),x.return=y,y=x)}return i(y);case Ju:e:{for(S=v.key;b!==null;){if(b.key===S)if(b.tag===4&&b.stateNode.containerInfo===v.containerInfo&&b.stateNode.implementation===v.implementation){n(y,b.sibling),b=r(b,v.children||[]),b.return=y,y=b;break e}else{n(y,b);break}else e(y,b);b=b.sibling}b=Qw(v,y.mode,x),b.return=y,y=b}return i(y);case sa:return S=v._init,g(y,b,S(v._payload),x)}if(df(v))return p(y,b,v,x);if(Ph(v))return m(y,b,v,x);ey(y,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,b!==null&&b.tag===6?(n(y,b.sibling),b=r(b,v),b.return=y,y=b):(n(y,b),b=Yw(v,y.mode,x),b.return=y,y=b),i(y)):n(y,b)}return g}var Wc=ED(!0),RD=ED(!1),Vp={},jo=Ka(Vp),Xf=Ka(Vp),Yf=Ka(Vp);function Tl(t){if(t===Vp)throw Error(ge(174));return t}function WC(t,e){switch(Pt(Yf,e),Pt(Xf,t),Pt(jo,Vp),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:oS(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=oS(e,t)}Wt(jo),Pt(jo,e)}function jc(){Wt(jo),Wt(Xf),Wt(Yf)}function _D(t){Tl(Yf.current);var e=Tl(jo.current),n=oS(e,t.type);e!==n&&(Pt(Xf,t),Pt(jo,n))}function jC(t){Xf.current===t&&(Wt(jo),Wt(Xf))}var nn=Ka(0);function p0(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var jw=[];function GC(){for(var t=0;t<jw.length;t++)jw[t]._workInProgressVersionPrimary=null;jw.length=0}var Oy=Di.ReactCurrentDispatcher,Gw=Di.ReactCurrentBatchConfig,Yl=0,rn=null,An=null,Wn=null,m0=!1,Tf=!1,Qf=0,sG=0;function fs(){throw Error(ge(321))}function HC(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!wo(t[n],e[n]))return!1;return!0}function qC(t,e,n,s,r,o){if(Yl=o,rn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Oy.current=t===null||t.memoizedState===null?aG:lG,t=n(s,r),Tf){o=0;do{if(Tf=!1,Qf=0,25<=o)throw Error(ge(301));o+=1,Wn=An=null,e.updateQueue=null,Oy.current=uG,t=n(s,r)}while(Tf)}if(Oy.current=g0,e=An!==null&&An.next!==null,Yl=0,Wn=An=rn=null,m0=!1,e)throw Error(ge(300));return t}function KC(){var t=Qf!==0;return Qf=0,t}function _o(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wn===null?rn.memoizedState=Wn=t:Wn=Wn.next=t,Wn}function Qr(){if(An===null){var t=rn.alternate;t=t!==null?t.memoizedState:null}else t=An.next;var e=Wn===null?rn.memoizedState:Wn.next;if(e!==null)Wn=e,An=t;else{if(t===null)throw Error(ge(310));An=t,t={memoizedState:An.memoizedState,baseState:An.baseState,baseQueue:An.baseQueue,queue:An.queue,next:null},Wn===null?rn.memoizedState=Wn=t:Wn=Wn.next=t}return Wn}function Zf(t,e){return typeof e=="function"?e(t):e}function Hw(t){var e=Qr(),n=e.queue;if(n===null)throw Error(ge(311));n.lastRenderedReducer=t;var s=An,r=s.baseQueue,o=n.pending;if(o!==null){if(r!==null){var i=r.next;r.next=o.next,o.next=i}s.baseQueue=r=o,n.pending=null}if(r!==null){o=r.next,s=s.baseState;var a=i=null,l=null,u=o;do{var c=u.lane;if((Yl&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:t(s,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=d,i=s):l=l.next=d,rn.lanes|=c,Ql|=c}u=u.next}while(u!==null&&u!==o);l===null?i=s:l.next=a,wo(s,e.memoizedState)||(Ks=!0),e.memoizedState=s,e.baseState=i,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do o=r.lane,rn.lanes|=o,Ql|=o,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function qw(t){var e=Qr(),n=e.queue;if(n===null)throw Error(ge(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,o=e.memoizedState;if(r!==null){n.pending=null;var i=r=r.next;do o=t(o,i.action),i=i.next;while(i!==r);wo(o,e.memoizedState)||(Ks=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,s]}function AD(){}function DD(t,e){var n=rn,s=Qr(),r=e(),o=!wo(s.memoizedState,r);if(o&&(s.memoizedState=r,Ks=!0),s=s.queue,XC(LD.bind(null,n,s,t),[t]),s.getSnapshot!==e||o||Wn!==null&&Wn.memoizedState.tag&1){if(n.flags|=2048,Jf(9,FD.bind(null,n,s,r,e),void 0,null),Kn===null)throw Error(ge(349));Yl&30||OD(n,e,r)}return r}function OD(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=rn.updateQueue,e===null?(e={lastEffect:null,stores:null},rn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function FD(t,e,n,s){e.value=n,e.getSnapshot=s,PD(e)&&MD(t)}function LD(t,e,n){return n(function(){PD(e)&&MD(t)})}function PD(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!wo(t,n)}catch{return!0}}function MD(t){var e=Ci(t,1);e!==null&&yo(e,t,1,-1)}function EE(t){var e=_o();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zf,lastRenderedState:t},e.queue=t,t=t.dispatch=iG.bind(null,rn,t),[e.memoizedState,t]}function Jf(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=rn.updateQueue,e===null?(e={lastEffect:null,stores:null},rn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function zD(){return Qr().memoizedState}function Fy(t,e,n,s){var r=_o();rn.flags|=t,r.memoizedState=Jf(1|e,n,void 0,s===void 0?null:s)}function bb(t,e,n,s){var r=Qr();s=s===void 0?null:s;var o=void 0;if(An!==null){var i=An.memoizedState;if(o=i.destroy,s!==null&&HC(s,i.deps)){r.memoizedState=Jf(e,n,o,s);return}}rn.flags|=t,r.memoizedState=Jf(1|e,n,o,s)}function RE(t,e){return Fy(8390656,8,t,e)}function XC(t,e){return bb(2048,8,t,e)}function BD(t,e){return bb(4,2,t,e)}function VD(t,e){return bb(4,4,t,e)}function UD(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function WD(t,e,n){return n=n!=null?n.concat([t]):null,bb(4,4,UD.bind(null,e,t),n)}function YC(){}function jD(t,e){var n=Qr();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&HC(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function GD(t,e){var n=Qr();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&HC(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function HD(t,e,n){return Yl&21?(wo(n,e)||(n=XA(),rn.lanes|=n,Ql|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ks=!0),t.memoizedState=n)}function rG(t,e){var n=$t;$t=n!==0&&4>n?n:4,t(!0);var s=Gw.transition;Gw.transition={};try{t(!1),e()}finally{$t=n,Gw.transition=s}}function qD(){return Qr().memoizedState}function oG(t,e,n){var s=Ta(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},KD(t))XD(e,n);else if(n=ND(t,e,n,s),n!==null){var r=Rs();yo(n,t,s,r),YD(n,e,s)}}function iG(t,e,n){var s=Ta(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(KD(t))XD(e,r);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,a=o(i,n);if(r.hasEagerState=!0,r.eagerState=a,wo(a,i)){var l=e.interleaved;l===null?(r.next=r,VC(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=ND(t,e,r,s),n!==null&&(r=Rs(),yo(n,t,s,r),YD(n,e,s))}}function KD(t){var e=t.alternate;return t===rn||e!==null&&e===rn}function XD(t,e){Tf=m0=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function YD(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,$C(t,n)}}var g0={readContext:Yr,useCallback:fs,useContext:fs,useEffect:fs,useImperativeHandle:fs,useInsertionEffect:fs,useLayoutEffect:fs,useMemo:fs,useReducer:fs,useRef:fs,useState:fs,useDebugValue:fs,useDeferredValue:fs,useTransition:fs,useMutableSource:fs,useSyncExternalStore:fs,useId:fs,unstable_isNewReconciler:!1},aG={readContext:Yr,useCallback:function(t,e){return _o().memoizedState=[t,e===void 0?null:e],t},useContext:Yr,useEffect:RE,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Fy(4194308,4,UD.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Fy(4194308,4,t,e)},useInsertionEffect:function(t,e){return Fy(4,2,t,e)},useMemo:function(t,e){var n=_o();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=_o();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=oG.bind(null,rn,t),[s.memoizedState,t]},useRef:function(t){var e=_o();return t={current:t},e.memoizedState=t},useState:EE,useDebugValue:YC,useDeferredValue:function(t){return _o().memoizedState=t},useTransition:function(){var t=EE(!1),e=t[0];return t=rG.bind(null,t[1]),_o().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=rn,r=_o();if(Yt){if(n===void 0)throw Error(ge(407));n=n()}else{if(n=e(),Kn===null)throw Error(ge(349));Yl&30||OD(s,e,n)}r.memoizedState=n;var o={value:n,getSnapshot:e};return r.queue=o,RE(LD.bind(null,s,o,t),[t]),s.flags|=2048,Jf(9,FD.bind(null,s,o,n,e),void 0,null),n},useId:function(){var t=_o(),e=Kn.identifierPrefix;if(Yt){var n=bi,s=yi;n=(s&~(1<<32-go(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=Qf++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=sG++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},lG={readContext:Yr,useCallback:jD,useContext:Yr,useEffect:XC,useImperativeHandle:WD,useInsertionEffect:BD,useLayoutEffect:VD,useMemo:GD,useReducer:Hw,useRef:zD,useState:function(){return Hw(Zf)},useDebugValue:YC,useDeferredValue:function(t){var e=Qr();return HD(e,An.memoizedState,t)},useTransition:function(){var t=Hw(Zf)[0],e=Qr().memoizedState;return[t,e]},useMutableSource:AD,useSyncExternalStore:DD,useId:qD,unstable_isNewReconciler:!1},uG={readContext:Yr,useCallback:jD,useContext:Yr,useEffect:XC,useImperativeHandle:WD,useInsertionEffect:BD,useLayoutEffect:VD,useMemo:GD,useReducer:qw,useRef:zD,useState:function(){return qw(Zf)},useDebugValue:YC,useDeferredValue:function(t){var e=Qr();return An===null?e.memoizedState=t:HD(e,An.memoizedState,t)},useTransition:function(){var t=qw(Zf)[0],e=Qr().memoizedState;return[t,e]},useMutableSource:AD,useSyncExternalStore:DD,useId:qD,unstable_isNewReconciler:!1};function Gc(t,e){try{var n="",s=e;do n+=PW(s),s=s.return;while(s);var r=n}catch(o){r=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:r,digest:null}}function Kw(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function IS(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var cG=typeof WeakMap=="function"?WeakMap:Map;function QD(t,e,n){n=vi(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){b0||(b0=!0,MS=s),IS(t,e)},n}function ZD(t,e,n){n=vi(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){IS(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){IS(t,e),typeof s!="function"&&(Na===null?Na=new Set([this]):Na.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function _E(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new cG;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=CG.bind(null,t,e,n),e.then(t,t))}function AE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function DE(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=vi(-1,1),e.tag=2,Ca(n,e,1))),n.lanes|=1),t)}var dG=Di.ReactCurrentOwner,Ks=!1;function $s(t,e,n,s){e.child=t===null?RD(e,null,n,s):Wc(e,t.child,n,s)}function OE(t,e,n,s,r){n=n.render;var o=e.ref;return bc(e,r),s=qC(t,e,n,s,o,r),n=KC(),t!==null&&!Ks?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Ni(t,e,r)):(Yt&&n&&FC(e),e.flags|=1,$s(t,e,s,r),e.child)}function FE(t,e,n,s,r){if(t===null){var o=n.type;return typeof o=="function"&&!rN(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,JD(t,e,o,s,r)):(t=zy(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&r)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:Gf,n(i,s)&&t.ref===e.ref)return Ni(t,e,r)}return e.flags|=1,t=$a(o,s),t.ref=e.ref,t.return=e,e.child=t}function JD(t,e,n,s,r){if(t!==null){var o=t.memoizedProps;if(Gf(o,s)&&t.ref===e.ref)if(Ks=!1,e.pendingProps=s=o,(t.lanes&r)!==0)t.flags&131072&&(Ks=!0);else return e.lanes=t.lanes,Ni(t,e,r)}return ES(t,e,n,s,r)}function eO(t,e,n){var s=e.pendingProps,r=s.children,o=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pt(cc,hr),hr|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Pt(cc,hr),hr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=o!==null?o.baseLanes:n,Pt(cc,hr),hr|=s}else o!==null?(s=o.baseLanes|n,e.memoizedState=null):s=n,Pt(cc,hr),hr|=s;return $s(t,e,r,n),e.child}function tO(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function ES(t,e,n,s,r){var o=Qs(n)?Kl:xs.current;return o=Vc(e,o),bc(e,r),n=qC(t,e,n,s,o,r),s=KC(),t!==null&&!Ks?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Ni(t,e,r)):(Yt&&s&&FC(e),e.flags|=1,$s(t,e,n,r),e.child)}function LE(t,e,n,s,r){if(Qs(n)){var o=!0;l0(e)}else o=!1;if(bc(e,r),e.stateNode===null)Ly(t,e),ID(e,n,s),$S(e,n,s,r),s=!0;else if(t===null){var i=e.stateNode,a=e.memoizedProps;i.props=a;var l=i.context,u=n.contextType;typeof u=="object"&&u!==null?u=Yr(u):(u=Qs(n)?Kl:xs.current,u=Vc(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==s||l!==u)&&$E(e,i,s,u),ra=!1;var h=e.memoizedState;i.state=h,f0(e,s,i,r),l=e.memoizedState,a!==s||h!==l||Ys.current||ra?(typeof c=="function"&&(TS(e,n,c,s),l=e.memoizedState),(a=ra||TE(e,n,a,s,h,l,u))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),i.props=s,i.state=l,i.context=u,s=a):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{i=e.stateNode,TD(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:ao(e.type,a),i.props=u,d=e.pendingProps,h=i.context,l=n.contextType,typeof l=="object"&&l!==null?l=Yr(l):(l=Qs(n)?Kl:xs.current,l=Vc(e,l));var f=n.getDerivedStateFromProps;(c=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==d||h!==l)&&$E(e,i,s,l),ra=!1,h=e.memoizedState,i.state=h,f0(e,s,i,r);var p=e.memoizedState;a!==d||h!==p||Ys.current||ra?(typeof f=="function"&&(TS(e,n,f,s),p=e.memoizedState),(u=ra||TE(e,n,u,s,h,p,l)||!1)?(c||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(s,p,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(s,p,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=p),i.props=s,i.state=p,i.context=l,s=u):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),s=!1)}return RS(t,e,n,s,o,r)}function RS(t,e,n,s,r,o){tO(t,e);var i=(e.flags&128)!==0;if(!s&&!i)return r&&wE(e,n,!1),Ni(t,e,o);s=e.stateNode,dG.current=e;var a=i&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&i?(e.child=Wc(e,t.child,null,o),e.child=Wc(e,null,a,o)):$s(t,e,a,o),e.memoizedState=s.state,r&&wE(e,n,!0),e.child}function nO(t){var e=t.stateNode;e.pendingContext?xE(t,e.pendingContext,e.pendingContext!==e.context):e.context&&xE(t,e.context,!1),WC(t,e.containerInfo)}function PE(t,e,n,s,r){return Uc(),PC(r),e.flags|=256,$s(t,e,n,s),e.child}var _S={dehydrated:null,treeContext:null,retryLane:0};function AS(t){return{baseLanes:t,cachePool:null,transitions:null}}function sO(t,e,n){var s=e.pendingProps,r=nn.current,o=!1,i=(e.flags&128)!==0,a;if((a=i)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),Pt(nn,r&1),t===null)return CS(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=s.children,t=s.fallback,o?(s=e.mode,o=e.child,i={mode:"hidden",children:i},!(s&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=wb(i,s,0,null),t=Ul(t,s,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=AS(n),e.memoizedState=_S,t):QC(e,i));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return hG(t,e,i,s,a,r,n);if(o){o=s.fallback,i=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:s.children};return!(i&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=$a(r,l),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?o=$a(a,o):(o=Ul(o,i,n,null),o.flags|=2),o.return=e,s.return=e,s.sibling=o,e.child=s,s=o,o=e.child,i=t.child.memoizedState,i=i===null?AS(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=t.childLanes&~n,e.memoizedState=_S,s}return o=t.child,t=o.sibling,s=$a(o,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function QC(t,e){return e=wb({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ty(t,e,n,s){return s!==null&&PC(s),Wc(e,t.child,null,n),t=QC(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function hG(t,e,n,s,r,o,i){if(n)return e.flags&256?(e.flags&=-257,s=Kw(Error(ge(422))),ty(t,e,i,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=s.fallback,r=e.mode,s=wb({mode:"visible",children:s.children},r,0,null),o=Ul(o,r,i,null),o.flags|=2,s.return=e,o.return=e,s.sibling=o,e.child=s,e.mode&1&&Wc(e,t.child,null,i),e.child.memoizedState=AS(i),e.memoizedState=_S,o);if(!(e.mode&1))return ty(t,e,i,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,o=Error(ge(419)),s=Kw(o,s,void 0),ty(t,e,i,s)}if(a=(i&t.childLanes)!==0,Ks||a){if(s=Kn,s!==null){switch(i&-i){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|i)?0:r,r!==0&&r!==o.retryLane&&(o.retryLane=r,Ci(t,r),yo(s,t,r,-1))}return sN(),s=Kw(Error(ge(421))),ty(t,e,i,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=NG.bind(null,t),r._reactRetry=e,null):(t=o.treeContext,gr=ka(r.nextSibling),xr=e,Yt=!0,fo=null,t!==null&&(zr[Br++]=yi,zr[Br++]=bi,zr[Br++]=Xl,yi=t.id,bi=t.overflow,Xl=e),e=QC(e,s.children),e.flags|=4096,e)}function ME(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),NS(t.return,e,n)}function Xw(t,e,n,s,r){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=s,o.tail=n,o.tailMode=r)}function rO(t,e,n){var s=e.pendingProps,r=s.revealOrder,o=s.tail;if($s(t,e,s.children,n),s=nn.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ME(t,n,e);else if(t.tag===19)ME(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(Pt(nn,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&p0(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Xw(e,!1,r,n,o);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&p0(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Xw(e,!0,n,null,o);break;case"together":Xw(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ly(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ni(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ql|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ge(153));if(e.child!==null){for(t=e.child,n=$a(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=$a(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function fG(t,e,n){switch(e.tag){case 3:nO(e),Uc();break;case 5:_D(e);break;case 1:Qs(e.type)&&l0(e);break;case 4:WC(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;Pt(d0,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Pt(nn,nn.current&1),e.flags|=128,null):n&e.child.childLanes?sO(t,e,n):(Pt(nn,nn.current&1),t=Ni(t,e,n),t!==null?t.sibling:null);Pt(nn,nn.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return rO(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Pt(nn,nn.current),s)break;return null;case 22:case 23:return e.lanes=0,eO(t,e,n)}return Ni(t,e,n)}var oO,DS,iO,aO;oO=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};DS=function(){};iO=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,Tl(jo.current);var o=null;switch(n){case"input":r=tS(t,r),s=tS(t,s),o=[];break;case"select":r=on({},r,{value:void 0}),s=on({},s,{value:void 0}),o=[];break;case"textarea":r=rS(t,r),s=rS(t,s),o=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=i0)}iS(n,s);var i;n=null;for(u in r)if(!s.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Mf.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in s){var l=s[u];if(a=r!=null?r[u]:void 0,s.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(i in a)!a.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&a[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(o||(o=[]),o.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Mf.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Vt("scroll",t),o||a===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};aO=function(t,e,n,s){n!==s&&(e.flags|=4)};function Wh(t,e){if(!Yt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function ps(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function pG(t,e,n){var s=e.pendingProps;switch(LC(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ps(e),null;case 1:return Qs(e.type)&&a0(),ps(e),null;case 3:return s=e.stateNode,jc(),Wt(Ys),Wt(xs),GC(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Jg(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,fo!==null&&(VS(fo),fo=null))),DS(t,e),ps(e),null;case 5:jC(e);var r=Tl(Yf.current);if(n=e.type,t!==null&&e.stateNode!=null)iO(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(ge(166));return ps(e),null}if(t=Tl(jo.current),Jg(e)){s=e.stateNode,n=e.type;var o=e.memoizedProps;switch(s[zo]=e,s[Kf]=o,t=(e.mode&1)!==0,n){case"dialog":Vt("cancel",s),Vt("close",s);break;case"iframe":case"object":case"embed":Vt("load",s);break;case"video":case"audio":for(r=0;r<ff.length;r++)Vt(ff[r],s);break;case"source":Vt("error",s);break;case"img":case"image":case"link":Vt("error",s),Vt("load",s);break;case"details":Vt("toggle",s);break;case"input":qI(s,o),Vt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!o.multiple},Vt("invalid",s);break;case"textarea":XI(s,o),Vt("invalid",s)}iS(n,o),r=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?s.textContent!==a&&(o.suppressHydrationWarning!==!0&&Zg(s.textContent,a,t),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Zg(s.textContent,a,t),r=["children",""+a]):Mf.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&Vt("scroll",s)}switch(n){case"input":jg(s),KI(s,o,!0);break;case"textarea":jg(s),YI(s);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(s.onclick=i0)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{i=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=OA(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=i.createElement(n,{is:s.is}):(t=i.createElement(n),n==="select"&&(i=t,s.multiple?i.multiple=!0:s.size&&(i.size=s.size))):t=i.createElementNS(t,n),t[zo]=e,t[Kf]=s,oO(t,e,!1,!1),e.stateNode=t;e:{switch(i=aS(n,s),n){case"dialog":Vt("cancel",t),Vt("close",t),r=s;break;case"iframe":case"object":case"embed":Vt("load",t),r=s;break;case"video":case"audio":for(r=0;r<ff.length;r++)Vt(ff[r],t);r=s;break;case"source":Vt("error",t),r=s;break;case"img":case"image":case"link":Vt("error",t),Vt("load",t),r=s;break;case"details":Vt("toggle",t),r=s;break;case"input":qI(t,s),r=tS(t,s),Vt("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=on({},s,{value:void 0}),Vt("invalid",t);break;case"textarea":XI(t,s),r=rS(t,s),Vt("invalid",t);break;default:r=s}iS(n,r),a=r;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?PA(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&FA(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&zf(t,l):typeof l=="number"&&zf(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Mf.hasOwnProperty(o)?l!=null&&o==="onScroll"&&Vt("scroll",t):l!=null&&wC(t,o,l,i))}switch(n){case"input":jg(t),KI(t,s,!1);break;case"textarea":jg(t),YI(t);break;case"option":s.value!=null&&t.setAttribute("value",""+Da(s.value));break;case"select":t.multiple=!!s.multiple,o=s.value,o!=null?pc(t,!!s.multiple,o,!1):s.defaultValue!=null&&pc(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=i0)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ps(e),null;case 6:if(t&&e.stateNode!=null)aO(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(ge(166));if(n=Tl(Yf.current),Tl(jo.current),Jg(e)){if(s=e.stateNode,n=e.memoizedProps,s[zo]=e,(o=s.nodeValue!==n)&&(t=xr,t!==null))switch(t.tag){case 3:Zg(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Zg(s.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[zo]=e,e.stateNode=s}return ps(e),null;case 13:if(Wt(nn),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Yt&&gr!==null&&e.mode&1&&!(e.flags&128))CD(),Uc(),e.flags|=98560,o=!1;else if(o=Jg(e),s!==null&&s.dehydrated!==null){if(t===null){if(!o)throw Error(ge(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ge(317));o[zo]=e}else Uc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ps(e),o=!1}else fo!==null&&(VS(fo),fo=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||nn.current&1?Fn===0&&(Fn=3):sN())),e.updateQueue!==null&&(e.flags|=4),ps(e),null);case 4:return jc(),DS(t,e),t===null&&Hf(e.stateNode.containerInfo),ps(e),null;case 10:return BC(e.type._context),ps(e),null;case 17:return Qs(e.type)&&a0(),ps(e),null;case 19:if(Wt(nn),o=e.memoizedState,o===null)return ps(e),null;if(s=(e.flags&128)!==0,i=o.rendering,i===null)if(s)Wh(o,!1);else{if(Fn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=p0(t),i!==null){for(e.flags|=128,Wh(o,!1),s=i.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)o=n,t=s,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,t=i.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Pt(nn,nn.current&1|2),e.child}t=t.sibling}o.tail!==null&&vn()>Hc&&(e.flags|=128,s=!0,Wh(o,!1),e.lanes=4194304)}else{if(!s)if(t=p0(i),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Wh(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!Yt)return ps(e),null}else 2*vn()-o.renderingStartTime>Hc&&n!==1073741824&&(e.flags|=128,s=!0,Wh(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(n=o.last,n!==null?n.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=vn(),e.sibling=null,n=nn.current,Pt(nn,s?n&1|2:n&1),e):(ps(e),null);case 22:case 23:return nN(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?hr&1073741824&&(ps(e),e.subtreeFlags&6&&(e.flags|=8192)):ps(e),null;case 24:return null;case 25:return null}throw Error(ge(156,e.tag))}function mG(t,e){switch(LC(e),e.tag){case 1:return Qs(e.type)&&a0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return jc(),Wt(Ys),Wt(xs),GC(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return jC(e),null;case 13:if(Wt(nn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ge(340));Uc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Wt(nn),null;case 4:return jc(),null;case 10:return BC(e.type._context),null;case 22:case 23:return nN(),null;case 24:return null;default:return null}}var ny=!1,gs=!1,gG=typeof WeakSet=="function"?WeakSet:Set,Re=null;function uc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){un(t,e,s)}else n.current=null}function OS(t,e,n){try{n()}catch(s){un(t,e,s)}}var zE=!1;function yG(t,e){if(yS=s0,t=dD(),OC(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,o=s.focusNode;s=s.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,a=-1,l=-1,u=0,c=0,d=t,h=null;t:for(;;){for(var f;d!==n||r!==0&&d.nodeType!==3||(a=i+r),d!==o||s!==0&&d.nodeType!==3||(l=i+s),d.nodeType===3&&(i+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++u===r&&(a=i),h===o&&++c===s&&(l=i),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(bS={focusedElem:t,selectionRange:n},s0=!1,Re=e;Re!==null;)if(e=Re,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Re=t;else for(;Re!==null;){e=Re;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,y=e.stateNode,b=y.getSnapshotBeforeUpdate(e.elementType===e.type?m:ao(e.type,m),g);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ge(163))}}catch(x){un(e,e.return,x)}if(t=e.sibling,t!==null){t.return=e.return,Re=t;break}Re=e.return}return p=zE,zE=!1,p}function $f(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var o=r.destroy;r.destroy=void 0,o!==void 0&&OS(e,n,o)}r=r.next}while(r!==s)}}function vb(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function FS(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function lO(t){var e=t.alternate;e!==null&&(t.alternate=null,lO(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[zo],delete e[Kf],delete e[wS],delete e[Jj],delete e[eG])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function uO(t){return t.tag===5||t.tag===3||t.tag===4}function BE(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||uO(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function LS(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=i0));else if(s!==4&&(t=t.child,t!==null))for(LS(t,e,n),t=t.sibling;t!==null;)LS(t,e,n),t=t.sibling}function PS(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(PS(t,e,n),t=t.sibling;t!==null;)PS(t,e,n),t=t.sibling}var os=null,co=!1;function Yi(t,e,n){for(n=n.child;n!==null;)cO(t,e,n),n=n.sibling}function cO(t,e,n){if(Wo&&typeof Wo.onCommitFiberUnmount=="function")try{Wo.onCommitFiberUnmount(db,n)}catch{}switch(n.tag){case 5:gs||uc(n,e);case 6:var s=os,r=co;os=null,Yi(t,e,n),os=s,co=r,os!==null&&(co?(t=os,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):os.removeChild(n.stateNode));break;case 18:os!==null&&(co?(t=os,n=n.stateNode,t.nodeType===8?Uw(t.parentNode,n):t.nodeType===1&&Uw(t,n),Wf(t)):Uw(os,n.stateNode));break;case 4:s=os,r=co,os=n.stateNode.containerInfo,co=!0,Yi(t,e,n),os=s,co=r;break;case 0:case 11:case 14:case 15:if(!gs&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var o=r,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&OS(n,e,i),r=r.next}while(r!==s)}Yi(t,e,n);break;case 1:if(!gs&&(uc(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){un(n,e,a)}Yi(t,e,n);break;case 21:Yi(t,e,n);break;case 22:n.mode&1?(gs=(s=gs)||n.memoizedState!==null,Yi(t,e,n),gs=s):Yi(t,e,n);break;default:Yi(t,e,n)}}function VE(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new gG),e.forEach(function(s){var r=TG.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function so(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var o=t,i=e,a=i;e:for(;a!==null;){switch(a.tag){case 5:os=a.stateNode,co=!1;break e;case 3:os=a.stateNode.containerInfo,co=!0;break e;case 4:os=a.stateNode.containerInfo,co=!0;break e}a=a.return}if(os===null)throw Error(ge(160));cO(o,i,r),os=null,co=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){un(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)dO(e,t),e=e.sibling}function dO(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(so(e,t),Ro(t),s&4){try{$f(3,t,t.return),vb(3,t)}catch(m){un(t,t.return,m)}try{$f(5,t,t.return)}catch(m){un(t,t.return,m)}}break;case 1:so(e,t),Ro(t),s&512&&n!==null&&uc(n,n.return);break;case 5:if(so(e,t),Ro(t),s&512&&n!==null&&uc(n,n.return),t.flags&32){var r=t.stateNode;try{zf(r,"")}catch(m){un(t,t.return,m)}}if(s&4&&(r=t.stateNode,r!=null)){var o=t.memoizedProps,i=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&AA(r,o),aS(a,i);var u=aS(a,o);for(i=0;i<l.length;i+=2){var c=l[i],d=l[i+1];c==="style"?PA(r,d):c==="dangerouslySetInnerHTML"?FA(r,d):c==="children"?zf(r,d):wC(r,c,d,u)}switch(a){case"input":nS(r,o);break;case"textarea":DA(r,o);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var f=o.value;f!=null?pc(r,!!o.multiple,f,!1):h!==!!o.multiple&&(o.defaultValue!=null?pc(r,!!o.multiple,o.defaultValue,!0):pc(r,!!o.multiple,o.multiple?[]:"",!1))}r[Kf]=o}catch(m){un(t,t.return,m)}}break;case 6:if(so(e,t),Ro(t),s&4){if(t.stateNode===null)throw Error(ge(162));r=t.stateNode,o=t.memoizedProps;try{r.nodeValue=o}catch(m){un(t,t.return,m)}}break;case 3:if(so(e,t),Ro(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Wf(e.containerInfo)}catch(m){un(t,t.return,m)}break;case 4:so(e,t),Ro(t);break;case 13:so(e,t),Ro(t),r=t.child,r.flags&8192&&(o=r.memoizedState!==null,r.stateNode.isHidden=o,!o||r.alternate!==null&&r.alternate.memoizedState!==null||(eN=vn())),s&4&&VE(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(gs=(u=gs)||c,so(e,t),gs=u):so(e,t),Ro(t),s&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(Re=t,c=t.child;c!==null;){for(d=Re=c;Re!==null;){switch(h=Re,f=h.child,h.tag){case 0:case 11:case 14:case 15:$f(4,h,h.return);break;case 1:uc(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){s=h,n=h.return;try{e=s,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){un(s,n,m)}}break;case 5:uc(h,h.return);break;case 22:if(h.memoizedState!==null){WE(d);continue}}f!==null?(f.return=h,Re=f):WE(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{r=d.stateNode,u?(o=r.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=LA("display",i))}catch(m){un(t,t.return,m)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){un(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:so(e,t),Ro(t),s&4&&VE(t);break;case 21:break;default:so(e,t),Ro(t)}}function Ro(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(uO(n)){var s=n;break e}n=n.return}throw Error(ge(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(zf(r,""),s.flags&=-33);var o=BE(t);PS(t,o,r);break;case 3:case 4:var i=s.stateNode.containerInfo,a=BE(t);LS(t,a,i);break;default:throw Error(ge(161))}}catch(l){un(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function bG(t,e,n){Re=t,hO(t)}function hO(t,e,n){for(var s=(t.mode&1)!==0;Re!==null;){var r=Re,o=r.child;if(r.tag===22&&s){var i=r.memoizedState!==null||ny;if(!i){var a=r.alternate,l=a!==null&&a.memoizedState!==null||gs;a=ny;var u=gs;if(ny=i,(gs=l)&&!u)for(Re=r;Re!==null;)i=Re,l=i.child,i.tag===22&&i.memoizedState!==null?jE(r):l!==null?(l.return=i,Re=l):jE(r);for(;o!==null;)Re=o,hO(o),o=o.sibling;Re=r,ny=a,gs=u}UE(t)}else r.subtreeFlags&8772&&o!==null?(o.return=r,Re=o):UE(t)}}function UE(t){for(;Re!==null;){var e=Re;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:gs||vb(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!gs)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:ao(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&NE(e,o,s);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}NE(e,i,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Wf(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ge(163))}gs||e.flags&512&&FS(e)}catch(h){un(e,e.return,h)}}if(e===t){Re=null;break}if(n=e.sibling,n!==null){n.return=e.return,Re=n;break}Re=e.return}}function WE(t){for(;Re!==null;){var e=Re;if(e===t){Re=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Re=n;break}Re=e.return}}function jE(t){for(;Re!==null;){var e=Re;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{vb(4,e)}catch(l){un(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(l){un(e,r,l)}}var o=e.return;try{FS(e)}catch(l){un(e,o,l)}break;case 5:var i=e.return;try{FS(e)}catch(l){un(e,i,l)}}}catch(l){un(e,e.return,l)}if(e===t){Re=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Re=a;break}Re=e.return}}var vG=Math.ceil,y0=Di.ReactCurrentDispatcher,ZC=Di.ReactCurrentOwner,qr=Di.ReactCurrentBatchConfig,wt=0,Kn=null,kn=null,ls=0,hr=0,cc=Ka(0),Fn=0,ep=null,Ql=0,xb=0,JC=0,If=null,Hs=null,eN=0,Hc=1/0,ci=null,b0=!1,MS=null,Na=null,sy=!1,ga=null,v0=0,Ef=0,zS=null,Py=-1,My=0;function Rs(){return wt&6?vn():Py!==-1?Py:Py=vn()}function Ta(t){return t.mode&1?wt&2&&ls!==0?ls&-ls:nG.transition!==null?(My===0&&(My=XA()),My):(t=$t,t!==0||(t=window.event,t=t===void 0?16:nD(t.type)),t):1}function yo(t,e,n,s){if(50<Ef)throw Ef=0,zS=null,Error(ge(185));Mp(t,n,s),(!(wt&2)||t!==Kn)&&(t===Kn&&(!(wt&2)&&(xb|=n),Fn===4&&la(t,ls)),Zs(t,s),n===1&&wt===0&&!(e.mode&1)&&(Hc=vn()+500,gb&&Xa()))}function Zs(t,e){var n=t.callbackNode;nj(t,e);var s=n0(t,t===Kn?ls:0);if(s===0)n!==null&&JI(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&JI(n),e===1)t.tag===0?tG(GE.bind(null,t)):wD(GE.bind(null,t)),Qj(function(){!(wt&6)&&Xa()}),n=null;else{switch(YA(s)){case 1:n=TC;break;case 4:n=qA;break;case 16:n=t0;break;case 536870912:n=KA;break;default:n=t0}n=xO(n,fO.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function fO(t,e){if(Py=-1,My=0,wt&6)throw Error(ge(327));var n=t.callbackNode;if(vc()&&t.callbackNode!==n)return null;var s=n0(t,t===Kn?ls:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=x0(t,s);else{e=s;var r=wt;wt|=2;var o=mO();(Kn!==t||ls!==e)&&(ci=null,Hc=vn()+500,Vl(t,e));do try{SG();break}catch(a){pO(t,a)}while(!0);zC(),y0.current=o,wt=r,kn!==null?e=0:(Kn=null,ls=0,e=Fn)}if(e!==0){if(e===2&&(r=hS(t),r!==0&&(s=r,e=BS(t,r))),e===1)throw n=ep,Vl(t,0),la(t,s),Zs(t,vn()),n;if(e===6)la(t,s);else{if(r=t.current.alternate,!(s&30)&&!xG(r)&&(e=x0(t,s),e===2&&(o=hS(t),o!==0&&(s=o,e=BS(t,o))),e===1))throw n=ep,Vl(t,0),la(t,s),Zs(t,vn()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(ge(345));case 2:pl(t,Hs,ci);break;case 3:if(la(t,s),(s&130023424)===s&&(e=eN+500-vn(),10<e)){if(n0(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){Rs(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=xS(pl.bind(null,t,Hs,ci),e);break}pl(t,Hs,ci);break;case 4:if(la(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var i=31-go(s);o=1<<i,i=e[i],i>r&&(r=i),s&=~o}if(s=r,s=vn()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*vG(s/1960))-s,10<s){t.timeoutHandle=xS(pl.bind(null,t,Hs,ci),s);break}pl(t,Hs,ci);break;case 5:pl(t,Hs,ci);break;default:throw Error(ge(329))}}}return Zs(t,vn()),t.callbackNode===n?fO.bind(null,t):null}function BS(t,e){var n=If;return t.current.memoizedState.isDehydrated&&(Vl(t,e).flags|=256),t=x0(t,e),t!==2&&(e=Hs,Hs=n,e!==null&&VS(e)),t}function VS(t){Hs===null?Hs=t:Hs.push.apply(Hs,t)}function xG(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],o=r.getSnapshot;r=r.value;try{if(!wo(o(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function la(t,e){for(e&=~JC,e&=~xb,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-go(e),s=1<<n;t[n]=-1,e&=~s}}function GE(t){if(wt&6)throw Error(ge(327));vc();var e=n0(t,0);if(!(e&1))return Zs(t,vn()),null;var n=x0(t,e);if(t.tag!==0&&n===2){var s=hS(t);s!==0&&(e=s,n=BS(t,s))}if(n===1)throw n=ep,Vl(t,0),la(t,e),Zs(t,vn()),n;if(n===6)throw Error(ge(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,pl(t,Hs,ci),Zs(t,vn()),null}function tN(t,e){var n=wt;wt|=1;try{return t(e)}finally{wt=n,wt===0&&(Hc=vn()+500,gb&&Xa())}}function Zl(t){ga!==null&&ga.tag===0&&!(wt&6)&&vc();var e=wt;wt|=1;var n=qr.transition,s=$t;try{if(qr.transition=null,$t=1,t)return t()}finally{$t=s,qr.transition=n,wt=e,!(wt&6)&&Xa()}}function nN(){hr=cc.current,Wt(cc)}function Vl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Yj(n)),kn!==null)for(n=kn.return;n!==null;){var s=n;switch(LC(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&a0();break;case 3:jc(),Wt(Ys),Wt(xs),GC();break;case 5:jC(s);break;case 4:jc();break;case 13:Wt(nn);break;case 19:Wt(nn);break;case 10:BC(s.type._context);break;case 22:case 23:nN()}n=n.return}if(Kn=t,kn=t=$a(t.current,null),ls=hr=e,Fn=0,ep=null,JC=xb=Ql=0,Hs=If=null,Nl!==null){for(e=0;e<Nl.length;e++)if(n=Nl[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,o=n.pending;if(o!==null){var i=o.next;o.next=r,s.next=i}n.pending=s}Nl=null}return t}function pO(t,e){do{var n=kn;try{if(zC(),Oy.current=g0,m0){for(var s=rn.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}m0=!1}if(Yl=0,Wn=An=rn=null,Tf=!1,Qf=0,ZC.current=null,n===null||n.return===null){Fn=1,ep=e,kn=null;break}e:{var o=t,i=n.return,a=n,l=e;if(e=ls,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=AE(i);if(f!==null){f.flags&=-257,DE(f,i,a,o,e),f.mode&1&&_E(o,u,e),e=f,l=u;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){_E(o,u,e),sN();break e}l=Error(ge(426))}}else if(Yt&&a.mode&1){var g=AE(i);if(g!==null){!(g.flags&65536)&&(g.flags|=256),DE(g,i,a,o,e),PC(Gc(l,a));break e}}o=l=Gc(l,a),Fn!==4&&(Fn=2),If===null?If=[o]:If.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var y=QD(o,l,e);CE(o,y);break e;case 1:a=l;var b=o.type,v=o.stateNode;if(!(o.flags&128)&&(typeof b.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Na===null||!Na.has(v)))){o.flags|=65536,e&=-e,o.lanes|=e;var x=ZD(o,a,e);CE(o,x);break e}}o=o.return}while(o!==null)}yO(n)}catch(w){e=w,kn===n&&n!==null&&(kn=n=n.return);continue}break}while(!0)}function mO(){var t=y0.current;return y0.current=g0,t===null?g0:t}function sN(){(Fn===0||Fn===3||Fn===2)&&(Fn=4),Kn===null||!(Ql&268435455)&&!(xb&268435455)||la(Kn,ls)}function x0(t,e){var n=wt;wt|=2;var s=mO();(Kn!==t||ls!==e)&&(ci=null,Vl(t,e));do try{wG();break}catch(r){pO(t,r)}while(!0);if(zC(),wt=n,y0.current=s,kn!==null)throw Error(ge(261));return Kn=null,ls=0,Fn}function wG(){for(;kn!==null;)gO(kn)}function SG(){for(;kn!==null&&!qW();)gO(kn)}function gO(t){var e=vO(t.alternate,t,hr);t.memoizedProps=t.pendingProps,e===null?yO(t):kn=e,ZC.current=null}function yO(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=mG(n,e),n!==null){n.flags&=32767,kn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Fn=6,kn=null;return}}else if(n=pG(n,e,hr),n!==null){kn=n;return}if(e=e.sibling,e!==null){kn=e;return}kn=e=t}while(e!==null);Fn===0&&(Fn=5)}function pl(t,e,n){var s=$t,r=qr.transition;try{qr.transition=null,$t=1,kG(t,e,n,s)}finally{qr.transition=r,$t=s}return null}function kG(t,e,n,s){do vc();while(ga!==null);if(wt&6)throw Error(ge(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ge(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(sj(t,o),t===Kn&&(kn=Kn=null,ls=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||sy||(sy=!0,xO(t0,function(){return vc(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=qr.transition,qr.transition=null;var i=$t;$t=1;var a=wt;wt|=4,ZC.current=null,yG(t,n),dO(n,t),Wj(bS),s0=!!yS,bS=yS=null,t.current=n,bG(n),KW(),wt=a,$t=i,qr.transition=o}else t.current=n;if(sy&&(sy=!1,ga=t,v0=r),o=t.pendingLanes,o===0&&(Na=null),QW(n.stateNode),Zs(t,vn()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(b0)throw b0=!1,t=MS,MS=null,t;return v0&1&&t.tag!==0&&vc(),o=t.pendingLanes,o&1?t===zS?Ef++:(Ef=0,zS=t):Ef=0,Xa(),null}function vc(){if(ga!==null){var t=YA(v0),e=qr.transition,n=$t;try{if(qr.transition=null,$t=16>t?16:t,ga===null)var s=!1;else{if(t=ga,ga=null,v0=0,wt&6)throw Error(ge(331));var r=wt;for(wt|=4,Re=t.current;Re!==null;){var o=Re,i=o.child;if(Re.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Re=u;Re!==null;){var c=Re;switch(c.tag){case 0:case 11:case 15:$f(8,c,o)}var d=c.child;if(d!==null)d.return=c,Re=d;else for(;Re!==null;){c=Re;var h=c.sibling,f=c.return;if(lO(c),c===u){Re=null;break}if(h!==null){h.return=f,Re=h;break}Re=f}}}var p=o.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}Re=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,Re=i;else e:for(;Re!==null;){if(o=Re,o.flags&2048)switch(o.tag){case 0:case 11:case 15:$f(9,o,o.return)}var y=o.sibling;if(y!==null){y.return=o.return,Re=y;break e}Re=o.return}}var b=t.current;for(Re=b;Re!==null;){i=Re;var v=i.child;if(i.subtreeFlags&2064&&v!==null)v.return=i,Re=v;else e:for(i=b;Re!==null;){if(a=Re,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:vb(9,a)}}catch(w){un(a,a.return,w)}if(a===i){Re=null;break e}var x=a.sibling;if(x!==null){x.return=a.return,Re=x;break e}Re=a.return}}if(wt=r,Xa(),Wo&&typeof Wo.onPostCommitFiberRoot=="function")try{Wo.onPostCommitFiberRoot(db,t)}catch{}s=!0}return s}finally{$t=n,qr.transition=e}}return!1}function HE(t,e,n){e=Gc(n,e),e=QD(t,e,1),t=Ca(t,e,1),e=Rs(),t!==null&&(Mp(t,1,e),Zs(t,e))}function un(t,e,n){if(t.tag===3)HE(t,t,n);else for(;e!==null;){if(e.tag===3){HE(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Na===null||!Na.has(s))){t=Gc(n,t),t=ZD(e,t,1),e=Ca(e,t,1),t=Rs(),e!==null&&(Mp(e,1,t),Zs(e,t));break}}e=e.return}}function CG(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=Rs(),t.pingedLanes|=t.suspendedLanes&n,Kn===t&&(ls&n)===n&&(Fn===4||Fn===3&&(ls&130023424)===ls&&500>vn()-eN?Vl(t,0):JC|=n),Zs(t,e)}function bO(t,e){e===0&&(t.mode&1?(e=qg,qg<<=1,!(qg&130023424)&&(qg=4194304)):e=1);var n=Rs();t=Ci(t,e),t!==null&&(Mp(t,e,n),Zs(t,n))}function NG(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),bO(t,n)}function TG(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(ge(314))}s!==null&&s.delete(e),bO(t,n)}var vO;vO=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ys.current)Ks=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ks=!1,fG(t,e,n);Ks=!!(t.flags&131072)}else Ks=!1,Yt&&e.flags&1048576&&SD(e,c0,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Ly(t,e),t=e.pendingProps;var r=Vc(e,xs.current);bc(e,n),r=qC(null,e,s,t,r,n);var o=KC();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Qs(s)?(o=!0,l0(e)):o=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,UC(e),r.updater=yb,e.stateNode=r,r._reactInternals=e,$S(e,s,t,n),e=RS(null,e,s,!0,o,n)):(e.tag=0,Yt&&o&&FC(e),$s(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(Ly(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=IG(s),t=ao(s,t),r){case 0:e=ES(null,e,s,t,n);break e;case 1:e=LE(null,e,s,t,n);break e;case 11:e=OE(null,e,s,t,n);break e;case 14:e=FE(null,e,s,ao(s.type,t),n);break e}throw Error(ge(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:ao(s,r),ES(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:ao(s,r),LE(t,e,s,r,n);case 3:e:{if(nO(e),t===null)throw Error(ge(387));s=e.pendingProps,o=e.memoizedState,r=o.element,TD(t,e),f0(e,s,null,n);var i=e.memoizedState;if(s=i.element,o.isDehydrated)if(o={element:s,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){r=Gc(Error(ge(423)),e),e=PE(t,e,s,n,r);break e}else if(s!==r){r=Gc(Error(ge(424)),e),e=PE(t,e,s,n,r);break e}else for(gr=ka(e.stateNode.containerInfo.firstChild),xr=e,Yt=!0,fo=null,n=RD(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Uc(),s===r){e=Ni(t,e,n);break e}$s(t,e,s,n)}e=e.child}return e;case 5:return _D(e),t===null&&CS(e),s=e.type,r=e.pendingProps,o=t!==null?t.memoizedProps:null,i=r.children,vS(s,r)?i=null:o!==null&&vS(s,o)&&(e.flags|=32),tO(t,e),$s(t,e,i,n),e.child;case 6:return t===null&&CS(e),null;case 13:return sO(t,e,n);case 4:return WC(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=Wc(e,null,s,n):$s(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:ao(s,r),OE(t,e,s,r,n);case 7:return $s(t,e,e.pendingProps,n),e.child;case 8:return $s(t,e,e.pendingProps.children,n),e.child;case 12:return $s(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,o=e.memoizedProps,i=r.value,Pt(d0,s._currentValue),s._currentValue=i,o!==null)if(wo(o.value,i)){if(o.children===r.children&&!Ys.current){e=Ni(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(o.tag===1){l=vi(-1,n&-n),l.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),NS(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(ge(341));i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),NS(i,n,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}$s(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,bc(e,n),r=Yr(r),s=s(r),e.flags|=1,$s(t,e,s,n),e.child;case 14:return s=e.type,r=ao(s,e.pendingProps),r=ao(s.type,r),FE(t,e,s,r,n);case 15:return JD(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:ao(s,r),Ly(t,e),e.tag=1,Qs(s)?(t=!0,l0(e)):t=!1,bc(e,n),ID(e,s,r),$S(e,s,r,n),RS(null,e,s,!0,t,n);case 19:return rO(t,e,n);case 22:return eO(t,e,n)}throw Error(ge(156,e.tag))};function xO(t,e){return HA(t,e)}function $G(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vr(t,e,n,s){return new $G(t,e,n,s)}function rN(t){return t=t.prototype,!(!t||!t.isReactComponent)}function IG(t){if(typeof t=="function")return rN(t)?1:0;if(t!=null){if(t=t.$$typeof,t===kC)return 11;if(t===CC)return 14}return 2}function $a(t,e){var n=t.alternate;return n===null?(n=Vr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function zy(t,e,n,s,r,o){var i=2;if(s=t,typeof t=="function")rN(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case ec:return Ul(n.children,r,o,e);case SC:i=8,r|=8;break;case Q1:return t=Vr(12,n,e,r|2),t.elementType=Q1,t.lanes=o,t;case Z1:return t=Vr(13,n,e,r),t.elementType=Z1,t.lanes=o,t;case J1:return t=Vr(19,n,e,r),t.elementType=J1,t.lanes=o,t;case EA:return wb(n,r,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case $A:i=10;break e;case IA:i=9;break e;case kC:i=11;break e;case CC:i=14;break e;case sa:i=16,s=null;break e}throw Error(ge(130,t==null?t:typeof t,""))}return e=Vr(i,n,e,r),e.elementType=t,e.type=s,e.lanes=o,e}function Ul(t,e,n,s){return t=Vr(7,t,s,e),t.lanes=n,t}function wb(t,e,n,s){return t=Vr(22,t,s,e),t.elementType=EA,t.lanes=n,t.stateNode={isHidden:!1},t}function Yw(t,e,n){return t=Vr(6,t,null,e),t.lanes=n,t}function Qw(t,e,n){return e=Vr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function EG(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_w(0),this.expirationTimes=_w(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_w(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function oN(t,e,n,s,r,o,i,a,l){return t=new EG(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Vr(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},UC(o),t}function RG(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ju,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function wO(t){if(!t)return Oa;t=t._reactInternals;e:{if(vu(t)!==t||t.tag!==1)throw Error(ge(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Qs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ge(171))}if(t.tag===1){var n=t.type;if(Qs(n))return xD(t,n,e)}return e}function SO(t,e,n,s,r,o,i,a,l){return t=oN(n,s,!0,t,r,o,i,a,l),t.context=wO(null),n=t.current,s=Rs(),r=Ta(n),o=vi(s,r),o.callback=e??null,Ca(n,o,r),t.current.lanes=r,Mp(t,r,s),Zs(t,s),t}function Sb(t,e,n,s){var r=e.current,o=Rs(),i=Ta(r);return n=wO(n),e.context===null?e.context=n:e.pendingContext=n,e=vi(o,i),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=Ca(r,e,i),t!==null&&(yo(t,r,i,o),Dy(t,r,i)),i}function w0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function qE(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function iN(t,e){qE(t,e),(t=t.alternate)&&qE(t,e)}function _G(){return null}var kO=typeof reportError=="function"?reportError:function(t){console.error(t)};function aN(t){this._internalRoot=t}kb.prototype.render=aN.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ge(409));Sb(t,e,null,null)};kb.prototype.unmount=aN.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Zl(function(){Sb(null,t,null,null)}),e[ki]=null}};function kb(t){this._internalRoot=t}kb.prototype.unstable_scheduleHydration=function(t){if(t){var e=JA();t={blockedOn:null,target:t,priority:e};for(var n=0;n<aa.length&&e!==0&&e<aa[n].priority;n++);aa.splice(n,0,t),n===0&&tD(t)}};function lN(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Cb(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function KE(){}function AG(t,e,n,s,r){if(r){if(typeof s=="function"){var o=s;s=function(){var u=w0(i);o.call(u)}}var i=SO(e,s,t,0,null,!1,!1,"",KE);return t._reactRootContainer=i,t[ki]=i.current,Hf(t.nodeType===8?t.parentNode:t),Zl(),i}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var u=w0(l);a.call(u)}}var l=oN(t,0,!1,null,null,!1,!1,"",KE);return t._reactRootContainer=l,t[ki]=l.current,Hf(t.nodeType===8?t.parentNode:t),Zl(function(){Sb(e,l,n,s)}),l}function Nb(t,e,n,s,r){var o=n._reactRootContainer;if(o){var i=o;if(typeof r=="function"){var a=r;r=function(){var l=w0(i);a.call(l)}}Sb(e,i,t,r)}else i=AG(n,e,t,r,s);return w0(i)}QA=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=hf(e.pendingLanes);n!==0&&($C(e,n|1),Zs(e,vn()),!(wt&6)&&(Hc=vn()+500,Xa()))}break;case 13:Zl(function(){var s=Ci(t,1);if(s!==null){var r=Rs();yo(s,t,1,r)}}),iN(t,1)}};IC=function(t){if(t.tag===13){var e=Ci(t,134217728);if(e!==null){var n=Rs();yo(e,t,134217728,n)}iN(t,134217728)}};ZA=function(t){if(t.tag===13){var e=Ta(t),n=Ci(t,e);if(n!==null){var s=Rs();yo(n,t,e,s)}iN(t,e)}};JA=function(){return $t};eD=function(t,e){var n=$t;try{return $t=t,e()}finally{$t=n}};uS=function(t,e,n){switch(e){case"input":if(nS(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=mb(s);if(!r)throw Error(ge(90));_A(s),nS(s,r)}}}break;case"textarea":DA(t,n);break;case"select":e=n.value,e!=null&&pc(t,!!n.multiple,e,!1)}};BA=tN;VA=Zl;var DG={usingClientEntryPoint:!1,Events:[Bp,rc,mb,MA,zA,tN]},jh={findFiberByHostInstance:Cl,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},OG={bundleType:jh.bundleType,version:jh.version,rendererPackageName:jh.rendererPackageName,rendererConfig:jh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Di.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=jA(t),t===null?null:t.stateNode},findFiberByHostInstance:jh.findFiberByHostInstance||_G,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ry=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ry.isDisabled&&ry.supportsFiber)try{db=ry.inject(OG),Wo=ry}catch{}}Tr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DG;Tr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lN(e))throw Error(ge(200));return RG(t,e,null,n)};Tr.createRoot=function(t,e){if(!lN(t))throw Error(ge(299));var n=!1,s="",r=kO;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=oN(t,1,!1,null,null,n,!1,s,r),t[ki]=e.current,Hf(t.nodeType===8?t.parentNode:t),new aN(e)};Tr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ge(188)):(t=Object.keys(t).join(","),Error(ge(268,t)));return t=jA(e),t=t===null?null:t.stateNode,t};Tr.flushSync=function(t){return Zl(t)};Tr.hydrate=function(t,e,n){if(!Cb(e))throw Error(ge(200));return Nb(null,t,e,!0,n)};Tr.hydrateRoot=function(t,e,n){if(!lN(t))throw Error(ge(405));var s=n!=null&&n.hydratedSources||null,r=!1,o="",i=kO;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=SO(e,null,t,1,n??null,r,!1,o,i),t[ki]=e.current,Hf(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new kb(e)};Tr.render=function(t,e,n){if(!Cb(e))throw Error(ge(200));return Nb(null,t,e,!1,n)};Tr.unmountComponentAtNode=function(t){if(!Cb(t))throw Error(ge(40));return t._reactRootContainer?(Zl(function(){Nb(null,null,t,!1,function(){t._reactRootContainer=null,t[ki]=null})}),!0):!1};Tr.unstable_batchedUpdates=tN;Tr.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!Cb(n))throw Error(ge(200));if(t==null||t._reactInternals===void 0)throw Error(ge(38));return Nb(t,e,n,!1,s)};Tr.version="18.2.0-next-9e3b772b8-20220608";function CO(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(CO)}catch(t){console.error(t)}}CO(),SA.exports=Tr;var vd=SA.exports;const uN=ub(vd),FG=uC({__proto__:null,default:uN},[vd]);var XE=vd;X1.createRoot=XE.createRoot,X1.hydrateRoot=XE.hydrateRoot;/**
 * @remix-run/router v1.15.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function cn(){return cn=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},cn.apply(this,arguments)}var yn;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(yn||(yn={}));const YE="popstate";function LG(t){t===void 0&&(t={});function e(s,r){let{pathname:o,search:i,hash:a}=s.location;return tp("",{pathname:o,search:i,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:Up(r)}return MG(e,n,null,t)}function pt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function qc(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function PG(){return Math.random().toString(36).substr(2,8)}function QE(t,e){return{usr:t.state,key:t.key,idx:e}}function tp(t,e,n,s){return n===void 0&&(n=null),cn({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Oi(e):e,{state:n,key:e&&e.key||s||PG()})}function Up(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Oi(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function MG(t,e,n,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:o=!1}=s,i=r.history,a=yn.Pop,l=null,u=c();u==null&&(u=0,i.replaceState(cn({},i.state,{idx:u}),""));function c(){return(i.state||{idx:null}).idx}function d(){a=yn.Pop;let g=c(),y=g==null?null:g-u;u=g,l&&l({action:a,location:m.location,delta:y})}function h(g,y){a=yn.Push;let b=tp(m.location,g,y);n&&n(b,g),u=c()+1;let v=QE(b,u),x=m.createHref(b);try{i.pushState(v,"",x)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;r.location.assign(x)}o&&l&&l({action:a,location:m.location,delta:1})}function f(g,y){a=yn.Replace;let b=tp(m.location,g,y);n&&n(b,g),u=c();let v=QE(b,u),x=m.createHref(b);i.replaceState(v,"",x),o&&l&&l({action:a,location:m.location,delta:0})}function p(g){let y=r.location.origin!=="null"?r.location.origin:r.location.href,b=typeof g=="string"?g:Up(g);return b=b.replace(/ $/,"%20"),pt(y,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,y)}let m={get action(){return a},get location(){return t(r,i)},listen(g){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(YE,d),l=g,()=>{r.removeEventListener(YE,d),l=null}},createHref(g){return e(r,g)},createURL:p,encodeLocation(g){let y=p(g);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:h,replace:f,go(g){return i.go(g)}};return m}var ln;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(ln||(ln={}));const zG=new Set(["lazy","caseSensitive","path","id","index","children"]);function BG(t){return t.index===!0}function US(t,e,n,s){return n===void 0&&(n=[]),s===void 0&&(s={}),t.map((r,o)=>{let i=[...n,o],a=typeof r.id=="string"?r.id:i.join("-");if(pt(r.index!==!0||!r.children,"Cannot specify children on an index route"),pt(!s[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),BG(r)){let l=cn({},r,e(r),{id:a});return s[a]=l,l}else{let l=cn({},r,e(r),{id:a,children:void 0});return s[a]=l,r.children&&(l.children=US(r.children,e,i,s)),l}})}function dc(t,e,n){n===void 0&&(n="/");let s=typeof e=="string"?Oi(e):e,r=Wp(s.pathname||"/",n);if(r==null)return null;let o=NO(t);UG(o);let i=null;for(let a=0;i==null&&a<o.length;++a){let l=e6(r);i=QG(o[a],l)}return i}function VG(t,e){let{route:n,pathname:s,params:r}=t;return{id:n.id,pathname:s,params:r,data:e[n.id],handle:n.handle}}function NO(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let r=(o,i,a)=>{let l={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};l.relativePath.startsWith("/")&&(pt(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let u=Ia([s,l.relativePath]),c=n.concat(l);o.children&&o.children.length>0&&(pt(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),NO(o.children,e,c,u)),!(o.path==null&&!o.index)&&e.push({path:u,score:XG(u,o.index),routesMeta:c})};return t.forEach((o,i)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))r(o,i);else for(let l of TO(o.path))r(o,i,l)}),e}function TO(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),o=n.replace(/\?$/,"");if(s.length===0)return r?[o,""]:[o];let i=TO(s.join("/")),a=[];return a.push(...i.map(l=>l===""?o:[o,l].join("/"))),r&&a.push(...i),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function UG(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:YG(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const WG=/^:[\w-]+$/,jG=3,GG=2,HG=1,qG=10,KG=-2,ZE=t=>t==="*";function XG(t,e){let n=t.split("/"),s=n.length;return n.some(ZE)&&(s+=KG),e&&(s+=GG),n.filter(r=>!ZE(r)).reduce((r,o)=>r+(WG.test(o)?jG:o===""?HG:qG),s)}function YG(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function QG(t,e){let{routesMeta:n}=t,s={},r="/",o=[];for(let i=0;i<n.length;++i){let a=n[i],l=i===n.length-1,u=r==="/"?e:e.slice(r.length)||"/",c=ZG({path:a.relativePath,caseSensitive:a.caseSensitive,end:l},u);if(!c)return null;Object.assign(s,c.params);let d=a.route;o.push({params:s,pathname:Ia([r,c.pathname]),pathnameBase:s6(Ia([r,c.pathnameBase])),route:d}),c.pathnameBase!=="/"&&(r=Ia([r,c.pathnameBase]))}return o}function ZG(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=JG(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let o=r[0],i=o.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:s.reduce((u,c,d)=>{let{paramName:h,isOptional:f}=c;if(h==="*"){let m=a[d]||"";i=o.slice(0,o.length-m.length).replace(/(.)\/+$/,"$1")}const p=a[d];return f&&!p?u[h]=void 0:u[h]=(p||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:i,pattern:t}}function JG(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),qc(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function e6(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return qc(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Wp(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function t6(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?Oi(t):t;return{pathname:n?n.startsWith("/")?n:n6(n,e):e,search:r6(s),hash:o6(r)}}function n6(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Zw(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function $O(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function IO(t,e){let n=$O(t);return e?n.map((s,r)=>r===t.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function EO(t,e,n,s){s===void 0&&(s=!1);let r;typeof t=="string"?r=Oi(t):(r=cn({},t),pt(!r.pathname||!r.pathname.includes("?"),Zw("?","pathname","search",r)),pt(!r.pathname||!r.pathname.includes("#"),Zw("#","pathname","hash",r)),pt(!r.search||!r.search.includes("#"),Zw("#","search","hash",r)));let o=t===""||r.pathname==="",i=o?"/":r.pathname,a;if(i==null)a=n;else{let d=e.length-1;if(!s&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),d-=1;r.pathname=h.join("/")}a=d>=0?e[d]:"/"}let l=t6(r,a),u=i&&i!=="/"&&i.endsWith("/"),c=(o||i===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const Ia=t=>t.join("/").replace(/\/\/+/g,"/"),s6=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),r6=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,o6=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class cN{constructor(e,n,s,r){r===void 0&&(r=!1),this.status=e,this.statusText=n||"",this.internal=r,s instanceof Error?(this.data=s.toString(),this.error=s):this.data=s}}function RO(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const _O=["post","put","patch","delete"],i6=new Set(_O),a6=["get",..._O],l6=new Set(a6),u6=new Set([301,302,303,307,308]),c6=new Set([307,308]),Jw={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},d6={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Gh={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},AO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,h6=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),DO="remix-router-transitions";function f6(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",s=!n;pt(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let r;if(t.mapRouteProperties)r=t.mapRouteProperties;else if(t.detectErrorBoundary){let M=t.detectErrorBoundary;r=G=>({hasErrorBoundary:M(G)})}else r=h6;let o={},i=US(t.routes,r,void 0,o),a,l=t.basename||"/",u=cn({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1},t.future),c=null,d=new Set,h=null,f=null,p=null,m=t.hydrationData!=null,g=dc(i,t.history.location,l),y=null;if(g==null){let M=Pr(404,{pathname:t.history.location.pathname}),{matches:G,route:ae}=i2(i);g=G,y={[ae.id]:M}}let b,v=g.some(M=>M.route.lazy),x=g.some(M=>M.route.loader);if(v)b=!1;else if(!x)b=!0;else if(u.v7_partialHydration){let M=t.hydrationData?t.hydrationData.loaderData:null,G=t.hydrationData?t.hydrationData.errors:null,ae=me=>me.route.loader?me.route.loader.hydrate===!0?!1:M&&M[me.route.id]!==void 0||G&&G[me.route.id]!==void 0:!0;if(G){let me=g.findIndex(xe=>G[xe.route.id]!==void 0);b=g.slice(0,me+1).every(ae)}else b=g.every(ae)}else b=t.hydrationData!=null;let w,S={historyAction:t.history.action,location:t.history.location,matches:g,initialized:b,navigation:Jw,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||y,fetchers:new Map,blockers:new Map},C=yn.Pop,N=!1,I,E=!1,A=new Map,z=null,V=!1,P=!1,K=[],Y=[],te=new Map,F=0,j=-1,q=new Map,J=new Set,_=new Map,W=new Map,Z=new Set,ie=new Map,re=new Map,fe=!1;function ye(){if(c=t.history.listen(M=>{let{action:G,location:ae,delta:me}=M;if(fe){fe=!1;return}qc(re.size===0||me!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let xe=X({currentLocation:S.location,nextLocation:ae,historyAction:G});if(xe&&me!=null){fe=!0,t.history.go(me*-1),ne(xe,{state:"blocked",location:ae,proceed(){ne(xe,{state:"proceeding",proceed:void 0,reset:void 0,location:ae}),t.history.go(me)},reset(){let We=new Map(S.blockers);We.set(xe,Gh),ke({blockers:We})}});return}return Xe(G,ae)}),n){C6(e,A);let M=()=>N6(e,A);e.addEventListener("pagehide",M),z=()=>e.removeEventListener("pagehide",M)}return S.initialized||Xe(yn.Pop,S.location,{initialHydration:!0}),w}function de(){c&&c(),z&&z(),d.clear(),I&&I.abort(),S.fetchers.forEach((M,G)=>Cs(G)),S.blockers.forEach((M,G)=>zu(G))}function $e(M){return d.add(M),()=>d.delete(M)}function ke(M,G){G===void 0&&(G={}),S=cn({},S,M);let ae=[],me=[];u.v7_fetcherPersist&&S.fetchers.forEach((xe,We)=>{xe.state==="idle"&&(Z.has(We)?me.push(We):ae.push(We))}),[...d].forEach(xe=>xe(S,{deletedFetchers:me,unstable_viewTransitionOpts:G.viewTransitionOpts,unstable_flushSync:G.flushSync===!0})),u.v7_fetcherPersist&&(ae.forEach(xe=>S.fetchers.delete(xe)),me.forEach(xe=>Cs(xe)))}function Ae(M,G,ae){var me,xe;let{flushSync:We}=ae===void 0?{}:ae,Pe=S.actionData!=null&&S.navigation.formMethod!=null&&ho(S.navigation.formMethod)&&S.navigation.state==="loading"&&((me=M.state)==null?void 0:me._isRedirect)!==!0,Be;G.actionData?Object.keys(G.actionData).length>0?Be=G.actionData:Be=null:Pe?Be=S.actionData:Be=null;let Me=G.loaderData?o2(S.loaderData,G.loaderData,G.matches||[],G.errors):S.loaderData,et=S.blockers;et.size>0&&(et=new Map(et),et.forEach((Ft,rs)=>et.set(rs,Gh)));let Kt=N===!0||S.navigation.formMethod!=null&&ho(S.navigation.formMethod)&&((xe=M.state)==null?void 0:xe._isRedirect)!==!0;a&&(i=a,a=void 0),V||C===yn.Pop||(C===yn.Push?t.history.push(M,M.state):C===yn.Replace&&t.history.replace(M,M.state));let ot;if(C===yn.Pop){let Ft=A.get(S.location.pathname);Ft&&Ft.has(M.pathname)?ot={currentLocation:S.location,nextLocation:M}:A.has(M.pathname)&&(ot={currentLocation:M,nextLocation:S.location})}else if(E){let Ft=A.get(S.location.pathname);Ft?Ft.add(M.pathname):(Ft=new Set([M.pathname]),A.set(S.location.pathname,Ft)),ot={currentLocation:S.location,nextLocation:M}}ke(cn({},G,{actionData:Be,loaderData:Me,historyAction:C,location:M,initialized:!0,navigation:Jw,revalidation:"idle",restoreScrollPosition:je(M,G.matches||S.matches),preventScrollReset:Kt,blockers:et}),{viewTransitionOpts:ot,flushSync:We===!0}),C=yn.Pop,N=!1,E=!1,V=!1,P=!1,K=[],Y=[]}async function Ue(M,G){if(typeof M=="number"){t.history.go(M);return}let ae=WS(S.location,S.matches,l,u.v7_prependBasename,M,u.v7_relativeSplatPath,G==null?void 0:G.fromRouteId,G==null?void 0:G.relative),{path:me,submission:xe,error:We}=JE(u.v7_normalizeFormMethod,!1,ae,G),Pe=S.location,Be=tp(S.location,me,G&&G.state);Be=cn({},Be,t.history.encodeLocation(Be));let Me=G&&G.replace!=null?G.replace:void 0,et=yn.Push;Me===!0?et=yn.Replace:Me===!1||xe!=null&&ho(xe.formMethod)&&xe.formAction===S.location.pathname+S.location.search&&(et=yn.Replace);let Kt=G&&"preventScrollReset"in G?G.preventScrollReset===!0:void 0,ot=(G&&G.unstable_flushSync)===!0,Ft=X({currentLocation:Pe,nextLocation:Be,historyAction:et});if(Ft){ne(Ft,{state:"blocked",location:Be,proceed(){ne(Ft,{state:"proceeding",proceed:void 0,reset:void 0,location:Be}),Ue(M,G)},reset(){let rs=new Map(S.blockers);rs.set(Ft,Gh),ke({blockers:rs})}});return}return await Xe(et,Be,{submission:xe,pendingError:We,preventScrollReset:Kt,replace:G&&G.replace,enableViewTransition:G&&G.unstable_viewTransition,flushSync:ot})}function ht(){if(lr(),ke({revalidation:"loading"}),S.navigation.state!=="submitting"){if(S.navigation.state==="idle"){Xe(S.historyAction,S.location,{startUninterruptedRevalidation:!0});return}Xe(C||S.historyAction,S.navigation.location,{overrideNavigation:S.navigation})}}async function Xe(M,G,ae){I&&I.abort(),I=null,C=M,V=(ae&&ae.startUninterruptedRevalidation)===!0,Ee(S.location,S.matches),N=(ae&&ae.preventScrollReset)===!0,E=(ae&&ae.enableViewTransition)===!0;let me=a||i,xe=ae&&ae.overrideNavigation,We=dc(me,G,l),Pe=(ae&&ae.flushSync)===!0;if(!We){let rs=Pr(404,{pathname:G.pathname}),{matches:cr,route:Vn}=i2(me);pe(),Ae(G,{matches:cr,loaderData:{},errors:{[Vn.id]:rs}},{flushSync:Pe});return}if(S.initialized&&!P&&b6(S.location,G)&&!(ae&&ae.submission&&ho(ae.submission.formMethod))){Ae(G,{matches:We},{flushSync:Pe});return}I=new AbortController;let Be=qh(t.history,G,I.signal,ae&&ae.submission),Me,et;if(ae&&ae.pendingError)et={[Rf(We).route.id]:ae.pendingError};else if(ae&&ae.submission&&ho(ae.submission.formMethod)){let rs=await Ke(Be,G,ae.submission,We,{replace:ae.replace,flushSync:Pe});if(rs.shortCircuited)return;Me=rs.pendingActionData,et=rs.pendingActionError,xe=e1(G,ae.submission),Pe=!1,Be=new Request(Be.url,{signal:Be.signal})}let{shortCircuited:Kt,loaderData:ot,errors:Ft}=await rt(Be,G,We,xe,ae&&ae.submission,ae&&ae.fetcherSubmission,ae&&ae.replace,ae&&ae.initialHydration===!0,Pe,Me,et);Kt||(I=null,Ae(G,cn({matches:We},Me?{actionData:Me}:{},{loaderData:ot,errors:Ft})))}async function Ke(M,G,ae,me,xe){xe===void 0&&(xe={}),lr();let We=S6(G,ae);ke({navigation:We},{flushSync:xe.flushSync===!0});let Pe,Be=GS(me,G);if(!Be.route.action&&!Be.route.lazy)Pe={type:ln.error,error:Pr(405,{method:M.method,pathname:G.pathname,routeId:Be.route.id})};else if(Pe=await Hh("action",M,Be,me,o,r,l,u.v7_relativeSplatPath),M.signal.aborted)return{shortCircuited:!0};if(Il(Pe)){let Me;return xe&&xe.replace!=null?Me=xe.replace:Me=Pe.location===S.location.pathname+S.location.search,await ss(S,Pe,{submission:ae,replace:Me}),{shortCircuited:!0}}if(hc(Pe)){let Me=Rf(me,Be.route.id);return(xe&&xe.replace)!==!0&&(C=yn.Push),{pendingActionData:{},pendingActionError:{[Me.route.id]:Pe.error}}}if($l(Pe))throw Pr(400,{type:"defer-action"});return{pendingActionData:{[Be.route.id]:Pe.data}}}async function rt(M,G,ae,me,xe,We,Pe,Be,Me,et,Kt){let ot=me||e1(G,xe),Ft=xe||We||u2(ot),rs=a||i,[cr,Vn]=e2(t.history,S,ae,Ft,G,u.v7_partialHydration&&Be===!0,P,K,Y,Z,_,J,rs,l,et,Kt);if(pe(St=>!(ae&&ae.some(Et=>Et.route.id===St))||cr&&cr.some(Et=>Et.route.id===St)),j=++F,cr.length===0&&Vn.length===0){let St=qi();return Ae(G,cn({matches:ae,loaderData:{},errors:Kt||null},et?{actionData:et}:{},St?{fetchers:new Map(S.fetchers)}:{}),{flushSync:Me}),{shortCircuited:!0}}if(!V&&(!u.v7_partialHydration||!Be)){Vn.forEach(Et=>{let Vs=S.fetchers.get(Et.key),Bg=Kh(void 0,Vs?Vs.data:void 0);S.fetchers.set(Et.key,Bg)});let St=et||S.actionData;ke(cn({navigation:ot},St?Object.keys(St).length===0?{actionData:null}:{actionData:St}:{},Vn.length>0?{fetchers:new Map(S.fetchers)}:{}),{flushSync:Me})}Vn.forEach(St=>{te.has(St.key)&&hs(St.key),St.controller&&te.set(St.key,St.controller)});let Bu=()=>Vn.forEach(St=>hs(St.key));I&&I.signal.addEventListener("abort",Bu);let{results:ww,loaderResults:Vu,fetcherResults:Xi}=await Rn(S.matches,ae,cr,Vn,M);if(M.signal.aborted)return{shortCircuited:!0};I&&I.signal.removeEventListener("abort",Bu),Vn.forEach(St=>te.delete(St.key));let ul=a2(ww);if(ul){if(ul.idx>=cr.length){let St=Vn[ul.idx-cr.length].key;J.add(St)}return await ss(S,ul.result,{replace:Pe}),{shortCircuited:!0}}let{loaderData:Sw,errors:Lh}=r2(S,ae,cr,Vu,Kt,Vn,Xi,ie);ie.forEach((St,Et)=>{St.subscribe(Vs=>{(Vs||St.done)&&ie.delete(Et)})}),u.v7_partialHydration&&Be&&S.errors&&Object.entries(S.errors).filter(St=>{let[Et]=St;return!cr.some(Vs=>Vs.route.id===Et)}).forEach(St=>{let[Et,Vs]=St;Lh=Object.assign(Lh||{},{[Et]:Vs})});let kw=qi(),Uu=ll(j),zg=kw||Uu||Vn.length>0;return cn({loaderData:Sw,errors:Lh},zg?{fetchers:new Map(S.fetchers)}:{})}function kt(M,G,ae,me){if(s)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");te.has(M)&&hs(M);let xe=(me&&me.unstable_flushSync)===!0,We=a||i,Pe=WS(S.location,S.matches,l,u.v7_prependBasename,ae,u.v7_relativeSplatPath,G,me==null?void 0:me.relative),Be=dc(We,Pe,l);if(!Be){_n(M,G,Pr(404,{pathname:Pe}),{flushSync:xe});return}let{path:Me,submission:et,error:Kt}=JE(u.v7_normalizeFormMethod,!0,Pe,me);if(Kt){_n(M,G,Kt,{flushSync:xe});return}let ot=GS(Be,Me);if(N=(me&&me.preventScrollReset)===!0,et&&ho(et.formMethod)){ar(M,G,Me,ot,Be,xe,et);return}_.set(M,{routeId:G,path:Me}),Ht(M,G,Me,ot,Be,xe,et)}async function ar(M,G,ae,me,xe,We,Pe){if(lr(),_.delete(M),!me.route.action&&!me.route.lazy){let Et=Pr(405,{method:Pe.formMethod,pathname:ae,routeId:G});_n(M,G,Et,{flushSync:We});return}let Be=S.fetchers.get(M);qt(M,k6(Pe,Be),{flushSync:We});let Me=new AbortController,et=qh(t.history,ae,Me.signal,Pe);te.set(M,Me);let Kt=F,ot=await Hh("action",et,me,xe,o,r,l,u.v7_relativeSplatPath);if(et.signal.aborted){te.get(M)===Me&&te.delete(M);return}if(u.v7_fetcherPersist&&Z.has(M)){if(Il(ot)||hc(ot)){qt(M,na(void 0));return}}else{if(Il(ot))if(te.delete(M),j>Kt){qt(M,na(void 0));return}else return J.add(M),qt(M,Kh(Pe)),ss(S,ot,{fetcherSubmission:Pe});if(hc(ot)){_n(M,G,ot.error);return}}if($l(ot))throw Pr(400,{type:"defer-action"});let Ft=S.navigation.location||S.location,rs=qh(t.history,Ft,Me.signal),cr=a||i,Vn=S.navigation.state!=="idle"?dc(cr,S.navigation.location,l):S.matches;pt(Vn,"Didn't find any matches after fetcher action");let Bu=++F;q.set(M,Bu);let ww=Kh(Pe,ot.data);S.fetchers.set(M,ww);let[Vu,Xi]=e2(t.history,S,Vn,Pe,Ft,!1,P,K,Y,Z,_,J,cr,l,{[me.route.id]:ot.data},void 0);Xi.filter(Et=>Et.key!==M).forEach(Et=>{let Vs=Et.key,Bg=S.fetchers.get(Vs),IU=Kh(void 0,Bg?Bg.data:void 0);S.fetchers.set(Vs,IU),te.has(Vs)&&hs(Vs),Et.controller&&te.set(Vs,Et.controller)}),ke({fetchers:new Map(S.fetchers)});let ul=()=>Xi.forEach(Et=>hs(Et.key));Me.signal.addEventListener("abort",ul);let{results:Sw,loaderResults:Lh,fetcherResults:kw}=await Rn(S.matches,Vn,Vu,Xi,rs);if(Me.signal.aborted)return;Me.signal.removeEventListener("abort",ul),q.delete(M),te.delete(M),Xi.forEach(Et=>te.delete(Et.key));let Uu=a2(Sw);if(Uu){if(Uu.idx>=Vu.length){let Et=Xi[Uu.idx-Vu.length].key;J.add(Et)}return ss(S,Uu.result)}let{loaderData:zg,errors:St}=r2(S,S.matches,Vu,Lh,void 0,Xi,kw,ie);if(S.fetchers.has(M)){let Et=na(ot.data);S.fetchers.set(M,Et)}ll(Bu),S.navigation.state==="loading"&&Bu>j?(pt(C,"Expected pending action"),I&&I.abort(),Ae(S.navigation.location,{matches:Vn,loaderData:zg,errors:St,fetchers:new Map(S.fetchers)})):(ke({errors:St,loaderData:o2(S.loaderData,zg,Vn,St),fetchers:new Map(S.fetchers)}),P=!1)}async function Ht(M,G,ae,me,xe,We,Pe){let Be=S.fetchers.get(M);qt(M,Kh(Pe,Be?Be.data:void 0),{flushSync:We});let Me=new AbortController,et=qh(t.history,ae,Me.signal);te.set(M,Me);let Kt=F,ot=await Hh("loader",et,me,xe,o,r,l,u.v7_relativeSplatPath);if($l(ot)&&(ot=await LO(ot,et.signal,!0)||ot),te.get(M)===Me&&te.delete(M),!et.signal.aborted){if(Z.has(M)){qt(M,na(void 0));return}if(Il(ot))if(j>Kt){qt(M,na(void 0));return}else{J.add(M),await ss(S,ot);return}if(hc(ot)){_n(M,G,ot.error);return}pt(!$l(ot),"Unhandled fetcher deferred data"),qt(M,na(ot.data))}}async function ss(M,G,ae){let{submission:me,fetcherSubmission:xe,replace:We}=ae===void 0?{}:ae;G.revalidate&&(P=!0);let Pe=tp(M.location,G.location,{_isRedirect:!0});if(pt(Pe,"Expected a location on the redirect navigation"),n){let Ft=!1;if(G.reloadDocument)Ft=!0;else if(AO.test(G.location)){const rs=t.history.createURL(G.location);Ft=rs.origin!==e.location.origin||Wp(rs.pathname,l)==null}if(Ft){We?e.location.replace(G.location):e.location.assign(G.location);return}}I=null;let Be=We===!0?yn.Replace:yn.Push,{formMethod:Me,formAction:et,formEncType:Kt}=M.navigation;!me&&!xe&&Me&&et&&Kt&&(me=u2(M.navigation));let ot=me||xe;if(c6.has(G.status)&&ot&&ho(ot.formMethod))await Xe(Be,Pe,{submission:cn({},ot,{formAction:G.location}),preventScrollReset:N});else{let Ft=e1(Pe,me);await Xe(Be,Pe,{overrideNavigation:Ft,fetcherSubmission:xe,preventScrollReset:N})}}async function Rn(M,G,ae,me,xe){let We=await Promise.all([...ae.map(Me=>Hh("loader",xe,Me,G,o,r,l,u.v7_relativeSplatPath)),...me.map(Me=>Me.matches&&Me.match&&Me.controller?Hh("loader",qh(t.history,Me.path,Me.controller.signal),Me.match,Me.matches,o,r,l,u.v7_relativeSplatPath):{type:ln.error,error:Pr(404,{pathname:Me.path})})]),Pe=We.slice(0,ae.length),Be=We.slice(ae.length);return await Promise.all([l2(M,ae,Pe,Pe.map(()=>xe.signal),!1,S.loaderData),l2(M,me.map(Me=>Me.match),Be,me.map(Me=>Me.controller?Me.controller.signal:null),!0)]),{results:We,loaderResults:Pe,fetcherResults:Be}}function lr(){P=!0,K.push(...pe()),_.forEach((M,G)=>{te.has(G)&&(Y.push(G),hs(G))})}function qt(M,G,ae){ae===void 0&&(ae={}),S.fetchers.set(M,G),ke({fetchers:new Map(S.fetchers)},{flushSync:(ae&&ae.flushSync)===!0})}function _n(M,G,ae,me){me===void 0&&(me={});let xe=Rf(S.matches,G);Cs(M),ke({errors:{[xe.route.id]:ae},fetchers:new Map(S.fetchers)},{flushSync:(me&&me.flushSync)===!0})}function ur(M){return u.v7_fetcherPersist&&(W.set(M,(W.get(M)||0)+1),Z.has(M)&&Z.delete(M)),S.fetchers.get(M)||d6}function Cs(M){let G=S.fetchers.get(M);te.has(M)&&!(G&&G.state==="loading"&&q.has(M))&&hs(M),_.delete(M),q.delete(M),J.delete(M),Z.delete(M),S.fetchers.delete(M)}function Rr(M){if(u.v7_fetcherPersist){let G=(W.get(M)||0)-1;G<=0?(W.delete(M),Z.add(M)):W.set(M,G)}else Cs(M);ke({fetchers:new Map(S.fetchers)})}function hs(M){let G=te.get(M);pt(G,"Expected fetch controller: "+M),G.abort(),te.delete(M)}function Hi(M){for(let G of M){let ae=ur(G),me=na(ae.data);S.fetchers.set(G,me)}}function qi(){let M=[],G=!1;for(let ae of J){let me=S.fetchers.get(ae);pt(me,"Expected fetcher: "+ae),me.state==="loading"&&(J.delete(ae),M.push(ae),G=!0)}return Hi(M),G}function ll(M){let G=[];for(let[ae,me]of q)if(me<M){let xe=S.fetchers.get(ae);pt(xe,"Expected fetcher: "+ae),xe.state==="loading"&&(hs(ae),q.delete(ae),G.push(ae))}return Hi(G),G.length>0}function Ki(M,G){let ae=S.blockers.get(M)||Gh;return re.get(M)!==G&&re.set(M,G),ae}function zu(M){S.blockers.delete(M),re.delete(M)}function ne(M,G){let ae=S.blockers.get(M)||Gh;pt(ae.state==="unblocked"&&G.state==="blocked"||ae.state==="blocked"&&G.state==="blocked"||ae.state==="blocked"&&G.state==="proceeding"||ae.state==="blocked"&&G.state==="unblocked"||ae.state==="proceeding"&&G.state==="unblocked","Invalid blocker state transition: "+ae.state+" -> "+G.state);let me=new Map(S.blockers);me.set(M,G),ke({blockers:me})}function X(M){let{currentLocation:G,nextLocation:ae,historyAction:me}=M;if(re.size===0)return;re.size>1&&qc(!1,"A router only supports one blocker at a time");let xe=Array.from(re.entries()),[We,Pe]=xe[xe.length-1],Be=S.blockers.get(We);if(!(Be&&Be.state==="proceeding")&&Pe({currentLocation:G,nextLocation:ae,historyAction:me}))return We}function pe(M){let G=[];return ie.forEach((ae,me)=>{(!M||M(me))&&(ae.cancel(),G.push(me),ie.delete(me))}),G}function Ce(M,G,ae){if(h=M,p=G,f=ae||null,!m&&S.navigation===Jw){m=!0;let me=je(S.location,S.matches);me!=null&&ke({restoreScrollPosition:me})}return()=>{h=null,p=null,f=null}}function Se(M,G){return f&&f(M,G.map(me=>VG(me,S.loaderData)))||M.key}function Ee(M,G){if(h&&p){let ae=Se(M,G);h[ae]=p()}}function je(M,G){if(h){let ae=Se(M,G),me=h[ae];if(typeof me=="number")return me}return null}function Ge(M){o={},a=US(M,r,void 0,o)}return w={get basename(){return l},get future(){return u},get state(){return S},get routes(){return i},get window(){return e},initialize:ye,subscribe:$e,enableScrollRestoration:Ce,navigate:Ue,fetch:kt,revalidate:ht,createHref:M=>t.history.createHref(M),encodeLocation:M=>t.history.encodeLocation(M),getFetcher:ur,deleteFetcher:Rr,dispose:de,getBlocker:Ki,deleteBlocker:zu,_internalFetchControllers:te,_internalActiveDeferreds:ie,_internalSetRoutes:Ge},w}function p6(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function WS(t,e,n,s,r,o,i,a){let l,u;if(i){l=[];for(let d of e)if(l.push(d),d.route.id===i){u=d;break}}else l=e,u=e[e.length-1];let c=EO(r||".",IO(l,o),Wp(t.pathname,n)||t.pathname,a==="path");return r==null&&(c.search=t.search,c.hash=t.hash),(r==null||r===""||r===".")&&u&&u.route.index&&!dN(c.search)&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),s&&n!=="/"&&(c.pathname=c.pathname==="/"?n:Ia([n,c.pathname])),Up(c)}function JE(t,e,n,s){if(!s||!p6(s))return{path:n};if(s.formMethod&&!w6(s.formMethod))return{path:n,error:Pr(405,{method:s.formMethod})};let r=()=>({path:n,error:Pr(400,{type:"invalid-body"})}),o=s.formMethod||"get",i=t?o.toUpperCase():o.toLowerCase(),a=FO(n);if(s.body!==void 0){if(s.formEncType==="text/plain"){if(!ho(i))return r();let h=typeof s.body=="string"?s.body:s.body instanceof FormData||s.body instanceof URLSearchParams?Array.from(s.body.entries()).reduce((f,p)=>{let[m,g]=p;return""+f+m+"="+g+`
`},""):String(s.body);return{path:n,submission:{formMethod:i,formAction:a,formEncType:s.formEncType,formData:void 0,json:void 0,text:h}}}else if(s.formEncType==="application/json"){if(!ho(i))return r();try{let h=typeof s.body=="string"?JSON.parse(s.body):s.body;return{path:n,submission:{formMethod:i,formAction:a,formEncType:s.formEncType,formData:void 0,json:h,text:void 0}}}catch{return r()}}}pt(typeof FormData=="function","FormData is not available in this environment");let l,u;if(s.formData)l=jS(s.formData),u=s.formData;else if(s.body instanceof FormData)l=jS(s.body),u=s.body;else if(s.body instanceof URLSearchParams)l=s.body,u=s2(l);else if(s.body==null)l=new URLSearchParams,u=new FormData;else try{l=new URLSearchParams(s.body),u=s2(l)}catch{return r()}let c={formMethod:i,formAction:a,formEncType:s&&s.formEncType||"application/x-www-form-urlencoded",formData:u,json:void 0,text:void 0};if(ho(c.formMethod))return{path:n,submission:c};let d=Oi(n);return e&&d.search&&dN(d.search)&&l.append("index",""),d.search="?"+l,{path:Up(d),submission:c}}function m6(t,e){let n=t;if(e){let s=t.findIndex(r=>r.route.id===e);s>=0&&(n=t.slice(0,s))}return n}function e2(t,e,n,s,r,o,i,a,l,u,c,d,h,f,p,m){let g=m?Object.values(m)[0]:p?Object.values(p)[0]:void 0,y=t.createURL(e.location),b=t.createURL(r),v=m?Object.keys(m)[0]:void 0,w=m6(n,v).filter((C,N)=>{let{route:I}=C;if(I.lazy)return!0;if(I.loader==null)return!1;if(o)return I.loader.hydrate?!0:e.loaderData[I.id]===void 0&&(!e.errors||e.errors[I.id]===void 0);if(g6(e.loaderData,e.matches[N],C)||a.some(z=>z===C.route.id))return!0;let E=e.matches[N],A=C;return t2(C,cn({currentUrl:y,currentParams:E.params,nextUrl:b,nextParams:A.params},s,{actionResult:g,defaultShouldRevalidate:i||y.pathname+y.search===b.pathname+b.search||y.search!==b.search||OO(E,A)}))}),S=[];return c.forEach((C,N)=>{if(o||!n.some(V=>V.route.id===C.routeId)||u.has(N))return;let I=dc(h,C.path,f);if(!I){S.push({key:N,routeId:C.routeId,path:C.path,matches:null,match:null,controller:null});return}let E=e.fetchers.get(N),A=GS(I,C.path),z=!1;d.has(N)?z=!1:l.includes(N)?z=!0:E&&E.state!=="idle"&&E.data===void 0?z=i:z=t2(A,cn({currentUrl:y,currentParams:e.matches[e.matches.length-1].params,nextUrl:b,nextParams:n[n.length-1].params},s,{actionResult:g,defaultShouldRevalidate:i})),z&&S.push({key:N,routeId:C.routeId,path:C.path,matches:I,match:A,controller:new AbortController})}),[w,S]}function g6(t,e,n){let s=!e||n.route.id!==e.route.id,r=t[n.route.id]===void 0;return s||r}function OO(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function t2(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}async function n2(t,e,n){if(!t.lazy)return;let s=await t.lazy();if(!t.lazy)return;let r=n[t.id];pt(r,"No route found in manifest");let o={};for(let i in s){let l=r[i]!==void 0&&i!=="hasErrorBoundary";qc(!l,'Route "'+r.id+'" has a static property "'+i+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+i+'" will be ignored.')),!l&&!zG.has(i)&&(o[i]=s[i])}Object.assign(r,o),Object.assign(r,cn({},e(r),{lazy:void 0}))}async function Hh(t,e,n,s,r,o,i,a,l){l===void 0&&(l={});let u,c,d,h=m=>{let g,y=new Promise((b,v)=>g=v);return d=()=>g(),e.signal.addEventListener("abort",d),Promise.race([m({request:e,params:n.params,context:l.requestContext}),y])};try{let m=n.route[t];if(n.route.lazy)if(m){let g,y=await Promise.all([h(m).catch(b=>{g=b}),n2(n.route,o,r)]);if(g)throw g;c=y[0]}else if(await n2(n.route,o,r),m=n.route[t],m)c=await h(m);else if(t==="action"){let g=new URL(e.url),y=g.pathname+g.search;throw Pr(405,{method:e.method,pathname:y,routeId:n.route.id})}else return{type:ln.data,data:void 0};else if(m)c=await h(m);else{let g=new URL(e.url),y=g.pathname+g.search;throw Pr(404,{pathname:y})}pt(c!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(m){u=ln.error,c=m}finally{d&&e.signal.removeEventListener("abort",d)}if(x6(c)){let m=c.status;if(u6.has(m)){let y=c.headers.get("Location");if(pt(y,"Redirects returned/thrown from loaders/actions must have a Location header"),!AO.test(y))y=WS(new URL(e.url),s.slice(0,s.indexOf(n)+1),i,!0,y,a);else if(!l.isStaticRequest){let b=new URL(e.url),v=y.startsWith("//")?new URL(b.protocol+y):new URL(y),x=Wp(v.pathname,i)!=null;v.origin===b.origin&&x&&(y=v.pathname+v.search+v.hash)}if(l.isStaticRequest)throw c.headers.set("Location",y),c;return{type:ln.redirect,status:m,location:y,revalidate:c.headers.get("X-Remix-Revalidate")!==null,reloadDocument:c.headers.get("X-Remix-Reload-Document")!==null}}if(l.isRouteRequest)throw{type:u===ln.error?ln.error:ln.data,response:c};let g;try{let y=c.headers.get("Content-Type");y&&/\bapplication\/json\b/.test(y)?c.body==null?g=null:g=await c.json():g=await c.text()}catch(y){return{type:ln.error,error:y}}return u===ln.error?{type:u,error:new cN(m,c.statusText,g),headers:c.headers}:{type:ln.data,data:g,statusCode:c.status,headers:c.headers}}if(u===ln.error)return{type:u,error:c};if(v6(c)){var f,p;return{type:ln.deferred,deferredData:c,statusCode:(f=c.init)==null?void 0:f.status,headers:((p=c.init)==null?void 0:p.headers)&&new Headers(c.init.headers)}}return{type:ln.data,data:c}}function qh(t,e,n,s){let r=t.createURL(FO(e)).toString(),o={signal:n};if(s&&ho(s.formMethod)){let{formMethod:i,formEncType:a}=s;o.method=i.toUpperCase(),a==="application/json"?(o.headers=new Headers({"Content-Type":a}),o.body=JSON.stringify(s.json)):a==="text/plain"?o.body=s.text:a==="application/x-www-form-urlencoded"&&s.formData?o.body=jS(s.formData):o.body=s.formData}return new Request(r,o)}function jS(t){let e=new URLSearchParams;for(let[n,s]of t.entries())e.append(n,typeof s=="string"?s:s.name);return e}function s2(t){let e=new FormData;for(let[n,s]of t.entries())e.append(n,s);return e}function y6(t,e,n,s,r){let o={},i=null,a,l=!1,u={};return n.forEach((c,d)=>{let h=e[d].route.id;if(pt(!Il(c),"Cannot handle redirect results in processLoaderData"),hc(c)){let f=Rf(t,h),p=c.error;s&&(p=Object.values(s)[0],s=void 0),i=i||{},i[f.route.id]==null&&(i[f.route.id]=p),o[h]=void 0,l||(l=!0,a=RO(c.error)?c.error.status:500),c.headers&&(u[h]=c.headers)}else $l(c)?(r.set(h,c.deferredData),o[h]=c.deferredData.data):o[h]=c.data,c.statusCode!=null&&c.statusCode!==200&&!l&&(a=c.statusCode),c.headers&&(u[h]=c.headers)}),s&&(i=s,o[Object.keys(s)[0]]=void 0),{loaderData:o,errors:i,statusCode:a||200,loaderHeaders:u}}function r2(t,e,n,s,r,o,i,a){let{loaderData:l,errors:u}=y6(e,n,s,r,a);for(let c=0;c<o.length;c++){let{key:d,match:h,controller:f}=o[c];pt(i!==void 0&&i[c]!==void 0,"Did not find corresponding fetcher result");let p=i[c];if(!(f&&f.signal.aborted))if(hc(p)){let m=Rf(t.matches,h==null?void 0:h.route.id);u&&u[m.route.id]||(u=cn({},u,{[m.route.id]:p.error})),t.fetchers.delete(d)}else if(Il(p))pt(!1,"Unhandled fetcher revalidation redirect");else if($l(p))pt(!1,"Unhandled fetcher deferred data");else{let m=na(p.data);t.fetchers.set(d,m)}}return{loaderData:l,errors:u}}function o2(t,e,n,s){let r=cn({},e);for(let o of n){let i=o.route.id;if(e.hasOwnProperty(i)?e[i]!==void 0&&(r[i]=e[i]):t[i]!==void 0&&o.route.loader&&(r[i]=t[i]),s&&s.hasOwnProperty(i))break}return r}function Rf(t,e){return(e?t.slice(0,t.findIndex(s=>s.route.id===e)+1):[...t]).reverse().find(s=>s.route.hasErrorBoundary===!0)||t[0]}function i2(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Pr(t,e){let{pathname:n,routeId:s,method:r,type:o}=e===void 0?{}:e,i="Unknown Server Error",a="Unknown @remix-run/router error";return t===400?(i="Bad Request",r&&n&&s?a="You made a "+r+' request to "'+n+'" but '+('did not provide a `loader` for route "'+s+'", ')+"so there is no way to handle the request.":o==="defer-action"?a="defer() is not supported in actions":o==="invalid-body"&&(a="Unable to encode submission body")):t===403?(i="Forbidden",a='Route "'+s+'" does not match URL "'+n+'"'):t===404?(i="Not Found",a='No route matches URL "'+n+'"'):t===405&&(i="Method Not Allowed",r&&n&&s?a="You made a "+r.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+s+'", ')+"so there is no way to handle the request.":r&&(a='Invalid request method "'+r.toUpperCase()+'"')),new cN(t||500,i,new Error(a),!0)}function a2(t){for(let e=t.length-1;e>=0;e--){let n=t[e];if(Il(n))return{result:n,idx:e}}}function FO(t){let e=typeof t=="string"?Oi(t):t;return Up(cn({},e,{hash:""}))}function b6(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function $l(t){return t.type===ln.deferred}function hc(t){return t.type===ln.error}function Il(t){return(t&&t.type)===ln.redirect}function v6(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function x6(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function w6(t){return l6.has(t.toLowerCase())}function ho(t){return i6.has(t.toLowerCase())}async function l2(t,e,n,s,r,o){for(let i=0;i<n.length;i++){let a=n[i],l=e[i];if(!l)continue;let u=t.find(d=>d.route.id===l.route.id),c=u!=null&&!OO(u,l)&&(o&&o[l.route.id])!==void 0;if($l(a)&&(r||c)){let d=s[i];pt(d,"Expected an AbortSignal for revalidating fetcher deferred result"),await LO(a,d,r).then(h=>{h&&(n[i]=h||n[i])})}}}async function LO(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:ln.data,data:t.deferredData.unwrappedData}}catch(r){return{type:ln.error,error:r}}return{type:ln.data,data:t.deferredData.data}}}function dN(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function GS(t,e){let n=typeof e=="string"?Oi(e).search:e.search;if(t[t.length-1].route.index&&dN(n||""))return t[t.length-1];let s=$O(t);return s[s.length-1]}function u2(t){let{formMethod:e,formAction:n,formEncType:s,text:r,formData:o,json:i}=t;if(!(!e||!n||!s)){if(r!=null)return{formMethod:e,formAction:n,formEncType:s,formData:void 0,json:void 0,text:r};if(o!=null)return{formMethod:e,formAction:n,formEncType:s,formData:o,json:void 0,text:void 0};if(i!==void 0)return{formMethod:e,formAction:n,formEncType:s,formData:void 0,json:i,text:void 0}}}function e1(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function S6(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Kh(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function k6(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function na(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function C6(t,e){try{let n=t.sessionStorage.getItem(DO);if(n){let s=JSON.parse(n);for(let[r,o]of Object.entries(s||{}))o&&Array.isArray(o)&&e.set(r,new Set(o||[]))}}catch{}}function N6(t,e){if(e.size>0){let n={};for(let[s,r]of e)n[s]=[...r];try{t.sessionStorage.setItem(DO,JSON.stringify(n))}catch(s){qc(!1,"Failed to save applied view transitions in sessionStorage ("+s+").")}}}/**
 * React Router v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function np(){return np=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},np.apply(this,arguments)}const Tb=R.createContext(null),PO=R.createContext(null),$b=R.createContext(null),Ib=R.createContext(null),xu=R.createContext({outlet:null,matches:[],isDataRoute:!1}),MO=R.createContext(null);function Eb(){return R.useContext(Ib)!=null}function zO(){return Eb()||pt(!1),R.useContext(Ib).location}function BO(t){R.useContext($b).static||R.useLayoutEffect(t)}function VO(){let{isDataRoute:t}=R.useContext(xu);return t?z6():T6()}function T6(){Eb()||pt(!1);let t=R.useContext(Tb),{basename:e,future:n,navigator:s}=R.useContext($b),{matches:r}=R.useContext(xu),{pathname:o}=zO(),i=JSON.stringify(IO(r,n.v7_relativeSplatPath)),a=R.useRef(!1);return BO(()=>{a.current=!0}),R.useCallback(function(u,c){if(c===void 0&&(c={}),!a.current)return;if(typeof u=="number"){s.go(u);return}let d=EO(u,JSON.parse(i),o,c.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Ia([e,d.pathname])),(c.replace?s.replace:s.push)(d,c.state,c)},[e,s,i,o,t])}const $6=R.createContext(null);function I6(t){let e=R.useContext(xu).outlet;return e&&R.createElement($6.Provider,{value:t},e)}function E6(t,e,n,s){Eb()||pt(!1);let{navigator:r}=R.useContext($b),{matches:o}=R.useContext(xu),i=o[o.length-1],a=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let u=zO(),c;if(e){var d;let g=typeof e=="string"?Oi(e):e;l==="/"||(d=g.pathname)!=null&&d.startsWith(l)||pt(!1),c=g}else c=u;let h=c.pathname||"/",f=h;if(l!=="/"){let g=l.replace(/^\//,"").split("/");f="/"+h.replace(/^\//,"").split("/").slice(g.length).join("/")}let p=dc(t,{pathname:f}),m=O6(p&&p.map(g=>Object.assign({},g,{params:Object.assign({},a,g.params),pathname:Ia([l,r.encodeLocation?r.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?l:Ia([l,r.encodeLocation?r.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),o,n,s);return e&&m?R.createElement(Ib.Provider,{value:{location:np({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:yn.Pop}},m):m}function R6(){let t=M6(),e=RO(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},e),n?R.createElement("pre",{style:r},n):null,null)}const _6=R.createElement(R6,null);class A6 extends R.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?R.createElement(xu.Provider,{value:this.props.routeContext},R.createElement(MO.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function D6(t){let{routeContext:e,match:n,children:s}=t,r=R.useContext(Tb);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),R.createElement(xu.Provider,{value:e},s)}function O6(t,e,n,s){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var o;if((o=n)!=null&&o.errors)t=n.matches;else return null}let i=t,a=(r=n)==null?void 0:r.errors;if(a!=null){let c=i.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id]));c>=0||pt(!1),i=i.slice(0,Math.min(i.length,c+1))}let l=!1,u=-1;if(n&&s&&s.v7_partialHydration)for(let c=0;c<i.length;c++){let d=i[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=c),d.route.id){let{loaderData:h,errors:f}=n,p=d.route.loader&&h[d.route.id]===void 0&&(!f||f[d.route.id]===void 0);if(d.route.lazy||p){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((c,d,h)=>{let f,p=!1,m=null,g=null;n&&(f=a&&d.route.id?a[d.route.id]:void 0,m=d.route.errorElement||_6,l&&(u<0&&h===0?(B6("route-fallback",!1),p=!0,g=null):u===h&&(p=!0,g=d.route.hydrateFallbackElement||null)));let y=e.concat(i.slice(0,h+1)),b=()=>{let v;return f?v=m:p?v=g:d.route.Component?v=R.createElement(d.route.Component,null):d.route.element?v=d.route.element:v=c,R.createElement(D6,{match:d,routeContext:{outlet:c,matches:y,isDataRoute:n!=null},children:v})};return n&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?R.createElement(A6,{location:n.location,revalidation:n.revalidation,component:m,error:f,children:b(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):b()},null)}var UO=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(UO||{}),S0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(S0||{});function F6(t){let e=R.useContext(Tb);return e||pt(!1),e}function L6(t){let e=R.useContext(PO);return e||pt(!1),e}function P6(t){let e=R.useContext(xu);return e||pt(!1),e}function WO(t){let e=P6(),n=e.matches[e.matches.length-1];return n.route.id||pt(!1),n.route.id}function M6(){var t;let e=R.useContext(MO),n=L6(S0.UseRouteError),s=WO(S0.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function z6(){let{router:t}=F6(UO.UseNavigateStable),e=WO(S0.UseNavigateStable),n=R.useRef(!1);return BO(()=>{n.current=!0}),R.useCallback(function(r,o){o===void 0&&(o={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,np({fromRouteId:e},o)))},[t,e])}const c2={};function B6(t,e,n){!e&&!c2[t]&&(c2[t]=!0)}function V6(t){return I6(t.context)}function U6(t){let{basename:e="/",children:n=null,location:s,navigationType:r=yn.Pop,navigator:o,static:i=!1,future:a}=t;Eb()&&pt(!1);let l=e.replace(/^\/*/,"/"),u=R.useMemo(()=>({basename:l,navigator:o,static:i,future:np({v7_relativeSplatPath:!1},a)}),[l,a,o,i]);typeof s=="string"&&(s=Oi(s));let{pathname:c="/",search:d="",hash:h="",state:f=null,key:p="default"}=s,m=R.useMemo(()=>{let g=Wp(c,l);return g==null?null:{location:{pathname:g,search:d,hash:h,state:f,key:p},navigationType:r}},[l,c,d,h,f,p,r]);return m==null?null:R.createElement($b.Provider,{value:u},R.createElement(Ib.Provider,{children:n,value:m}))}new Promise(()=>{});function W6(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:R.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:R.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:R.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.22.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function k0(){return k0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},k0.apply(this,arguments)}const j6="6";try{window.__reactRouterVersion=j6}catch{}function G6(t,e){return f6({basename:e==null?void 0:e.basename,future:k0({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:LG({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||H6(),routes:t,mapRouteProperties:W6,window:e==null?void 0:e.window}).initialize()}function H6(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=k0({},e,{errors:q6(e.errors)})),e}function q6(t){if(!t)return null;let e=Object.entries(t),n={};for(let[s,r]of e)if(r&&r.__type==="RouteErrorResponse")n[s]=new cN(r.status,r.statusText,r.data,r.internal===!0);else if(r&&r.__type==="Error"){if(r.__subType){let o=window[r.__subType];if(typeof o=="function")try{let i=new o(r.message);i.stack="",n[s]=i}catch{}}if(n[s]==null){let o=new Error(r.message);o.stack="",n[s]=o}}else n[s]=r;return n}const K6=R.createContext({isTransitioning:!1}),X6=R.createContext(new Map),Y6="startTransition",d2=GU[Y6],Q6="flushSync",h2=FG[Q6];function Z6(t){d2?d2(t):t()}function Xh(t){h2?h2(t):t()}class J6{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=s=>{this.status==="pending"&&(this.status="resolved",e(s))},this.reject=s=>{this.status==="pending"&&(this.status="rejected",n(s))}})}}function e5(t){let{fallbackElement:e,router:n,future:s}=t,[r,o]=R.useState(n.state),[i,a]=R.useState(),[l,u]=R.useState({isTransitioning:!1}),[c,d]=R.useState(),[h,f]=R.useState(),[p,m]=R.useState(),g=R.useRef(new Map),{v7_startTransition:y}=s||{},b=R.useCallback(C=>{y?Z6(C):C()},[y]),v=R.useCallback((C,N)=>{let{deletedFetchers:I,unstable_flushSync:E,unstable_viewTransitionOpts:A}=N;I.forEach(V=>g.current.delete(V)),C.fetchers.forEach((V,P)=>{V.data!==void 0&&g.current.set(P,V.data)});let z=n.window==null||typeof n.window.document.startViewTransition!="function";if(!A||z){E?Xh(()=>o(C)):b(()=>o(C));return}if(E){Xh(()=>{h&&(c&&c.resolve(),h.skipTransition()),u({isTransitioning:!0,flushSync:!0,currentLocation:A.currentLocation,nextLocation:A.nextLocation})});let V=n.window.document.startViewTransition(()=>{Xh(()=>o(C))});V.finished.finally(()=>{Xh(()=>{d(void 0),f(void 0),a(void 0),u({isTransitioning:!1})})}),Xh(()=>f(V));return}h?(c&&c.resolve(),h.skipTransition(),m({state:C,currentLocation:A.currentLocation,nextLocation:A.nextLocation})):(a(C),u({isTransitioning:!0,flushSync:!1,currentLocation:A.currentLocation,nextLocation:A.nextLocation}))},[n.window,h,c,g,b]);R.useLayoutEffect(()=>n.subscribe(v),[n,v]),R.useEffect(()=>{l.isTransitioning&&!l.flushSync&&d(new J6)},[l]),R.useEffect(()=>{if(c&&i&&n.window){let C=i,N=c.promise,I=n.window.document.startViewTransition(async()=>{b(()=>o(C)),await N});I.finished.finally(()=>{d(void 0),f(void 0),a(void 0),u({isTransitioning:!1})}),f(I)}},[b,i,c,n.window]),R.useEffect(()=>{c&&i&&r.location.key===i.location.key&&c.resolve()},[c,h,r.location,i]),R.useEffect(()=>{!l.isTransitioning&&p&&(a(p.state),u({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),m(void 0))},[l.isTransitioning,p]),R.useEffect(()=>{},[]);let x=R.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:C=>n.navigate(C),push:(C,N,I)=>n.navigate(C,{state:N,preventScrollReset:I==null?void 0:I.preventScrollReset}),replace:(C,N,I)=>n.navigate(C,{replace:!0,state:N,preventScrollReset:I==null?void 0:I.preventScrollReset})}),[n]),w=n.basename||"/",S=R.useMemo(()=>({router:n,navigator:x,static:!1,basename:w}),[n,x,w]);return R.createElement(R.Fragment,null,R.createElement(Tb.Provider,{value:S},R.createElement(PO.Provider,{value:r},R.createElement(X6.Provider,{value:g.current},R.createElement(K6.Provider,{value:l},R.createElement(U6,{basename:w,location:r.location,navigationType:r.historyAction,navigator:x,future:{v7_relativeSplatPath:n.future.v7_relativeSplatPath}},r.initialized||n.future.v7_partialHydration?R.createElement(t5,{routes:n.routes,future:n.future,state:r}):e))))),null)}function t5(t){let{routes:e,future:n,state:s}=t;return E6(e,void 0,s,n)}var f2;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(f2||(f2={}));var p2;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(p2||(p2={}));var jO={};function n5(t){const e=new Error(t);if(e.stack===void 0)try{throw e}catch{}return e}var s5=n5,it=s5;function r5(t){return!!t&&typeof t.then=="function"}var Ut=r5;function o5(t,e){if(t!=null)return t;throw it(e??"Got unexpected null or undefined")}var Qt=o5;function Je(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Rb{getValue(){throw it("BaseLoadable")}toPromise(){throw it("BaseLoadable")}valueMaybe(){throw it("BaseLoadable")}valueOrThrow(){throw it(`Loadable expected value, but in "${this.state}" state`)}promiseMaybe(){throw it("BaseLoadable")}promiseOrThrow(){throw it(`Loadable expected promise, but in "${this.state}" state`)}errorMaybe(){throw it("BaseLoadable")}errorOrThrow(){throw it(`Loadable expected error, but in "${this.state}" state`)}is(e){return e.state===this.state&&e.contents===this.contents}map(e){throw it("BaseLoadable")}}class i5 extends Rb{constructor(e){super(),Je(this,"state","hasValue"),Je(this,"contents",void 0),this.contents=e}getValue(){return this.contents}toPromise(){return Promise.resolve(this.contents)}valueMaybe(){return this.contents}valueOrThrow(){return this.contents}promiseMaybe(){}errorMaybe(){}map(e){try{const n=e(this.contents);return Ut(n)?Jl(n):Kc(n)?n:jp(n)}catch(n){return Ut(n)?Jl(n.next(()=>this.map(e))):_b(n)}}}class a5 extends Rb{constructor(e){super(),Je(this,"state","hasError"),Je(this,"contents",void 0),this.contents=e}getValue(){throw this.contents}toPromise(){return Promise.reject(this.contents)}valueMaybe(){}promiseMaybe(){}errorMaybe(){return this.contents}errorOrThrow(){return this.contents}map(e){return this}}class GO extends Rb{constructor(e){super(),Je(this,"state","loading"),Je(this,"contents",void 0),this.contents=e}getValue(){throw this.contents}toPromise(){return this.contents}valueMaybe(){}promiseMaybe(){return this.contents}promiseOrThrow(){return this.contents}errorMaybe(){}map(e){return Jl(this.contents.then(n=>{const s=e(n);if(Kc(s)){const r=s;switch(r.state){case"hasValue":return r.contents;case"hasError":throw r.contents;case"loading":return r.contents}}return s}).catch(n=>{if(Ut(n))return n.then(()=>this.map(e).contents);throw n}))}}function jp(t){return Object.freeze(new i5(t))}function _b(t){return Object.freeze(new a5(t))}function Jl(t){return Object.freeze(new GO(t))}function HO(){return Object.freeze(new GO(new Promise(()=>{})))}function l5(t){return t.every(e=>e.state==="hasValue")?jp(t.map(e=>e.contents)):t.some(e=>e.state==="hasError")?_b(Qt(t.find(e=>e.state==="hasError"),"Invalid loadable passed to loadableAll").contents):Jl(Promise.all(t.map(e=>e.contents)))}function qO(t){const n=(Array.isArray(t)?t:Object.getOwnPropertyNames(t).map(r=>t[r])).map(r=>Kc(r)?r:Ut(r)?Jl(r):jp(r)),s=l5(n);return Array.isArray(t)?s:s.map(r=>Object.getOwnPropertyNames(t).reduce((o,i,a)=>({...o,[i]:r[a]}),{}))}function Kc(t){return t instanceof Rb}const u5={of:t=>Ut(t)?Jl(t):Kc(t)?t:jp(t),error:t=>_b(t),loading:()=>HO(),all:qO,isLoadable:Kc};var wu={loadableWithValue:jp,loadableWithError:_b,loadableWithPromise:Jl,loadableLoading:HO,loadableAll:qO,isLoadable:Kc,RecoilLoadable:u5},c5=wu.loadableWithValue,d5=wu.loadableWithError,h5=wu.loadableWithPromise,f5=wu.loadableLoading,p5=wu.loadableAll,m5=wu.isLoadable,g5=wu.RecoilLoadable,Gp=Object.freeze({__proto__:null,loadableWithValue:c5,loadableWithError:d5,loadableWithPromise:h5,loadableLoading:f5,loadableAll:p5,isLoadable:m5,RecoilLoadable:g5});const HS={RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED:!0,RECOIL_GKS_ENABLED:new Set(["recoil_hamt_2020","recoil_sync_external_store","recoil_suppress_rerender_in_callback","recoil_memory_managament_2020"])};function y5(t,e){var n,s;const r=(n=jO[t])===null||n===void 0||(s=n.toLowerCase())===null||s===void 0?void 0:s.trim();if(r==null||r==="")return;if(!["true","false"].includes(r))throw it(`process.env.${t} value must be 'true', 'false', or empty: ${r}`);e(r==="true")}function b5(t,e){var n;const s=(n=jO[t])===null||n===void 0?void 0:n.trim();s==null||s===""||e(s.split(/\s*,\s*|\s+/))}function v5(){var t;typeof process>"u"||((t=process)===null||t===void 0?void 0:t.env)!=null&&(y5("RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED",e=>{HS.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED=e}),b5("RECOIL_GKS_ENABLED",e=>{e.forEach(n=>{HS.RECOIL_GKS_ENABLED.add(n)})}))}v5();var xd=HS;function Ab(t){return xd.RECOIL_GKS_ENABLED.has(t)}Ab.setPass=t=>{xd.RECOIL_GKS_ENABLED.add(t)};Ab.setFail=t=>{xd.RECOIL_GKS_ENABLED.delete(t)};Ab.clear=()=>{xd.RECOIL_GKS_ENABLED.clear()};var At=Ab;function x5(t,e,{error:n}={}){return null}var w5=x5,hN=w5,t1,n1,s1;const S5=(t1=lt.createMutableSource)!==null&&t1!==void 0?t1:lt.unstable_createMutableSource,KO=(n1=lt.useMutableSource)!==null&&n1!==void 0?n1:lt.unstable_useMutableSource,XO=(s1=lt.useSyncExternalStore)!==null&&s1!==void 0?s1:lt.unstable_useSyncExternalStore;function k5(){var t;const{ReactCurrentDispatcher:e,ReactCurrentOwner:n}=lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;return((t=e==null?void 0:e.current)!==null&&t!==void 0?t:n.currentDispatcher).useSyncExternalStore!=null}function C5(){return At("recoil_transition_support")?{mode:"TRANSITION_SUPPORT",early:!0,concurrent:!0}:At("recoil_sync_external_store")&&XO!=null?{mode:"SYNC_EXTERNAL_STORE",early:!0,concurrent:!1}:At("recoil_mutable_source")&&KO!=null&&typeof window<"u"&&!window.$disableRecoilValueMutableSource_TEMP_HACK_DO_NOT_USE?At("recoil_suppress_rerender_in_callback")?{mode:"MUTABLE_SOURCE",early:!0,concurrent:!0}:{mode:"MUTABLE_SOURCE",early:!1,concurrent:!1}:At("recoil_suppress_rerender_in_callback")?{mode:"LEGACY",early:!0,concurrent:!1}:{mode:"LEGACY",early:!1,concurrent:!1}}function N5(){return!1}var Hp={createMutableSource:S5,useMutableSource:KO,useSyncExternalStore:XO,currentRendererSupportsUseSyncExternalStore:k5,reactMode:C5,isFastRefreshEnabled:N5};class fN{constructor(e){Je(this,"key",void 0),this.key=e}toJSON(){return{key:this.key}}}class YO extends fN{}class QO extends fN{}function T5(t){return t instanceof YO||t instanceof QO}var Db={AbstractRecoilValue:fN,RecoilState:YO,RecoilValueReadOnly:QO,isRecoilValue:T5},$5=Db.AbstractRecoilValue,I5=Db.RecoilState,E5=Db.RecoilValueReadOnly,R5=Db.isRecoilValue,Xc=Object.freeze({__proto__:null,AbstractRecoilValue:$5,RecoilState:I5,RecoilValueReadOnly:E5,isRecoilValue:R5});function _5(t,e){return function*(){let n=0;for(const s of t)yield e(s,n++)}()}var Ob=_5;class ZO{}const A5=new ZO,eu=new Map,pN=new Map;function D5(t){return Ob(t,e=>Qt(pN.get(e)))}function O5(t){if(eu.has(t)){const e=`Duplicate atom key "${t}". This is a FATAL ERROR in
      production. But it is safe to ignore this warning if it occurred because of
      hot module replacement.`;console.warn(e)}}function F5(t){xd.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED&&O5(t.key),eu.set(t.key,t);const e=t.set==null?new Xc.RecoilValueReadOnly(t.key):new Xc.RecoilState(t.key);return pN.set(t.key,e),e}class JO extends Error{}function L5(t){const e=eu.get(t);if(e==null)throw new JO(`Missing definition for RecoilValue: "${t}""`);return e}function P5(t){return eu.get(t)}const C0=new Map;function M5(t){var e;if(!At("recoil_memory_managament_2020"))return;const n=eu.get(t);if(n!=null&&(e=n.shouldDeleteConfigOnRelease)!==null&&e!==void 0&&e.call(n)){var s;eu.delete(t),(s=eF(t))===null||s===void 0||s(),C0.delete(t)}}function z5(t,e){At("recoil_memory_managament_2020")&&(e===void 0?C0.delete(t):C0.set(t,e))}function eF(t){return C0.get(t)}var rr={nodes:eu,recoilValues:pN,registerNode:F5,getNode:L5,getNodeMaybe:P5,deleteNodeConfigIfPossible:M5,setConfigDeletionHandler:z5,getConfigDeletionHandler:eF,recoilValuesForKeys:D5,NodeMissingError:JO,DefaultValue:ZO,DEFAULT_VALUE:A5};function B5(t,e){e()}var V5={enqueueExecution:B5};function U5(t,e){return e={exports:{}},t(e,e.exports),e.exports}var W5=U5(function(t){var e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ne){return typeof ne}:function(ne){return ne&&typeof Symbol=="function"&&ne.constructor===Symbol&&ne!==Symbol.prototype?"symbol":typeof ne},n={},s=5,r=Math.pow(2,s),o=r-1,i=r/2,a=r/4,l={},u=function(X){return function(){return X}},c=n.hash=function(ne){var X=typeof ne>"u"?"undefined":e(ne);if(X==="number")return ne;X!=="string"&&(ne+="");for(var pe=0,Ce=0,Se=ne.length;Ce<Se;++Ce){var Ee=ne.charCodeAt(Ce);pe=(pe<<5)-pe+Ee|0}return pe},d=function(X){return X-=X>>1&1431655765,X=(X&858993459)+(X>>2&858993459),X=X+(X>>4)&252645135,X+=X>>8,X+=X>>16,X&127},h=function(X,pe){return pe>>>X&o},f=function(X){return 1<<X},p=function(X,pe){return d(X&pe-1)},m=function(X,pe,Ce,Se){var Ee=Se;if(!X){var je=Se.length;Ee=new Array(je);for(var Ge=0;Ge<je;++Ge)Ee[Ge]=Se[Ge]}return Ee[pe]=Ce,Ee},g=function(X,pe,Ce){var Se=Ce.length-1,Ee=0,je=0,Ge=Ce;if(X)Ee=je=pe;else for(Ge=new Array(Se);Ee<pe;)Ge[je++]=Ce[Ee++];for(++Ee;Ee<=Se;)Ge[je++]=Ce[Ee++];return X&&(Ge.length=Se),Ge},y=function(X,pe,Ce,Se){var Ee=Se.length;if(X){for(var je=Ee;je>=pe;)Se[je--]=Se[je];return Se[pe]=Ce,Se}for(var Ge=0,M=0,G=new Array(Ee+1);Ge<pe;)G[M++]=Se[Ge++];for(G[pe]=Ce;Ge<Ee;)G[++M]=Se[Ge++];return G},b=1,v=2,x=3,w=4,S={__hamt_isEmpty:!0},C=function(X){return X===S||X&&X.__hamt_isEmpty},N=function(X,pe,Ce,Se){return{type:b,edit:X,hash:pe,key:Ce,value:Se,_modify:F}},I=function(X,pe,Ce){return{type:v,edit:X,hash:pe,children:Ce,_modify:j}},E=function(X,pe,Ce){return{type:x,edit:X,mask:pe,children:Ce,_modify:q}},A=function(X,pe,Ce){return{type:w,edit:X,size:pe,children:Ce,_modify:J}},z=function(X){return X===S||X.type===b||X.type===v},V=function(X,pe,Ce,Se,Ee){for(var je=[],Ge=Se,M=0,G=0;Ge;++G)Ge&1&&(je[G]=Ee[M++]),Ge>>>=1;return je[pe]=Ce,A(X,M+1,je)},P=function(X,pe,Ce,Se){for(var Ee=new Array(pe-1),je=0,Ge=0,M=0,G=Se.length;M<G;++M)if(M!==Ce){var ae=Se[M];ae&&!C(ae)&&(Ee[je++]=ae,Ge|=1<<M)}return E(X,Ge,Ee)},K=function ne(X,pe,Ce,Se,Ee,je){if(Ce===Ee)return I(X,Ce,[je,Se]);var Ge=h(pe,Ce),M=h(pe,Ee);return E(X,f(Ge)|f(M),Ge===M?[ne(X,pe+s,Ce,Se,Ee,je)]:Ge<M?[Se,je]:[je,Se])},Y=function(X,pe,Ce,Se,Ee,je,Ge,M){for(var G=Ee.length,ae=0;ae<G;++ae){var me=Ee[ae];if(Ce(Ge,me.key)){var xe=me.value,We=je(xe);return We===xe?Ee:We===l?(--M.value,g(X,ae,Ee)):m(X,ae,N(pe,Se,Ge,We),Ee)}}var Pe=je();return Pe===l?Ee:(++M.value,m(X,G,N(pe,Se,Ge,Pe),Ee))},te=function(X,pe){return X===pe.edit},F=function(X,pe,Ce,Se,Ee,je,Ge){if(pe(je,this.key)){var M=Se(this.value);return M===this.value?this:M===l?(--Ge.value,S):te(X,this)?(this.value=M,this):N(X,Ee,je,M)}var G=Se();return G===l?this:(++Ge.value,K(X,Ce,this.hash,this,Ee,N(X,Ee,je,G)))},j=function(X,pe,Ce,Se,Ee,je,Ge){if(Ee===this.hash){var M=te(X,this),G=Y(M,X,pe,this.hash,this.children,Se,je,Ge);return G===this.children?this:G.length>1?I(X,this.hash,G):G[0]}var ae=Se();return ae===l?this:(++Ge.value,K(X,Ce,this.hash,this,Ee,N(X,Ee,je,ae)))},q=function(X,pe,Ce,Se,Ee,je,Ge){var M=this.mask,G=this.children,ae=h(Ce,Ee),me=f(ae),xe=p(M,me),We=M&me,Pe=We?G[xe]:S,Be=Pe._modify(X,pe,Ce+s,Se,Ee,je,Ge);if(Pe===Be)return this;var Me=te(X,this),et=M,Kt=void 0;if(We&&C(Be)){if(et&=~me,!et)return S;if(G.length<=2&&z(G[xe^1]))return G[xe^1];Kt=g(Me,xe,G)}else if(!We&&!C(Be)){if(G.length>=i)return V(X,ae,Be,M,G);et|=me,Kt=y(Me,xe,Be,G)}else Kt=m(Me,xe,Be,G);return Me?(this.mask=et,this.children=Kt,this):E(X,et,Kt)},J=function(X,pe,Ce,Se,Ee,je,Ge){var M=this.size,G=this.children,ae=h(Ce,Ee),me=G[ae],xe=(me||S)._modify(X,pe,Ce+s,Se,Ee,je,Ge);if(me===xe)return this;var We=te(X,this),Pe=void 0;if(C(me)&&!C(xe))++M,Pe=m(We,ae,xe,G);else if(!C(me)&&C(xe)){if(--M,M<=a)return P(X,M,ae,G);Pe=m(We,ae,S,G)}else Pe=m(We,ae,xe,G);return We?(this.size=M,this.children=Pe,this):A(X,M,Pe)};S._modify=function(ne,X,pe,Ce,Se,Ee,je){var Ge=Ce();return Ge===l?S:(++je.value,N(ne,Se,Ee,Ge))};function _(ne,X,pe,Ce,Se){this._editable=ne,this._edit=X,this._config=pe,this._root=Ce,this._size=Se}_.prototype.setTree=function(ne,X){return this._editable?(this._root=ne,this._size=X,this):ne===this._root?this:new _(this._editable,this._edit,this._config,ne,X)};var W=n.tryGetHash=function(ne,X,pe,Ce){for(var Se=Ce._root,Ee=0,je=Ce._config.keyEq;;)switch(Se.type){case b:return je(pe,Se.key)?Se.value:ne;case v:{if(X===Se.hash)for(var Ge=Se.children,M=0,G=Ge.length;M<G;++M){var ae=Ge[M];if(je(pe,ae.key))return ae.value}return ne}case x:{var me=h(Ee,X),xe=f(me);if(Se.mask&xe){Se=Se.children[p(Se.mask,xe)],Ee+=s;break}return ne}case w:{if(Se=Se.children[h(Ee,X)],Se){Ee+=s;break}return ne}default:return ne}};_.prototype.tryGetHash=function(ne,X,pe){return W(ne,X,pe,this)};var Z=n.tryGet=function(ne,X,pe){return W(ne,pe._config.hash(X),X,pe)};_.prototype.tryGet=function(ne,X){return Z(ne,X,this)};var ie=n.getHash=function(ne,X,pe){return W(void 0,ne,X,pe)};_.prototype.getHash=function(ne,X){return ie(ne,X,this)},n.get=function(ne,X){return W(void 0,X._config.hash(ne),ne,X)},_.prototype.get=function(ne,X){return Z(X,ne,this)};var re=n.has=function(ne,X,pe){return W(l,ne,X,pe)!==l};_.prototype.hasHash=function(ne,X){return re(ne,X,this)};var fe=n.has=function(ne,X){return re(X._config.hash(ne),ne,X)};_.prototype.has=function(ne){return fe(ne,this)};var ye=function(X,pe){return X===pe};n.make=function(ne){return new _(0,0,{keyEq:ne&&ne.keyEq||ye,hash:ne&&ne.hash||c},S,0)},n.empty=n.make();var de=n.isEmpty=function(ne){return ne&&!!C(ne._root)};_.prototype.isEmpty=function(){return de(this)};var $e=n.modifyHash=function(ne,X,pe,Ce){var Se={value:Ce._size},Ee=Ce._root._modify(Ce._editable?Ce._edit:NaN,Ce._config.keyEq,0,ne,X,pe,Se);return Ce.setTree(Ee,Se.value)};_.prototype.modifyHash=function(ne,X,pe){return $e(pe,ne,X,this)};var ke=n.modify=function(ne,X,pe){return $e(ne,pe._config.hash(X),X,pe)};_.prototype.modify=function(ne,X){return ke(X,ne,this)};var Ae=n.setHash=function(ne,X,pe,Ce){return $e(u(pe),ne,X,Ce)};_.prototype.setHash=function(ne,X,pe){return Ae(ne,X,pe,this)};var Ue=n.set=function(ne,X,pe){return Ae(pe._config.hash(ne),ne,X,pe)};_.prototype.set=function(ne,X){return Ue(ne,X,this)};var ht=u(l),Xe=n.removeHash=function(ne,X,pe){return $e(ht,ne,X,pe)};_.prototype.removeHash=_.prototype.deleteHash=function(ne,X){return Xe(ne,X,this)};var Ke=n.remove=function(ne,X){return Xe(X._config.hash(ne),ne,X)};_.prototype.remove=_.prototype.delete=function(ne){return Ke(ne,this)};var rt=n.beginMutation=function(ne){return new _(ne._editable+1,ne._edit+1,ne._config,ne._root,ne._size)};_.prototype.beginMutation=function(){return rt(this)};var kt=n.endMutation=function(ne){return ne._editable=ne._editable&&ne._editable-1,ne};_.prototype.endMutation=function(){return kt(this)};var ar=n.mutate=function(ne,X){var pe=rt(X);return ne(pe),kt(pe)};_.prototype.mutate=function(ne){return ar(ne,this)};var Ht=function(X){return X&&ss(X[0],X[1],X[2],X[3],X[4])},ss=function(X,pe,Ce,Se,Ee){for(;Ce<X;){var je=pe[Ce++];if(je&&!C(je))return Rn(je,Se,[X,pe,Ce,Se,Ee])}return Ht(Ee)},Rn=function(X,pe,Ce){switch(X.type){case b:return{value:pe(X),rest:Ce};case v:case w:case x:var Se=X.children;return ss(Se.length,Se,0,pe,Ce);default:return Ht(Ce)}},lr={done:!0};function qt(ne){this.v=ne}qt.prototype.next=function(){if(!this.v)return lr;var ne=this.v;return this.v=Ht(ne.rest),ne},qt.prototype[Symbol.iterator]=function(){return this};var _n=function(X,pe){return new qt(Rn(X._root,pe))},ur=function(X){return[X.key,X.value]},Cs=n.entries=function(ne){return _n(ne,ur)};_.prototype.entries=_.prototype[Symbol.iterator]=function(){return Cs(this)};var Rr=function(X){return X.key},hs=n.keys=function(ne){return _n(ne,Rr)};_.prototype.keys=function(){return hs(this)};var Hi=function(X){return X.value},qi=n.values=_.prototype.values=function(ne){return _n(ne,Hi)};_.prototype.values=function(){return qi(this)};var ll=n.fold=function(ne,X,pe){var Ce=pe._root;if(Ce.type===b)return ne(X,Ce.value,Ce.key);for(var Se=[Ce.children],Ee=void 0;Ee=Se.pop();)for(var je=0,Ge=Ee.length;je<Ge;){var M=Ee[je++];M&&M.type&&(M.type===b?X=ne(X,M.value,M.key):Se.push(M.children))}return X};_.prototype.fold=function(ne,X){return ll(ne,X,this)};var Ki=n.forEach=function(ne,X){return ll(function(pe,Ce,Se){return ne(Ce,Se,X)},null,X)};_.prototype.forEach=function(ne){return Ki(ne,this)};var zu=n.count=function(ne){return ne._size};_.prototype.count=function(){return zu(this)},Object.defineProperty(_.prototype,"size",{get:_.prototype.count}),t.exports?t.exports=n:(void 0).hamt=n});class j5{constructor(e){Je(this,"_map",void 0),this._map=new Map(e==null?void 0:e.entries())}keys(){return this._map.keys()}entries(){return this._map.entries()}get(e){return this._map.get(e)}has(e){return this._map.has(e)}set(e,n){return this._map.set(e,n),this}delete(e){return this._map.delete(e),this}clone(){return gN(this)}toMap(){return new Map(this._map)}}class mN{constructor(e){if(Je(this,"_hamt",W5.empty.beginMutation()),e instanceof mN){const n=e._hamt.endMutation();e._hamt=n.beginMutation(),this._hamt=n.beginMutation()}else if(e)for(const[n,s]of e.entries())this._hamt.set(n,s)}keys(){return this._hamt.keys()}entries(){return this._hamt.entries()}get(e){return this._hamt.get(e)}has(e){return this._hamt.has(e)}set(e,n){return this._hamt.set(e,n),this}delete(e){return this._hamt.delete(e),this}clone(){return gN(this)}toMap(){return new Map(this._hamt)}}function gN(t){return At("recoil_hamt_2020")?new mN(t):new j5(t)}var G5={persistentMap:gN},H5=G5.persistentMap,q5=Object.freeze({__proto__:null,persistentMap:H5});function K5(t,...e){const n=new Set;e:for(const s of t){for(const r of e)if(r.has(s))continue e;n.add(s)}return n}var _f=K5;function X5(t,e){const n=new Map;return t.forEach((s,r)=>{n.set(r,e(s,r))}),n}var N0=X5;function Y5(){return{nodeDeps:new Map,nodeToNodeSubscriptions:new Map}}function Q5(t){return{nodeDeps:N0(t.nodeDeps,e=>new Set(e)),nodeToNodeSubscriptions:N0(t.nodeToNodeSubscriptions,e=>new Set(e))}}function r1(t,e,n,s){const{nodeDeps:r,nodeToNodeSubscriptions:o}=n,i=r.get(t);if(i&&s&&i!==s.nodeDeps.get(t))return;r.set(t,e);const a=i==null?e:_f(e,i);for(const l of a)o.has(l)||o.set(l,new Set),Qt(o.get(l)).add(t);if(i){const l=_f(i,e);for(const u of l){if(!o.has(u))return;const c=Qt(o.get(u));c.delete(t),c.size===0&&o.delete(u)}}}function Z5(t,e,n,s){var r,o,i,a;const l=n.getState();s===l.currentTree.version||s===((r=l.nextTree)===null||r===void 0?void 0:r.version)||((o=l.previousTree)===null||o===void 0||o.version);const u=n.getGraph(s);if(r1(t,e,u),s===((i=l.previousTree)===null||i===void 0?void 0:i.version)){const d=n.getGraph(l.currentTree.version);r1(t,e,d,u)}if(s===((a=l.previousTree)===null||a===void 0?void 0:a.version)||s===l.currentTree.version){var c;const d=(c=l.nextTree)===null||c===void 0?void 0:c.version;if(d!==void 0){const h=n.getGraph(d);r1(t,e,h,u)}}}var qp={cloneGraph:Q5,graph:Y5,saveDepsToStore:Z5};let J5=0;const eH=()=>J5++;let tH=0;const nH=()=>tH++;let sH=0;const rH=()=>sH++;var Fb={getNextTreeStateVersion:eH,getNextStoreID:nH,getNextComponentID:rH};const{persistentMap:m2}=q5,{graph:oH}=qp,{getNextTreeStateVersion:tF}=Fb;function nF(){const t=tF();return{version:t,stateID:t,transactionMetadata:{},dirtyAtoms:new Set,atomValues:m2(),nonvalidatedAtoms:m2()}}function iH(){const t=nF();return{currentTree:t,nextTree:null,previousTree:null,commitDepth:0,knownAtoms:new Set,knownSelectors:new Set,transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:new Map().set(t.version,oH()),retention:{referenceCounts:new Map,nodesRetainedByZone:new Map,retainablesToCheckForRelease:new Set},nodeCleanupFunctions:new Map}}var sF={makeEmptyTreeState:nF,makeEmptyStoreState:iH,getNextTreeStateVersion:tF};class rF{}function aH(){return new rF}var Lb={RetentionZone:rF,retentionZone:aH};function lH(t,e){const n=new Set(t);return n.add(e),n}function uH(t,e){const n=new Set(t);return n.delete(e),n}function cH(t,e,n){const s=new Map(t);return s.set(e,n),s}function dH(t,e,n){const s=new Map(t);return s.set(e,n(s.get(e))),s}function hH(t,e){const n=new Map(t);return n.delete(e),n}function fH(t,e){const n=new Map(t);return e.forEach(s=>n.delete(s)),n}var oF={setByAddingToSet:lH,setByDeletingFromSet:uH,mapBySettingInMap:cH,mapByUpdatingInMap:dH,mapByDeletingFromMap:hH,mapByDeletingMultipleFromMap:fH};function*pH(t,e){let n=0;for(const s of t)e(s,n++)&&(yield s)}var yN=pH;function mH(t,e){return new Proxy(t,{get:(s,r)=>(!(r in s)&&r in e&&(s[r]=e[r]()),s[r]),ownKeys:s=>Object.keys(s)})}var iF=mH;const{getNode:Kp,getNodeMaybe:gH,recoilValuesForKeys:g2}=rr,{RetentionZone:y2}=Lb,{setByAddingToSet:yH}=oF,bH=Object.freeze(new Set);class vH extends Error{}function xH(t,e,n){if(!At("recoil_memory_managament_2020"))return()=>{};const{nodesRetainedByZone:s}=t.getState().retention;function r(o){let i=s.get(o);i||s.set(o,i=new Set),i.add(e)}if(n instanceof y2)r(n);else if(Array.isArray(n))for(const o of n)r(o);return()=>{if(!At("recoil_memory_managament_2020"))return;const{retention:o}=t.getState();function i(a){const l=o.nodesRetainedByZone.get(a);l==null||l.delete(e),l&&l.size===0&&o.nodesRetainedByZone.delete(a)}if(n instanceof y2)i(n);else if(Array.isArray(n))for(const a of n)i(a)}}function bN(t,e,n,s){const r=t.getState();if(r.nodeCleanupFunctions.has(n))return;const o=Kp(n),i=xH(t,n,o.retainedBy),a=o.init(t,e,s);r.nodeCleanupFunctions.set(n,()=>{a(),i()})}function wH(t,e,n){bN(t,t.getState().currentTree,e,n)}function SH(t,e){var n;const s=t.getState();(n=s.nodeCleanupFunctions.get(e))===null||n===void 0||n(),s.nodeCleanupFunctions.delete(e)}function kH(t,e,n){return bN(t,e,n,"get"),Kp(n).get(t,e)}function aF(t,e,n){return Kp(n).peek(t,e)}function CH(t,e,n){var s;const r=gH(e);return r==null||(s=r.invalidate)===null||s===void 0||s.call(r,t),{...t,atomValues:t.atomValues.clone().delete(e),nonvalidatedAtoms:t.nonvalidatedAtoms.clone().set(e,n),dirtyAtoms:yH(t.dirtyAtoms,e)}}function NH(t,e,n,s){const r=Kp(n);if(r.set==null)throw new vH(`Attempt to set read-only RecoilValue: ${n}`);const o=r.set;return bN(t,e,n,"set"),o(t,e,s)}function TH(t,e,n){const s=t.getState(),r=t.getGraph(e.version),o=Kp(n).nodeType;return iF({type:o},{loadable:()=>aF(t,e,n),isActive:()=>s.knownAtoms.has(n)||s.knownSelectors.has(n),isSet:()=>o==="selector"?!1:e.atomValues.has(n),isModified:()=>e.dirtyAtoms.has(n),deps:()=>{var i;return g2((i=r.nodeDeps.get(n))!==null&&i!==void 0?i:[])},subscribers:()=>{var i,a;return{nodes:g2(yN(lF(t,e,new Set([n])),l=>l!==n)),components:Ob((i=(a=s.nodeToComponentSubscriptions.get(n))===null||a===void 0?void 0:a.values())!==null&&i!==void 0?i:[],([l])=>({name:l}))}}})}function lF(t,e,n){const s=new Set,r=Array.from(n),o=t.getGraph(e.version);for(let a=r.pop();a;a=r.pop()){var i;s.add(a);const l=(i=o.nodeToNodeSubscriptions.get(a))!==null&&i!==void 0?i:bH;for(const u of l)s.has(u)||r.push(u)}return s}var Ya={getNodeLoadable:kH,peekNodeLoadable:aF,setNodeValue:NH,initializeNode:wH,cleanUpNode:SH,setUnvalidatedAtomValue_DEPRECATED:CH,peekNodeInfo:TH,getDownstreamNodes:lF};let uF=null;function $H(t){uF=t}function IH(){var t;(t=uF)===null||t===void 0||t()}var cF={setInvalidateMemoizedSnapshot:$H,invalidateMemoizedSnapshot:IH};const{getDownstreamNodes:EH,getNodeLoadable:dF,setNodeValue:RH}=Ya,{getNextComponentID:_H}=Fb,{getNode:AH,getNodeMaybe:hF}=rr,{DefaultValue:vN}=rr,{reactMode:DH}=Hp,{AbstractRecoilValue:OH,RecoilState:FH,RecoilValueReadOnly:LH,isRecoilValue:PH}=Xc,{invalidateMemoizedSnapshot:MH}=cF;function zH(t,{key:e},n=t.getState().currentTree){var s,r;const o=t.getState();n.version===o.currentTree.version||n.version===((s=o.nextTree)===null||s===void 0?void 0:s.version)||(n.version,(r=o.previousTree)===null||r===void 0||r.version);const i=dF(t,n,e);return i.state==="loading"&&i.contents.catch(()=>{}),i}function BH(t,e){const n=t.clone();return e.forEach((s,r)=>{s.state==="hasValue"&&s.contents instanceof vN?n.delete(r):n.set(r,s)}),n}function VH(t,e,{key:n},s){if(typeof s=="function"){const r=dF(t,e,n);if(r.state==="loading"){const o=`Tried to set atom or selector "${n}" using an updater function while the current state is pending, this is not currently supported.`;throw it(o)}else if(r.state==="hasError")throw r.contents;return s(r.contents)}else return s}function UH(t,e,n){if(n.type==="set"){const{recoilValue:r,valueOrUpdater:o}=n,i=VH(t,e,r,o),a=RH(t,e,r.key,i);for(const[l,u]of a.entries())qS(e,l,u)}else if(n.type==="setLoadable"){const{recoilValue:{key:r},loadable:o}=n;qS(e,r,o)}else if(n.type==="markModified"){const{recoilValue:{key:r}}=n;e.dirtyAtoms.add(r)}else if(n.type==="setUnvalidated"){var s;const{recoilValue:{key:r},unvalidatedValue:o}=n,i=hF(r);i==null||(s=i.invalidate)===null||s===void 0||s.call(i,e),e.atomValues.delete(r),e.nonvalidatedAtoms.set(r,o),e.dirtyAtoms.add(r)}else hN(`Unknown action ${n.type}`)}function qS(t,e,n){n.state==="hasValue"&&n.contents instanceof vN?t.atomValues.delete(e):t.atomValues.set(e,n),t.dirtyAtoms.add(e),t.nonvalidatedAtoms.delete(e)}function fF(t,e){t.replaceState(n=>{const s=pF(n);for(const r of e)UH(t,s,r);return mF(t,s),MH(),s})}function Pb(t,e){if(Af.length){const n=Af[Af.length-1];let s=n.get(t);s||n.set(t,s=[]),s.push(e)}else fF(t,[e])}const Af=[];function WH(){const t=new Map;return Af.push(t),()=>{for(const[e,n]of t)fF(e,n);Af.pop()}}function pF(t){return{...t,atomValues:t.atomValues.clone(),nonvalidatedAtoms:t.nonvalidatedAtoms.clone(),dirtyAtoms:new Set(t.dirtyAtoms)}}function mF(t,e){const n=EH(t,e,e.dirtyAtoms);for(const o of n){var s,r;(s=hF(o))===null||s===void 0||(r=s.invalidate)===null||r===void 0||r.call(s,e)}}function gF(t,e,n){Pb(t,{type:"set",recoilValue:e,valueOrUpdater:n})}function jH(t,e,n){if(n instanceof vN)return gF(t,e,n);Pb(t,{type:"setLoadable",recoilValue:e,loadable:n})}function GH(t,e){Pb(t,{type:"markModified",recoilValue:e})}function HH(t,e,n){Pb(t,{type:"setUnvalidated",recoilValue:e,unvalidatedValue:n})}function qH(t,{key:e},n,s=null){const r=_H(),o=t.getState();o.nodeToComponentSubscriptions.has(e)||o.nodeToComponentSubscriptions.set(e,new Map),Qt(o.nodeToComponentSubscriptions.get(e)).set(r,[s??"<not captured>",n]);const i=DH();if(i.early&&(i.mode==="LEGACY"||i.mode==="MUTABLE_SOURCE")){const a=t.getState().nextTree;a&&a.dirtyAtoms.has(e)&&n(a)}return{release:()=>{const a=t.getState(),l=a.nodeToComponentSubscriptions.get(e);l===void 0||!l.has(r)||(l.delete(r),l.size===0&&a.nodeToComponentSubscriptions.delete(e))}}}function KH(t,e){var n;const{currentTree:s}=t.getState(),r=AH(e.key);(n=r.clearCache)===null||n===void 0||n.call(r,t,s)}var ni={RecoilValueReadOnly:LH,AbstractRecoilValue:OH,RecoilState:FH,getRecoilValueAsLoadable:zH,setRecoilValue:gF,setRecoilValueLoadable:jH,markRecoilValueModified:GH,setUnvalidatedRecoilValue:HH,subscribeToRecoilValue:qH,isRecoilValue:PH,applyAtomValueWrites:BH,batchStart:WH,writeLoadableToTreeState:qS,invalidateDownstreams:mF,copyTreeState:pF,refreshRecoilValue:KH};function XH(t,e,n){const s=t.entries();let r=s.next();for(;!r.done;){const o=r.value;if(e.call(n,o[1],o[0],t))return!0;r=s.next()}return!1}var YH=XH;const{cleanUpNode:QH}=Ya,{deleteNodeConfigIfPossible:ZH,getNode:yF}=rr,{RetentionZone:bF}=Lb,JH=12e4,vF=new Set;function xF(t,e){const n=t.getState(),s=n.currentTree;if(n.nextTree)return;const r=new Set;for(const i of e)if(i instanceof bF)for(const a of s8(n,i))r.add(a);else r.add(i);const o=e8(t,r);for(const i of o)n8(t,s,i)}function e8(t,e){const n=t.getState(),s=n.currentTree,r=t.getGraph(s.version),o=new Set,i=new Set;return a(e),o;function a(l){const u=new Set,c=t8(t,s,l,o,i);for(const p of c){var d;if(yF(p).retainedBy==="recoilRoot"){i.add(p);continue}if(((d=n.retention.referenceCounts.get(p))!==null&&d!==void 0?d:0)>0){i.add(p);continue}if(wF(p).some(g=>n.retention.referenceCounts.get(g))){i.add(p);continue}const m=r.nodeToNodeSubscriptions.get(p);if(m&&YH(m,g=>i.has(g))){i.add(p);continue}o.add(p),u.add(p)}const h=new Set;for(const p of u)for(const m of(f=r.nodeDeps.get(p))!==null&&f!==void 0?f:vF){var f;o.has(m)||h.add(m)}h.size&&a(h)}}function t8(t,e,n,s,r){const o=t.getGraph(e.version),i=[],a=new Set;for(;n.size>0;)l(Qt(n.values().next().value));return i;function l(u){if(s.has(u)||r.has(u)){n.delete(u);return}if(a.has(u))return;const c=o.nodeToNodeSubscriptions.get(u);if(c)for(const d of c)l(d);a.add(u),n.delete(u),i.push(u)}}function n8(t,e,n){if(!At("recoil_memory_managament_2020"))return;QH(t,n);const s=t.getState();s.knownAtoms.delete(n),s.knownSelectors.delete(n),s.nodeTransactionSubscriptions.delete(n),s.retention.referenceCounts.delete(n);const r=wF(n);for(const l of r){var o;(o=s.retention.nodesRetainedByZone.get(l))===null||o===void 0||o.delete(n)}e.atomValues.delete(n),e.dirtyAtoms.delete(n),e.nonvalidatedAtoms.delete(n);const i=s.graphsByVersion.get(e.version);if(i){const l=i.nodeDeps.get(n);if(l!==void 0){i.nodeDeps.delete(n);for(const u of l){var a;(a=i.nodeToNodeSubscriptions.get(u))===null||a===void 0||a.delete(n)}}i.nodeToNodeSubscriptions.delete(n)}ZH(n)}function s8(t,e){var n;return(n=t.retention.nodesRetainedByZone.get(e))!==null&&n!==void 0?n:vF}function wF(t){const e=yF(t).retainedBy;return e===void 0||e==="components"||e==="recoilRoot"?[]:e instanceof bF?[e]:e}function r8(t,e){const n=t.getState();n.nextTree?n.retention.retainablesToCheckForRelease.add(e):xF(t,new Set([e]))}function o8(t,e,n){var s;if(!At("recoil_memory_managament_2020"))return;const r=t.getState().retention.referenceCounts,o=((s=r.get(e))!==null&&s!==void 0?s:0)+n;o===0?SF(t,e):r.set(e,o)}function SF(t,e){if(!At("recoil_memory_managament_2020"))return;t.getState().retention.referenceCounts.delete(e),r8(t,e)}function i8(t){if(!At("recoil_memory_managament_2020"))return;const e=t.getState();xF(t,e.retention.retainablesToCheckForRelease),e.retention.retainablesToCheckForRelease.clear()}function a8(t){return t===void 0?"recoilRoot":t}var Su={SUSPENSE_TIMEOUT_MS:JH,updateRetainCount:o8,updateRetainCountToZero:SF,releaseScheduledRetainablesNow:i8,retainedByOptionWithDefault:a8};const{unstable_batchedUpdates:l8}=uN;var u8={unstable_batchedUpdates:l8};const{unstable_batchedUpdates:c8}=u8;var d8={unstable_batchedUpdates:c8};const{batchStart:h8}=ni,{unstable_batchedUpdates:f8}=d8;let xN=f8||(t=>t());const p8=t=>{xN=t},m8=()=>xN,g8=t=>{xN(()=>{let e=()=>{};try{e=h8(),t()}finally{e()}})};var Mb={getBatcher:m8,setBatcher:p8,batchUpdates:g8};function*y8(t){for(const e of t)for(const n of e)yield n}var kF=y8;const CF=typeof Window>"u"||typeof window>"u",b8=t=>!CF&&(t===window||t instanceof Window),v8=typeof navigator<"u"&&navigator.product==="ReactNative";var zb={isSSR:CF,isReactNative:v8,isWindow:b8};function x8(t,e){let n;return(...s)=>{n||(n={});const r=e(...s);return Object.hasOwnProperty.call(n,r)||(n[r]=t(...s)),n[r]}}function w8(t,e){let n,s;return(...r)=>{const o=e(...r);return n===o||(n=o,s=t(...r)),s}}function S8(t,e){let n,s;return[(...i)=>{const a=e(...i);return n===a||(n=a,s=t(...i)),s},()=>{n=null}]}var k8={memoizeWithArgsHash:x8,memoizeOneWithArgsHash:w8,memoizeOneWithArgsHashAndInvalidation:S8};const{batchUpdates:KS}=Mb,{initializeNode:C8,peekNodeInfo:N8}=Ya,{graph:T8}=qp,{getNextStoreID:$8}=Fb,{DEFAULT_VALUE:I8,recoilValues:b2,recoilValuesForKeys:v2}=rr,{AbstractRecoilValue:E8,getRecoilValueAsLoadable:R8,setRecoilValue:x2,setUnvalidatedRecoilValue:_8}=ni,{updateRetainCount:By}=Su,{setInvalidateMemoizedSnapshot:A8}=cF,{getNextTreeStateVersion:D8,makeEmptyStoreState:O8}=sF,{isSSR:F8}=zb,{memoizeOneWithArgsHashAndInvalidation:L8}=k8;class Bb{constructor(e,n){Je(this,"_store",void 0),Je(this,"_refCount",1),Je(this,"getLoadable",s=>(this.checkRefCount_INTERNAL(),R8(this._store,s))),Je(this,"getPromise",s=>(this.checkRefCount_INTERNAL(),this.getLoadable(s).toPromise())),Je(this,"getNodes_UNSTABLE",s=>{if(this.checkRefCount_INTERNAL(),(s==null?void 0:s.isModified)===!0){if((s==null?void 0:s.isInitialized)===!1)return[];const i=this._store.getState().currentTree;return v2(i.dirtyAtoms)}const r=this._store.getState().knownAtoms,o=this._store.getState().knownSelectors;return(s==null?void 0:s.isInitialized)==null?b2.values():s.isInitialized===!0?v2(kF([r,o])):yN(b2.values(),({key:i})=>!r.has(i)&&!o.has(i))}),Je(this,"getInfo_UNSTABLE",({key:s})=>(this.checkRefCount_INTERNAL(),N8(this._store,this._store.getState().currentTree,s))),Je(this,"map",s=>{this.checkRefCount_INTERNAL();const r=new XS(this,KS);return s(r),r}),Je(this,"asyncMap",async s=>{this.checkRefCount_INTERNAL();const r=new XS(this,KS);return r.retain(),await s(r),r.autoRelease_INTERNAL(),r}),this._store={storeID:$8(),parentStoreID:n,getState:()=>e,replaceState:s=>{e.currentTree=s(e.currentTree)},getGraph:s=>{const r=e.graphsByVersion;if(r.has(s))return Qt(r.get(s));const o=T8();return r.set(s,o),o},subscribeToTransactions:()=>({release:()=>{}}),addTransactionMetadata:()=>{throw it("Cannot subscribe to Snapshots")}};for(const s of this._store.getState().knownAtoms)C8(this._store,s,"get"),By(this._store,s,1);this.autoRelease_INTERNAL()}retain(){this._refCount<=0,this._refCount++;let e=!1;return()=>{e||(e=!0,this._release())}}autoRelease_INTERNAL(){F8||window.setTimeout(()=>this._release(),10)}_release(){if(this._refCount--,this._refCount===0){if(this._store.getState().nodeCleanupFunctions.forEach(e=>e()),this._store.getState().nodeCleanupFunctions.clear(),!At("recoil_memory_managament_2020"))return}else this._refCount<0}isRetained(){return this._refCount>0}checkRefCount_INTERNAL(){At("recoil_memory_managament_2020")&&this._refCount<=0}getStore_INTERNAL(){return this.checkRefCount_INTERNAL(),this._store}getID(){return this.checkRefCount_INTERNAL(),this._store.getState().currentTree.stateID}getStoreID(){return this.checkRefCount_INTERNAL(),this._store.storeID}}function NF(t,e,n=!1){const s=t.getState(),r=n?D8():e.version;return{currentTree:{version:n?r:e.version,stateID:n?r:e.stateID,transactionMetadata:{...e.transactionMetadata},dirtyAtoms:new Set(e.dirtyAtoms),atomValues:e.atomValues.clone(),nonvalidatedAtoms:e.nonvalidatedAtoms.clone()},commitDepth:0,nextTree:null,previousTree:null,knownAtoms:new Set(s.knownAtoms),knownSelectors:new Set(s.knownSelectors),transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:new Map().set(r,t.getGraph(e.version)),retention:{referenceCounts:new Map,nodesRetainedByZone:new Map,retainablesToCheckForRelease:new Set},nodeCleanupFunctions:new Map(Ob(s.nodeCleanupFunctions.entries(),([o])=>[o,()=>{}]))}}function P8(t){const e=new Bb(O8());return t!=null?e.map(t):e}const[w2,TF]=L8((t,e)=>{var n;const s=t.getState(),r=e==="latest"?(n=s.nextTree)!==null&&n!==void 0?n:s.currentTree:Qt(s.previousTree);return new Bb(NF(t,r),t.storeID)},(t,e)=>{var n,s;return String(e)+String(t.storeID)+String((n=t.getState().nextTree)===null||n===void 0?void 0:n.version)+String(t.getState().currentTree.version)+String((s=t.getState().previousTree)===null||s===void 0?void 0:s.version)});A8(TF);function M8(t,e="latest"){const n=w2(t,e);return n.isRetained()?n:(TF(),w2(t,e))}class XS extends Bb{constructor(e,n){super(NF(e.getStore_INTERNAL(),e.getStore_INTERNAL().getState().currentTree,!0),e.getStoreID()),Je(this,"_batch",void 0),Je(this,"set",(s,r)=>{this.checkRefCount_INTERNAL();const o=this.getStore_INTERNAL();this._batch(()=>{By(o,s.key,1),x2(this.getStore_INTERNAL(),s,r)})}),Je(this,"reset",s=>{this.checkRefCount_INTERNAL();const r=this.getStore_INTERNAL();this._batch(()=>{By(r,s.key,1),x2(this.getStore_INTERNAL(),s,I8)})}),Je(this,"setUnvalidatedAtomValues_DEPRECATED",s=>{this.checkRefCount_INTERNAL();const r=this.getStore_INTERNAL();KS(()=>{for(const[o,i]of s.entries())By(r,o,1),_8(r,new E8(o),i)})}),this._batch=n}}var Vb={Snapshot:Bb,MutableSnapshot:XS,freshSnapshot:P8,cloneSnapshot:M8},z8=Vb.Snapshot,B8=Vb.MutableSnapshot,V8=Vb.freshSnapshot,U8=Vb.cloneSnapshot,Ub=Object.freeze({__proto__:null,Snapshot:z8,MutableSnapshot:B8,freshSnapshot:V8,cloneSnapshot:U8});function W8(...t){const e=new Set;for(const n of t)for(const s of n)e.add(s);return e}var j8=W8;const{useRef:G8}=lt;function H8(t){const e=G8(t);return e.current===t&&typeof t=="function"&&(e.current=t()),e}var S2=H8;const{getNextTreeStateVersion:q8,makeEmptyStoreState:$F}=sF,{cleanUpNode:K8,getDownstreamNodes:X8,initializeNode:Y8,setNodeValue:Q8,setUnvalidatedAtomValue_DEPRECATED:Z8}=Ya,{graph:J8}=qp,{cloneGraph:e7}=qp,{getNextStoreID:IF}=Fb,{createMutableSource:o1,reactMode:EF}=Hp,{applyAtomValueWrites:t7}=ni,{releaseScheduledRetainablesNow:RF}=Su,{freshSnapshot:n7}=Ub,{useCallback:s7,useContext:_F,useEffect:YS,useMemo:r7,useRef:o7,useState:i7}=lt;function Yh(){throw it("This component must be used inside a <RecoilRoot> component.")}const AF=Object.freeze({storeID:IF(),getState:Yh,replaceState:Yh,getGraph:Yh,subscribeToTransactions:Yh,addTransactionMetadata:Yh});let QS=!1;function k2(t){if(QS)throw it("An atom update was triggered within the execution of a state updater function. State updater functions provided to Recoil must be pure functions.");const e=t.getState();if(e.nextTree===null){At("recoil_memory_managament_2020")&&At("recoil_release_on_cascading_update_killswitch_2021")&&e.commitDepth>0&&RF(t);const n=e.currentTree.version,s=q8();e.nextTree={...e.currentTree,version:s,stateID:s,dirtyAtoms:new Set,transactionMetadata:{}},e.graphsByVersion.set(s,e7(Qt(e.graphsByVersion.get(n))))}}const DF=lt.createContext({current:AF}),Wb=()=>_F(DF),OF=lt.createContext(null);function a7(){return _F(OF)}function wN(t,e,n){const s=X8(t,n,n.dirtyAtoms);for(const r of s){const o=e.nodeToComponentSubscriptions.get(r);if(o)for(const[i,[a,l]]of o)l(n)}}function FF(t){const e=t.getState(),n=e.currentTree,s=n.dirtyAtoms;if(s.size){for(const[r,o]of e.nodeTransactionSubscriptions)if(s.has(r))for(const[i,a]of o)a(t);for(const[r,o]of e.transactionSubscriptions)o(t);(!EF().early||e.suspendedComponentResolvers.size>0)&&(wN(t,e,n),e.suspendedComponentResolvers.forEach(r=>r()),e.suspendedComponentResolvers.clear())}e.queuedComponentCallbacks_DEPRECATED.forEach(r=>r(n)),e.queuedComponentCallbacks_DEPRECATED.splice(0,e.queuedComponentCallbacks_DEPRECATED.length)}function l7(t){const e=t.getState();e.commitDepth++;try{const{nextTree:n}=e;if(n==null)return;e.previousTree=e.currentTree,e.currentTree=n,e.nextTree=null,FF(t),e.previousTree!=null?e.graphsByVersion.delete(e.previousTree.version):hN("Ended batch with no previous state, which is unexpected","recoil"),e.previousTree=null,At("recoil_memory_managament_2020")&&n==null&&RF(t)}finally{e.commitDepth--}}function u7({setNotifyBatcherOfChange:t}){const e=Wb(),[,n]=i7([]);return t(()=>n({})),YS(()=>(t(()=>n({})),()=>{t(()=>{})}),[t]),YS(()=>{V5.enqueueExecution("Batcher",()=>{l7(e.current)})}),null}function c7(t,e){const n=$F();return e({set:(s,r)=>{const o=n.currentTree,i=Q8(t,o,s.key,r),a=new Set(i.keys()),l=o.nonvalidatedAtoms.clone();for(const u of a)l.delete(u);n.currentTree={...o,dirtyAtoms:j8(o.dirtyAtoms,a),atomValues:t7(o.atomValues,i),nonvalidatedAtoms:l}},setUnvalidatedAtomValues:s=>{s.forEach((r,o)=>{n.currentTree=Z8(n.currentTree,o,r)})}}),n}function d7(t){const e=n7(t),n=e.getStore_INTERNAL().getState();return e.retain(),n.nodeCleanupFunctions.forEach(s=>s()),n.nodeCleanupFunctions.clear(),n}let C2=0;function h7({initializeState_DEPRECATED:t,initializeState:e,store_INTERNAL:n,children:s}){let r;const o=f=>{const p=r.current.graphsByVersion;if(p.has(f))return Qt(p.get(f));const m=J8();return p.set(f,m),m},i=(f,p)=>{if(p==null){const{transactionSubscriptions:m}=d.current.getState(),g=C2++;return m.set(g,f),{release:()=>{m.delete(g)}}}else{const{nodeTransactionSubscriptions:m}=d.current.getState();m.has(p)||m.set(p,new Map);const g=C2++;return Qt(m.get(p)).set(g,f),{release:()=>{const y=m.get(p);y&&(y.delete(g),y.size===0&&m.delete(p))}}}},a=f=>{k2(d.current);for(const p of Object.keys(f))Qt(d.current.getState().nextTree).transactionMetadata[p]=f[p]},l=f=>{k2(d.current);const p=Qt(r.current.nextTree);let m;try{QS=!0,m=f(p)}finally{QS=!1}m!==p&&(r.current.nextTree=m,EF().early&&wN(d.current,r.current,m),Qt(u.current)())},u=o7(null),c=s7(f=>{u.current=f},[u]),d=S2(()=>n??{storeID:IF(),getState:()=>r.current,replaceState:l,getGraph:o,subscribeToTransactions:i,addTransactionMetadata:a});n!=null&&(d.current=n),r=S2(()=>t!=null?c7(d.current,t):e!=null?d7(e):$F());const h=r7(()=>o1==null?void 0:o1(r,()=>r.current.currentTree.version),[r]);return YS(()=>{const f=d.current;for(const p of new Set(f.getState().knownAtoms))Y8(f,p,"get");return()=>{for(const p of f.getState().knownAtoms)K8(f,p)}},[d]),lt.createElement(DF.Provider,{value:d},lt.createElement(OF.Provider,{value:h},lt.createElement(u7,{setNotifyBatcherOfChange:c}),s))}function f7(t){const{override:e,...n}=t,s=Wb();return e===!1&&s.current!==AF?t.children:lt.createElement(h7,n)}function p7(){return Wb().current.storeID}var Fi={RecoilRoot:f7,useStoreRef:Wb,useRecoilMutableSource:a7,useRecoilStoreID:p7,notifyComponents_FOR_TESTING:wN,sendEndOfBatchNotifications_FOR_TESTING:FF};function m7(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let n=0,s=t.length;n<s;n++)if(t[n]!==e[n])return!1;return!0}var g7=m7;const{useEffect:y7,useRef:b7}=lt;function v7(t){const e=b7();return y7(()=>{e.current=t}),e.current}var LF=v7;const{useStoreRef:x7}=Fi,{SUSPENSE_TIMEOUT_MS:w7}=Su,{updateRetainCount:Qh}=Su,{RetentionZone:S7}=Lb,{useEffect:k7,useRef:C7}=lt,{isSSR:N2}=zb;function N7(t){if(At("recoil_memory_managament_2020"))return T7(t)}function T7(t){const n=(Array.isArray(t)?t:[t]).map(i=>i instanceof S7?i:i.key),s=x7();k7(()=>{if(!At("recoil_memory_managament_2020"))return;const i=s.current;if(r.current&&!N2)window.clearTimeout(r.current),r.current=null;else for(const a of n)Qh(i,a,1);return()=>{for(const a of n)Qh(i,a,-1)}},[s,...n]);const r=C7(),o=LF(n);if(!N2&&(o===void 0||!g7(o,n))){const i=s.current;for(const a of n)Qh(i,a,1);if(o)for(const a of o)Qh(i,a,-1);r.current&&window.clearTimeout(r.current),r.current=window.setTimeout(()=>{r.current=null;for(const a of n)Qh(i,a,-1)},w7)}}var SN=N7;function $7(){return"<component name not available>"}var Xp=$7;const{batchUpdates:I7}=Mb,{DEFAULT_VALUE:PF}=rr,{currentRendererSupportsUseSyncExternalStore:E7,reactMode:wd,useMutableSource:R7,useSyncExternalStore:_7}=Hp,{useRecoilMutableSource:A7,useStoreRef:si}=Fi,{AbstractRecoilValue:ZS,getRecoilValueAsLoadable:Yp,setRecoilValue:T0,setUnvalidatedRecoilValue:D7,subscribeToRecoilValue:Yc}=ni,{useCallback:Js,useEffect:Qc,useMemo:MF,useRef:Df,useState:kN}=lt,{setByAddingToSet:O7}=oF,{isSSR:F7}=zb;function CN(t,e,n){if(t.state==="hasValue")return t.contents;throw t.state==="loading"?new Promise(r=>{const o=n.current.getState().suspendedComponentResolvers;o.add(r),F7&&Ut(t.contents)&&t.contents.finally(()=>{o.delete(r)})}):t.state==="hasError"?t.contents:it(`Invalid value of loadable atom "${e.key}"`)}function L7(){const t=Xp(),e=si(),[,n]=kN([]),s=Df(new Set);s.current=new Set;const r=Df(new Set),o=Df(new Map),i=Js(l=>{const u=o.current.get(l);u&&(u.release(),o.current.delete(l))},[o]),a=Js((l,u)=>{o.current.has(u)&&n([])},[]);return Qc(()=>{const l=e.current;_f(s.current,r.current).forEach(u=>{if(o.current.has(u))return;const c=Yc(l,new ZS(u),h=>a(h,u),t);o.current.set(u,c),l.getState().nextTree?l.getState().queuedComponentCallbacks_DEPRECATED.push(()=>{a(l.getState(),u)}):a(l.getState(),u)}),_f(r.current,s.current).forEach(u=>{i(u)}),r.current=s.current}),Qc(()=>{const l=o.current;return _f(s.current,new Set(l.keys())).forEach(u=>{const c=Yc(e.current,new ZS(u),d=>a(d,u),t);l.set(u,c)}),()=>l.forEach((u,c)=>i(c))},[t,e,i,a]),MF(()=>{function l(p){return m=>{T0(e.current,p,m)}}function u(p){return()=>T0(e.current,p,PF)}function c(p){var m;s.current.has(p.key)||(s.current=O7(s.current,p.key));const g=e.current.getState();return Yp(e.current,p,wd().early&&(m=g.nextTree)!==null&&m!==void 0?m:g.currentTree)}function d(p){const m=c(p);return CN(m,p,e)}function h(p){return[d(p),l(p)]}function f(p){return[c(p),l(p)]}return{getRecoilValue:d,getRecoilValueLoadable:c,getRecoilState:h,getRecoilStateLoadable:f,getSetRecoilState:l,getResetRecoilState:u}},[s,e])}const P7={current:0};function M7(t){const e=si(),n=Xp(),s=Js(()=>{var a;const l=e.current,u=l.getState(),c=wd().early&&(a=u.nextTree)!==null&&a!==void 0?a:u.currentTree;return{loadable:Yp(l,t,c),key:t.key}},[e,t]),r=Js(a=>{let l;return()=>{var u,c;const d=a();return(u=l)!==null&&u!==void 0&&u.loadable.is(d.loadable)&&((c=l)===null||c===void 0?void 0:c.key)===d.key?l:(l=d,d)}},[]),o=MF(()=>r(s),[s,r]),i=Js(a=>{const l=e.current;return Yc(l,t,a,n).release},[e,t,n]);return _7(i,o,o).loadable}function z7(t){const e=si(),n=Js(()=>{var u;const c=e.current,d=c.getState(),h=wd().early&&(u=d.nextTree)!==null&&u!==void 0?u:d.currentTree;return Yp(c,t,h)},[e,t]),s=Js(()=>n(),[n]),r=Xp(),o=Js((u,c)=>{const d=e.current;return Yc(d,t,()=>{if(!At("recoil_suppress_rerender_in_callback"))return c();const f=n();l.current.is(f)||c(),l.current=f},r).release},[e,t,r,n]),i=A7();if(i==null)throw it("Recoil hooks must be used in components contained within a <RecoilRoot> component.");const a=R7(i,s,o),l=Df(a);return Qc(()=>{l.current=a}),a}function JS(t){const e=si(),n=Xp(),s=Js(()=>{var l;const u=e.current,c=u.getState(),d=wd().early&&(l=c.nextTree)!==null&&l!==void 0?l:c.currentTree;return Yp(u,t,d)},[e,t]),r=Js(()=>({loadable:s(),key:t.key}),[s,t.key]),o=Js(l=>{const u=r();return l.loadable.is(u.loadable)&&l.key===u.key?l:u},[r]);Qc(()=>{const l=Yc(e.current,t,u=>{a(o)},n);return a(o),l.release},[n,t,e,o]);const[i,a]=kN(r);return i.key!==t.key?r().loadable:i.loadable}function B7(t){const e=si(),[,n]=kN([]),s=Xp(),r=Js(()=>{var a;const l=e.current,u=l.getState(),c=wd().early&&(a=u.nextTree)!==null&&a!==void 0?a:u.currentTree;return Yp(l,t,c)},[e,t]),o=r(),i=Df(o);return Qc(()=>{i.current=o}),Qc(()=>{const a=e.current,l=a.getState(),u=Yc(a,t,d=>{var h;if(!At("recoil_suppress_rerender_in_callback"))return n([]);const f=r();(h=i.current)!==null&&h!==void 0&&h.is(f)||n(f),i.current=f},s);if(l.nextTree)a.getState().queuedComponentCallbacks_DEPRECATED.push(()=>{i.current=null,n([])});else{var c;if(!At("recoil_suppress_rerender_in_callback"))return n([]);const d=r();(c=i.current)!==null&&c!==void 0&&c.is(d)||n(d),i.current=d}return u.release},[s,r,t,e]),o}function NN(t){return At("recoil_memory_managament_2020")&&SN(t),{TRANSITION_SUPPORT:JS,SYNC_EXTERNAL_STORE:E7()?M7:JS,MUTABLE_SOURCE:z7,LEGACY:B7}[wd().mode](t)}function zF(t){const e=si(),n=NN(t);return CN(n,t,e)}function jb(t){const e=si();return Js(n=>{T0(e.current,t,n)},[e,t])}function V7(t){const e=si();return Js(()=>{T0(e.current,t,PF)},[e,t])}function U7(t){return[zF(t),jb(t)]}function W7(t){return[NN(t),jb(t)]}function j7(){const t=si();return(e,n={})=>{I7(()=>{t.current.addTransactionMetadata(n),e.forEach((s,r)=>D7(t.current,new ZS(r),s))})}}function BF(t){return At("recoil_memory_managament_2020")&&SN(t),JS(t)}function VF(t){const e=si(),n=BF(t);return CN(n,t,e)}function G7(t){return[VF(t),jb(t)]}var H7={recoilComponentGetRecoilValueCount_FOR_TESTING:P7,useRecoilInterface:L7,useRecoilState:U7,useRecoilStateLoadable:W7,useRecoilValue:zF,useRecoilValueLoadable:NN,useResetRecoilState:V7,useSetRecoilState:jb,useSetUnvalidatedAtomValues:j7,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:BF,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:VF,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:G7};function q7(t,e){const n=new Map;for(const[s,r]of t)e(r,s)&&n.set(s,r);return n}var K7=q7;function X7(t,e){const n=new Set;for(const s of t)e(s)&&n.add(s);return n}var Y7=X7;function Q7(...t){const e=new Map;for(let n=0;n<t.length;n++){const s=t[n].keys();let r;for(;!(r=s.next()).done;)e.set(r.value,t[n].get(r.value))}return e}var Z7=Q7;const{batchUpdates:J7}=Mb,{DEFAULT_VALUE:eq,getNode:UF,nodes:tq}=rr,{useStoreRef:TN}=Fi,{AbstractRecoilValue:nq,setRecoilValueLoadable:sq}=ni,{SUSPENSE_TIMEOUT_MS:rq}=Su,{cloneSnapshot:$0}=Ub,{useCallback:Gb,useEffect:WF,useRef:T2,useState:oq}=lt,{isSSR:$2}=zb;function Hb(t){const e=TN();WF(()=>e.current.subscribeToTransactions(t).release,[t,e])}function I2(t){const e=t.atomValues.toMap(),n=N0(K7(e,(s,r)=>{const i=UF(r).persistence_UNSTABLE;return i!=null&&i.type!=="none"&&s.state==="hasValue"}),s=>s.contents);return Z7(t.nonvalidatedAtoms.toMap(),n)}function iq(t){Hb(Gb(e=>{let n=e.getState().previousTree;const s=e.getState().currentTree;n||(n=e.getState().currentTree);const r=I2(s),o=I2(n),i=N0(tq,l=>{var u,c,d,h;return{persistence_UNSTABLE:{type:(u=(c=l.persistence_UNSTABLE)===null||c===void 0?void 0:c.type)!==null&&u!==void 0?u:"none",backButton:(d=(h=l.persistence_UNSTABLE)===null||h===void 0?void 0:h.backButton)!==null&&d!==void 0?d:!1}}}),a=Y7(s.dirtyAtoms,l=>r.has(l)||o.has(l));t({atomValues:r,previousAtomValues:o,atomInfo:i,modifiedAtoms:a,transactionMetadata:{...s.transactionMetadata}})},[t]))}function aq(t){Hb(Gb(e=>{const n=$0(e,"latest"),s=$0(e,"previous");t({snapshot:n,previousSnapshot:s})},[t]))}function lq(){const t=TN(),[e,n]=oq(()=>$0(t.current)),s=LF(e),r=T2(),o=T2();if(Hb(Gb(a=>n($0(a)),[])),WF(()=>{const a=e.retain();if(r.current&&!$2){var l;window.clearTimeout(r.current),r.current=null,(l=o.current)===null||l===void 0||l.call(o),o.current=null}return()=>{window.setTimeout(a,10)}},[e]),s!==e&&!$2){if(r.current){var i;window.clearTimeout(r.current),r.current=null,(i=o.current)===null||i===void 0||i.call(o),o.current=null}o.current=e.retain(),r.current=window.setTimeout(()=>{var a;r.current=null,(a=o.current)===null||a===void 0||a.call(o),o.current=null},rq)}return e}function jF(t,e){var n;const s=t.getState(),r=(n=s.nextTree)!==null&&n!==void 0?n:s.currentTree,o=e.getStore_INTERNAL().getState().currentTree;J7(()=>{const i=new Set;for(const u of[r.atomValues.keys(),o.atomValues.keys()])for(const c of u){var a,l;((a=r.atomValues.get(c))===null||a===void 0?void 0:a.contents)!==((l=o.atomValues.get(c))===null||l===void 0?void 0:l.contents)&&UF(c).shouldRestoreFromSnapshots&&i.add(c)}i.forEach(u=>{sq(t,new nq(u),o.atomValues.has(u)?Qt(o.atomValues.get(u)):eq)}),t.replaceState(u=>({...u,stateID:e.getID()}))})}function uq(){const t=TN();return Gb(e=>jF(t.current,e),[t])}var GF={useRecoilSnapshot:lq,gotoSnapshot:jF,useGotoRecoilSnapshot:uq,useRecoilTransactionObserver:aq,useTransactionObservation_DEPRECATED:iq,useTransactionSubscription_DEPRECATED:Hb};const{peekNodeInfo:cq}=Ya,{useStoreRef:dq}=Fi;function hq(){const t=dq();return({key:e})=>cq(t.current,t.current.getState().currentTree,e)}var fq=hq;const{reactMode:pq}=Hp,{RecoilRoot:mq,useStoreRef:gq}=Fi,{useMemo:yq}=lt;function bq(){pq().mode==="MUTABLE_SOURCE"&&console.warn("Warning: There are known issues using useRecoilBridgeAcrossReactRoots() in recoil_mutable_source rendering mode.  Please consider upgrading to recoil_sync_external_store mode.");const t=gq().current;return yq(()=>{function e({children:n}){return lt.createElement(mq,{store_INTERNAL:t},n)}return e},[t])}var vq=bq;const{loadableWithValue:xq}=Gp,{initializeNode:wq}=Ya,{DEFAULT_VALUE:Sq,getNode:kq}=rr,{copyTreeState:Cq,getRecoilValueAsLoadable:Nq,invalidateDownstreams:Tq,writeLoadableToTreeState:$q}=ni;function E2(t){return kq(t.key).nodeType==="atom"}class Iq{constructor(e,n){Je(this,"_store",void 0),Je(this,"_treeState",void 0),Je(this,"_changes",void 0),Je(this,"get",s=>{if(this._changes.has(s.key))return this._changes.get(s.key);if(!E2(s))throw it("Reading selectors within atomicUpdate is not supported");const r=Nq(this._store,s,this._treeState);if(r.state==="hasValue")return r.contents;throw r.state==="hasError"?r.contents:it(`Expected Recoil atom ${s.key} to have a value, but it is in a loading state.`)}),Je(this,"set",(s,r)=>{if(!E2(s))throw it("Setting selectors within atomicUpdate is not supported");if(typeof r=="function"){const o=this.get(s);this._changes.set(s.key,r(o))}else wq(this._store,s.key,"set"),this._changes.set(s.key,r)}),Je(this,"reset",s=>{this.set(s,Sq)}),this._store=e,this._treeState=n,this._changes=new Map}newTreeState_INTERNAL(){if(this._changes.size===0)return this._treeState;const e=Cq(this._treeState);for(const[n,s]of this._changes)$q(e,n,xq(s));return Tq(this._store,e),e}}function Eq(t){return e=>{t.replaceState(n=>{const s=new Iq(t,n);return e(s),s.newTreeState_INTERNAL()})}}var Rq={atomicUpdater:Eq},_q=Rq.atomicUpdater,HF=Object.freeze({__proto__:null,atomicUpdater:_q});function Aq(t,e){if(!t)throw new Error(e)}var Dq=Aq,pf=Dq;const{atomicUpdater:Oq}=HF,{batchUpdates:Fq}=Mb,{DEFAULT_VALUE:Lq}=rr,{useStoreRef:Pq}=Fi,{refreshRecoilValue:Mq,setRecoilValue:R2}=ni,{cloneSnapshot:zq}=Ub,{gotoSnapshot:Bq}=GF,{useCallback:Vq}=lt;class qF{}const Uq=new qF;function KF(t,e,n,s){let r=Uq,o;if(Fq(()=>{const a="useRecoilCallback() expects a function that returns a function: it accepts a function of the type (RecoilInterface) => (Args) => ReturnType and returns a callback function (Args) => ReturnType, where RecoilInterface is an object {snapshot, set, ...} and Args and ReturnType are the argument and return types of the callback you want to create.  Please see the docs at recoiljs.org for details.";if(typeof e!="function")throw it(a);const l=iF({...s??{},set:(c,d)=>R2(t,c,d),reset:c=>R2(t,c,Lq),refresh:c=>Mq(t,c),gotoSnapshot:c=>Bq(t,c),transact_UNSTABLE:c=>Oq(t)(c)},{snapshot:()=>{const c=zq(t);return o=c.retain(),c}}),u=e(l);if(typeof u!="function")throw it(a);r=u(...n)}),r instanceof qF&&pf(!1),Ut(r))r=r.finally(()=>{var a;(a=o)===null||a===void 0||a()});else{var i;(i=o)===null||i===void 0||i()}return r}function Wq(t,e){const n=Pq();return Vq((...s)=>KF(n.current,t,s),e!=null?[...e,n]:void 0)}var XF={recoilCallback:KF,useRecoilCallback:Wq};const{useStoreRef:jq}=Fi,{refreshRecoilValue:Gq}=ni,{useCallback:Hq}=lt;function qq(t){const e=jq();return Hq(()=>{const n=e.current;Gq(n,t)},[t,e])}var Kq=qq;const{atomicUpdater:Xq}=HF,{useStoreRef:Yq}=Fi,{useMemo:Qq}=lt;function Zq(t,e){const n=Yq();return Qq(()=>(...s)=>{Xq(n.current)(o=>{t(o)(...s)})},e!=null?[...e,n]:void 0)}var Jq=Zq;class eK{constructor(e){Je(this,"value",void 0),this.value=e}}var tK={WrappedValue:eK},nK=tK.WrappedValue,YF=Object.freeze({__proto__:null,WrappedValue:nK});const{isFastRefreshEnabled:sK}=Hp;class _2 extends Error{}class rK{constructor(e){var n,s,r;Je(this,"_name",void 0),Je(this,"_numLeafs",void 0),Je(this,"_root",void 0),Je(this,"_onHit",void 0),Je(this,"_onSet",void 0),Je(this,"_mapNodeValue",void 0),this._name=e==null?void 0:e.name,this._numLeafs=0,this._root=null,this._onHit=(n=e==null?void 0:e.onHit)!==null&&n!==void 0?n:()=>{},this._onSet=(s=e==null?void 0:e.onSet)!==null&&s!==void 0?s:()=>{},this._mapNodeValue=(r=e==null?void 0:e.mapNodeValue)!==null&&r!==void 0?r:o=>o}size(){return this._numLeafs}root(){return this._root}get(e,n){var s;return(s=this.getLeafNode(e,n))===null||s===void 0?void 0:s.value}getLeafNode(e,n){if(this._root==null)return;let s=this._root;for(;s;){if(n==null||n.onNodeVisit(s),s.type==="leaf")return this._onHit(s),s;const r=this._mapNodeValue(e(s.nodeKey));s=s.branches.get(r)}}set(e,n,s){const r=()=>{var o,i,a,l;let u,c;for(const[g,y]of e){var d,h,f;const b=this._root;if((b==null?void 0:b.type)==="leaf")throw this.invalidCacheError();const v=u;if(u=v?v.branches.get(c):b,u=(d=u)!==null&&d!==void 0?d:{type:"branch",nodeKey:g,parent:v,branches:new Map,branchKey:c},u.type!=="branch"||u.nodeKey!==g)throw this.invalidCacheError();v==null||v.branches.set(c,u),s==null||(h=s.onNodeVisit)===null||h===void 0||h.call(s,u),c=this._mapNodeValue(y),this._root=(f=this._root)!==null&&f!==void 0?f:u}const p=u?(o=u)===null||o===void 0?void 0:o.branches.get(c):this._root;if(p!=null&&(p.type!=="leaf"||p.branchKey!==c))throw this.invalidCacheError();const m={type:"leaf",value:n,parent:u,branchKey:c};(i=u)===null||i===void 0||i.branches.set(c,m),this._root=(a=this._root)!==null&&a!==void 0?a:m,this._numLeafs++,this._onSet(m),s==null||(l=s.onNodeVisit)===null||l===void 0||l.call(s,m)};try{r()}catch(o){if(o instanceof _2)this.clear(),r();else throw o}}delete(e){const n=this.root();if(!n)return!1;if(e===n)return this._root=null,this._numLeafs=0,!0;let s=e.parent,r=e.branchKey;for(;s;){var o;if(s.branches.delete(r),s===n)return s.branches.size===0?(this._root=null,this._numLeafs=0):this._numLeafs--,!0;if(s.branches.size>0)break;r=(o=s)===null||o===void 0?void 0:o.branchKey,s=s.parent}for(;s!==n;s=s.parent)if(s==null)return!1;return this._numLeafs--,!0}clear(){this._numLeafs=0,this._root=null}invalidCacheError(){const e=sK()?"Possible Fast Refresh module reload detected.  This may also be caused by an selector returning inconsistent values. Resetting cache.":"Invalid cache values.  This happens when selectors do not return consistent values for the same input dependency values.  That may also be caused when using Fast Refresh to change a selector implementation.  Resetting cache.";throw hN(e+(this._name!=null?` - ${this._name}`:"")),new _2}}var oK={TreeCache:rK},iK=oK.TreeCache,QF=Object.freeze({__proto__:null,TreeCache:iK});class aK{constructor(e){var n;Je(this,"_maxSize",void 0),Je(this,"_size",void 0),Je(this,"_head",void 0),Je(this,"_tail",void 0),Je(this,"_map",void 0),Je(this,"_keyMapper",void 0),this._maxSize=e.maxSize,this._size=0,this._head=null,this._tail=null,this._map=new Map,this._keyMapper=(n=e.mapKey)!==null&&n!==void 0?n:s=>s}head(){return this._head}tail(){return this._tail}size(){return this._size}maxSize(){return this._maxSize}has(e){return this._map.has(this._keyMapper(e))}get(e){const n=this._keyMapper(e),s=this._map.get(n);if(s)return this.set(e,s.value),s.value}set(e,n){const s=this._keyMapper(e);this._map.get(s)&&this.delete(e);const o=this.head(),i={key:e,right:o,left:null,value:n};o?o.left=i:this._tail=i,this._map.set(s,i),this._head=i,this._size++,this._maybeDeleteLRU()}_maybeDeleteLRU(){this.size()>this.maxSize()&&this.deleteLru()}deleteLru(){const e=this.tail();e&&this.delete(e.key)}delete(e){const n=this._keyMapper(e);if(!this._size||!this._map.has(n))return;const s=Qt(this._map.get(n)),r=s.right,o=s.left;r&&(r.left=s.left),o&&(o.right=s.right),s===this.head()&&(this._head=r),s===this.tail()&&(this._tail=o),this._map.delete(n),this._size--}clear(){this._size=0,this._head=null,this._tail=null,this._map=new Map}}var lK={LRUCache:aK},uK=lK.LRUCache,ZF=Object.freeze({__proto__:null,LRUCache:uK});const{LRUCache:cK}=ZF,{TreeCache:dK}=QF;function hK({name:t,maxSize:e,mapNodeValue:n=s=>s}){const s=new cK({maxSize:e}),r=new dK({name:t,mapNodeValue:n,onHit:o=>{s.set(o,!0)},onSet:o=>{const i=s.tail();s.set(o,!0),i&&r.size()>e&&r.delete(i.key)}});return r}var A2=hK;function oo(t,e,n){if(typeof t=="string"&&!t.includes('"')&&!t.includes("\\"))return`"${t}"`;switch(typeof t){case"undefined":return"";case"boolean":return t?"true":"false";case"number":case"symbol":return String(t);case"string":return JSON.stringify(t);case"function":if((e==null?void 0:e.allowFunctions)!==!0)throw it("Attempt to serialize function in a Recoil cache key");return`__FUNCTION(${t.name})__`}if(t===null)return"null";if(typeof t!="object"){var s;return(s=JSON.stringify(t))!==null&&s!==void 0?s:""}if(Ut(t))return"__PROMISE__";if(Array.isArray(t))return`[${t.map((r,o)=>oo(r,e,o.toString()))}]`;if(typeof t.toJSON=="function")return oo(t.toJSON(n),e,n);if(t instanceof Map){const r={};for(const[o,i]of t)r[typeof o=="string"?o:oo(o,e)]=i;return oo(r,e,n)}return t instanceof Set?oo(Array.from(t).sort((r,o)=>oo(r,e).localeCompare(oo(o,e))),e,n):Symbol!==void 0&&t[Symbol.iterator]!=null&&typeof t[Symbol.iterator]=="function"?oo(Array.from(t),e,n):`{${Object.keys(t).filter(r=>t[r]!==void 0).sort().map(r=>`${oo(r,e)}:${oo(t[r],e,r)}`).join(",")}}`}function fK(t,e={allowFunctions:!1}){return oo(t,e)}var qb=fK;const{TreeCache:pK}=QF,oy={equality:"reference",eviction:"keep-all",maxSize:1/0};function mK({equality:t=oy.equality,eviction:e=oy.eviction,maxSize:n=oy.maxSize}=oy,s){const r=gK(t);return yK(e,n,r,s)}function gK(t){switch(t){case"reference":return e=>e;case"value":return e=>qb(e)}throw it(`Unrecognized equality policy ${t}`)}function yK(t,e,n,s){switch(t){case"keep-all":return new pK({name:s,mapNodeValue:n});case"lru":return A2({name:s,maxSize:Qt(e),mapNodeValue:n});case"most-recent":return A2({name:s,maxSize:1,mapNodeValue:n})}throw it(`Unrecognized eviction policy ${t}`)}var bK=mK;function vK(t){return()=>null}var xK={startPerfBlock:vK};const{isLoadable:wK,loadableWithError:iy,loadableWithPromise:SK,loadableWithValue:i1}=Gp,{WrappedValue:JF}=YF,{getNodeLoadable:ay,peekNodeLoadable:kK,setNodeValue:CK}=Ya,{saveDepsToStore:NK}=qp,{DEFAULT_VALUE:TK,getConfigDeletionHandler:$K,getNode:IK,registerNode:D2}=rr,{isRecoilValue:EK}=Xc,{markRecoilValueModified:O2}=ni,{retainedByOptionWithDefault:RK}=Su,{recoilCallback:_K}=XF,{startPerfBlock:AK}=xK;class eL{}const Zh=new eL,Jh=[],ly=new Map,DK=(()=>{let t=0;return()=>t++})();function tL(t){let e=null;const{key:n,get:s,cachePolicy_UNSTABLE:r}=t,o=t.set!=null?t.set:void 0,i=new Set,a=bK(r??{equality:"reference",eviction:"keep-all"},n),l=RK(t.retainedBy_UNSTABLE),u=new Map;let c=0;function d(){return!At("recoil_memory_managament_2020")||c>0}function h(_){return _.getState().knownSelectors.add(n),c++,()=>{c--}}function f(){return $K(n)!==void 0&&!d()}function p(_,W,Z,ie,re){Y(W,ie,re),m(_,Z)}function m(_,W){P(_,W)&&V(_),y(W,!0)}function g(_,W){P(_,W)&&(Qt(E(_)).stateVersions.clear(),y(W,!1))}function y(_,W){const Z=ly.get(_);if(Z!=null){for(const ie of Z)O2(ie,Qt(e));W&&ly.delete(_)}}function b(_,W){let Z=ly.get(W);Z==null&&ly.set(W,Z=new Set),Z.add(_)}function v(_,W,Z,ie,re,fe){return W.then(ye=>{if(!d())throw V(_),Zh;const de=i1(ye);return p(_,Z,re,de,ie),ye}).catch(ye=>{if(!d())throw V(_),Zh;if(Ut(ye))return x(_,ye,Z,ie,re,fe);const de=iy(ye);throw p(_,Z,re,de,ie),ye})}function x(_,W,Z,ie,re,fe){return W.then(ye=>{if(!d())throw V(_),Zh;fe.loadingDepKey!=null&&fe.loadingDepPromise===W?Z.atomValues.set(fe.loadingDepKey,i1(ye)):_.getState().knownSelectors.forEach(Ae=>{Z.atomValues.delete(Ae)});const de=C(_,Z);if(de&&de.state!=="loading"){if((P(_,re)||E(_)==null)&&m(_,re),de.state==="hasValue")return de.contents;throw de.contents}if(!P(_,re)){const Ae=I(_,Z);if(Ae!=null)return Ae.loadingLoadable.contents}const[$e,ke]=S(_,Z,re);if($e.state!=="loading"&&p(_,Z,re,$e,ke),$e.state==="hasError")throw $e.contents;return $e.contents}).catch(ye=>{if(ye instanceof eL)throw Zh;if(!d())throw V(_),Zh;const de=iy(ye);throw p(_,Z,re,de,ie),ye})}function w(_,W,Z,ie){var re,fe,ye,de;if(P(_,ie)||W.version===((re=_.getState())===null||re===void 0||(fe=re.currentTree)===null||fe===void 0?void 0:fe.version)||W.version===((ye=_.getState())===null||ye===void 0||(de=ye.nextTree)===null||de===void 0?void 0:de.version)){var $e,ke,Ae;NK(n,Z,_,($e=(ke=_.getState())===null||ke===void 0||(Ae=ke.nextTree)===null||Ae===void 0?void 0:Ae.version)!==null&&$e!==void 0?$e:_.getState().currentTree.version)}for(const Ue of Z)i.add(Ue)}function S(_,W,Z){const ie=AK(n);let re=!0,fe=!0;const ye=()=>{ie(),fe=!1};let de,$e=!1,ke;const Ae={loadingDepKey:null,loadingDepPromise:null},Ue=new Map;function ht({key:Ke}){const rt=ay(_,W,Ke);switch(Ue.set(Ke,rt),re||(w(_,W,new Set(Ue.keys()),Z),g(_,Z)),rt.state){case"hasValue":return rt.contents;case"hasError":throw rt.contents;case"loading":throw Ae.loadingDepKey=Ke,Ae.loadingDepPromise=rt.contents,rt.contents}throw it("Invalid Loadable state")}const Xe=Ke=>(...rt)=>{if(fe)throw it("Callbacks from getCallback() should only be called asynchronously after the selector is evalutated.  It can be used for selectors to return objects with callbacks that can work with Recoil state without a subscription.");return e==null&&pf(!1),_K(_,Ke,rt,{node:e})};try{de=s({get:ht,getCallback:Xe}),de=EK(de)?ht(de):de,wK(de)&&(de.state==="hasError"&&($e=!0),de=de.contents),Ut(de)?de=v(_,de,W,Ue,Z,Ae).finally(ye):ye(),de=de instanceof JF?de.value:de}catch(Ke){de=Ke,Ut(de)?de=x(_,de,W,Ue,Z,Ae).finally(ye):($e=!0,ye())}return $e?ke=iy(de):Ut(de)?ke=SK(de):ke=i1(de),re=!1,z(_,Z,Ue),w(_,W,new Set(Ue.keys()),Z),[ke,Ue]}function C(_,W){let Z=W.atomValues.get(n);if(Z!=null)return Z;const ie=new Set;try{Z=a.get(fe=>(typeof fe!="string"&&pf(!1),ay(_,W,fe).contents),{onNodeVisit:fe=>{fe.type==="branch"&&fe.nodeKey!==n&&ie.add(fe.nodeKey)}})}catch(fe){throw it(`Problem with cache lookup for selector "${n}": ${fe.message}`)}if(Z){var re;W.atomValues.set(n,Z),w(_,W,ie,(re=E(_))===null||re===void 0?void 0:re.executionID)}return Z}function N(_,W){const Z=C(_,W);if(Z!=null)return V(_),Z;const ie=I(_,W);if(ie!=null){var re;return((re=ie.loadingLoadable)===null||re===void 0?void 0:re.state)==="loading"&&b(_,ie.executionID),ie.loadingLoadable}const fe=DK(),[ye,de]=S(_,W,fe);return ye.state==="loading"?(A(_,fe,ye,de,W),b(_,fe)):(V(_),Y(W,ye,de)),ye}function I(_,W){const Z=kF([u.has(_)?[Qt(u.get(_))]:[],Ob(yN(u,([re])=>re!==_),([,re])=>re)]);function ie(re){for(const[fe,ye]of re)if(!ay(_,W,fe).is(ye))return!0;return!1}for(const re of Z){if(re.stateVersions.get(W.version)||!ie(re.depValuesDiscoveredSoFarDuringAsyncWork))return re.stateVersions.set(W.version,!0),re;re.stateVersions.set(W.version,!1)}}function E(_){return u.get(_)}function A(_,W,Z,ie,re){u.set(_,{depValuesDiscoveredSoFarDuringAsyncWork:ie,executionID:W,loadingLoadable:Z,stateVersions:new Map([[re.version,!0]])})}function z(_,W,Z){if(P(_,W)){const ie=E(_);ie!=null&&(ie.depValuesDiscoveredSoFarDuringAsyncWork=Z)}}function V(_){u.delete(_)}function P(_,W){var Z;return W===((Z=E(_))===null||Z===void 0?void 0:Z.executionID)}function K(_){return Array.from(_.entries()).map(([W,Z])=>[W,Z.contents])}function Y(_,W,Z){_.atomValues.set(n,W);try{a.set(K(Z),W)}catch(ie){throw it(`Problem with setting cache for selector "${n}": ${ie.message}`)}}function te(_){if(Jh.includes(n)){const W=`Recoil selector has circular dependencies: ${Jh.slice(Jh.indexOf(n)).join("  ")}`;return iy(it(W))}Jh.push(n);try{return _()}finally{Jh.pop()}}function F(_,W){const Z=W.atomValues.get(n);return Z??a.get(ie=>{var re;return typeof ie!="string"&&pf(!1),(re=kK(_,W,ie))===null||re===void 0?void 0:re.contents})}function j(_,W){return te(()=>N(_,W))}function q(_){_.atomValues.delete(n)}function J(_,W){e==null&&pf(!1);for(const ie of i){var Z;const re=IK(ie);(Z=re.clearCache)===null||Z===void 0||Z.call(re,_,W)}i.clear(),q(W),a.clear(),O2(_,e)}return o!=null?e=D2({key:n,nodeType:"selector",peek:F,get:j,set:(W,Z,ie)=>{let re=!1;const fe=new Map;function ye({key:Ae}){if(re)throw it("Recoil: Async selector sets are not currently supported.");const Ue=ay(W,Z,Ae);if(Ue.state==="hasValue")return Ue.contents;if(Ue.state==="loading"){const ht=`Getting value of asynchronous atom or selector "${Ae}" in a pending state while setting selector "${n}" is not yet supported.`;throw it(ht)}else throw Ue.contents}function de(Ae,Ue){if(re)throw it("Recoil: Async selector sets are not currently supported.");const ht=typeof Ue=="function"?Ue(ye(Ae)):Ue;CK(W,Z,Ae.key,ht).forEach((Ke,rt)=>fe.set(rt,Ke))}function $e(Ae){de(Ae,TK)}const ke=o({set:de,get:ye,reset:$e},ie);if(ke!==void 0)throw Ut(ke)?it("Recoil: Async selector sets are not currently supported."):it("Recoil: selector set should be a void function.");return re=!0,fe},init:h,invalidate:q,clearCache:J,shouldDeleteConfigOnRelease:f,dangerouslyAllowMutability:t.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1,retainedBy:l}):e=D2({key:n,nodeType:"selector",peek:F,get:j,init:h,invalidate:q,clearCache:J,shouldDeleteConfigOnRelease:f,dangerouslyAllowMutability:t.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1,retainedBy:l})}tL.value=t=>new JF(t);var Zc=tL;const{isLoadable:OK,loadableWithError:a1,loadableWithPromise:l1,loadableWithValue:ju}=Gp,{WrappedValue:nL}=YF,{peekNodeInfo:FK}=Ya,{DEFAULT_VALUE:bl,DefaultValue:oa,getConfigDeletionHandler:sL,registerNode:LK,setConfigDeletionHandler:PK}=rr,{isRecoilValue:MK}=Xc,{getRecoilValueAsLoadable:zK,markRecoilValueModified:BK,setRecoilValue:F2,setRecoilValueLoadable:VK}=ni,{retainedByOptionWithDefault:UK}=Su,ef=t=>t instanceof nL?t.value:t;function WK(t){const{key:e,persistence_UNSTABLE:n}=t,s=UK(t.retainedBy_UNSTABLE);let r=0;function o(b){return l1(b.then(v=>(i=ju(v),v)).catch(v=>{throw i=a1(v),v}))}let i=Ut(t.default)?o(t.default):OK(t.default)?t.default.state==="loading"?o(t.default.contents):t.default:ju(ef(t.default));i.contents;let a;const l=new Map;function u(b){return b}function c(b,v){const x=v.then(w=>{var S,C;return((C=((S=b.getState().nextTree)!==null&&S!==void 0?S:b.getState().currentTree).atomValues.get(e))===null||C===void 0?void 0:C.contents)===x&&F2(b,y,w),w}).catch(w=>{var S,C;throw((C=((S=b.getState().nextTree)!==null&&S!==void 0?S:b.getState().currentTree).atomValues.get(e))===null||C===void 0?void 0:C.contents)===x&&VK(b,y,a1(w)),w});return x}function d(b,v,x){var w;r++;const S=()=>{var E;r--,(E=l.get(b))===null||E===void 0||E.forEach(A=>A()),l.delete(b)};if(b.getState().knownAtoms.add(e),i.state==="loading"){const E=()=>{var A;((A=b.getState().nextTree)!==null&&A!==void 0?A:b.getState().currentTree).atomValues.has(e)||BK(b,y)};i.contents.finally(E)}const C=(w=t.effects)!==null&&w!==void 0?w:t.effects_UNSTABLE;if(C!=null){let E=function(q){if(P&&q.key===e){const J=V;return J instanceof oa?h(b,v):Ut(J)?l1(J.then(_=>_ instanceof oa?i.toPromise():_)):ju(J)}return zK(b,q)},A=function(q){return E(q).toPromise()},z=function(q){var J;const _=FK(b,(J=b.getState().nextTree)!==null&&J!==void 0?J:b.getState().currentTree,q.key);return P&&q.key===e&&!(V instanceof oa)?{..._,isSet:!0,loadable:E(q)}:_},V=bl,P=!0,K=!1,Y=null;const te=q=>J=>{if(P){const _=E(y),W=_.state==="hasValue"?_.contents:bl;V=typeof J=="function"?J(W):J,Ut(V)&&(V=V.then(Z=>(Y={effect:q,value:Z},Z)))}else{if(Ut(J))throw it("Setting atoms to async values is not implemented.");typeof J!="function"&&(Y={effect:q,value:ef(J)}),F2(b,y,typeof J=="function"?_=>{const W=ef(J(_));return Y={effect:q,value:W},W}:ef(J))}},F=q=>()=>te(q)(bl),j=q=>J=>{var _;const{release:W}=b.subscribeToTransactions(Z=>{var ie;let{currentTree:re,previousTree:fe}=Z.getState();fe||(fe=re);const ye=(ie=re.atomValues.get(e))!==null&&ie!==void 0?ie:i;if(ye.state==="hasValue"){var de,$e,ke,Ae;const Ue=ye.contents,ht=(de=fe.atomValues.get(e))!==null&&de!==void 0?de:i,Xe=ht.state==="hasValue"?ht.contents:bl;(($e=Y)===null||$e===void 0?void 0:$e.effect)!==q||((ke=Y)===null||ke===void 0?void 0:ke.value)!==Ue?J(Ue,Xe,!re.atomValues.has(e)):((Ae=Y)===null||Ae===void 0?void 0:Ae.effect)===q&&(Y=null)}},e);l.set(b,[...(_=l.get(b))!==null&&_!==void 0?_:[],W])};for(const q of C)try{const J=q({node:y,storeID:b.storeID,parentStoreID_UNSTABLE:b.parentStoreID,trigger:x,setSelf:te(q),resetSelf:F(q),onSet:j(q),getPromise:A,getLoadable:E,getInfo_UNSTABLE:z});if(J!=null){var N;l.set(b,[...(N=l.get(b))!==null&&N!==void 0?N:[],J])}}catch(J){V=J,K=!0}if(P=!1,!(V instanceof oa)){var I;const q=K?a1(V):Ut(V)?l1(c(b,V)):ju(ef(V));q.contents,v.atomValues.set(e,q),(I=b.getState().nextTree)===null||I===void 0||I.atomValues.set(e,q)}}return S}function h(b,v){var x,w;return(x=(w=v.atomValues.get(e))!==null&&w!==void 0?w:a)!==null&&x!==void 0?x:i}function f(b,v){if(v.atomValues.has(e))return Qt(v.atomValues.get(e));if(v.nonvalidatedAtoms.has(e)){if(a!=null)return a;if(n==null)return i;const x=v.nonvalidatedAtoms.get(e),w=n.validator(x,bl);return a=w instanceof oa?i:ju(w),a}else return i}function p(){a=void 0}function m(b,v,x){if(v.atomValues.has(e)){const w=Qt(v.atomValues.get(e));if(w.state==="hasValue"&&x===w.contents)return new Map}else if(!v.nonvalidatedAtoms.has(e)&&x instanceof oa)return new Map;return a=void 0,new Map().set(e,ju(x))}function g(){return sL(e)!==void 0&&r<=0}const y=LK({key:e,nodeType:"atom",peek:h,get:f,set:m,init:d,invalidate:p,shouldDeleteConfigOnRelease:g,dangerouslyAllowMutability:t.dangerouslyAllowMutability,persistence_UNSTABLE:t.persistence_UNSTABLE?{type:t.persistence_UNSTABLE.type,backButton:t.persistence_UNSTABLE.backButton}:void 0,shouldRestoreFromSnapshots:!0,retainedBy:s});return y}function $N(t){const{...e}=t,n="default"in t?t.default:new Promise(()=>{});return MK(n)?jK({...e,default:n}):WK({...e,default:n})}function jK(t){const e=$N({...t,default:bl,persistence_UNSTABLE:t.persistence_UNSTABLE===void 0?void 0:{...t.persistence_UNSTABLE,validator:s=>s instanceof oa?s:Qt(t.persistence_UNSTABLE).validator(s,bl)},effects:t.effects,effects_UNSTABLE:t.effects_UNSTABLE}),n=Zc({key:`${t.key}__withFallback`,get:({get:s})=>{const r=s(e);return r instanceof oa?t.default:r},set:({set:s},r)=>s(e,r),cachePolicy_UNSTABLE:{eviction:"most-recent"},dangerouslyAllowMutability:t.dangerouslyAllowMutability});return PK(n.key,sL(t.key)),n}$N.value=t=>new nL(t);var rL=$N;class GK{constructor(e){var n;Je(this,"_map",void 0),Je(this,"_keyMapper",void 0),this._map=new Map,this._keyMapper=(n=e==null?void 0:e.mapKey)!==null&&n!==void 0?n:s=>s}size(){return this._map.size}has(e){return this._map.has(this._keyMapper(e))}get(e){return this._map.get(this._keyMapper(e))}set(e,n){this._map.set(this._keyMapper(e),n)}delete(e){this._map.delete(this._keyMapper(e))}clear(){this._map.clear()}}var HK={MapCache:GK},qK=HK.MapCache,KK=Object.freeze({__proto__:null,MapCache:qK});const{LRUCache:L2}=ZF,{MapCache:XK}=KK,uy={equality:"reference",eviction:"none",maxSize:1/0};function YK({equality:t=uy.equality,eviction:e=uy.eviction,maxSize:n=uy.maxSize}=uy){const s=QK(t);return ZK(e,n,s)}function QK(t){switch(t){case"reference":return e=>e;case"value":return e=>qb(e)}throw it(`Unrecognized equality policy ${t}`)}function ZK(t,e,n){switch(t){case"keep-all":return new XK({mapKey:n});case"lru":return new L2({mapKey:n,maxSize:Qt(e)});case"most-recent":return new L2({mapKey:n,maxSize:1})}throw it(`Unrecognized eviction policy ${t}`)}var oL=YK;const{setConfigDeletionHandler:JK}=rr;function e9(t){var e,n;const s=oL({equality:(e=(n=t.cachePolicyForParams_UNSTABLE)===null||n===void 0?void 0:n.equality)!==null&&e!==void 0?e:"value",eviction:"keep-all"});return r=>{var o,i;const a=s.get(r);if(a!=null)return a;const{cachePolicyForParams_UNSTABLE:l,...u}=t,c="default"in t?t.default:new Promise(()=>{}),d=rL({...u,key:`${t.key}__${(o=qb(r))!==null&&o!==void 0?o:"void"}`,default:typeof c=="function"?c(r):c,retainedBy_UNSTABLE:typeof t.retainedBy_UNSTABLE=="function"?t.retainedBy_UNSTABLE(r):t.retainedBy_UNSTABLE,effects:typeof t.effects=="function"?t.effects(r):typeof t.effects_UNSTABLE=="function"?t.effects_UNSTABLE(r):(i=t.effects)!==null&&i!==void 0?i:t.effects_UNSTABLE});return s.set(r,d),JK(d.key,()=>{s.delete(r)}),d}}var t9=e9;const{setConfigDeletionHandler:n9}=rr;let s9=0;function r9(t){var e,n;const s=oL({equality:(e=(n=t.cachePolicyForParams_UNSTABLE)===null||n===void 0?void 0:n.equality)!==null&&e!==void 0?e:"value",eviction:"keep-all"});return r=>{var o;let i;try{i=s.get(r)}catch(h){throw it(`Problem with cache lookup for selector ${t.key}: ${h.message}`)}if(i!=null)return i;const a=`${t.key}__selectorFamily/${(o=qb(r,{allowFunctions:!0}))!==null&&o!==void 0?o:"void"}/${s9++}`,l=h=>t.get(r)(h),u=t.cachePolicy_UNSTABLE,c=typeof t.retainedBy_UNSTABLE=="function"?t.retainedBy_UNSTABLE(r):t.retainedBy_UNSTABLE;let d;if(t.set!=null){const h=t.set;d=Zc({key:a,get:l,set:(p,m)=>h(r)(p,m),cachePolicy_UNSTABLE:u,dangerouslyAllowMutability:t.dangerouslyAllowMutability,retainedBy_UNSTABLE:c})}else d=Zc({key:a,get:l,cachePolicy_UNSTABLE:u,dangerouslyAllowMutability:t.dangerouslyAllowMutability,retainedBy_UNSTABLE:c});return s.set(r,d),n9(d.key,()=>{s.delete(r)}),d}}var Qa=r9;const o9=Qa({key:"__constant",get:t=>()=>t,cachePolicyForParams_UNSTABLE:{equality:"reference"}});function i9(t){return o9(t)}var a9=i9;const l9=Qa({key:"__error",get:t=>()=>{throw it(t)},cachePolicyForParams_UNSTABLE:{equality:"reference"}});function u9(t){return l9(t)}var c9=u9;function d9(t){return t}var h9=d9;const{loadableWithError:iL,loadableWithPromise:aL,loadableWithValue:lL}=Gp;function Kb(t,e){const n=Array(e.length).fill(void 0),s=Array(e.length).fill(void 0);for(const[r,o]of e.entries())try{n[r]=t(o)}catch(i){s[r]=i}return[n,s]}function f9(t){return t!=null&&!Ut(t)}function Xb(t){return Array.isArray(t)?t:Object.getOwnPropertyNames(t).map(e=>t[e])}function ek(t,e){return Array.isArray(t)?e:Object.getOwnPropertyNames(t).reduce((n,s,r)=>({...n,[s]:e[r]}),{})}function xc(t,e,n){const s=n.map((r,o)=>r==null?lL(e[o]):Ut(r)?aL(r):iL(r));return ek(t,s)}function p9(t,e){return e.map((n,s)=>n===void 0?t[s]:n)}const m9=Qa({key:"__waitForNone",get:t=>({get:e})=>{const n=Xb(t),[s,r]=Kb(e,n);return xc(t,s,r)},dangerouslyAllowMutability:!0}),g9=Qa({key:"__waitForAny",get:t=>({get:e})=>{const n=Xb(t),[s,r]=Kb(e,n);return r.some(o=>!Ut(o))?xc(t,s,r):new Promise(o=>{for(const[i,a]of r.entries())Ut(a)&&a.then(l=>{s[i]=l,r[i]=void 0,o(xc(t,s,r))}).catch(l=>{r[i]=l,o(xc(t,s,r))})})},dangerouslyAllowMutability:!0}),y9=Qa({key:"__waitForAll",get:t=>({get:e})=>{const n=Xb(t),[s,r]=Kb(e,n);if(r.every(i=>i==null))return ek(t,s);const o=r.find(f9);if(o!=null)throw o;return Promise.all(r).then(i=>ek(t,p9(s,i)))},dangerouslyAllowMutability:!0}),b9=Qa({key:"__waitForAllSettled",get:t=>({get:e})=>{const n=Xb(t),[s,r]=Kb(e,n);return r.every(o=>!Ut(o))?xc(t,s,r):Promise.all(r.map((o,i)=>Ut(o)?o.then(a=>{s[i]=a,r[i]=void 0}).catch(a=>{s[i]=void 0,r[i]=a}):null)).then(()=>xc(t,s,r))},dangerouslyAllowMutability:!0}),v9=Qa({key:"__noWait",get:t=>({get:e})=>{try{return Zc.value(lL(e(t)))}catch(n){return Zc.value(Ut(n)?aL(n):iL(n))}},dangerouslyAllowMutability:!0});var x9={waitForNone:m9,waitForAny:g9,waitForAll:y9,waitForAllSettled:b9,noWait:v9};const{RecoilLoadable:w9}=Gp,{DefaultValue:S9}=rr,{RecoilRoot:k9,useRecoilStoreID:C9}=Fi,{isRecoilValue:N9}=Xc,{retentionZone:T9}=Lb,{freshSnapshot:$9}=Ub,{useRecoilState:I9,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:E9,useRecoilStateLoadable:R9,useRecoilValue:_9,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:A9,useRecoilValueLoadable:D9,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:O9,useResetRecoilState:F9,useSetRecoilState:L9}=H7,{useGotoRecoilSnapshot:P9,useRecoilSnapshot:M9,useRecoilTransactionObserver:z9}=GF,{useRecoilCallback:B9}=XF,{noWait:V9,waitForAll:U9,waitForAllSettled:W9,waitForAny:j9,waitForNone:G9}=x9;var H9={DefaultValue:S9,isRecoilValue:N9,RecoilLoadable:w9,RecoilEnv:xd,RecoilRoot:k9,useRecoilStoreID:C9,useRecoilBridgeAcrossReactRoots_UNSTABLE:vq,atom:rL,selector:Zc,atomFamily:t9,selectorFamily:Qa,constSelector:a9,errorSelector:c9,readOnlySelector:h9,noWait:V9,waitForNone:G9,waitForAny:j9,waitForAll:U9,waitForAllSettled:W9,useRecoilValue:_9,useRecoilValueLoadable:D9,useRecoilState:I9,useRecoilStateLoadable:R9,useSetRecoilState:L9,useResetRecoilState:F9,useGetRecoilValueInfo_UNSTABLE:fq,useRecoilRefresher_UNSTABLE:Kq,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:O9,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:A9,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:E9,useRecoilCallback:B9,useRecoilTransaction_UNSTABLE:Jq,useGotoRecoilSnapshot:P9,useRecoilSnapshot:M9,useRecoilTransactionObserver_UNSTABLE:z9,snapshot_UNSTABLE:$9,useRetain:SN,retentionZone:T9},q9=H9.RecoilRoot;const K9=R.createContext(null),u1={didCatch:!1,error:null};class X9 extends R.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=u1}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(e!==null){for(var n,s,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];(n=(s=this.props).onReset)===null||n===void 0||n.call(s,{args:o,reason:"imperative-api"}),this.setState(u1)}}componentDidCatch(e,n){var s,r;(s=(r=this.props).onError)===null||s===void 0||s.call(r,e,n)}componentDidUpdate(e,n){const{didCatch:s}=this.state,{resetKeys:r}=this.props;if(s&&n.error!==null&&Y9(e.resetKeys,r)){var o,i;(o=(i=this.props).onReset)===null||o===void 0||o.call(i,{next:r,prev:e.resetKeys,reason:"keys"}),this.setState(u1)}}render(){const{children:e,fallbackRender:n,FallbackComponent:s,fallback:r}=this.props,{didCatch:o,error:i}=this.state;let a=e;if(o){const l={error:i,resetErrorBoundary:this.resetErrorBoundary};if(typeof n=="function")a=n(l);else if(s)a=R.createElement(s,l);else if(r===null||R.isValidElement(r))a=r;else throw i}return R.createElement(K9.Provider,{value:{didCatch:o,error:i,resetErrorBoundary:this.resetErrorBoundary}},a)}}function Y9(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t.length!==e.length||t.some((n,s)=>!Object.is(n,e[s]))}const ml=()=>{const t=VO(),e=()=>{t(-1)};return se.jsxs("div",{id:"error-page",children:[se.jsx("p",{children:"   "}),se.jsx("button",{onClick:e,children:" "})]})},Q9=({children:t})=>se.jsx(X9,{FallbackComponent:ml,children:t}),Z9=({children:t})=>se.jsx(R.Suspense,{fallback:se.jsx(se.Fragment,{children:""}),children:t}),J9={main:"/",example:"/example",example2:"/example2",camera:"/camera"},Gu=()=>{const t=VO(),e=()=>{t(J9.main,{replace:!0})};return se.jsxs("div",{id:"error-page",className:"flex flex-col justify-center align-center p-20 text-center h-screen",children:[se.jsx("p",{className:"text-3xl",children:" "}),se.jsx("p",{className:"text-3xl",children:"."}),se.jsx("div",{className:"m-10 w-25",children:se.jsx("button",{className:"text-2xl bg-gray-100 p-4 rounded-lg",onClick:e,children:se.jsx("p",{children:" "})})})]})};function uL(t,e){return function(){return t.apply(e,arguments)}}const{toString:eX}=Object.prototype,{getPrototypeOf:IN}=Object,Yb=(t=>e=>{const n=eX.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),ri=t=>(t=t.toLowerCase(),e=>Yb(e)===t),Qb=t=>e=>typeof e===t,{isArray:Sd}=Array,sp=Qb("undefined");function tX(t){return t!==null&&!sp(t)&&t.constructor!==null&&!sp(t.constructor)&&Kr(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const cL=ri("ArrayBuffer");function nX(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&cL(t.buffer),e}const sX=Qb("string"),Kr=Qb("function"),dL=Qb("number"),Zb=t=>t!==null&&typeof t=="object",rX=t=>t===!0||t===!1,Vy=t=>{if(Yb(t)!=="object")return!1;const e=IN(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},oX=ri("Date"),iX=ri("File"),aX=ri("Blob"),lX=ri("FileList"),uX=t=>Zb(t)&&Kr(t.pipe),cX=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Kr(t.append)&&((e=Yb(t))==="formdata"||e==="object"&&Kr(t.toString)&&t.toString()==="[object FormData]"))},dX=ri("URLSearchParams"),hX=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Qp(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let s,r;if(typeof t!="object"&&(t=[t]),Sd(t))for(s=0,r=t.length;s<r;s++)e.call(null,t[s],s,t);else{const o=n?Object.getOwnPropertyNames(t):Object.keys(t),i=o.length;let a;for(s=0;s<i;s++)a=o[s],e.call(null,t[a],a,t)}}function hL(t,e){e=e.toLowerCase();const n=Object.keys(t);let s=n.length,r;for(;s-- >0;)if(r=n[s],e===r.toLowerCase())return r;return null}const fL=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,pL=t=>!sp(t)&&t!==fL;function tk(){const{caseless:t}=pL(this)&&this||{},e={},n=(s,r)=>{const o=t&&hL(e,r)||r;Vy(e[o])&&Vy(s)?e[o]=tk(e[o],s):Vy(s)?e[o]=tk({},s):Sd(s)?e[o]=s.slice():e[o]=s};for(let s=0,r=arguments.length;s<r;s++)arguments[s]&&Qp(arguments[s],n);return e}const fX=(t,e,n,{allOwnKeys:s}={})=>(Qp(e,(r,o)=>{n&&Kr(r)?t[o]=uL(r,n):t[o]=r},{allOwnKeys:s}),t),pX=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),mX=(t,e,n,s)=>{t.prototype=Object.create(e.prototype,s),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},gX=(t,e,n,s)=>{let r,o,i;const a={};if(e=e||{},t==null)return e;do{for(r=Object.getOwnPropertyNames(t),o=r.length;o-- >0;)i=r[o],(!s||s(i,t,e))&&!a[i]&&(e[i]=t[i],a[i]=!0);t=n!==!1&&IN(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},yX=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const s=t.indexOf(e,n);return s!==-1&&s===n},bX=t=>{if(!t)return null;if(Sd(t))return t;let e=t.length;if(!dL(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},vX=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&IN(Uint8Array)),xX=(t,e)=>{const s=(t&&t[Symbol.iterator]).call(t);let r;for(;(r=s.next())&&!r.done;){const o=r.value;e.call(t,o[0],o[1])}},wX=(t,e)=>{let n;const s=[];for(;(n=t.exec(e))!==null;)s.push(n);return s},SX=ri("HTMLFormElement"),kX=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,r){return s.toUpperCase()+r}),P2=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),CX=ri("RegExp"),mL=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),s={};Qp(n,(r,o)=>{let i;(i=e(r,o,t))!==!1&&(s[o]=i||r)}),Object.defineProperties(t,s)},NX=t=>{mL(t,(e,n)=>{if(Kr(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=t[n];if(Kr(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},TX=(t,e)=>{const n={},s=r=>{r.forEach(o=>{n[o]=!0})};return Sd(t)?s(t):s(String(t).split(e)),n},$X=()=>{},IX=(t,e)=>(t=+t,Number.isFinite(t)?t:e),c1="abcdefghijklmnopqrstuvwxyz",M2="0123456789",gL={DIGIT:M2,ALPHA:c1,ALPHA_DIGIT:c1+c1.toUpperCase()+M2},EX=(t=16,e=gL.ALPHA_DIGIT)=>{let n="";const{length:s}=e;for(;t--;)n+=e[Math.random()*s|0];return n};function RX(t){return!!(t&&Kr(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const _X=t=>{const e=new Array(10),n=(s,r)=>{if(Zb(s)){if(e.indexOf(s)>=0)return;if(!("toJSON"in s)){e[r]=s;const o=Sd(s)?[]:{};return Qp(s,(i,a)=>{const l=n(i,r+1);!sp(l)&&(o[a]=l)}),e[r]=void 0,o}}return s};return n(t,0)},AX=ri("AsyncFunction"),DX=t=>t&&(Zb(t)||Kr(t))&&Kr(t.then)&&Kr(t.catch),ue={isArray:Sd,isArrayBuffer:cL,isBuffer:tX,isFormData:cX,isArrayBufferView:nX,isString:sX,isNumber:dL,isBoolean:rX,isObject:Zb,isPlainObject:Vy,isUndefined:sp,isDate:oX,isFile:iX,isBlob:aX,isRegExp:CX,isFunction:Kr,isStream:uX,isURLSearchParams:dX,isTypedArray:vX,isFileList:lX,forEach:Qp,merge:tk,extend:fX,trim:hX,stripBOM:pX,inherits:mX,toFlatObject:gX,kindOf:Yb,kindOfTest:ri,endsWith:yX,toArray:bX,forEachEntry:xX,matchAll:wX,isHTMLForm:SX,hasOwnProperty:P2,hasOwnProp:P2,reduceDescriptors:mL,freezeMethods:NX,toObjectSet:TX,toCamelCase:kX,noop:$X,toFiniteNumber:IX,findKey:hL,global:fL,isContextDefined:pL,ALPHABET:gL,generateString:EX,isSpecCompliantForm:RX,toJSONObject:_X,isAsyncFn:AX,isThenable:DX};function bt(t,e,n,s,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),s&&(this.request=s),r&&(this.response=r)}ue.inherits(bt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ue.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const yL=bt.prototype,bL={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{bL[t]={value:t}});Object.defineProperties(bt,bL);Object.defineProperty(yL,"isAxiosError",{value:!0});bt.from=(t,e,n,s,r,o)=>{const i=Object.create(yL);return ue.toFlatObject(t,i,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),bt.call(i,t.message,e,n,s,r),i.cause=t,i.name=t.name,o&&Object.assign(i,o),i};const OX=null;function nk(t){return ue.isPlainObject(t)||ue.isArray(t)}function vL(t){return ue.endsWith(t,"[]")?t.slice(0,-2):t}function z2(t,e,n){return t?t.concat(e).map(function(r,o){return r=vL(r),!n&&o?"["+r+"]":r}).join(n?".":""):e}function FX(t){return ue.isArray(t)&&!t.some(nk)}const LX=ue.toFlatObject(ue,{},null,function(e){return/^is[A-Z]/.test(e)});function Jb(t,e,n){if(!ue.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=ue.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,g){return!ue.isUndefined(g[m])});const s=n.metaTokens,r=n.visitor||c,o=n.dots,i=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&ue.isSpecCompliantForm(e);if(!ue.isFunction(r))throw new TypeError("visitor must be a function");function u(p){if(p===null)return"";if(ue.isDate(p))return p.toISOString();if(!l&&ue.isBlob(p))throw new bt("Blob is not supported. Use a Buffer instead.");return ue.isArrayBuffer(p)||ue.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function c(p,m,g){let y=p;if(p&&!g&&typeof p=="object"){if(ue.endsWith(m,"{}"))m=s?m:m.slice(0,-2),p=JSON.stringify(p);else if(ue.isArray(p)&&FX(p)||(ue.isFileList(p)||ue.endsWith(m,"[]"))&&(y=ue.toArray(p)))return m=vL(m),y.forEach(function(v,x){!(ue.isUndefined(v)||v===null)&&e.append(i===!0?z2([m],x,o):i===null?m:m+"[]",u(v))}),!1}return nk(p)?!0:(e.append(z2(g,m,o),u(p)),!1)}const d=[],h=Object.assign(LX,{defaultVisitor:c,convertValue:u,isVisitable:nk});function f(p,m){if(!ue.isUndefined(p)){if(d.indexOf(p)!==-1)throw Error("Circular reference detected in "+m.join("."));d.push(p),ue.forEach(p,function(y,b){(!(ue.isUndefined(y)||y===null)&&r.call(e,y,ue.isString(b)?b.trim():b,m,h))===!0&&f(y,m?m.concat(b):[b])}),d.pop()}}if(!ue.isObject(t))throw new TypeError("data must be an object");return f(t),e}function B2(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function EN(t,e){this._pairs=[],t&&Jb(t,this,e)}const xL=EN.prototype;xL.append=function(e,n){this._pairs.push([e,n])};xL.toString=function(e){const n=e?function(s){return e.call(this,s,B2)}:B2;return this._pairs.map(function(r){return n(r[0])+"="+n(r[1])},"").join("&")};function PX(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function wL(t,e,n){if(!e)return t;const s=n&&n.encode||PX,r=n&&n.serialize;let o;if(r?o=r(e,n):o=ue.isURLSearchParams(e)?e.toString():new EN(e,n).toString(s),o){const i=t.indexOf("#");i!==-1&&(t=t.slice(0,i)),t+=(t.indexOf("?")===-1?"?":"&")+o}return t}class V2{constructor(){this.handlers=[]}use(e,n,s){return this.handlers.push({fulfilled:e,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ue.forEach(this.handlers,function(s){s!==null&&e(s)})}}const SL={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},MX=typeof URLSearchParams<"u"?URLSearchParams:EN,zX=typeof FormData<"u"?FormData:null,BX=typeof Blob<"u"?Blob:null,VX={isBrowser:!0,classes:{URLSearchParams:MX,FormData:zX,Blob:BX},protocols:["http","https","file","blob","url","data"]},kL=typeof window<"u"&&typeof document<"u",UX=(t=>kL&&["ReactNative","NativeScript","NS"].indexOf(t)<0)(typeof navigator<"u"&&navigator.product),WX=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",jX=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:kL,hasStandardBrowserEnv:UX,hasStandardBrowserWebWorkerEnv:WX},Symbol.toStringTag,{value:"Module"})),Bo={...jX,...VX};function GX(t,e){return Jb(t,new Bo.classes.URLSearchParams,Object.assign({visitor:function(n,s,r,o){return Bo.isNode&&ue.isBuffer(n)?(this.append(s,n.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},e))}function HX(t){return ue.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function qX(t){const e={},n=Object.keys(t);let s;const r=n.length;let o;for(s=0;s<r;s++)o=n[s],e[o]=t[o];return e}function CL(t){function e(n,s,r,o){let i=n[o++];if(i==="__proto__")return!0;const a=Number.isFinite(+i),l=o>=n.length;return i=!i&&ue.isArray(r)?r.length:i,l?(ue.hasOwnProp(r,i)?r[i]=[r[i],s]:r[i]=s,!a):((!r[i]||!ue.isObject(r[i]))&&(r[i]=[]),e(n,s,r[i],o)&&ue.isArray(r[i])&&(r[i]=qX(r[i])),!a)}if(ue.isFormData(t)&&ue.isFunction(t.entries)){const n={};return ue.forEachEntry(t,(s,r)=>{e(HX(s),r,n,0)}),n}return null}function KX(t,e,n){if(ue.isString(t))try{return(e||JSON.parse)(t),ue.trim(t)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(t)}const RN={transitional:SL,adapter:["xhr","http"],transformRequest:[function(e,n){const s=n.getContentType()||"",r=s.indexOf("application/json")>-1,o=ue.isObject(e);if(o&&ue.isHTMLForm(e)&&(e=new FormData(e)),ue.isFormData(e))return r?JSON.stringify(CL(e)):e;if(ue.isArrayBuffer(e)||ue.isBuffer(e)||ue.isStream(e)||ue.isFile(e)||ue.isBlob(e))return e;if(ue.isArrayBufferView(e))return e.buffer;if(ue.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(o){if(s.indexOf("application/x-www-form-urlencoded")>-1)return GX(e,this.formSerializer).toString();if((a=ue.isFileList(e))||s.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Jb(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return o||r?(n.setContentType("application/json",!1),KX(e)):e}],transformResponse:[function(e){const n=this.transitional||RN.transitional,s=n&&n.forcedJSONParsing,r=this.responseType==="json";if(e&&ue.isString(e)&&(s&&!this.responseType||r)){const i=!(n&&n.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(a){if(i)throw a.name==="SyntaxError"?bt.from(a,bt.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Bo.classes.FormData,Blob:Bo.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ue.forEach(["delete","get","head","post","put","patch"],t=>{RN.headers[t]={}});const _N=RN,XX=ue.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),YX=t=>{const e={};let n,s,r;return t&&t.split(`
`).forEach(function(i){r=i.indexOf(":"),n=i.substring(0,r).trim().toLowerCase(),s=i.substring(r+1).trim(),!(!n||e[n]&&XX[n])&&(n==="set-cookie"?e[n]?e[n].push(s):e[n]=[s]:e[n]=e[n]?e[n]+", "+s:s)}),e},U2=Symbol("internals");function tf(t){return t&&String(t).trim().toLowerCase()}function Uy(t){return t===!1||t==null?t:ue.isArray(t)?t.map(Uy):String(t)}function QX(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(t);)e[s[1]]=s[2];return e}const ZX=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function d1(t,e,n,s,r){if(ue.isFunction(s))return s.call(this,e,n);if(r&&(e=n),!!ue.isString(e)){if(ue.isString(s))return e.indexOf(s)!==-1;if(ue.isRegExp(s))return s.test(e)}}function JX(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,s)=>n.toUpperCase()+s)}function eY(t,e){const n=ue.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(t,s+n,{value:function(r,o,i){return this[s].call(this,e,r,o,i)},configurable:!0})})}class ev{constructor(e){e&&this.set(e)}set(e,n,s){const r=this;function o(a,l,u){const c=tf(l);if(!c)throw new Error("header name must be a non-empty string");const d=ue.findKey(r,c);(!d||r[d]===void 0||u===!0||u===void 0&&r[d]!==!1)&&(r[d||l]=Uy(a))}const i=(a,l)=>ue.forEach(a,(u,c)=>o(u,c,l));return ue.isPlainObject(e)||e instanceof this.constructor?i(e,n):ue.isString(e)&&(e=e.trim())&&!ZX(e)?i(YX(e),n):e!=null&&o(n,e,s),this}get(e,n){if(e=tf(e),e){const s=ue.findKey(this,e);if(s){const r=this[s];if(!n)return r;if(n===!0)return QX(r);if(ue.isFunction(n))return n.call(this,r,s);if(ue.isRegExp(n))return n.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=tf(e),e){const s=ue.findKey(this,e);return!!(s&&this[s]!==void 0&&(!n||d1(this,this[s],s,n)))}return!1}delete(e,n){const s=this;let r=!1;function o(i){if(i=tf(i),i){const a=ue.findKey(s,i);a&&(!n||d1(s,s[a],a,n))&&(delete s[a],r=!0)}}return ue.isArray(e)?e.forEach(o):o(e),r}clear(e){const n=Object.keys(this);let s=n.length,r=!1;for(;s--;){const o=n[s];(!e||d1(this,this[o],o,e,!0))&&(delete this[o],r=!0)}return r}normalize(e){const n=this,s={};return ue.forEach(this,(r,o)=>{const i=ue.findKey(s,o);if(i){n[i]=Uy(r),delete n[o];return}const a=e?JX(o):String(o).trim();a!==o&&delete n[o],n[a]=Uy(r),s[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return ue.forEach(this,(s,r)=>{s!=null&&s!==!1&&(n[r]=e&&ue.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const s=new this(e);return n.forEach(r=>s.set(r)),s}static accessor(e){const s=(this[U2]=this[U2]={accessors:{}}).accessors,r=this.prototype;function o(i){const a=tf(i);s[a]||(eY(r,i),s[a]=!0)}return ue.isArray(e)?e.forEach(o):o(e),this}}ev.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ue.reduceDescriptors(ev.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(s){this[n]=s}}});ue.freezeMethods(ev);const xi=ev;function h1(t,e){const n=this||_N,s=e||n,r=xi.from(s.headers);let o=s.data;return ue.forEach(t,function(a){o=a.call(n,o,r.normalize(),e?e.status:void 0)}),r.normalize(),o}function NL(t){return!!(t&&t.__CANCEL__)}function Zp(t,e,n){bt.call(this,t??"canceled",bt.ERR_CANCELED,e,n),this.name="CanceledError"}ue.inherits(Zp,bt,{__CANCEL__:!0});function tY(t,e,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?t(n):e(new bt("Request failed with status code "+n.status,[bt.ERR_BAD_REQUEST,bt.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const nY=Bo.hasStandardBrowserEnv?{write(t,e,n,s,r,o){const i=[t+"="+encodeURIComponent(e)];ue.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),ue.isString(s)&&i.push("path="+s),ue.isString(r)&&i.push("domain="+r),o===!0&&i.push("secure"),document.cookie=i.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function sY(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function rY(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function TL(t,e){return t&&!sY(e)?rY(t,e):e}const oY=Bo.hasStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let s;function r(o){let i=o;return e&&(n.setAttribute("href",i),i=n.href),n.setAttribute("href",i),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return s=r(window.location.href),function(i){const a=ue.isString(i)?r(i):i;return a.protocol===s.protocol&&a.host===s.host}}():function(){return function(){return!0}}();function iY(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function aY(t,e){t=t||10;const n=new Array(t),s=new Array(t);let r=0,o=0,i;return e=e!==void 0?e:1e3,function(l){const u=Date.now(),c=s[o];i||(i=u),n[r]=l,s[r]=u;let d=o,h=0;for(;d!==r;)h+=n[d++],d=d%t;if(r=(r+1)%t,r===o&&(o=(o+1)%t),u-i<e)return;const f=c&&u-c;return f?Math.round(h*1e3/f):void 0}}function W2(t,e){let n=0;const s=aY(50,250);return r=>{const o=r.loaded,i=r.lengthComputable?r.total:void 0,a=o-n,l=s(a),u=o<=i;n=o;const c={loaded:o,total:i,progress:i?o/i:void 0,bytes:a,rate:l||void 0,estimated:l&&i&&u?(i-o)/l:void 0,event:r};c[e?"download":"upload"]=!0,t(c)}}const lY=typeof XMLHttpRequest<"u",uY=lY&&function(t){return new Promise(function(n,s){let r=t.data;const o=xi.from(t.headers).normalize();let{responseType:i,withXSRFToken:a}=t,l;function u(){t.cancelToken&&t.cancelToken.unsubscribe(l),t.signal&&t.signal.removeEventListener("abort",l)}let c;if(ue.isFormData(r)){if(Bo.hasStandardBrowserEnv||Bo.hasStandardBrowserWebWorkerEnv)o.setContentType(!1);else if((c=o.getContentType())!==!1){const[m,...g]=c?c.split(";").map(y=>y.trim()).filter(Boolean):[];o.setContentType([m||"multipart/form-data",...g].join("; "))}}let d=new XMLHttpRequest;if(t.auth){const m=t.auth.username||"",g=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";o.set("Authorization","Basic "+btoa(m+":"+g))}const h=TL(t.baseURL,t.url);d.open(t.method.toUpperCase(),wL(h,t.params,t.paramsSerializer),!0),d.timeout=t.timeout;function f(){if(!d)return;const m=xi.from("getAllResponseHeaders"in d&&d.getAllResponseHeaders()),y={data:!i||i==="text"||i==="json"?d.responseText:d.response,status:d.status,statusText:d.statusText,headers:m,config:t,request:d};tY(function(v){n(v),u()},function(v){s(v),u()},y),d=null}if("onloadend"in d?d.onloadend=f:d.onreadystatechange=function(){!d||d.readyState!==4||d.status===0&&!(d.responseURL&&d.responseURL.indexOf("file:")===0)||setTimeout(f)},d.onabort=function(){d&&(s(new bt("Request aborted",bt.ECONNABORTED,t,d)),d=null)},d.onerror=function(){s(new bt("Network Error",bt.ERR_NETWORK,t,d)),d=null},d.ontimeout=function(){let g=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const y=t.transitional||SL;t.timeoutErrorMessage&&(g=t.timeoutErrorMessage),s(new bt(g,y.clarifyTimeoutError?bt.ETIMEDOUT:bt.ECONNABORTED,t,d)),d=null},Bo.hasStandardBrowserEnv&&(a&&ue.isFunction(a)&&(a=a(t)),a||a!==!1&&oY(h))){const m=t.xsrfHeaderName&&t.xsrfCookieName&&nY.read(t.xsrfCookieName);m&&o.set(t.xsrfHeaderName,m)}r===void 0&&o.setContentType(null),"setRequestHeader"in d&&ue.forEach(o.toJSON(),function(g,y){d.setRequestHeader(y,g)}),ue.isUndefined(t.withCredentials)||(d.withCredentials=!!t.withCredentials),i&&i!=="json"&&(d.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&d.addEventListener("progress",W2(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&d.upload&&d.upload.addEventListener("progress",W2(t.onUploadProgress)),(t.cancelToken||t.signal)&&(l=m=>{d&&(s(!m||m.type?new Zp(null,t,d):m),d.abort(),d=null)},t.cancelToken&&t.cancelToken.subscribe(l),t.signal&&(t.signal.aborted?l():t.signal.addEventListener("abort",l)));const p=iY(h);if(p&&Bo.protocols.indexOf(p)===-1){s(new bt("Unsupported protocol "+p+":",bt.ERR_BAD_REQUEST,t));return}d.send(r||null)})},sk={http:OX,xhr:uY};ue.forEach(sk,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const j2=t=>`- ${t}`,cY=t=>ue.isFunction(t)||t===null||t===!1,$L={getAdapter:t=>{t=ue.isArray(t)?t:[t];const{length:e}=t;let n,s;const r={};for(let o=0;o<e;o++){n=t[o];let i;if(s=n,!cY(n)&&(s=sk[(i=String(n)).toLowerCase()],s===void 0))throw new bt(`Unknown adapter '${i}'`);if(s)break;r[i||"#"+o]=s}if(!s){const o=Object.entries(r).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let i=e?o.length>1?`since :
`+o.map(j2).join(`
`):" "+j2(o[0]):"as no adapter specified";throw new bt("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return s},adapters:sk};function f1(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Zp(null,t)}function G2(t){return f1(t),t.headers=xi.from(t.headers),t.data=h1.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),$L.getAdapter(t.adapter||_N.adapter)(t).then(function(s){return f1(t),s.data=h1.call(t,t.transformResponse,s),s.headers=xi.from(s.headers),s},function(s){return NL(s)||(f1(t),s&&s.response&&(s.response.data=h1.call(t,t.transformResponse,s.response),s.response.headers=xi.from(s.response.headers))),Promise.reject(s)})}const H2=t=>t instanceof xi?{...t}:t;function Jc(t,e){e=e||{};const n={};function s(u,c,d){return ue.isPlainObject(u)&&ue.isPlainObject(c)?ue.merge.call({caseless:d},u,c):ue.isPlainObject(c)?ue.merge({},c):ue.isArray(c)?c.slice():c}function r(u,c,d){if(ue.isUndefined(c)){if(!ue.isUndefined(u))return s(void 0,u,d)}else return s(u,c,d)}function o(u,c){if(!ue.isUndefined(c))return s(void 0,c)}function i(u,c){if(ue.isUndefined(c)){if(!ue.isUndefined(u))return s(void 0,u)}else return s(void 0,c)}function a(u,c,d){if(d in e)return s(u,c);if(d in t)return s(void 0,u)}const l={url:o,method:o,data:o,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:a,headers:(u,c)=>r(H2(u),H2(c),!0)};return ue.forEach(Object.keys(Object.assign({},t,e)),function(c){const d=l[c]||r,h=d(t[c],e[c],c);ue.isUndefined(h)&&d!==a||(n[c]=h)}),n}const IL="1.6.8",AN={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{AN[t]=function(s){return typeof s===t||"a"+(e<1?"n ":" ")+t}});const q2={};AN.transitional=function(e,n,s){function r(o,i){return"[Axios v"+IL+"] Transitional option '"+o+"'"+i+(s?". "+s:"")}return(o,i,a)=>{if(e===!1)throw new bt(r(i," has been removed"+(n?" in "+n:"")),bt.ERR_DEPRECATED);return n&&!q2[i]&&(q2[i]=!0,console.warn(r(i," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(o,i,a):!0}};function dY(t,e,n){if(typeof t!="object")throw new bt("options must be an object",bt.ERR_BAD_OPTION_VALUE);const s=Object.keys(t);let r=s.length;for(;r-- >0;){const o=s[r],i=e[o];if(i){const a=t[o],l=a===void 0||i(a,o,t);if(l!==!0)throw new bt("option "+o+" must be "+l,bt.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new bt("Unknown option "+o,bt.ERR_BAD_OPTION)}}const rk={assertOptions:dY,validators:AN},Qi=rk.validators;class I0{constructor(e){this.defaults=e,this.interceptors={request:new V2,response:new V2}}async request(e,n){try{return await this._request(e,n)}catch(s){if(s instanceof Error){let r;Error.captureStackTrace?Error.captureStackTrace(r={}):r=new Error;const o=r.stack?r.stack.replace(/^.+\n/,""):"";s.stack?o&&!String(s.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+o):s.stack=o}throw s}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Jc(this.defaults,n);const{transitional:s,paramsSerializer:r,headers:o}=n;s!==void 0&&rk.assertOptions(s,{silentJSONParsing:Qi.transitional(Qi.boolean),forcedJSONParsing:Qi.transitional(Qi.boolean),clarifyTimeoutError:Qi.transitional(Qi.boolean)},!1),r!=null&&(ue.isFunction(r)?n.paramsSerializer={serialize:r}:rk.assertOptions(r,{encode:Qi.function,serialize:Qi.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let i=o&&ue.merge(o.common,o[n.method]);o&&ue.forEach(["delete","get","head","post","put","patch","common"],p=>{delete o[p]}),n.headers=xi.concat(i,o);const a=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(n)===!1||(l=l&&m.synchronous,a.unshift(m.fulfilled,m.rejected))});const u=[];this.interceptors.response.forEach(function(m){u.push(m.fulfilled,m.rejected)});let c,d=0,h;if(!l){const p=[G2.bind(this),void 0];for(p.unshift.apply(p,a),p.push.apply(p,u),h=p.length,c=Promise.resolve(n);d<h;)c=c.then(p[d++],p[d++]);return c}h=a.length;let f=n;for(d=0;d<h;){const p=a[d++],m=a[d++];try{f=p(f)}catch(g){m.call(this,g);break}}try{c=G2.call(this,f)}catch(p){return Promise.reject(p)}for(d=0,h=u.length;d<h;)c=c.then(u[d++],u[d++]);return c}getUri(e){e=Jc(this.defaults,e);const n=TL(e.baseURL,e.url);return wL(n,e.params,e.paramsSerializer)}}ue.forEach(["delete","get","head","options"],function(e){I0.prototype[e]=function(n,s){return this.request(Jc(s||{},{method:e,url:n,data:(s||{}).data}))}});ue.forEach(["post","put","patch"],function(e){function n(s){return function(o,i,a){return this.request(Jc(a||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:o,data:i}))}}I0.prototype[e]=n(),I0.prototype[e+"Form"]=n(!0)});const Wy=I0;class DN{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(o){n=o});const s=this;this.promise.then(r=>{if(!s._listeners)return;let o=s._listeners.length;for(;o-- >0;)s._listeners[o](r);s._listeners=null}),this.promise.then=r=>{let o;const i=new Promise(a=>{s.subscribe(a),o=a}).then(r);return i.cancel=function(){s.unsubscribe(o)},i},e(function(o,i,a){s.reason||(s.reason=new Zp(o,i,a),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}static source(){let e;return{token:new DN(function(r){e=r}),cancel:e}}}const hY=DN;function fY(t){return function(n){return t.apply(null,n)}}function pY(t){return ue.isObject(t)&&t.isAxiosError===!0}const ok={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ok).forEach(([t,e])=>{ok[e]=t});const mY=ok;function EL(t){const e=new Wy(t),n=uL(Wy.prototype.request,e);return ue.extend(n,Wy.prototype,e,{allOwnKeys:!0}),ue.extend(n,e,null,{allOwnKeys:!0}),n.create=function(r){return EL(Jc(t,r))},n}const wn=EL(_N);wn.Axios=Wy;wn.CanceledError=Zp;wn.CancelToken=hY;wn.isCancel=NL;wn.VERSION=IL;wn.toFormData=Jb;wn.AxiosError=bt;wn.Cancel=wn.CanceledError;wn.all=function(e){return Promise.all(e)};wn.spread=fY;wn.isAxiosError=pY;wn.mergeConfig=Jc;wn.AxiosHeaders=xi;wn.formToJSON=t=>CL(ue.isHTMLForm(t)?new FormData(t):t);wn.getAdapter=$L.getAdapter;wn.HttpStatusCode=mY;wn.default=wn;var gY={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const yY=gY.VITE_AI_DATA,bY=async t=>(await wn.post("https://api.openai.com/v1/chat/completions",{model:"gpt-4o-mini",messages:[{role:"user",content:t}]},{headers:{Authorization:`Bearer ${yY}`,"Content-Type":"application/json"}})).data.choices[0].message.content;function ik(){return ik=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},ik.apply(this,arguments)}var vY={strings:["These are the default values...","You know what you should do?","Use your own!","Have a great day!"],stringsElement:null,typeSpeed:0,startDelay:0,backSpeed:0,smartBackspace:!0,shuffle:!1,backDelay:700,fadeOut:!1,fadeOutClass:"typed-fade-out",fadeOutDelay:500,loop:!1,loopCount:1/0,showCursor:!0,cursorChar:"|",autoInsertCss:!0,attr:null,bindInputFocusEvents:!1,contentType:"html",onBegin:function(t){},onComplete:function(t){},preStringTyped:function(t,e){},onStringTyped:function(t,e){},onLastStringBackspaced:function(t){},onTypingPaused:function(t,e){},onTypingResumed:function(t,e){},onReset:function(t){},onStop:function(t,e){},onStart:function(t,e){},onDestroy:function(t){}},xY=new(function(){function t(){}var e=t.prototype;return e.load=function(n,s,r){if(n.el=typeof r=="string"?document.querySelector(r):r,n.options=ik({},vY,s),n.isInput=n.el.tagName.toLowerCase()==="input",n.attr=n.options.attr,n.bindInputFocusEvents=n.options.bindInputFocusEvents,n.showCursor=!n.isInput&&n.options.showCursor,n.cursorChar=n.options.cursorChar,n.cursorBlinking=!0,n.elContent=n.attr?n.el.getAttribute(n.attr):n.el.textContent,n.contentType=n.options.contentType,n.typeSpeed=n.options.typeSpeed,n.startDelay=n.options.startDelay,n.backSpeed=n.options.backSpeed,n.smartBackspace=n.options.smartBackspace,n.backDelay=n.options.backDelay,n.fadeOut=n.options.fadeOut,n.fadeOutClass=n.options.fadeOutClass,n.fadeOutDelay=n.options.fadeOutDelay,n.isPaused=!1,n.strings=n.options.strings.map(function(u){return u.trim()}),n.stringsElement=typeof n.options.stringsElement=="string"?document.querySelector(n.options.stringsElement):n.options.stringsElement,n.stringsElement){n.strings=[],n.stringsElement.style.cssText="clip: rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px;";var o=Array.prototype.slice.apply(n.stringsElement.children),i=o.length;if(i)for(var a=0;a<i;a+=1)n.strings.push(o[a].innerHTML.trim())}for(var l in n.strPos=0,n.currentElContent=this.getCurrentElContent(n),n.currentElContent&&n.currentElContent.length>0&&(n.strPos=n.currentElContent.length-1,n.strings.unshift(n.currentElContent)),n.sequence=[],n.strings)n.sequence[l]=l;n.arrayPos=0,n.stopNum=0,n.loop=n.options.loop,n.loopCount=n.options.loopCount,n.curLoop=0,n.shuffle=n.options.shuffle,n.pause={status:!1,typewrite:!0,curString:"",curStrPos:0},n.typingComplete=!1,n.autoInsertCss=n.options.autoInsertCss,n.autoInsertCss&&(this.appendCursorAnimationCss(n),this.appendFadeOutAnimationCss(n))},e.getCurrentElContent=function(n){return n.attr?n.el.getAttribute(n.attr):n.isInput?n.el.value:n.contentType==="html"?n.el.innerHTML:n.el.textContent},e.appendCursorAnimationCss=function(n){var s="data-typed-js-cursor-css";if(n.showCursor&&!document.querySelector("["+s+"]")){var r=document.createElement("style");r.setAttribute(s,"true"),r.innerHTML=`
        .typed-cursor{
          opacity: 1;
        }
        .typed-cursor.typed-cursor--blink{
          animation: typedjsBlink 0.7s infinite;
          -webkit-animation: typedjsBlink 0.7s infinite;
                  animation: typedjsBlink 0.7s infinite;
        }
        @keyframes typedjsBlink{
          50% { opacity: 0.0; }
        }
        @-webkit-keyframes typedjsBlink{
          0% { opacity: 1; }
          50% { opacity: 0.0; }
          100% { opacity: 1; }
        }
      `,document.body.appendChild(r)}},e.appendFadeOutAnimationCss=function(n){var s="data-typed-fadeout-js-css";if(n.fadeOut&&!document.querySelector("["+s+"]")){var r=document.createElement("style");r.setAttribute(s,"true"),r.innerHTML=`
        .typed-fade-out{
          opacity: 0;
          transition: opacity .25s;
        }
        .typed-cursor.typed-cursor--blink.typed-fade-out{
          -webkit-animation: 0;
          animation: 0;
        }
      `,document.body.appendChild(r)}},t}()),K2=new(function(){function t(){}var e=t.prototype;return e.typeHtmlChars=function(n,s,r){if(r.contentType!=="html")return s;var o=n.substring(s).charAt(0);if(o==="<"||o==="&"){var i;for(i=o==="<"?">":";";n.substring(s+1).charAt(0)!==i&&!(1+ ++s>n.length););s++}return s},e.backSpaceHtmlChars=function(n,s,r){if(r.contentType!=="html")return s;var o=n.substring(s).charAt(0);if(o===">"||o===";"){var i;for(i=o===">"?"<":"&";n.substring(s-1).charAt(0)!==i&&!(--s<0););s--}return s},t}()),wY=function(){function t(n,s){xY.load(this,s,n),this.begin()}var e=t.prototype;return e.toggle=function(){this.pause.status?this.start():this.stop()},e.stop=function(){this.typingComplete||this.pause.status||(this.toggleBlinking(!0),this.pause.status=!0,this.options.onStop(this.arrayPos,this))},e.start=function(){this.typingComplete||this.pause.status&&(this.pause.status=!1,this.pause.typewrite?this.typewrite(this.pause.curString,this.pause.curStrPos):this.backspace(this.pause.curString,this.pause.curStrPos),this.options.onStart(this.arrayPos,this))},e.destroy=function(){this.reset(!1),this.options.onDestroy(this)},e.reset=function(n){n===void 0&&(n=!0),clearInterval(this.timeout),this.replaceText(""),this.cursor&&this.cursor.parentNode&&(this.cursor.parentNode.removeChild(this.cursor),this.cursor=null),this.strPos=0,this.arrayPos=0,this.curLoop=0,n&&(this.insertCursor(),this.options.onReset(this),this.begin())},e.begin=function(){var n=this;this.options.onBegin(this),this.typingComplete=!1,this.shuffleStringsIfNeeded(this),this.insertCursor(),this.bindInputFocusEvents&&this.bindFocusEvents(),this.timeout=setTimeout(function(){n.strPos===0?n.typewrite(n.strings[n.sequence[n.arrayPos]],n.strPos):n.backspace(n.strings[n.sequence[n.arrayPos]],n.strPos)},this.startDelay)},e.typewrite=function(n,s){var r=this;this.fadeOut&&this.el.classList.contains(this.fadeOutClass)&&(this.el.classList.remove(this.fadeOutClass),this.cursor&&this.cursor.classList.remove(this.fadeOutClass));var o=this.humanizer(this.typeSpeed),i=1;this.pause.status!==!0?this.timeout=setTimeout(function(){s=K2.typeHtmlChars(n,s,r);var a=0,l=n.substring(s);if(l.charAt(0)==="^"&&/^\^\d+/.test(l)){var u=1;u+=(l=/\d+/.exec(l)[0]).length,a=parseInt(l),r.temporaryPause=!0,r.options.onTypingPaused(r.arrayPos,r),n=n.substring(0,s)+n.substring(s+u),r.toggleBlinking(!0)}if(l.charAt(0)==="`"){for(;n.substring(s+i).charAt(0)!=="`"&&(i++,!(s+i>n.length)););var c=n.substring(0,s),d=n.substring(c.length+1,s+i),h=n.substring(s+i+1);n=c+d+h,i--}r.timeout=setTimeout(function(){r.toggleBlinking(!1),s>=n.length?r.doneTyping(n,s):r.keepTyping(n,s,i),r.temporaryPause&&(r.temporaryPause=!1,r.options.onTypingResumed(r.arrayPos,r))},a)},o):this.setPauseStatus(n,s,!0)},e.keepTyping=function(n,s,r){s===0&&(this.toggleBlinking(!1),this.options.preStringTyped(this.arrayPos,this));var o=n.substring(0,s+=r);this.replaceText(o),this.typewrite(n,s)},e.doneTyping=function(n,s){var r=this;this.options.onStringTyped(this.arrayPos,this),this.toggleBlinking(!0),this.arrayPos===this.strings.length-1&&(this.complete(),this.loop===!1||this.curLoop===this.loopCount)||(this.timeout=setTimeout(function(){r.backspace(n,s)},this.backDelay))},e.backspace=function(n,s){var r=this;if(this.pause.status!==!0){if(this.fadeOut)return this.initFadeOut();this.toggleBlinking(!1);var o=this.humanizer(this.backSpeed);this.timeout=setTimeout(function(){s=K2.backSpaceHtmlChars(n,s,r);var i=n.substring(0,s);if(r.replaceText(i),r.smartBackspace){var a=r.strings[r.arrayPos+1];r.stopNum=a&&i===a.substring(0,s)?s:0}s>r.stopNum?(s--,r.backspace(n,s)):s<=r.stopNum&&(r.arrayPos++,r.arrayPos===r.strings.length?(r.arrayPos=0,r.options.onLastStringBackspaced(),r.shuffleStringsIfNeeded(),r.begin()):r.typewrite(r.strings[r.sequence[r.arrayPos]],s))},o)}else this.setPauseStatus(n,s,!1)},e.complete=function(){this.options.onComplete(this),this.loop?this.curLoop++:this.typingComplete=!0},e.setPauseStatus=function(n,s,r){this.pause.typewrite=r,this.pause.curString=n,this.pause.curStrPos=s},e.toggleBlinking=function(n){this.cursor&&(this.pause.status||this.cursorBlinking!==n&&(this.cursorBlinking=n,n?this.cursor.classList.add("typed-cursor--blink"):this.cursor.classList.remove("typed-cursor--blink")))},e.humanizer=function(n){return Math.round(Math.random()*n/2)+n},e.shuffleStringsIfNeeded=function(){this.shuffle&&(this.sequence=this.sequence.sort(function(){return Math.random()-.5}))},e.initFadeOut=function(){var n=this;return this.el.className+=" "+this.fadeOutClass,this.cursor&&(this.cursor.className+=" "+this.fadeOutClass),setTimeout(function(){n.arrayPos++,n.replaceText(""),n.strings.length>n.arrayPos?n.typewrite(n.strings[n.sequence[n.arrayPos]],0):(n.typewrite(n.strings[0],0),n.arrayPos=0)},this.fadeOutDelay)},e.replaceText=function(n){this.attr?this.el.setAttribute(this.attr,n):this.isInput?this.el.value=n:this.contentType==="html"?this.el.innerHTML=n:this.el.textContent=n},e.bindFocusEvents=function(){var n=this;this.isInput&&(this.el.addEventListener("focus",function(s){n.stop()}),this.el.addEventListener("blur",function(s){n.el.value&&n.el.value.length!==0||n.start()}))},e.insertCursor=function(){this.showCursor&&(this.cursor||(this.cursor=document.createElement("span"),this.cursor.className="typed-cursor",this.cursor.setAttribute("aria-hidden",!0),this.cursor.innerHTML=this.cursorChar,this.el.parentNode&&this.el.parentNode.insertBefore(this.cursor,this.el.nextSibling)))},t}();const SY=R.memo(({style:t,className:e,typedRef:n,parseRef:s,stopped:r,children:o,startWhenVisible:i,...a})=>{const l=R.useRef(null),u=R.useMemo(()=>{var d;return[...Object.values(a).filter(h=>typeof h=="boolean"||typeof h=="number"||typeof h=="string"),(d=a.strings)==null?void 0:d.join(",")]},[a]);R.useEffect(()=>{const d=s&&s(l)||l.current,h=new wY(d,{...a});if((r||i)&&(h==null||h.stop()),i){const f=new IntersectionObserver(([p])=>{p.isIntersecting&&(h==null||h.start(),f.disconnect())});f.observe(d)}return n&&h&&n(h),()=>{h.destroy()}},u);const c=o?lt.cloneElement(o,{ref:l}):lt.createElement("span",{style:t,ref:l});return lt.createElement("span",{style:t,className:e,"data-testid":"react-typed"},c)}),kY=()=>{const[t,e]=R.useState(!1),[n,s]=R.useState([]),[r,o]=R.useState(""),i=R.useRef(null),a=R.useRef(null),l=()=>{e(!t),!t&&i.current&&i.current.focus()},u=h=>{o(h.target.value)},c=async()=>{if(r.trim()==="")return;const h={sender:"user",text:r};s(f=>[...f,h]),o("");try{const p={sender:"bot",text:await bY(r)};s(m=>[...m,p])}catch(f){console.error("OpenAI API    :",f),s(p=>[...p,{sender:"bot",text:" .  ."}])}},d=h=>{h.key==="Enter"&&(h.preventDefault(),c())};return R.useEffect(()=>{const h=f=>{a.current&&!a.current.contains(f.target)&&e(!1)};return document.addEventListener("mousedown",h),()=>{document.removeEventListener("mousedown",h)}},[a]),se.jsxs("div",{className:"relative",children:[se.jsx("button",{onClick:l,className:"fixed bottom-4 right-4 bg-blue-500 text-white p-3 rounded-full shadow-lg",children:t?"":" "}),t&&se.jsxs("div",{ref:a,className:"fixed bottom-16 right-4 w-full h-[400px] md:h-[500px] max-w-xs bg-white shadow-lg border border-gray-300 rounded-lg flex flex-col",children:[se.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:n.map((h,f)=>se.jsx("div",{className:`mb-2 ${h.sender==="user"?"text-right":"text-left"}`,children:se.jsx("span",{className:`inline-block p-2 rounded-lg ${h.sender==="user"?"bg-blue-500 text-white":"bg-gray-200 text-black"}`,children:h.sender==="bot"?se.jsx(SY,{strings:[h.text],typeSpeed:40,showCursor:!1}):h.text})},f))}),se.jsxs("div",{className:"p-2 border-t border-gray-300",children:[se.jsx("input",{type:"text",value:r,onChange:u,onKeyDown:d,className:"w-full p-2 border rounded-lg",placeholder:" ...",ref:i}),se.jsx("button",{onClick:c,className:"mt-2 w-full bg-blue-500 text-white p-2 rounded-lg",children:""})]})]})]})};function CY(){return se.jsx("div",{className:"flex-1 flex-col w-full flex justify-center",children:se.jsx("main",{className:"max-w-[430px] w-full bg-white  relative mx-auto",children:se.jsx("div",{className:"relative w-full h-screen overflow-hidden",children:se.jsx(kY,{})})})})}function Yn(){return Yn=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Yn.apply(this,arguments)}function fr(t,e,{checkForDefaultPrevented:n=!0}={}){return function(r){if(t==null||t(r),n===!1||!r.defaultPrevented)return e==null?void 0:e(r)}}function NY(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function RL(...t){return e=>t.forEach(n=>NY(n,e))}function tu(...t){return R.useCallback(RL(...t),t)}function _L(t,e=[]){let n=[];function s(o,i){const a=R.createContext(i),l=n.length;n=[...n,i];function u(d){const{scope:h,children:f,...p}=d,m=(h==null?void 0:h[t][l])||a,g=R.useMemo(()=>p,Object.values(p));return R.createElement(m.Provider,{value:g},f)}function c(d,h){const f=(h==null?void 0:h[t][l])||a,p=R.useContext(f);if(p)return p;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${o}\``)}return u.displayName=o+"Provider",[u,c]}const r=()=>{const o=n.map(i=>R.createContext(i));return function(a){const l=(a==null?void 0:a[t])||o;return R.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return r.scopeName=t,[s,TY(r,...e)]}function TY(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const s=t.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(o){const i=s.reduce((a,{useScope:l,scopeName:u})=>{const d=l(o)[`__scope${u}`];return{...a,...d}},{});return R.useMemo(()=>({[`__scope${e.scopeName}`]:i}),[i])}};return n.scopeName=e.scopeName,n}const E0=R.forwardRef((t,e)=>{const{children:n,...s}=t,r=R.Children.toArray(n),o=r.find(IY);if(o){const i=o.props.children,a=r.map(l=>l===o?R.Children.count(i)>1?R.Children.only(null):R.isValidElement(i)?i.props.children:null:l);return R.createElement(ak,Yn({},s,{ref:e}),R.isValidElement(i)?R.cloneElement(i,void 0,a):null)}return R.createElement(ak,Yn({},s,{ref:e}),n)});E0.displayName="Slot";const ak=R.forwardRef((t,e)=>{const{children:n,...s}=t;return R.isValidElement(n)?R.cloneElement(n,{...EY(s,n.props),ref:e?RL(e,n.ref):n.ref}):R.Children.count(n)>1?R.Children.only(null):null});ak.displayName="SlotClone";const $Y=({children:t})=>R.createElement(R.Fragment,null,t);function IY(t){return R.isValidElement(t)&&t.type===$Y}function EY(t,e){const n={...e};for(const s in e){const r=t[s],o=e[s];/^on[A-Z]/.test(s)?r&&o?n[s]=(...a)=>{o(...a),r(...a)}:r&&(n[s]=r):s==="style"?n[s]={...r,...o}:s==="className"&&(n[s]=[r,o].filter(Boolean).join(" "))}return{...t,...n}}function RY(t){const e=t+"CollectionProvider",[n,s]=_L(e),[r,o]=n(e,{collectionRef:{current:null},itemMap:new Map}),i=f=>{const{scope:p,children:m}=f,g=lt.useRef(null),y=lt.useRef(new Map).current;return lt.createElement(r,{scope:p,itemMap:y,collectionRef:g},m)},a=t+"CollectionSlot",l=lt.forwardRef((f,p)=>{const{scope:m,children:g}=f,y=o(a,m),b=tu(p,y.collectionRef);return lt.createElement(E0,{ref:b},g)}),u=t+"CollectionItemSlot",c="data-radix-collection-item",d=lt.forwardRef((f,p)=>{const{scope:m,children:g,...y}=f,b=lt.useRef(null),v=tu(p,b),x=o(u,m);return lt.useEffect(()=>(x.itemMap.set(b,{ref:b,...y}),()=>void x.itemMap.delete(b))),lt.createElement(E0,{[c]:"",ref:v},g)});function h(f){const p=o(t+"CollectionConsumer",f);return lt.useCallback(()=>{const g=p.collectionRef.current;if(!g)return[];const y=Array.from(g.querySelectorAll(`[${c}]`));return Array.from(p.itemMap.values()).sort((x,w)=>y.indexOf(x.ref.current)-y.indexOf(w.ref.current))},[p.collectionRef,p.itemMap])}return[{Provider:i,Slot:l,ItemSlot:d},h,s]}const _Y=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],oi=_Y.reduce((t,e)=>{const n=R.forwardRef((s,r)=>{const{asChild:o,...i}=s,a=o?E0:e;return R.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),R.createElement(a,Yn({},i,{ref:r}))});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function AL(t,e){t&&vd.flushSync(()=>t.dispatchEvent(e))}function Ti(t){const e=R.useRef(t);return R.useEffect(()=>{e.current=t}),R.useMemo(()=>(...n)=>{var s;return(s=e.current)===null||s===void 0?void 0:s.call(e,...n)},[])}function AY(t,e=globalThis==null?void 0:globalThis.document){const n=Ti(t);R.useEffect(()=>{const s=r=>{r.key==="Escape"&&n(r)};return e.addEventListener("keydown",s),()=>e.removeEventListener("keydown",s)},[n,e])}const lk="dismissableLayer.update",DY="dismissableLayer.pointerDownOutside",OY="dismissableLayer.focusOutside";let X2;const DL=R.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),FY=R.forwardRef((t,e)=>{var n;const{disableOutsidePointerEvents:s=!1,onEscapeKeyDown:r,onPointerDownOutside:o,onFocusOutside:i,onInteractOutside:a,onDismiss:l,...u}=t,c=R.useContext(DL),[d,h]=R.useState(null),f=(n=d==null?void 0:d.ownerDocument)!==null&&n!==void 0?n:globalThis==null?void 0:globalThis.document,[,p]=R.useState({}),m=tu(e,N=>h(N)),g=Array.from(c.layers),[y]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),b=g.indexOf(y),v=d?g.indexOf(d):-1,x=c.layersWithOutsidePointerEventsDisabled.size>0,w=v>=b,S=PY(N=>{const I=N.target,E=[...c.branches].some(A=>A.contains(I));!w||E||(o==null||o(N),a==null||a(N),N.defaultPrevented||l==null||l())},f),C=MY(N=>{const I=N.target;[...c.branches].some(A=>A.contains(I))||(i==null||i(N),a==null||a(N),N.defaultPrevented||l==null||l())},f);return AY(N=>{v===c.layers.size-1&&(r==null||r(N),!N.defaultPrevented&&l&&(N.preventDefault(),l()))},f),R.useEffect(()=>{if(d)return s&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(X2=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),Y2(),()=>{s&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=X2)}},[d,f,s,c]),R.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),Y2())},[d,c]),R.useEffect(()=>{const N=()=>p({});return document.addEventListener(lk,N),()=>document.removeEventListener(lk,N)},[]),R.createElement(oi.div,Yn({},u,{ref:m,style:{pointerEvents:x?w?"auto":"none":void 0,...t.style},onFocusCapture:fr(t.onFocusCapture,C.onFocusCapture),onBlurCapture:fr(t.onBlurCapture,C.onBlurCapture),onPointerDownCapture:fr(t.onPointerDownCapture,S.onPointerDownCapture)}))}),LY=R.forwardRef((t,e)=>{const n=R.useContext(DL),s=R.useRef(null),r=tu(e,s);return R.useEffect(()=>{const o=s.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),R.createElement(oi.div,Yn({},t,{ref:r}))});function PY(t,e=globalThis==null?void 0:globalThis.document){const n=Ti(t),s=R.useRef(!1),r=R.useRef(()=>{});return R.useEffect(()=>{const o=a=>{if(a.target&&!s.current){let c=function(){OL(DY,n,u,{discrete:!0})};var l=c;const u={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=c,e.addEventListener("click",r.current,{once:!0})):c()}else e.removeEventListener("click",r.current);s.current=!1},i=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(i),e.removeEventListener("pointerdown",o),e.removeEventListener("click",r.current)}},[e,n]),{onPointerDownCapture:()=>s.current=!0}}function MY(t,e=globalThis==null?void 0:globalThis.document){const n=Ti(t),s=R.useRef(!1);return R.useEffect(()=>{const r=o=>{o.target&&!s.current&&OL(OY,n,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,n]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function Y2(){const t=new CustomEvent(lk);document.dispatchEvent(t)}function OL(t,e,n,{discrete:s}){const r=n.originalEvent.target,o=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),s?AL(r,o):r.dispatchEvent(o)}const zY=FY,BY=LY,VY=R.forwardRef((t,e)=>{var n;const{container:s=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...r}=t;return s?uN.createPortal(R.createElement(oi.div,Yn({},r,{ref:e})),s):null}),uk=globalThis!=null&&globalThis.document?R.useLayoutEffect:()=>{};function UY(t,e){return R.useReducer((n,s)=>{const r=e[n][s];return r??n},t)}const FL=t=>{const{present:e,children:n}=t,s=WY(e),r=typeof n=="function"?n({present:s.isPresent}):R.Children.only(n),o=tu(s.ref,r.ref);return typeof n=="function"||s.isPresent?R.cloneElement(r,{ref:o}):null};FL.displayName="Presence";function WY(t){const[e,n]=R.useState(),s=R.useRef({}),r=R.useRef(t),o=R.useRef("none"),i=t?"mounted":"unmounted",[a,l]=UY(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return R.useEffect(()=>{const u=cy(s.current);o.current=a==="mounted"?u:"none"},[a]),uk(()=>{const u=s.current,c=r.current;if(c!==t){const h=o.current,f=cy(u);t?l("MOUNT"):f==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(c&&h!==f?"ANIMATION_OUT":"UNMOUNT"),r.current=t}},[t,l]),uk(()=>{if(e){const u=d=>{const f=cy(s.current).includes(d.animationName);d.target===e&&f&&vd.flushSync(()=>l("ANIMATION_END"))},c=d=>{d.target===e&&(o.current=cy(s.current))};return e.addEventListener("animationstart",c),e.addEventListener("animationcancel",u),e.addEventListener("animationend",u),()=>{e.removeEventListener("animationstart",c),e.removeEventListener("animationcancel",u),e.removeEventListener("animationend",u)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:R.useCallback(u=>{u&&(s.current=getComputedStyle(u)),n(u)},[])}}function cy(t){return(t==null?void 0:t.animationName)||"none"}function jY({prop:t,defaultProp:e,onChange:n=()=>{}}){const[s,r]=GY({defaultProp:e,onChange:n}),o=t!==void 0,i=o?t:s,a=Ti(n),l=R.useCallback(u=>{if(o){const d=typeof u=="function"?u(t):u;d!==t&&a(d)}else r(u)},[o,t,r,a]);return[i,l]}function GY({defaultProp:t,onChange:e}){const n=R.useState(t),[s]=n,r=R.useRef(s),o=Ti(e);return R.useEffect(()=>{r.current!==s&&(o(s),r.current=s)},[s,r,o]),n}const LL=R.forwardRef((t,e)=>R.createElement(oi.span,Yn({},t,{ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}))),PL="ToastProvider",[ON,HY,qY]=RY("Toast"),[ML,GEe]=_L("Toast",[qY]),[KY,tv]=ML(PL),zL=t=>{const{__scopeToast:e,label:n="Notification",duration:s=5e3,swipeDirection:r="right",swipeThreshold:o=50,children:i}=t,[a,l]=R.useState(null),[u,c]=R.useState(0),d=R.useRef(!1),h=R.useRef(!1);return R.createElement(ON.Provider,{scope:e},R.createElement(KY,{scope:e,label:n,duration:s,swipeDirection:r,swipeThreshold:o,toastCount:u,viewport:a,onViewportChange:l,onToastAdd:R.useCallback(()=>c(f=>f+1),[]),onToastRemove:R.useCallback(()=>c(f=>f-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h},i))};zL.propTypes={label(t){if(t.label&&typeof t.label=="string"&&!t.label.trim()){const e=`Invalid prop \`label\` supplied to \`${PL}\`. Expected non-empty \`string\`.`;return new Error(e)}return null}};const XY="ToastViewport",YY=["F8"],ck="toast.viewportPause",dk="toast.viewportResume",QY=R.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:s=YY,label:r="Notifications ({hotkey})",...o}=t,i=tv(XY,n),a=HY(n),l=R.useRef(null),u=R.useRef(null),c=R.useRef(null),d=R.useRef(null),h=tu(e,d,i.onViewportChange),f=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=i.toastCount>0;R.useEffect(()=>{const g=y=>{var b;s.every(x=>y[x]||y.code===x)&&((b=d.current)===null||b===void 0||b.focus())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[s]),R.useEffect(()=>{const g=l.current,y=d.current;if(p&&g&&y){const b=()=>{if(!i.isClosePausedRef.current){const S=new CustomEvent(ck);y.dispatchEvent(S),i.isClosePausedRef.current=!0}},v=()=>{if(i.isClosePausedRef.current){const S=new CustomEvent(dk);y.dispatchEvent(S),i.isClosePausedRef.current=!1}},x=S=>{!g.contains(S.relatedTarget)&&v()},w=()=>{g.contains(document.activeElement)||v()};return g.addEventListener("focusin",b),g.addEventListener("focusout",x),g.addEventListener("pointermove",b),g.addEventListener("pointerleave",w),window.addEventListener("blur",b),window.addEventListener("focus",v),()=>{g.removeEventListener("focusin",b),g.removeEventListener("focusout",x),g.removeEventListener("pointermove",b),g.removeEventListener("pointerleave",w),window.removeEventListener("blur",b),window.removeEventListener("focus",v)}}},[p,i.isClosePausedRef]);const m=R.useCallback(({tabbingDirection:g})=>{const b=a().map(v=>{const x=v.ref.current,w=[x,...fQ(x)];return g==="forwards"?w:w.reverse()});return(g==="forwards"?b.reverse():b).flat()},[a]);return R.useEffect(()=>{const g=d.current;if(g){const y=b=>{const v=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!v){const N=document.activeElement,I=b.shiftKey;if(b.target===g&&I){var w;(w=u.current)===null||w===void 0||w.focus();return}const z=m({tabbingDirection:I?"backwards":"forwards"}),V=z.findIndex(P=>P===N);if(p1(z.slice(V+1)))b.preventDefault();else{var S,C;I?(S=u.current)===null||S===void 0||S.focus():(C=c.current)===null||C===void 0||C.focus()}}};return g.addEventListener("keydown",y),()=>g.removeEventListener("keydown",y)}},[a,m]),R.createElement(BY,{ref:l,role:"region","aria-label":r.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:p?void 0:"none"}},p&&R.createElement(Q2,{ref:u,onFocusFromOutsideViewport:()=>{const g=m({tabbingDirection:"forwards"});p1(g)}}),R.createElement(ON.Slot,{scope:n},R.createElement(oi.ol,Yn({tabIndex:-1},o,{ref:h}))),p&&R.createElement(Q2,{ref:c,onFocusFromOutsideViewport:()=>{const g=m({tabbingDirection:"backwards"});p1(g)}}))}),ZY="ToastFocusProxy",Q2=R.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:s,...r}=t,o=tv(ZY,n);return R.createElement(LL,Yn({"aria-hidden":!0,tabIndex:0},r,{ref:e,style:{position:"fixed"},onFocus:i=>{var a;const l=i.relatedTarget;!((a=o.viewport)!==null&&a!==void 0&&a.contains(l))&&s()}}))}),nv="Toast",JY="toast.swipeStart",eQ="toast.swipeMove",tQ="toast.swipeCancel",nQ="toast.swipeEnd",sQ=R.forwardRef((t,e)=>{const{forceMount:n,open:s,defaultOpen:r,onOpenChange:o,...i}=t,[a=!0,l]=jY({prop:s,defaultProp:r,onChange:o});return R.createElement(FL,{present:n||a},R.createElement(BL,Yn({open:a},i,{ref:e,onClose:()=>l(!1),onPause:Ti(t.onPause),onResume:Ti(t.onResume),onSwipeStart:fr(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:fr(t.onSwipeMove,u=>{const{x:c,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${c}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:fr(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:fr(t.onSwipeEnd,u=>{const{x:c,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${c}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})))}),[rQ,oQ]=ML(nv,{onClose(){}}),BL=R.forwardRef((t,e)=>{const{__scopeToast:n,type:s="foreground",duration:r,open:o,onClose:i,onEscapeKeyDown:a,onPause:l,onResume:u,onSwipeStart:c,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:f,...p}=t,m=tv(nv,n),[g,y]=R.useState(null),b=tu(e,P=>y(P)),v=R.useRef(null),x=R.useRef(null),w=r||m.duration,S=R.useRef(0),C=R.useRef(w),N=R.useRef(0),{onToastAdd:I,onToastRemove:E}=m,A=Ti(()=>{var P;(g==null?void 0:g.contains(document.activeElement))&&((P=m.viewport)===null||P===void 0||P.focus()),i()}),z=R.useCallback(P=>{!P||P===1/0||(window.clearTimeout(N.current),S.current=new Date().getTime(),N.current=window.setTimeout(A,P))},[A]);R.useEffect(()=>{const P=m.viewport;if(P){const K=()=>{z(C.current),u==null||u()},Y=()=>{const te=new Date().getTime()-S.current;C.current=C.current-te,window.clearTimeout(N.current),l==null||l()};return P.addEventListener(ck,Y),P.addEventListener(dk,K),()=>{P.removeEventListener(ck,Y),P.removeEventListener(dk,K)}}},[m.viewport,w,l,u,z]),R.useEffect(()=>{o&&!m.isClosePausedRef.current&&z(w)},[o,w,m.isClosePausedRef,z]),R.useEffect(()=>(I(),()=>E()),[I,E]);const V=R.useMemo(()=>g?jL(g):null,[g]);return m.viewport?R.createElement(R.Fragment,null,V&&R.createElement(iQ,{__scopeToast:n,role:"status","aria-live":s==="foreground"?"assertive":"polite","aria-atomic":!0},V),R.createElement(rQ,{scope:n,onClose:A},vd.createPortal(R.createElement(ON.ItemSlot,{scope:n},R.createElement(zY,{asChild:!0,onEscapeKeyDown:fr(a,()=>{m.isFocusedToastEscapeKeyDownRef.current||A(),m.isFocusedToastEscapeKeyDownRef.current=!1})},R.createElement(oi.li,Yn({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":m.swipeDirection},p,{ref:b,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:fr(t.onKeyDown,P=>{P.key==="Escape"&&(a==null||a(P.nativeEvent),P.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,A()))}),onPointerDown:fr(t.onPointerDown,P=>{P.button===0&&(v.current={x:P.clientX,y:P.clientY})}),onPointerMove:fr(t.onPointerMove,P=>{if(!v.current)return;const K=P.clientX-v.current.x,Y=P.clientY-v.current.y,te=!!x.current,F=["left","right"].includes(m.swipeDirection),j=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,q=F?j(0,K):0,J=F?0:j(0,Y),_=P.pointerType==="touch"?10:2,W={x:q,y:J},Z={originalEvent:P,delta:W};te?(x.current=W,dy(eQ,d,Z,{discrete:!1})):Z2(W,m.swipeDirection,_)?(x.current=W,dy(JY,c,Z,{discrete:!1}),P.target.setPointerCapture(P.pointerId)):(Math.abs(K)>_||Math.abs(Y)>_)&&(v.current=null)}),onPointerUp:fr(t.onPointerUp,P=>{const K=x.current,Y=P.target;if(Y.hasPointerCapture(P.pointerId)&&Y.releasePointerCapture(P.pointerId),x.current=null,v.current=null,K){const te=P.currentTarget,F={originalEvent:P,delta:K};Z2(K,m.swipeDirection,m.swipeThreshold)?dy(nQ,f,F,{discrete:!0}):dy(tQ,h,F,{discrete:!0}),te.addEventListener("click",j=>j.preventDefault(),{once:!0})}})})))),m.viewport))):null});BL.propTypes={type(t){if(t.type&&!["foreground","background"].includes(t.type)){const e=`Invalid prop \`type\` supplied to \`${nv}\`. Expected \`foreground | background\`.`;return new Error(e)}return null}};const iQ=t=>{const{__scopeToast:e,children:n,...s}=t,r=tv(nv,e),[o,i]=R.useState(!1),[a,l]=R.useState(!1);return dQ(()=>i(!0)),R.useEffect(()=>{const u=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(u)},[]),a?null:R.createElement(VY,{asChild:!0},R.createElement(LL,s,o&&R.createElement(R.Fragment,null,r.label," ",n)))},aQ=R.forwardRef((t,e)=>{const{__scopeToast:n,...s}=t;return R.createElement(oi.div,Yn({},s,{ref:e}))}),lQ=R.forwardRef((t,e)=>{const{__scopeToast:n,...s}=t;return R.createElement(oi.div,Yn({},s,{ref:e}))}),uQ="ToastAction",VL=R.forwardRef((t,e)=>{const{altText:n,...s}=t;return n?R.createElement(WL,{altText:n,asChild:!0},R.createElement(UL,Yn({},s,{ref:e}))):null});VL.propTypes={altText(t){return t.altText?null:new Error(`Missing prop \`altText\` expected on \`${uQ}\``)}};const cQ="ToastClose",UL=R.forwardRef((t,e)=>{const{__scopeToast:n,...s}=t,r=oQ(cQ,n);return R.createElement(WL,{asChild:!0},R.createElement(oi.button,Yn({type:"button"},s,{ref:e,onClick:fr(t.onClick,r.onClose)})))}),WL=R.forwardRef((t,e)=>{const{__scopeToast:n,altText:s,...r}=t;return R.createElement(oi.div,Yn({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":s||void 0},r,{ref:e}))});function jL(t){const e=[];return Array.from(t.childNodes).forEach(s=>{if(s.nodeType===s.TEXT_NODE&&s.textContent&&e.push(s.textContent),hQ(s)){const r=s.ariaHidden||s.hidden||s.style.display==="none",o=s.dataset.radixToastAnnounceExclude==="";if(!r)if(o){const i=s.dataset.radixToastAnnounceAlt;i&&e.push(i)}else e.push(...jL(s))}}),e}function dy(t,e,n,{discrete:s}){const r=n.originalEvent.currentTarget,o=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&r.addEventListener(t,e,{once:!0}),s?AL(r,o):r.dispatchEvent(o)}const Z2=(t,e,n=0)=>{const s=Math.abs(t.x),r=Math.abs(t.y),o=s>r;return e==="left"||e==="right"?o&&s>n:!o&&r>n};function dQ(t=()=>{}){const e=Ti(t);uk(()=>{let n=0,s=0;return n=window.requestAnimationFrame(()=>s=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(s)}},[e])}function hQ(t){return t.nodeType===t.ELEMENT_NODE}function fQ(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const r=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||r?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function p1(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}const pQ=zL,GL=QY,HL=sQ,qL=aQ,KL=lQ,XL=VL,YL=UL;function QL(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=QL(t[e]))&&(s&&(s+=" "),s+=n);else for(e in t)t[e]&&(s&&(s+=" "),s+=e);return s}function mQ(){for(var t,e,n=0,s="";n<arguments.length;)(t=arguments[n++])&&(e=QL(t))&&(s&&(s+=" "),s+=e);return s}const J2=t=>typeof t=="boolean"?"".concat(t):t===0?"0":t,eR=mQ,gQ=(t,e)=>n=>{var s;if((e==null?void 0:e.variants)==null)return eR(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:r,defaultVariants:o}=e,i=Object.keys(r).map(u=>{const c=n==null?void 0:n[u],d=o==null?void 0:o[u];if(c===null)return null;const h=J2(c)||J2(d);return r[u][h]}),a=n&&Object.entries(n).reduce((u,c)=>{let[d,h]=c;return h===void 0||(u[d]=h),u},{}),l=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((u,c)=>{let{class:d,className:h,...f}=c;return Object.entries(f).every(p=>{let[m,g]=p;return Array.isArray(g)?g.includes({...o,...a}[m]):{...o,...a}[m]===g})?[...u,d,h]:u},[]);return eR(t,i,l,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.360.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var yQ={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.360.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bQ=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.360.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vQ=(t,e)=>{const n=R.forwardRef(({color:s="currentColor",size:r=24,strokeWidth:o=2,absoluteStrokeWidth:i,className:a="",children:l,...u},c)=>R.createElement("svg",{ref:c,...yQ,width:r,height:r,stroke:s,strokeWidth:i?Number(o)*24/Number(r):o,className:["lucide",`lucide-${bQ(t)}`,a].join(" "),...u},[...e.map(([d,h])=>R.createElement(d,h)),...Array.isArray(l)?l:[l]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.360.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xQ=vQ("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function ZL(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=ZL(t[e]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}function wQ(){for(var t,e,n=0,s="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=ZL(t))&&(s&&(s+=" "),s+=e);return s}const FN="-";function SQ(t){const e=CQ(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=t;function r(i){const a=i.split(FN);return a[0]===""&&a.length!==1&&a.shift(),JL(a,e)||kQ(i)}function o(i,a){const l=n[i]||[];return a&&s[i]?[...l,...s[i]]:l}return{getClassGroupId:r,getConflictingClassGroupIds:o}}function JL(t,e){var i;if(t.length===0)return e.classGroupId;const n=t[0],s=e.nextPart.get(n),r=s?JL(t.slice(1),s):void 0;if(r)return r;if(e.validators.length===0)return;const o=t.join(FN);return(i=e.validators.find(({validator:a})=>a(o)))==null?void 0:i.classGroupId}const tR=/^\[(.+)\]$/;function kQ(t){if(tR.test(t)){const e=tR.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}}function CQ(t){const{theme:e,prefix:n}=t,s={nextPart:new Map,validators:[]};return TQ(Object.entries(t.classGroups),n).forEach(([o,i])=>{hk(i,s,o,e)}),s}function hk(t,e,n,s){t.forEach(r=>{if(typeof r=="string"){const o=r===""?e:nR(e,r);o.classGroupId=n;return}if(typeof r=="function"){if(NQ(r)){hk(r(s),e,n,s);return}e.validators.push({validator:r,classGroupId:n});return}Object.entries(r).forEach(([o,i])=>{hk(i,nR(e,o),n,s)})})}function nR(t,e){let n=t;return e.split(FN).forEach(s=>{n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n}function NQ(t){return t.isThemeGetter}function TQ(t,e){return e?t.map(([n,s])=>{const r=s.map(o=>typeof o=="string"?e+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([i,a])=>[e+i,a])):o);return[n,r]}):t}function $Q(t){if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,s=new Map;function r(o,i){n.set(o,i),e++,e>t&&(e=0,s=n,n=new Map)}return{get(o){let i=n.get(o);if(i!==void 0)return i;if((i=s.get(o))!==void 0)return r(o,i),i},set(o,i){n.has(o)?n.set(o,i):r(o,i)}}}const eP="!";function IQ(t){const e=t.separator,n=e.length===1,s=e[0],r=e.length;return function(i){const a=[];let l=0,u=0,c;for(let m=0;m<i.length;m++){let g=i[m];if(l===0){if(g===s&&(n||i.slice(m,m+r)===e)){a.push(i.slice(u,m)),u=m+r;continue}if(g==="/"){c=m;continue}}g==="["?l++:g==="]"&&l--}const d=a.length===0?i:i.substring(u),h=d.startsWith(eP),f=h?d.substring(1):d,p=c&&c>u?c-u:void 0;return{modifiers:a,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:p}}}function EQ(t){if(t.length<=1)return t;const e=[];let n=[];return t.forEach(s=>{s[0]==="["?(e.push(...n.sort(),s),n=[]):n.push(s)}),e.push(...n.sort()),e}function RQ(t){return{cache:$Q(t.cacheSize),splitModifiers:IQ(t),...SQ(t)}}const _Q=/\s+/;function AQ(t,e){const{splitModifiers:n,getClassGroupId:s,getConflictingClassGroupIds:r}=e,o=new Set;return t.trim().split(_Q).map(i=>{const{modifiers:a,hasImportantModifier:l,baseClassName:u,maybePostfixModifierPosition:c}=n(i);let d=s(c?u.substring(0,c):u),h=!!c;if(!d){if(!c)return{isTailwindClass:!1,originalClassName:i};if(d=s(u),!d)return{isTailwindClass:!1,originalClassName:i};h=!1}const f=EQ(a).join(":");return{isTailwindClass:!0,modifierId:l?f+eP:f,classGroupId:d,originalClassName:i,hasPostfixModifier:h}}).reverse().filter(i=>{if(!i.isTailwindClass)return!0;const{modifierId:a,classGroupId:l,hasPostfixModifier:u}=i,c=a+l;return o.has(c)?!1:(o.add(c),r(l,u).forEach(d=>o.add(a+d)),!0)}).reverse().map(i=>i.originalClassName).join(" ")}function DQ(){let t=0,e,n,s="";for(;t<arguments.length;)(e=arguments[t++])&&(n=tP(e))&&(s&&(s+=" "),s+=n);return s}function tP(t){if(typeof t=="string")return t;let e,n="";for(let s=0;s<t.length;s++)t[s]&&(e=tP(t[s]))&&(n&&(n+=" "),n+=e);return n}function OQ(t,...e){let n,s,r,o=i;function i(l){const u=e.reduce((c,d)=>d(c),t());return n=RQ(u),s=n.cache.get,r=n.cache.set,o=a,a(l)}function a(l){const u=s(l);if(u)return u;const c=AQ(l,n);return r(l,c),c}return function(){return o(DQ.apply(null,arguments))}}function Bt(t){const e=n=>n[t]||[];return e.isThemeGetter=!0,e}const nP=/^\[(?:([a-z-]+):)?(.+)\]$/i,FQ=/^\d+\/\d+$/,LQ=new Set(["px","full","screen"]),PQ=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,MQ=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,zQ=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,BQ=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,VQ=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/;function li(t){return El(t)||LQ.has(t)||FQ.test(t)}function Zi(t){return kd(t,"length",XQ)}function El(t){return!!t&&!Number.isNaN(Number(t))}function hy(t){return kd(t,"number",El)}function nf(t){return!!t&&Number.isInteger(Number(t))}function UQ(t){return t.endsWith("%")&&El(t.slice(0,-1))}function tt(t){return nP.test(t)}function Ji(t){return PQ.test(t)}const WQ=new Set(["length","size","percentage"]);function jQ(t){return kd(t,WQ,sP)}function GQ(t){return kd(t,"position",sP)}const HQ=new Set(["image","url"]);function qQ(t){return kd(t,HQ,QQ)}function KQ(t){return kd(t,"",YQ)}function sf(){return!0}function kd(t,e,n){const s=nP.exec(t);return s?s[1]?typeof e=="string"?s[1]===e:e.has(s[1]):n(s[2]):!1}function XQ(t){return MQ.test(t)&&!zQ.test(t)}function sP(){return!1}function YQ(t){return BQ.test(t)}function QQ(t){return VQ.test(t)}function ZQ(){const t=Bt("colors"),e=Bt("spacing"),n=Bt("blur"),s=Bt("brightness"),r=Bt("borderColor"),o=Bt("borderRadius"),i=Bt("borderSpacing"),a=Bt("borderWidth"),l=Bt("contrast"),u=Bt("grayscale"),c=Bt("hueRotate"),d=Bt("invert"),h=Bt("gap"),f=Bt("gradientColorStops"),p=Bt("gradientColorStopPositions"),m=Bt("inset"),g=Bt("margin"),y=Bt("opacity"),b=Bt("padding"),v=Bt("saturate"),x=Bt("scale"),w=Bt("sepia"),S=Bt("skew"),C=Bt("space"),N=Bt("translate"),I=()=>["auto","contain","none"],E=()=>["auto","hidden","clip","visible","scroll"],A=()=>["auto",tt,e],z=()=>[tt,e],V=()=>["",li,Zi],P=()=>["auto",El,tt],K=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Y=()=>["solid","dashed","dotted","double","none"],te=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"],F=()=>["start","end","center","between","around","evenly","stretch"],j=()=>["","0",tt],q=()=>["auto","avoid","all","avoid-page","page","left","right","column"],J=()=>[El,hy],_=()=>[El,tt];return{cacheSize:500,separator:":",theme:{colors:[sf],spacing:[li,Zi],blur:["none","",Ji,tt],brightness:J(),borderColor:[t],borderRadius:["none","","full",Ji,tt],borderSpacing:z(),borderWidth:V(),contrast:J(),grayscale:j(),hueRotate:_(),invert:j(),gap:z(),gradientColorStops:[t],gradientColorStopPositions:[UQ,Zi],inset:A(),margin:A(),opacity:J(),padding:z(),saturate:J(),scale:J(),sepia:j(),skew:_(),space:z(),translate:z()},classGroups:{aspect:[{aspect:["auto","square","video",tt]}],container:["container"],columns:[{columns:[Ji]}],"break-after":[{"break-after":q()}],"break-before":[{"break-before":q()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...K(),tt]}],overflow:[{overflow:E()}],"overflow-x":[{"overflow-x":E()}],"overflow-y":[{"overflow-y":E()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",nf,tt]}],basis:[{basis:A()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",tt]}],grow:[{grow:j()}],shrink:[{shrink:j()}],order:[{order:["first","last","none",nf,tt]}],"grid-cols":[{"grid-cols":[sf]}],"col-start-end":[{col:["auto",{span:["full",nf,tt]},tt]}],"col-start":[{"col-start":P()}],"col-end":[{"col-end":P()}],"grid-rows":[{"grid-rows":[sf]}],"row-start-end":[{row:["auto",{span:[nf,tt]},tt]}],"row-start":[{"row-start":P()}],"row-end":[{"row-end":P()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",tt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",tt]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...F()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...F(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...F(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[C]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[C]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",tt,e]}],"min-w":[{"min-w":[tt,e,"min","max","fit"]}],"max-w":[{"max-w":[tt,e,"none","full","min","max","fit","prose",{screen:[Ji]},Ji]}],h:[{h:[tt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[tt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[tt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[tt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Ji,Zi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",hy]}],"font-family":[{font:[sf]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",tt]}],"line-clamp":[{"line-clamp":["none",El,hy]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",li,tt]}],"list-image":[{"list-image":["none",tt]}],"list-style-type":[{list:["none","disc","decimal",tt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Y(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",li,Zi]}],"underline-offset":[{"underline-offset":["auto",li,tt]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:z()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",tt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",tt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...K(),GQ]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",jQ]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},qQ]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...Y(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:Y()}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:["",...Y()]}],"outline-offset":[{"outline-offset":[li,tt]}],"outline-w":[{outline:[li,Zi]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:V()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[li,Zi]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Ji,KQ]}],"shadow-color":[{shadow:[sf]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":te()}],"bg-blend":[{"bg-blend":te()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[s]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Ji,tt]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[d]}],saturate:[{saturate:[v]}],sepia:[{sepia:[w]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[v]}],"backdrop-sepia":[{"backdrop-sepia":[w]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",tt]}],duration:[{duration:_()}],ease:[{ease:["linear","in","out","in-out",tt]}],delay:[{delay:_()}],animate:[{animate:["none","spin","ping","pulse","bounce",tt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[x]}],"scale-x":[{"scale-x":[x]}],"scale-y":[{"scale-y":[x]}],rotate:[{rotate:[nf,tt]}],"translate-x":[{"translate-x":[N]}],"translate-y":[{"translate-y":[N]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",tt]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",tt]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":z()}],"scroll-mx":[{"scroll-mx":z()}],"scroll-my":[{"scroll-my":z()}],"scroll-ms":[{"scroll-ms":z()}],"scroll-me":[{"scroll-me":z()}],"scroll-mt":[{"scroll-mt":z()}],"scroll-mr":[{"scroll-mr":z()}],"scroll-mb":[{"scroll-mb":z()}],"scroll-ml":[{"scroll-ml":z()}],"scroll-p":[{"scroll-p":z()}],"scroll-px":[{"scroll-px":z()}],"scroll-py":[{"scroll-py":z()}],"scroll-ps":[{"scroll-ps":z()}],"scroll-pe":[{"scroll-pe":z()}],"scroll-pt":[{"scroll-pt":z()}],"scroll-pr":[{"scroll-pr":z()}],"scroll-pb":[{"scroll-pb":z()}],"scroll-pl":[{"scroll-pl":z()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",tt]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[li,Zi,hy]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}const JQ=OQ(ZQ);function Jr(...t){return JQ(wQ(t))}const eZ=pQ,rP=R.forwardRef(({className:t,...e},n)=>se.jsx(GL,{ref:n,className:Jr("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));rP.displayName=GL.displayName;const tZ=gQ("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border border-slate-200 p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full dark:border-slate-800",{variants:{variant:{default:"border bg-white text-slate-950 dark:bg-slate-950 dark:text-slate-50",destructive:"destructive group border-red-500 bg-red-500 text-slate-50 dark:border-red-900 dark:bg-red-900 dark:text-slate-50"}},defaultVariants:{variant:"default"}}),oP=R.forwardRef(({className:t,variant:e,...n},s)=>se.jsx(HL,{ref:s,className:Jr(tZ({variant:e}),t),...n}));oP.displayName=HL.displayName;const nZ=R.forwardRef(({className:t,...e},n)=>se.jsx(XL,{ref:n,className:Jr("inline-flex h-8 shrink-0 items-center justify-center rounded-md border border-slate-200 bg-transparent px-3 text-sm font-medium ring-offset-white transition-colors hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-slate-950 focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-slate-100/40 group-[.destructive]:hover:border-red-500/30 group-[.destructive]:hover:bg-red-500 group-[.destructive]:hover:text-slate-50 group-[.destructive]:focus:ring-red-500 dark:border-slate-800 dark:ring-offset-slate-950 dark:hover:bg-slate-800 dark:focus:ring-slate-300 dark:group-[.destructive]:border-slate-800/40 dark:group-[.destructive]:hover:border-red-900/30 dark:group-[.destructive]:hover:bg-red-900 dark:group-[.destructive]:hover:text-slate-50 dark:group-[.destructive]:focus:ring-red-900",t),...e}));nZ.displayName=XL.displayName;const iP=R.forwardRef(({className:t,...e},n)=>se.jsx(YL,{ref:n,className:Jr("absolute right-2 top-2 rounded-md p-1 text-slate-950/50 opacity-0 transition-opacity hover:text-slate-950 focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600 dark:text-slate-50/50 dark:hover:text-slate-50",t),"toast-close":"",...e,children:se.jsx(xQ,{className:"h-4 w-4"})}));iP.displayName=YL.displayName;const aP=R.forwardRef(({className:t,...e},n)=>se.jsx(qL,{ref:n,className:Jr("text-sm font-semibold",t),...e}));aP.displayName=qL.displayName;const lP=R.forwardRef(({className:t,...e},n)=>se.jsx(KL,{ref:n,className:Jr("text-sm opacity-90",t),...e}));lP.displayName=KL.displayName;const sZ=1,rZ=1e6;let m1=0;function oZ(){return m1=(m1+1)%Number.MAX_SAFE_INTEGER,m1.toString()}const g1=new Map,sR=t=>{if(g1.has(t))return;const e=setTimeout(()=>{g1.delete(t),Of({type:"REMOVE_TOAST",toastId:t})},rZ);g1.set(t,e)},iZ=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,sZ)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?sR(n):t.toasts.forEach(s=>{sR(s.id)}),{...t,toasts:t.toasts.map(s=>s.id===n||n===void 0?{...s,open:!1}:s)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},jy=[];let Gy={toasts:[]};function Of(t){Gy=iZ(Gy,t),jy.forEach(e=>{e(Gy)})}function aZ({...t}){const e=oZ(),n=r=>Of({type:"UPDATE_TOAST",toast:{...r,id:e}}),s=()=>Of({type:"DISMISS_TOAST",toastId:e});return Of({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:r=>{r||s()}}}),{id:e,dismiss:s,update:n}}function lZ(){const[t,e]=R.useState(Gy);return R.useEffect(()=>(jy.push(e),()=>{const n=jy.indexOf(e);n>-1&&jy.splice(n,1)}),[t]),{...t,toast:aZ,dismiss:n=>Of({type:"DISMISS_TOAST",toastId:n})}}function uZ(){const{toasts:t}=lZ();return se.jsxs(eZ,{children:[t.map(function({id:e,title:n,description:s,action:r,...o}){return se.jsxs(oP,{...o,children:[se.jsxs("div",{className:"grid gap-1",children:[n&&se.jsx(aP,{children:n}),s&&se.jsx(lP,{children:s})]}),r,se.jsx(iP,{})]},e)}),se.jsx(rP,{})]})}const uP=R.forwardRef(({className:t,...e},n)=>se.jsx("div",{ref:n,className:Jr("rounded-lg border border-slate-200 bg-white text-slate-950 shadow-sm dark:border-slate-800 dark:bg-slate-950 dark:text-slate-50",t),...e}));uP.displayName="Card";const cP=R.forwardRef(({className:t,...e},n)=>se.jsx("div",{ref:n,className:Jr("flex flex-col space-y-1.5 p-6",t),...e}));cP.displayName="CardHeader";const cZ=R.forwardRef(({className:t,...e},n)=>se.jsx("h3",{ref:n,className:Jr("text-2xl font-semibold leading-none tracking-tight",t),...e}));cZ.displayName="CardTitle";const dZ=R.forwardRef(({className:t,...e},n)=>se.jsx("p",{ref:n,className:Jr("text-sm text-slate-500 dark:text-slate-400",t),...e}));dZ.displayName="CardDescription";const dP=R.forwardRef(({className:t,...e},n)=>se.jsx("div",{ref:n,className:Jr("p-6 pt-0",t),...e}));dP.displayName="CardContent";const hZ=R.forwardRef(({className:t,...e},n)=>se.jsx("div",{ref:n,className:Jr("flex items-center p-6 pt-0",t),...e}));hZ.displayName="CardFooter";const fZ=()=>{const{isPending:t,error:e,data:n}=wA({queryKey:["repoData"],queryFn:()=>fetch("https://api.github.com/repos/tannerlinsley/react-query").then(s=>s.json())});return t?"Loading...":e?"An error has occurred: "+e.message:se.jsxs("div",{children:[se.jsx("h1",{children:n.name}),se.jsx("p",{children:n.description}),se.jsxs("strong",{children:[" ",n.subscribers_count]})," ",se.jsxs("strong",{children:[" ",n.stargazers_count]})," ",se.jsxs("strong",{children:[" ",n.forks_count]}),se.jsxs(uP,{children:[se.jsx(cP,{children:" asdfsadf"}),se.jsx(dP,{children:"asd;fasdfasdf"})]})]})};function pZ(){return se.jsx(fZ,{})}const mZ=()=>wn.get("/personalInfo").then(t=>t.data);function gZ(){var e;const t=wA({queryKey:["personData"],queryFn:()=>mZ()});return t.isPending?"Loading...":t.error?"An error has occurred: "+(((e=t.error)==null?void 0:e.message)||"Unknown error"):se.jsxs("div",{children:[se.jsx("h2",{children:"Todos:"}),se.jsx("h2",{children:"Personal Info:"}),se.jsx("div",{children:se.jsx("h1",{children:t.data.productName})})]})}const yZ=({buttonText:t,iconUrl:e,background:n})=>se.jsxs("button",{className:"w-[90%] flex items-center justify-center text-gray-800 font-semibold py-2 px-4 rounded hover:bg-opacity-80 active:bg-opacity-70 transition duration-300",style:{background:n},children:[se.jsx("img",{className:"mr-2",src:e,alt:"Logo",width:"24",height:"24"}),t]}),bZ=()=>{const t=[{buttonText:" ",iconUrl:"https://www.kakaocdn.net/kakaocorp/brand/kakaologo.png",background:"#FFC400"},{buttonText:" ",iconUrl:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",background:"#fff"}];return se.jsx("div",{className:"flex items-center justify-center h-screen",children:se.jsx("main",{className:"max-w-[430px] w-full bg-customPink relative mx-auto p-4 h-screen",children:se.jsx("div",{className:"flex flex-col items-center justify-center",children:t.map((e,n)=>se.jsx(yZ,{buttonText:e.buttonText,iconUrl:e.iconUrl,background:e.background},n))})})})},hP=({children:t})=>se.jsx(se.Fragment,{children:se.jsx("div",{className:"flex-1  flex-col w-full flex justify-center",children:se.jsx("main",{className:"max-w-[430px] overflow-hidden scrollbar-hide w-full bg-white overflow-y-scroll overflow-x-hidden relative mx-auto",children:se.jsx("div",{className:"flex-grow bg-white overflow-hidden scrollbar-hide",children:t})})})}),Hy=({placeholder:t,marginTop:e,value:n,onChange:s})=>se.jsx(se.Fragment,{children:se.jsx("input",{className:`rounded-lg border border-[#5ECDC7] p-2 w-full
        focus:outline-none focus:ring-0 focus:border-[#5ECDC7] transition duration-200
        ${e}
        `,placeholder:t,style:{transform:"scale(1)",transition:"none"},value:n,onChange:s})}),fk=({text:t,align:e,marginTop:n,marginBottom:s})=>se.jsx(se.Fragment,{children:se.jsx("p",{className:`text-customBrown text-size24 ${e} ${n} ${s} font-semibold leading-6`,children:t})}),vZ="data:image/svg+xml,%3csvg%20width='16'%20height='9'%20viewBox='0%200%2016%209'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M1%201L8%208L15%201'%20stroke='%23D8D8D8'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",xZ="data:image/svg+xml,%3csvg%20width='16'%20height='9'%20viewBox='0%200%2016%209'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M1%208L8%201L15%208'%20stroke='%23D8D8D8'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";var wZ={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const rR=t=>{let e;const n=new Set,s=(c,d)=>{const h=typeof c=="function"?c(e):c;if(!Object.is(h,e)){const f=e;e=d??(typeof h!="object"||h===null)?h:Object.assign({},e,h),n.forEach(p=>p(e,f))}},r=()=>e,l={setState:s,getState:r,getInitialState:()=>u,subscribe:c=>(n.add(c),()=>n.delete(c)),destroy:()=>{(wZ?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=e=t(s,r,l);return l},SZ=t=>t?rR(t):rR;var fP={exports:{}},pP={},mP={exports:{}},gP={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ed=R;function kZ(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var CZ=typeof Object.is=="function"?Object.is:kZ,NZ=ed.useState,TZ=ed.useEffect,$Z=ed.useLayoutEffect,IZ=ed.useDebugValue;function EZ(t,e){var n=e(),s=NZ({inst:{value:n,getSnapshot:e}}),r=s[0].inst,o=s[1];return $Z(function(){r.value=n,r.getSnapshot=e,y1(r)&&o({inst:r})},[t,n,e]),TZ(function(){return y1(r)&&o({inst:r}),t(function(){y1(r)&&o({inst:r})})},[t]),IZ(n),n}function y1(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!CZ(t,n)}catch{return!0}}function RZ(t,e){return e()}var _Z=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?RZ:EZ;gP.useSyncExternalStore=ed.useSyncExternalStore!==void 0?ed.useSyncExternalStore:_Z;mP.exports=gP;var AZ=mP.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sv=R,DZ=AZ;function OZ(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var FZ=typeof Object.is=="function"?Object.is:OZ,LZ=DZ.useSyncExternalStore,PZ=sv.useRef,MZ=sv.useEffect,zZ=sv.useMemo,BZ=sv.useDebugValue;pP.useSyncExternalStoreWithSelector=function(t,e,n,s,r){var o=PZ(null);if(o.current===null){var i={hasValue:!1,value:null};o.current=i}else i=o.current;o=zZ(function(){function l(f){if(!u){if(u=!0,c=f,f=s(f),r!==void 0&&i.hasValue){var p=i.value;if(r(p,f))return d=p}return d=f}if(p=d,FZ(c,f))return p;var m=s(f);return r!==void 0&&r(p,m)?p:(c=f,d=m)}var u=!1,c,d,h=n===void 0?null:n;return[function(){return l(e())},h===null?void 0:function(){return l(h())}]},[e,n,s,r]);var a=LZ(t,o[0],o[1]);return MZ(function(){i.hasValue=!0,i.value=a},[a]),BZ(a),a};fP.exports=pP;var VZ=fP.exports;const UZ=ub(VZ);var LN={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{useDebugValue:WZ}=lt,{useSyncExternalStoreWithSelector:jZ}=UZ;let oR=!1;const GZ=t=>t;function HZ(t,e=GZ,n){(LN?"production":void 0)!=="production"&&n&&!oR&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),oR=!0);const s=jZ(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return WZ(s),s}const iR=t=>{(LN?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?SZ(t):t,n=(s,r)=>HZ(e,s,r);return Object.assign(n,e),n},qZ=t=>t?iR(t):iR;var KZ=t=>((LN?"production":void 0)!=="production"&&console.warn("[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`."),qZ(t));const PN=KZ(t=>({currentPage:1,nextPage:()=>t(e=>({currentPage:Math.min(e.currentPage+1,3)})),prevPage:()=>t(e=>({currentPage:Math.max(e.currentPage-1,1)})),nickname:"",setNickname:e=>t({nickname:e}),babyname:"",setBabyname:e=>t({babyname:e}),dueDate:"",setDueDate:e=>t({dueDate:e}),monthAfterBirth:"",setMonthAfterBirth:e=>t({monthAfterBirth:e})})),XZ=()=>{const{nickname:t,babyname:e,setBabyname:n,dueDate:s,setDueDate:r,monthAfterBirth:o,setMonthAfterBirth:i}=PN(),a=[{text:"Please enter "},{text:"your baby's information "}],[l,u]=R.useState(!1),[c,d]=R.useState("When is the due date"),h=["When is the due date","Months after birth"],f=m=>{d(m),u(!1)};R.useEffect(()=>{i(""),r("")},[c]);const p=()=>{t&&e&&(s.length===10||o)?console.log(t,e,s,o):alert("Not enough field")};return se.jsxs(hP,{children:[se.jsxs("div",{className:"flex flex-col h-screen px-7",children:[se.jsx("div",{className:"mt-[25%] mb-[120px]",children:a.map((m,g)=>se.jsx(fk,{text:m.text,align:""},g))}),se.jsxs("div",{className:"",children:[se.jsx("p",{className:"text-costomMint",children:"Whats the babys name"}),se.jsx(Hy,{placeholder:"name",value:e,onChange:m=>n(m.target.value)})]}),se.jsxs("div",{className:"p-2 w-auto rounded-[8px] border border-[#EAEAEA] bg-[#F7F7F7] mt-7 mb-1",children:[se.jsxs("div",{className:"flex-row space-x-2 cursor-pointer",onClick:()=>u(m=>!m),children:[se.jsx("button",{children:se.jsx("img",{src:l?xZ:vZ,alt:"Toggle options"})}),se.jsx("span",{className:"text-costomMint",children:c})]}),l&&se.jsx("div",{children:h.filter(m=>m!==c).map((m,g)=>se.jsx("p",{className:"text-[#D8D8D8] mx-6",style:{cursor:"pointer",color:"black"},onClick:()=>f(m),children:m},g))})]}),c==="When is the due date"?se.jsx(Hy,{placeholder:"due date (format: YYYY-MM-DD)",value:s,onChange:m=>r(m.target.value)}):se.jsx(Hy,{placeholder:"Months after birth (only number)",value:o,onChange:m=>{const g=m.target.value;/^\d*$/.test(g)&&i(g)}})]}),se.jsx("button",{className:`fixed bottom-10 left-0 right-0 mx-auto max-w-[430px] text-center cursor-pointer py-[18px] px-[42px]
        ${e&&(s||o)?"bg-customPink text-white hover:bg-opacity-80 active:bg-opacity-70":"bg-[#FFF] text-customPink border border-[#EF8491] opacity-50 cursor-not-allowed"}
        w-[124px] h-[60px] flex items-center justify-center rounded-[40px] transition duration-200`,onClick:e&&(s||o)?p:void 0,children:se.jsx("span",{className:"w-10",children:"Next"})})]})},YZ="/assets/WelcomLogo-Bemv6VvY.svg",QZ=()=>{const t=[{text:"Please enter "},{text:"your nickname "}],{nickname:e,setNickname:n,nextPage:s}=PN(),r=()=>{e?s():alert(" .")};return se.jsxs(hP,{children:[se.jsxs("div",{className:"flex flex-col h-screen px-6",children:[" ",se.jsx(fk,{text:"Welcom !",align:"text-center",marginTop:"mt-[20%]",marginBottom:"mb-[36px]"}),se.jsxs("div",{className:"flex justify-center mb-[60px]",children:[" ",se.jsx("img",{className:"w-[140px] h-[150px]",src:YZ,alt:"Welcome Logo"})]}),t.map((o,i)=>se.jsx(fk,{text:o.text,align:""},i)),se.jsx(Hy,{placeholder:"nickname",marginTop:"mt-6",value:e,onChange:o=>n(o.target.value)})]}),se.jsx("button",{className:`fixed bottom-10 left-0 right-0 mx-auto max-w-[430px] text-center cursor-pointer py-[18px] px-[42px]
    ${e?"bg-customPink text-white hover:bg-opacity-80 active:bg-opacity-70":"bg-[#FFF] text-customPink border border-[#EF8491] opacity-50"}
    w-[124px] h-[60px] flex items-center justify-center rounded-[40px]`,onClick:r,children:se.jsx("span",{className:"w-10",children:"Next"})})]})},ZZ=()=>{const{currentPage:t}=PN();return se.jsxs(se.Fragment,{children:[t===1&&se.jsx(QZ,{}),t===2&&se.jsx(XZ,{})]})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JZ=1e-7,eJ=1e-4;class MN{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class rv{refCount(e){return Us("refCount")}incRef(e){return Us("incRef")}timerAvailable(){return!0}time(e){return Us("time")}read(e){return Us("read")}readSync(e){return Us("readSync")}readToGPU(e,n){return Us("readToGPU")}numDataIds(){return Us("numDataIds")}disposeData(e,n){return Us("disposeData")}write(e,n,s){return Us("write")}move(e,n,s,r,o){return Us("move")}createTensorFromGPUData(e,n,s){return Us("createTensorFromGPUData")}memory(){return Us("memory")}floatPrecision(){return Us("floatPrecision")}epsilon(){return this.floatPrecision()===32?JZ:eJ}dispose(){return Us("dispose")}}function Us(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zN(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,mi(t,e,n)}function tJ(t,e){if(t.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${t.length}Second array length was ${e.length}`);let n=t.length,s=0;for(;n>0;)s=Math.random()*n|0,n--,mi(t,n,s),mi(e,n,s)}function Fa(t,e,n){return Math.max(t,Math.min(e,n))}function ov(t){return t%2===0?t:t+1}function mi(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function yP(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function nJ(t,e){const n=Math.random();return e*n+(1-n)*t}function sJ(t,e){let n=0;for(let s=0;s<t.length;s++){const r=Number(t[s])-Number(e[s]);n+=r*r}return n}function T(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Zn(t,e,n=""){T(ut(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function ku(t){T(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function oe(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function rJ(t){return t.length===0}function bP(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==null&&e[n]!==null&&t[n]!==e[n])return!1;return!0}function ut(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function nu(t){return t%1===0}function oJ(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function R0(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function iJ(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return zN(e),e}function Wl(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function pk(t,e=r=>0,n,s){return new Promise((r,o)=>{let i=0;const a=()=>{if(t()){r();return}i++;const l=e(i);if(n!=null&&i>=n){o();return}s!=null?s(a,l):setTimeout(a,l)};a()})}function BN(t,e){let n=1,s=-1;for(let o=0;o<t.length;++o)if(t[o]>=0)n*=t[o];else if(t[o]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${o}`);s=o}else if(t[o]<0)throw Error(`Shapes can not be < 0. Found ${t[o]} at dim ${o}`);if(s===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const r=t.slice();return r[s]=e/n,r}function st(t,e){const n=e.length;return t=t==null?e.map((s,r)=>r):[].concat(t),T(t.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),T(t.every(s=>nu(s)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(s=>s<0?n+s:s)}function Li(t,e){const n=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||r?null:st(e,t).sort();let i=0;for(let a=0;a<t.length;++a){if(o!=null){if(o[i]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(o[i]==null||o[i]>a)&&t[a]===1&&(n.push(t[a]),s.push(a)),o[i]<=a&&i++}t[a]!==1&&(n.push(t[a]),s.push(a))}return{newShape:n,keptDims:s}}function Pn(t,e){return sn(t,e)}function sn(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function vP(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function xP(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function VN(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function rp(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function wP(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function Vo(t){return typeof t=="string"||t instanceof String}function SP(t){return typeof t=="boolean"}function _0(t){return typeof t=="number"}function Cu(t){return Array.isArray(t)?Cu(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":_0(t)?"float32":Vo(t)?"string":SP(t)?"bool":"float32"}function La(t){return!!(t&&t.constructor&&t.call&&t.apply)}function A0(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Le(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let s=e-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}function kP(t,e,n,s=!1){const r=new Array;if(e.length===1){const o=e[0]*(s?2:1);for(let i=0;i<o;i++)r[i]=n[t+i]}else{const o=e[0],i=e.slice(1),a=i.reduce((l,u)=>l*u)*(s?2:1);for(let l=0;l<o;l++)r[l]=kP(t+l*a,i,n,s)}return r}function wr(t,e,n=!1){if(t.length===0)return e[0];const s=t.reduce((r,o)=>r*o)*(n?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return kP(0,t,e,n)}function CP(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function iv(t,e){const n=Qn(t,e);for(let s=0;s<n.length;s++)n[s]=1;return n}function Qn(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function UN(t,e){const n=t.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return wr(t,new Float32Array(n));if(e==="int32")return wr(t,new Int32Array(n));if(e==="bool")return wr(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function or(t){t.forEach(e=>{T(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function bo(t,e,n){if(e===0)return 0;if(e===1)return t[0];let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=n[r]*t[r];return s}function Nu(t,e,n){if(e===0)return[];if(e===1)return[t];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(t/n[r]),t-=s[r]*n[r];return s[s.length-1]=t,s}function Pa(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aR="tfjsflags";class NP{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=aJ,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(ee().getBool("IS_TEST")||ee().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,s){if(this.flagRegistry[e]={evaluationFn:n,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];ee().getBool("IS_TEST")||ee().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(Pa(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);aR in e&&e[aR].split(",").forEach(s=>{const[r,o]=s.split(":");this.urlFlags[r]=uJ(r,o)})}}function aJ(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(lJ(e,s[0],s[1]),s.join("="))),e}function lJ(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function uJ(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function ee(){return WN}let WN=null;function cJ(t){WN=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let b1;function TP(){if(b1==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");b1=t}return b1}function dJ(){const t=TP();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function jN(t,e){const n=dJ();if(n.has(t))return n.get(t);{const s=e();return n.set(t,s),n.get(t)}}const Jp="Abs",Cd="Acos",Nd="Acosh",Tu="Add",em="AddN",av="All",lv="Any",tm="ArgMax",nm="ArgMin",Td="Asin",$d="Asinh",Id="Atan",Ed="Atanh",Rd="Atan2",sm="AvgPool",uv="AvgPoolGrad",rm="AvgPool3D",cv="AvgPool3DGrad",om="BatchMatMul",im="BatchToSpaceND",dv="Bincount",am="BitwiseAnd",$P="BroadcastTo",hv="BroadcastArgs",_d="Cast",Ad="Ceil",Dd="ClipByValue",fv="Complex",lm="ComplexAbs",um="Concat",cm="Conv2D",pv="Conv2DBackpropFilter",dm="Conv2DBackpropInput",hm="Conv3D",mv="Conv3DBackpropFilterV2",gv="Conv3DBackpropInputV2",Od="Cos",Fd="Cosh",yv="Cumprod",fm="Cumsum",bv="CropAndResize",vv="DenseBincount",xv="DepthToSpace",pm="DepthwiseConv2dNative",wv="DepthwiseConv2dNativeBackpropFilter",Sv="DepthwiseConv2dNativeBackpropInput",kv="Diag",mm="Dilation2D",D0="Dilation2DBackpropInput",O0="Dilation2DBackpropFilter",Cv="Draw",Ld="RealDiv",Nv="Einsum",Pd="Elu",Tv="EluGrad",Md="Erf",gm="Equal",zd="Exp",ym="ExpandDims",Bd="Expm1",$v="FFT",Iv="Fill",Ev="FlipLeftRight",Vd="Floor",Ud="FloorDiv",bm="FusedBatchNorm",vm="GatherV2",Rv="GatherNd",xm="Greater",Wd="GreaterEqual",jd="Identity",_v="IFFT",Av="Imag",Gd="IsFinite",Hd="IsInf",qd="IsNan",wm="LeakyRelu",Sm="Less",km="LessEqual",Dv="LinSpace",Kd="Log",Xd="Log1p",Cm="LogicalAnd",Nm="LogicalNot",Tm="LogicalOr",hJ="LogicalXor",IP="LogSoftmax",fJ="LowerBound",$m="LRN",Ov="LRNGrad",pJ="MatrixBandPart",Im="Max",Yd="Maximum",Em="MaxPool",Fv="MaxPoolGrad",Rm="MaxPool3D",Lv="MaxPool3DGrad",Pv="MaxPoolWithArgmax",_m="Mean",Am="Min",Qd="Minimum",Dm="MirrorPad",Zd="Mod",Mv="Multinomial",Jd="Multiply",Om="Neg",Fm="NotEqual",zv="NonMaxSuppressionV3",Bv="NonMaxSuppressionV4",Vv="NonMaxSuppressionV5",Lm="OnesLike",Pm="OneHot",Mm="Pack",zm="PadV2",mJ="Pool",eh="Pow",Bm="Prelu",Vm="Prod",Uv="RaggedGather",Wv="RaggedRange",jv="RaggedTensorToTensor",Gv="Range",Hv="Real",th="Reciprocal",nh="Relu",Um="Reshape",Wm="ResizeNearestNeighbor",qv="ResizeNearestNeighborGrad",jm="ResizeBilinear",Kv="ResizeBilinearGrad",sh="Relu6",Gm="Reverse",rh="Round",oh="Rsqrt",Xv="ScatterNd",Yv="TensorScatterUpdate",Qv="SearchSorted",Hm="Select",ih="Selu",qm="Slice",ah="Sin",lh="Sinh",uh="Sign",ch="Sigmoid",dh="Softplus",hh="Sqrt",Km="Sum",Xm="SpaceToBatchND",Ym="SplitV",Qm="Softmax",Zv="SparseFillEmptyRows",Jv="SparseReshape",ex="SparseSegmentMean",tx="SparseSegmentSum",nx="SparseToDense",fh="SquaredDifference",sx="Square",Zm="StaticRegexReplace",rx="StridedSlice",ox="StringNGrams",ix="StringSplit",ax="StringToHashBucketFast",ph="Sub",mh="Tan",gh="Tanh",yh="Tile",lx="TopK",ux="Transform",jl="Transpose",cx="Unique",Jm="Unpack",eg="UnsortedSegmentSum",gJ="UpperBound",tg="ZerosLike",bh="Step",F0="FromPixels",dx="RotateWithOffset",op="_FusedMatMul",ip="FusedConv2D",ap="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pr(...t){ee().getBool("IS_TEST")||ee().getBool("PROD")||console.warn(...t)}function yJ(...t){ee().getBool("IS_TEST")||ee().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const td=jN("kernelRegistry",()=>new Map),lp=jN("gradRegistry",()=>new Map);function up(t,e){const n=GN(t,e);return td.get(n)}function mk(t){return lp.get(t)}function L0(t){const e=td.entries(),n=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[o,i]=r,[a]=o.split("_");a===t&&n.push(i)}return n}function hx(t){const{kernelName:e,backendName:n}=t,s=GN(e,n);td.has(s)&&pr(`The kernel '${e}' for backend '${n}' is already registered`),td.set(s,t)}function EP(t){const{kernelName:e}=t;lp.has(e)&&ee().getBool("DEBUG")&&pr(`Overriding the gradient for '${e}'`),lp.set(e,t)}function bJ(t,e){const n=GN(t,e);if(!td.has(n))throw new Error(`The kernel '${t}' for backend '${e}' is not registered`);td.delete(n)}function vJ(t){if(!lp.has(t))throw new Error(`The gradient '${t}' for backend is not registered`);lp.delete(t)}function xJ(t,e){L0(t).forEach(s=>{const r=Object.assign({},s,{backendName:e});hx(r)})}function GN(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RP(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var _P=Mt,Ur=null;try{Ur=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Mt(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Mt.prototype.__isLong__;Object.defineProperty(Mt.prototype,"__isLong__",{value:!0});function ir(t){return(t&&t.__isLong__)===!0}Mt.isLong=ir;var lR={},uR={};function $u(t,e){var n,s,r;return e?(t>>>=0,(r=0<=t&&t<256)&&(s=uR[t],s)?s:(n=zt(t,(t|0)<0?-1:0,!0),r&&(uR[t]=n),n)):(t|=0,(r=-128<=t&&t<128)&&(s=lR[t],s)?s:(n=zt(t,t<0?-1:0,!1),r&&(lR[t]=n),n))}Mt.fromInt=$u;function Wr(t,e){if(isNaN(t))return e?Rl:jr;if(e){if(t<0)return Rl;if(t>=AP)return FP}else{if(t<=-dR)return Xs;if(t+1>=dR)return OP}return t<0?Wr(-t,e).neg():zt(t%nd|0,t/nd|0,e)}Mt.fromNumber=Wr;function zt(t,e,n){return new Mt(t,e,n)}Mt.fromBits=zt;var P0=Math.pow;function HN(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return jr;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return HN(t.substring(1),e,n).neg();for(var r=Wr(P0(n,8)),o=jr,i=0;i<t.length;i+=8){var a=Math.min(8,t.length-i),l=parseInt(t.substring(i,i+a),n);if(a<8){var u=Wr(P0(n,a));o=o.mul(u).add(Wr(l))}else o=o.mul(r),o=o.add(Wr(l))}return o.unsigned=e,o}Mt.fromString=HN;function To(t,e){return typeof t=="number"?Wr(t,e):typeof t=="string"?HN(t,e):zt(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Mt.fromValue=To;var cR=65536,wJ=1<<24,nd=cR*cR,AP=nd*nd,dR=AP/2,hR=$u(wJ),jr=$u(0);Mt.ZERO=jr;var Rl=$u(0,!0);Mt.UZERO=Rl;var fc=$u(1);Mt.ONE=fc;var DP=$u(1,!0);Mt.UONE=DP;var gk=$u(-1);Mt.NEG_ONE=gk;var OP=zt(-1,2147483647,!1);Mt.MAX_VALUE=OP;var FP=zt(-1,-1,!0);Mt.MAX_UNSIGNED_VALUE=FP;var Xs=zt(0,-2147483648,!1);Mt.MIN_VALUE=Xs;var we=Mt.prototype;we.toInt=function(){return this.unsigned?this.low>>>0:this.low};we.toNumber=function(){return this.unsigned?(this.high>>>0)*nd+(this.low>>>0):this.high*nd+(this.low>>>0)};we.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Xs)){var n=Wr(e),s=this.div(n),r=s.mul(n).sub(this);return s.toString(e)+r.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var o=Wr(P0(e,6),this.unsigned),i=this,a="";;){var l=i.div(o),u=i.sub(l.mul(o)).toInt()>>>0,c=u.toString(e);if(i=l,i.isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}};we.getHighBits=function(){return this.high};we.getHighBitsUnsigned=function(){return this.high>>>0};we.getLowBits=function(){return this.low};we.getLowBitsUnsigned=function(){return this.low>>>0};we.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Xs)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};we.isZero=function(){return this.high===0&&this.low===0};we.eqz=we.isZero;we.isNegative=function(){return!this.unsigned&&this.high<0};we.isPositive=function(){return this.unsigned||this.high>=0};we.isOdd=function(){return(this.low&1)===1};we.isEven=function(){return(this.low&1)===0};we.equals=function(e){return ir(e)||(e=To(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};we.eq=we.equals;we.notEquals=function(e){return!this.eq(e)};we.neq=we.notEquals;we.ne=we.notEquals;we.lessThan=function(e){return this.comp(e)<0};we.lt=we.lessThan;we.lessThanOrEqual=function(e){return this.comp(e)<=0};we.lte=we.lessThanOrEqual;we.le=we.lessThanOrEqual;we.greaterThan=function(e){return this.comp(e)>0};we.gt=we.greaterThan;we.greaterThanOrEqual=function(e){return this.comp(e)>=0};we.gte=we.greaterThanOrEqual;we.ge=we.greaterThanOrEqual;we.compare=function(e){if(ir(e)||(e=To(e)),this.eq(e))return 0;var n=this.isNegative(),s=e.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};we.comp=we.compare;we.negate=function(){return!this.unsigned&&this.eq(Xs)?Xs:this.not().add(fc)};we.neg=we.negate;we.add=function(e){ir(e)||(e=To(e));var n=this.high>>>16,s=this.high&65535,r=this.low>>>16,o=this.low&65535,i=e.high>>>16,a=e.high&65535,l=e.low>>>16,u=e.low&65535,c=0,d=0,h=0,f=0;return f+=o+u,h+=f>>>16,f&=65535,h+=r+l,d+=h>>>16,h&=65535,d+=s+a,c+=d>>>16,d&=65535,c+=n+i,c&=65535,zt(h<<16|f,c<<16|d,this.unsigned)};we.subtract=function(e){return ir(e)||(e=To(e)),this.add(e.neg())};we.sub=we.subtract;we.multiply=function(e){if(this.isZero())return jr;if(ir(e)||(e=To(e)),Ur){var n=Ur.mul(this.low,this.high,e.low,e.high);return zt(n,Ur.get_high(),this.unsigned)}if(e.isZero())return jr;if(this.eq(Xs))return e.isOdd()?Xs:jr;if(e.eq(Xs))return this.isOdd()?Xs:jr;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(hR)&&e.lt(hR))return Wr(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,r=this.high&65535,o=this.low>>>16,i=this.low&65535,a=e.high>>>16,l=e.high&65535,u=e.low>>>16,c=e.low&65535,d=0,h=0,f=0,p=0;return p+=i*c,f+=p>>>16,p&=65535,f+=o*c,h+=f>>>16,f&=65535,f+=i*u,h+=f>>>16,f&=65535,h+=r*c,d+=h>>>16,h&=65535,h+=o*u,d+=h>>>16,h&=65535,h+=i*l,d+=h>>>16,h&=65535,d+=s*c+r*u+o*l+i*a,d&=65535,zt(f<<16|p,d<<16|h,this.unsigned)};we.mul=we.multiply;we.divide=function(e){if(ir(e)||(e=To(e)),e.isZero())throw Error("division by zero");if(Ur){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?Ur.div_u:Ur.div_s)(this.low,this.high,e.low,e.high);return zt(n,Ur.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Rl:jr;var s,r,o;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Rl;if(e.gt(this.shru(1)))return DP;o=Rl}else{if(this.eq(Xs)){if(e.eq(fc)||e.eq(gk))return Xs;if(e.eq(Xs))return fc;var i=this.shr(1);return s=i.div(e).shl(1),s.eq(jr)?e.isNegative()?fc:gk:(r=this.sub(e.mul(s)),o=s.add(r.div(e)),o)}else if(e.eq(Xs))return this.unsigned?Rl:jr;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=jr}for(r=this;r.gte(e);){s=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(s)/Math.LN2),l=a<=48?1:P0(2,a-48),u=Wr(s),c=u.mul(e);c.isNegative()||c.gt(r);)s-=l,u=Wr(s,this.unsigned),c=u.mul(e);u.isZero()&&(u=fc),o=o.add(u),r=r.sub(c)}return o};we.div=we.divide;we.modulo=function(e){if(ir(e)||(e=To(e)),Ur){var n=(this.unsigned?Ur.rem_u:Ur.rem_s)(this.low,this.high,e.low,e.high);return zt(n,Ur.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};we.mod=we.modulo;we.rem=we.modulo;we.not=function(){return zt(~this.low,~this.high,this.unsigned)};we.and=function(e){return ir(e)||(e=To(e)),zt(this.low&e.low,this.high&e.high,this.unsigned)};we.or=function(e){return ir(e)||(e=To(e)),zt(this.low|e.low,this.high|e.high,this.unsigned)};we.xor=function(e){return ir(e)||(e=To(e)),zt(this.low^e.low,this.high^e.high,this.unsigned)};we.shiftLeft=function(e){return ir(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?zt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):zt(0,this.low<<e-32,this.unsigned)};we.shl=we.shiftLeft;we.shiftRight=function(e){return ir(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?zt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):zt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};we.shr=we.shiftRight;we.shiftRightUnsigned=function(e){if(ir(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var s=this.low;return zt(s>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?zt(n,0,this.unsigned):zt(n>>>e-32,0,this.unsigned)};we.shru=we.shiftRightUnsigned;we.shr_u=we.shiftRightUnsigned;we.toSigned=function(){return this.unsigned?zt(this.low,this.high,!1):this};we.toUnsigned=function(){return this.unsigned?this:zt(this.low,this.high,!0)};we.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};we.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};we.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Mt.fromBytes=function(e,n,s){return s?Mt.fromBytesLE(e,n):Mt.fromBytesBE(e,n)};Mt.fromBytesLE=function(e,n){return new Mt(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Mt.fromBytesBE=function(e,n){return new Mt(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const LP=ub(_P),SJ=uC({__proto__:null,default:LP},[_P]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vl=LP||SJ;function ng(t){return vl.fromString(t,!0,16)}const PP=ng("c3a5c85c97cb3127"),gl=ng("b492b66fbe98f273"),ys=ng("9ae16a3b2f90404f");function yk(t){return t.xor(t.shru(47))}function MP(t,e,n){const s=t.slice(e,e+n);return vl.fromBytes(Array.from(s),!0,!0)}function _t(t,e){return MP(t,e,8)}function fR(t,e){return MP(t,e,4)}function Dn(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function Ea(t,e,n=ng("9ddfea08eb382d69")){let s=t.xor(e).mul(n);s=s.xor(s.shru(47));let r=e.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function kJ(t,e,n,s,r,o){r=r.add(t),o=Dn(o.add(r).add(s),21);const i=r;return r=r.add(e),r=r.add(n),o=o.add(Dn(r,44)),[r.add(s),o.add(i)]}function fy(t,e,n,s){return kJ(_t(t,e),_t(t,e+8),_t(t,e+16),_t(t,e+24),n,s)}function CJ(t,e=t.length){if(e>=8){const n=ys.add(e*2),s=_t(t,0).add(ys),r=_t(t,e-8),o=Dn(r,37).mul(n).add(s),i=Dn(s,25).add(r).mul(n);return Ea(o,i,n)}if(e>=4){const n=ys.add(e*2),s=fR(t,0);return Ea(s.shl(3).add(e),fR(t,e-4),n)}if(e>0){const n=t[0],s=t[e>>1],r=t[e-1],o=n+(s<<8),i=e+(r<<2);return yk(ys.mul(o).xor(PP.mul(i))).mul(ys)}return ys}function NJ(t,e=t.length){const n=ys.add(e*2),s=_t(t,0).mul(gl),r=_t(t,8),o=_t(t,e-8).mul(n),i=_t(t,e-16).mul(ys);return Ea(Dn(s.add(r),43).add(Dn(o,30)).add(i),s.add(Dn(r.add(ys),18)).add(o),n)}function TJ(t,e=t.length){const n=ys.add(e*2),s=_t(t,0).mul(ys),r=_t(t,8),o=_t(t,e-8).mul(n),i=_t(t,e-16).mul(ys),a=Dn(s.add(r),43).add(Dn(o,30)).add(i),l=Ea(a,s.add(Dn(r.add(ys),18)).add(o),n),u=_t(t,16).mul(n),c=_t(t,24),d=a.add(_t(t,e-32)).mul(n),h=l.add(_t(t,e-24)).mul(n);return Ea(Dn(u.add(c),43).add(Dn(d,30)).add(h),u.add(Dn(c.add(s),18)).add(d),n)}function zP(t,e=t.length){const n=vl.fromNumber(81,!0);if(e<=32)return e<=16?CJ(t,e):NJ(t,e);if(e<=64)return TJ(t,e);let s=n,r=n.mul(gl).add(113),o=yk(r.mul(ys).add(113)).mul(ys),i=[vl.UZERO,vl.UZERO],a=[vl.UZERO,vl.UZERO];s=s.mul(ys).add(_t(t,0));let l=0;const u=(e-1>>6)*64,c=u+(e-1&63)-63;do s=Dn(s.add(r).add(i[0]).add(_t(t,l+8)),37).mul(gl),r=Dn(r.add(i[1]).add(_t(t,l+48)),42).mul(gl),s=s.xor(a[1]),r=r.add(i[0]).add(_t(t,l+40)),o=Dn(o.add(a[0]),33).mul(gl),i=fy(t,l,i[1].mul(gl),s.add(a[0])),a=fy(t,l+32,o.add(a[1]),r.add(_t(t,l+16))),[o,s]=[s,o],l+=64;while(l!==u);const d=gl.add(o.and(255).shl(1));return l=c,a[0]=a[0].add(e-1&63),i[0]=i[0].add(a[0]),a[0]=a[0].add(i[0]),s=Dn(s.add(r).add(i[0]).add(_t(t,l+8)),37).mul(d),r=Dn(r.add(i[1]).add(_t(t,l+48)),42).mul(d),s=s.xor(a[1].mul(9)),r=r.add(i[0].mul(9).add(_t(t,l+40))),o=Dn(o.add(a[0]),33).mul(d),i=fy(t,l,i[1].mul(d),s.add(a[0])),a=fy(t,l+32,o.add(a[1]),r.add(_t(t,l+16))),[o,s]=[s,o],Ea(Ea(i[0],a[0],d).add(yk(r).mul(PP)).add(o),Ea(i[1],a[1],d).add(s),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pi(t,e){return e==="string"?Go(t):Za([t],e)}function $J(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Za(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Yo(t)),ee().getBool("DEBUG")&&vP(t,e),$J(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let s=0;s<n.length;++s)Math.round(t[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${e}`)}function is(){return ee().platform.now()}function IJ(t,e){return ee().platform.fetch(t,e)}function Go(t,e="utf-8"){return e=e||"utf-8",ee().platform.encode(t,e)}function $i(t,e="utf-8"){return e=e||"utf-8",ee().platform.decode(t,e)}function On(t){return ee().platform.isTypedArray!=null?ee().platform.isTypedArray(t):RP(t)}function Yo(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||Pa(t)||t==null||On(t)&&n)e.push(t);else if(Array.isArray(t)||On(t))for(let s=0;s<t.length;++s)Yo(t[s],e,n);else{let s=-1;for(const r of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)Yo(t[r],e,n)}return e}const EJ=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:ut,arraysEqualWithNull:bP,assert:T,assertNonNegativeIntegerDimensions:or,assertNonNull:ku,assertShapesMatch:Zn,bytesFromStringArray:wP,bytesPerElement:rp,checkConversionForErrors:vP,clamp:Fa,computeStrides:Le,convertBackendValuesAndArrayBuffer:CP,createScalarValue:Pi,createShuffledIndices:iJ,decodeString:$i,distSquared:sJ,encodeString:Go,fetch:IJ,fingerPrint64:zP,flatten:Yo,getArrayFromDType:sn,getTypedArrayFromDType:Pn,hasEncodingLoss:VN,hexToLong:ng,indexToLoc:Nu,inferDtype:Cu,inferFromImplicitShape:BN,isBoolean:SP,isFunction:La,isInt:nu,isNumber:_0,isPromise:Pa,isScalarShape:rJ,isString:Vo,isTypedArray:On,isValidDtype:xP,locToIndex:bo,makeOnesTypedArray:iv,makeZerosNestedTypedArray:UN,makeZerosTypedArray:Qn,nearestDivisor:A0,nearestLargerEven:ov,now:is,parseAxisParam:st,randUniform:nJ,repeatedTry:pk,rightPad:Wl,shuffle:zN,shuffleCombo:tJ,sizeFromShape:oe,sizeToSquarishShape:R0,squeezeShape:Li,sum:yP,swap:mi,tanh:oJ,toNestedArray:wr,toTypedArray:Za},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RJ{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new AJ)}profileKernel(e,n,s){let r;const o=()=>{r=s()};let i;const a=is();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();for(const u of r)u.dataSync();i=Promise.resolve({kernelMs:is()-a})}if(ee().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<r.length;u++){const c=r[u];c.data().then(d=>{_J(d,c.dtype,e)})}return{kernelName:e,outputs:r,inputs:n,timeMs:i.then(u=>u.kernelMs),extraInfo:i.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:s,timeMs:r,inputs:o,extraInfo:i}=e;s.forEach(a=>{Promise.all([a.data(),r,i]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],o,l[2])})})}}function _J(t,e,n){if(e!=="float32")return!1;for(let s=0;s<t.length;s++){const r=t[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class AJ{logKernelProfile(e,n,s,r,o,i){const a=typeof r=="number"?Wl(`${r}ms`,9):r.error,l=Wl(e,25),u=n.rank,c=n.size,d=Wl(n.shape.toString(),14);let h="";for(const f in o){const p=o[f];if(p!=null){const m=p.shape||n.shape,g=m.length;h+=`${f}: ${g}D ${g>0?m:""} `}}console.log(`%c${l}	%c${a}	%c${u}D ${d}	%c${c}	%c${h}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DJ(t,e,n){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<t.length;l++){const u=t[l],c=u.inputs;for(const d in c){const h=c[d];let f=!1;for(let p=0;p<e.length;p++)if(s[h.id]){u.outputs.forEach(m=>s[m.id]=!0),f=!0,r[u.id]=!0;break}if(f)break}}const o={};o[n.id]=!0;const i={};for(let l=t.length-1;l>=0;l--){const u=t[l],c=u.inputs;for(let d=0;d<u.outputs.length;d++)if(o[u.outputs[d].id]){for(const h in c)o[c[h].id]=!0,i[u.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const u=t[l];if(r[u.id]&&i[u.id]){const c={};for(const h in u.inputs){const f=u.inputs[h];s[f.id]&&(c[h]=f)}const d=Object.assign({},u);d.inputs=c,d.outputs=u.outputs,a.push(d)}}return a}function OJ(t,e,n,s){for(let r=e.length-1;r>=0;r--){const o=e[r],i=[];if(o.outputs.forEach(l=>{const u=t[l.id];u!=null?i.push(u):i.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const a=o.gradient(i);for(const l in o.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const u=n(()=>a[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=o.inputs[l];if(!ut(u.shape,c.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(t[c.id]==null)t[c.id]=u;else{const d=t[c.id];t[c.id]=s(d,u),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pR=20,rf=3,v1=7;function FJ(t,e,n,s){const r=Le(e),o=LJ(t,e,n,r),i=e.length,a=qy(t,e,n,r,o),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${i}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(u=>"    "+u).join(`
`)),l.join(`
`)}function LJ(t,e,n,s){const r=oe(e),o=s[s.length-1],i=new Array(o).fill(0),a=e.length,l=n==="complex64"?gf(t):t;if(a>1)for(let u=0;u<r/o;u++){const c=u*o;for(let d=0;d<o;d++)i[d]=Math.max(i[d],mf(l[c+d],0,n).length)}return i}function mf(t,e,n){let s;return Array.isArray(t)?s=`${parseFloat(t[0].toFixed(v1))} + ${parseFloat(t[1].toFixed(v1))}j`:Vo(t)?s=`'${t}'`:n==="bool"?s=BP(t):s=parseFloat(t.toFixed(v1)).toString(),Wl(s,e)}function BP(t){return t===0?"false":"true"}function qy(t,e,n,s,r,o=!0){const i=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const m=gf(t);return[mf(m[0],0,n)]}return n==="bool"?[BP(t[0])]:[t[0].toString()]}if(l===1){if(a>pR){const g=rf*i;let y=Array.from(t.slice(0,g)),b=Array.from(t.slice((a-rf)*i,a*i));return n==="complex64"&&(y=gf(y),b=gf(b)),["["+y.map((v,x)=>mf(v,r[x],n)).join(", ")+", ..., "+b.map((v,x)=>mf(v,r[a-rf+x],n)).join(", ")+"]"]}return["["+(n==="complex64"?gf(t):Array.from(t)).map((g,y)=>mf(g,r[y],n)).join(", ")+"]"]}const u=e.slice(1),c=s.slice(1),d=s[0]*i,h=[];if(a>pR){for(let m=0;m<rf;m++){const g=m*d,y=g+d;h.push(...qy(t.slice(g,y),u,n,c,r,!1))}h.push("...");for(let m=a-rf;m<a;m++){const g=m*d,y=g+d;h.push(...qy(t.slice(g,y),u,n,c,r,m===a-1))}}else for(let m=0;m<a;m++){const g=m*d,y=g+d;h.push(...qy(t.slice(g,y),u,n,c,r,m===a-1))}const f=l===2?",":"";h[0]="["+(a>0?h[0]+f:"");for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+f;let p=`,
`;for(let m=2;m<l;m++)p+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(o?"":p),h}function gf(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xn{constructor(e,n,s){if(this.dtype=n,this.shape=e.slice(),this.size=oe(e),s!=null){const r=s.length;T(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||sn(n,this.size),this.strides=Le(e)}set(e,...n){n.length===0&&(n=[0]),T(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const r of e){if(r<0||r>=this.shape[n]){const o=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(o)}n++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(e/this.strides[s]),e-=n[s]*this.strides[s];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return po().makeTensor(this.values,this.shape,this.dtype)}}let po=null,Yu=null;function PJ(t){po=t}function MJ(t){Yu=t}class vt{constructor(e,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=oe(e),this.strides=Le(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Yu.buffer(this.shape,this.dtype,e)}bufferSync(){return Yu.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return wr(this.shape,e,this.dtype==="complex64")}arraySync(){return wr(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=po().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(s=>$i(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),po().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=po().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>$i(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await po().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),po().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Yu.print(this,e)}clone(){return this.throwIfDisposed(),Yu.clone(this)}toString(e=!1){const n=this.dataSync();return FJ(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Yu.cast(this,e)}variable(e=!0,n,s){return this.throwIfDisposed(),po().makeVariable(this,e,n,s)}}Object.defineProperty(vt,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function le(){return jN("Tensor",()=>vt)}le();class cp extends vt{constructor(e,n,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=n,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!ut(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);po().disposeTensor(this),this.dataId=e.dataId,po().incRef(this,null)}dispose(){po().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(cp,Symbol.hasInstance,{value:t=>t instanceof vt&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var bk;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(bk||(bk={}));var vk;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(vk||(vk={}));var xk;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(xk||(xk={}));var wk;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(wk||(wk={}));var Sk;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(Sk||(Sk={}));const zJ={float32:wk,int32:vk,bool:xk,complex64:Sk};function As(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return zJ[t][e]}function fx(t){return As(t,"int32")}function VP(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function UP(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function en(t,e){if(t.dtype===e.dtype)return[t,e];const n=As(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function WP(t,e){T(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function px(t,e){return e.some(n=>n.id===t.id)}function Ii(t){const e=[];return jP(t,e,new Set),e}function jP(t,e,n){if(t==null)return;if(t instanceof vt){e.push(t);return}if(!BJ(t))return;const s=t;for(const r in s){const o=s[r];n.has(o)||(n.add(o),jP(o,e,n))}}function BJ(t){return Array.isArray(t)||typeof t=="object"}const VJ=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:WP,getTensorsInContainer:Ii,isTensorInList:px,makeTypesMatch:en},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x1(t){return t.kernelName!=null}class mR{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class sd{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new mR}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,s=1){return e in this.registryFactory?(pr(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(e);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new RJ(this.backendInstance),!0}setupRegisteredKernels(){L0(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){L0(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof rv)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,o=s.then(i=>r<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,pr(`Initialization of backend ${e} failed`),pr(i.stack||i.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return pr(`Initialization of backend ${e} failed`),pr(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n],{success:r,asyncInit:o}=this.initializeBackend(s);if(o||r)return{name:s,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const s=this.state.tensorInfo.get(n),r=s.backend,o=this.readSync(n),i=r.refCount(n);r.disposeData(n,!0),s.backend=e,e.move(n,o,s.shape,s.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let s=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,n,s){e();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return sd.nextTensorId++}nextVariableId(){return sd.nextVariableId++}clone(e){const n=D.runKernel(jd,{x:e}),s={x:e},r=i=>({x:()=>{const a="float32",l={x:i},u={dtype:a};return D.runKernel(_d,l,u)}}),o=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,o,{}),n}runKernel(e,n,s){if(this.backendName==null&&this.backend,!(up(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,s){const r=this.backend.numDataIds();let o=0;s.forEach(l=>{o+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-n-o-i;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,s=[];const r=this.isTapeOn(),o=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const u=x1(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(x1(e)){const{kernelName:p,inputs:m,attrs:g}=e;this.backendName==null&&this.backend;const y=up(p,this.backendName);T(y!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const b=this.backend.numDataIds();l=y.kernelFunc({inputs:m,attrs:g,backend:this.backend});const v=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,b,v);const x=v.map(w=>w.rank!=null?w:this.makeTensorFromTensorInfo(w));if(r){const w=this.getTensorsForGradient(p,m,x);s=this.saveTensorsForBackwardMode(w)}return x}}else{const{forwardFunc:p}=e,m=g=>{r&&(s=g.map(y=>this.keep(this.clone(y))))};a=()=>{const g=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,m));const y=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,g,y),y}}const{inputs:c,attrs:d}=e,h=x1(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(f=this.profiler.profileKernel(u,c,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),r&&this.addTapeNode(u,c,n,h,s,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(p=>c[p]!=null?c[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,n,s){const r=mk(e);if(r!=null){const o=r.inputsToSave||[],i=r.outputsToSave||[];let a;r.saveAllInputs?(T(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(u=>n[u])):a=o.map(u=>n[u]);const l=s.filter((u,c)=>i[c]);return a.concat(l)}return[]}makeTensor(e,n,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let o=e;s==="string"&&Vo(e[0])&&(o=e.map(l=>Go(l)));const i=r.write(o,n,s),a=new vt(n,s,i,this.nextTensorId());if(this.trackTensor(a,r),s==="string"){const l=this.state.tensorInfo.get(i),u=wP(o);this.state.numBytes+=u-l.bytes,l.bytes=u}return a}makeTensorFromDataId(e,n,s,r){s=s||"float32";const o={dataId:e,shape:n,dtype:s};return this.makeTensorFromTensorInfo(o,r)}makeTensorFromTensorInfo(e,n){const{dataId:s,shape:r,dtype:o}=e,i=new vt(r,o,s,this.nextTensorId());return this.trackTensor(i,n),i}makeVariable(e,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const o=new cp(e,n,s,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*rp(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof cp||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*rp(e.dtype);this.state.numBytes-=s}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,s,r,o,i){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:s,saved:o},l=mk(e);l!=null&&(r=l.gradFunc),r!=null&&(a.gradient=u=>(u=u.map((c,d)=>{if(c==null){const h=s[d],f=Qn(h.size,h.dtype);return this.makeTensor(f,h.shape,h.dtype)}return c}),r(u.length>1?u:u[0],o,i))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=Ii(e),s=new Set(n.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const i=this.state.activeScope.track[o];!i.kept&&!s.has(i.id)&&i.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(o=>{!o.kept&&o.scopeId===r.id&&this.track(o)})}gradients(e,n,s,r=!1){if(T(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));T(o instanceof vt,()=>"The result y returned by f() must be a tensor.");const i=DJ(this.state.activeTape,n,o);if(!r&&i.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[o.id]=s??UJ(o.shape),OJ(a,i,u=>this.tidy(u),WJ);const l=n.map(u=>a[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:o,grads:l}})}customGrad(e){return T(La(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{T(n.every(a=>a instanceof vt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((a,l)=>{r[l]=a});const o=(a,l)=>(s=e(...n,l),T(s.value instanceof vt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),T(La(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),i=(a,l)=>{const u=s.gradFunc(a,l),c=Array.isArray(u)?u:[u];T(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),T(c.every(h=>h instanceof vt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return c.forEach((h,f)=>{d[f]=()=>h}),d};return this.runKernelFunc({forwardFunc:o,backwardsFunc:i,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=is(),s=await this.backend.time(e);return s.wallMs=is()-n,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new mR;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}sd.nextTensorId=0;sd.nextVariableId=0;function UJ(t){const e=iv(oe(t),"float32");return D.makeTensor(e,t,"float32")}function GP(){const t=TP();if(t._tfengine==null){const e=new NP(t);t._tfengine=new sd(e)}return cJ(t._tfengine.ENV),PJ(()=>t._tfengine),t._tfengine}const D=GP();function WJ(t,e){const n={a:t,b:e};return D.runKernel(Tu,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jJ(){return typeof navigator<"u"&&navigator!=null}let kk;function GJ(t){kk=t}function qN(t){if(kk!==void 0)return kk;if(t||jJ()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function KN(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const HJ=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:KN,isMobile:qN,mockIsMobile:GJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ds=ee();Ds.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Ds.registerFlag("IS_BROWSER",()=>KN());Ds.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Ds.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Ds.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Ds.registerFlag("PROD",()=>!1);Ds.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Ds.getBool("DEBUG"));Ds.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Ds.registerFlag("IS_TEST",()=>!1);Ds.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Ds.getBool("DEBUG"));Ds.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Ds.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Ds.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qo(t,e){let n=t;if(On(t))return e==="string"?[]:[t.length];if(VP(t)){const r=t.channels||"RGBA";return[t.height,t.width*r.length]}else if(UP(t))return[t.buffer.size/(e==null?4:rp(e))];if(!Array.isArray(t))return[];const s=[];for(;Array.isArray(n)||On(n)&&e!=="string";)s.push(n.length),n=n[0];return Array.isArray(t)&&ee().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&HP(t,s,[]),s}function HP(t,e,n){if(n=n||[],!Array.isArray(t)&&!On(t)){T(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}T(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),T(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const s=e.slice(1);for(let r=0;r<t.length;++r)HP(t[r],s,n.concat(r))}function gR(t,e,n,s){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${t} tensor, but got ${e} tensor`)}}function $(t,e,n,s="numeric"){if(t instanceof le())return gR(s,t.dtype,e,n),t;let r=Cu(t);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),gR(s,r,e,n),t==null||!On(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const o=Qo(t,r);!On(t)&&!Array.isArray(t)&&(t=[t]);const a=r!=="string"?Za(t,r):Yo(t,[],!0);return D.makeTensor(a,o,r)}function dp(t,e,n,s="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((o,i)=>$(o,`${e}[${i}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XN="__op";function O(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+XN;const r=(...o)=>{D.startScope(n);try{const i=s(...o);return Pa(i)&&console.error("Cannot return a Promise inside of tidy."),D.endScope(i),i}catch(i){throw D.endScope(null),i}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qJ(t,e){const n=$(t,"real","complex"),s=$(e,"imag","complex");Zn(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return D.runKernel(fv,r)}const Ei=O({complex_:qJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ja(t,e,n,s){if(s==null)s=Cu(t);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(UP(t)||VP(t)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return D.backend.createTensorFromGPUData(t,e||n,s)}if(!On(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){or(e);const r=oe(e),o=oe(n);T(r===o,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${o}`);for(let i=0;i<n.length;++i){const a=n[i],l=i===n.length-1?a!==oe(e.slice(i)):!0;T(n[i]===e[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!On(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=s!=="string"?Za(t,s):Yo(t,[],!0),D.makeTensor(t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xr(t,e,n){const s=Qo(t,n);return Ja(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const su={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class $o{static join(e){return new $o(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>On(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const o=n+r.byteLength;this.shards.push({buffer:r,start:n,end:o}),n=o}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=n-e,o=new ArrayBuffer(r),i=new Uint8Array(o);let a=0;for(let l=s;l<this.shards.length;l++){const u=this.shards[l],d=e+a-u.start,h=a,p=Math.min(n,u.end)-u.start,m=new Uint8Array(u.buffer,d,p-d);if(i.set(m,h),a+=m.length,n<u.end)break}return o}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(r){return e<r.start?-1:e>=r.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=KJ(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function KJ(t,e){let n=0,s=t.length;for(;n<=s;){const r=Math.floor((s-n)/2)+n,o=e(t[r]);if(o===0)return r;o<0?s=r:n=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XJ(){ee().set("PROD",!0)}function YJ(){ee().set("DEBUG",!0)}function QJ(){ee().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function ZJ(t){ee().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function JJ(){D.disposeVariables()}function lo(){return D}function M0(){return D.memory()}function eee(t){return D.profile(t)}function Q(t,e){return D.tidy(t,e)}function Qe(t){Ii(t).forEach(n=>n.dispose())}function Cn(t){return D.keep(t)}function tee(t){return D.time(t)}function nee(t){return D.setBackend(t)}function see(){return D.ready()}function qP(){return D.backendName}function ree(t){D.removeBackend(t)}function oee(t){return D.findBackend(t)}function iee(t){return D.findBackendFactory(t)}function YN(t,e,n=1){return D.registerBackend(t,e,n)}function QN(){return D.backend}function aee(t,e){ee().setPlatform(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ma=4;async function Ck(t,e){const n=[],s=[],r=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);for(let i=0;i<r.length;++i){const a=r[i],l=Array.isArray(t)?t[i].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const u={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async d=>{const h=await l.bytes(),f=h.reduce((g,y)=>g+y.length,0)+Ma*h.length,p=new Uint8Array(f);let m=0;for(let g=0;g<h.length;g++){const y=h[g],b=new Uint8Array(new Uint32Array([y.length]).buffer);p.set(b,m),m+=Ma,p.set(y,m),m+=y.length}d(p)});s.push(c)}else s.push(l.data());e!=null&&(u.group=e),n.push(u)}const o=await Promise.all(s);return{data:cee(o),specs:n}}function KP(t,e){const n=new $o(t),s={};let r=0;for(const o of e){const i=lee(o,(a,l)=>n.slice(r+a,r+l));s[o.name]=XP(o,n.slice(r,r+i)),r+=i}return s}function lee(t,e){const n=oe(t.shape);let s;if("quantization"in t){const r=t.quantization;s=su[r.dtype]}else if(t.dtype==="string"){let r=0;for(let o=0;o<n;o++)r+=Ma+new Uint32Array(e(r,r+Ma))[0];return r}else s=su[t.dtype];return n*s}async function uee(t,e){const n=oe(t.shape);let s;if("quantization"in t){const r=t.quantization;s=su[r.dtype]}else if(t.dtype==="string"){let r=0;for(let o=0;o<n;o++)r+=Ma+new Uint32Array(await e(r,r+Ma))[0];return r}else s=su[t.dtype];return n*s}function XP(t,e){const n=t.name,s=t.dtype,r=t.shape,o=oe(r);let i,a=0;if("quantization"in t){const l=t.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${t.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${t.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const u=su[l.dtype],c=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(s==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){i=new Float32Array(c.length);for(let d=0;d<c.length;d++){const h=c[d];i[d]=h*l.scale+l.min}}else if(l.dtype==="float16")i=gee()(c);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(s==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);i=new Int32Array(c.length);for(let d=0;d<c.length;d++){const h=c[d];i[d]=Math.round(h*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);a+=o*u}else if(s==="string"){const l=oe(t.shape);i=[];for(let u=0;u<l;u++){const c=new Uint32Array(e.slice(a,a+Ma))[0];a+=Ma;const d=new Uint8Array(e.slice(a,a+c));i.push(d),a+=c}}else{const l=su[s];if(s==="float32")i=new Float32Array(e);else if(s==="int32")i=new Int32Array(e);else if(s==="bool")i=new Uint8Array(e);else if(s==="complex64"){i=new Float32Array(e);const u=new Float32Array(i.length/2),c=new Float32Array(i.length/2);for(let p=0;p<u.length;p++)u[p]=i[p*2],c[p]=i[p*2+1];const d=Xr(u,r,"float32"),h=Xr(c,r,"float32"),f=Ei(d,h);return d.dispose(),h.dispose(),f}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);a+=o*l}return Xr(i,r,s)}async function yR(t,e,n){let s=new Uint8Array(e);for(;s.byteLength<n;){const{done:r,value:o}=await t.read();if(r&&o==null){const a=n-s.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}const i=new Uint8Array(s.length+o.byteLength);i.set(s,0),i.set(new Uint8Array(o),s.length),s=i}return s.buffer}async function YP(t,e){const n={},s=t.getReader();let r=new ArrayBuffer(0);for(const o of e){const i=await uee(o,async(u,c)=>(r=await yR(s,r,c),r.slice(u,c)));r=await yR(s,r,i);const a=r.slice(0,i);r=r.slice(i);const l=XP(o,a);if(n[o.name]=l,qP()==="webgpu"){const u=QN();"uploadToGPU"in u&&oe(l.shape)>=ee().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&u.uploadToGPU(l.dataId)}}return n}function cee(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(o=>{if(e+=o.byteLength,n.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${o.constructor.name}`)});const s=new Uint8Array(e);let r=0;return n.forEach(o=>{s.set(new Uint8Array(o.buffer),r),r+=o.byteLength}),s.buffer}const ZN=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function bR(t){return ZN?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function dee(t){if(ZN)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let s=0,r=e.length;s<r;s++)n+=String.fromCharCode(e[s]);return btoa(n)}function hee(t){if(ZN){const s=Buffer.from(t,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;++s)n.set([e.charCodeAt(s)],s);return n.buffer}function QP(t){return $o.join(t)}function vR(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function ZP(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function JP(t,e,n){const s={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(s.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=e,s.weightData=n}return t.signature!=null&&(s.signature=t.signature),t.userDefinedMetadata!=null&&(s.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(s.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(s.initializerSignature=t.initializerSignature),s}async function JN(t,e){let n,s;return t.weightsManifest!=null&&([n,s]=await e(t.weightsManifest)),JP(t,n,s)}function sg(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:bR(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:bR(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new $o(t.weightData).byteLength}}function Nk(t){const e=[];for(const n of t)e.push(...n.weights);return e}function fee(){const t=n=>{let s=n<<13,r=0;for(;!(s&8388608);)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function pee(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function mee(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function gee(){const t=fee(),e=pee(),n=mee();return s=>{const r=new ArrayBuffer(4*s.length),o=new Uint32Array(r);for(let i=0;i<s.length;i++){const a=s[i],l=t[n[a>>10]+(a&1023)]+e[a>>10];o[i]=l}return new Float32Array(r)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xt{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Xt.instance==null&&(Xt.instance=new Xt),Xt.instance}static registerSaveRouter(e){Xt.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Xt.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Xt.getHandlers(e,"save")}static getLoadHandlers(e,n){return Xt.getHandlers(e,"load",n)}static getHandlers(e,n,s){const r=[];return(n==="load"?Xt.getInstance().loadRouters:Xt.getInstance().saveRouters).forEach(i=>{const a=i(e,s);a!==null&&r.push(a)}),r}}const yee=t=>Xt.registerSaveRouter(t),bee=t=>Xt.registerLoadRouter(t),e3=t=>Xt.getSaveHandlers(t),vee=(t,e)=>Xt.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tk="tensorflowjs",$k=1,_l="models_store",ya="model_info_store";function t3(){if(!ee().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Ik(t){const e=t.result;e.createObjectStore(_l,{keyPath:"modelPath"}),e.createObjectStore(ya,{keyPath:"modelPath"})}class ru{constructor(e){if(this.indexedDB=t3(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((s,r)=>{const o=this.indexedDB.open(Tk,$k);o.onupgradeneeded=()=>Ik(o),o.onsuccess=()=>{const i=o.result;if(n==null){const a=i.transaction(_l,"readonly"),u=a.objectStore(_l).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return i.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(u.result.modelArtifacts)},u.onerror=c=>(i.close(),r(u.error)),a.oncomplete=()=>i.close()}else{n.weightData=$o.join(n.weightData);const a=sg(n),l=i.transaction(ya,"readwrite");let u=l.objectStore(ya),c;try{c=u.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(h){return r(h)}let d;c.onsuccess=()=>{d=i.transaction(_l,"readwrite");const h=d.objectStore(_l);let f;try{f=h.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return r(p)}f.onsuccess=()=>s({modelArtifactsInfo:a}),f.onerror=p=>{u=l.objectStore(ya);const m=u.delete(this.modelPath);m.onsuccess=()=>(i.close(),r(f.error)),m.onerror=g=>(i.close(),r(f.error))}},c.onerror=h=>(i.close(),r(c.error)),l.oncomplete=()=>{d==null?i.close():d.oncomplete=()=>i.close()}}},o.onerror=i=>r(o.error)})}}ru.URL_SCHEME="indexeddb://";const n3=t=>ee().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ru.URL_SCHEME)?xee(t.slice(ru.URL_SCHEME.length)):null;Xt.registerSaveRouter(n3);Xt.registerLoadRouter(n3);function xee(t){return new ru(t)}function wee(t){return t.startsWith(ru.URL_SCHEME)?t.slice(ru.URL_SCHEME.length):t}class See{constructor(){this.indexedDB=t3()}async listModels(){return new Promise((e,n)=>{const s=this.indexedDB.open(Tk,$k);s.onupgradeneeded=()=>Ik(s),s.onsuccess=()=>{const r=s.result,o=r.transaction(ya,"readonly"),a=o.objectStore(ya).getAll();a.onsuccess=()=>{const l={};for(const u of a.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},a.onerror=l=>(r.close(),n(a.error)),o.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(e){return e=wee(e),new Promise((n,s)=>{const r=this.indexedDB.open(Tk,$k);r.onupgradeneeded=()=>Ik(r),r.onsuccess=()=>{const o=r.result,i=o.transaction(ya,"readwrite"),a=i.objectStore(ya),l=a.get(e);let u;l.onsuccess=()=>{if(l.result==null)return o.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=a.delete(e),d=()=>{u=o.transaction(_l,"readwrite");const f=u.objectStore(_l).delete(e);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=p=>s(l.error)};c.onsuccess=d,c.onerror=h=>(d(),o.close(),s(l.error))}},l.onerror=c=>(o.close(),s(l.error)),i.oncomplete=()=>{u==null?o.close():u.oncomplete=()=>o.close()}},r.onerror=o=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gi="/",Qu="tensorflowjs_models",s3="info",kee="model_topology",Cee="weight_specs",Nee="weight_data",Tee="model_metadata";function r3(t){return{info:[Qu,t,s3].join(gi),topology:[Qu,t,kee].join(gi),weightSpecs:[Qu,t,Cee].join(gi),weightData:[Qu,t,Nee].join(gi),modelMetadata:[Qu,t,Tee].join(gi)}}function o3(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function $ee(t){const e=t.split(gi);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(gi)}function Iee(t){return t.startsWith(ou.URL_SCHEME)?t.slice(ou.URL_SCHEME.length):t}class ou{constructor(e){if(!ee().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=r3(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=sg(e),o=$o.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,dee(o));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch{throw o3(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const a=JSON.parse(o);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=hee(i),n}}ou.URL_SCHEME="localstorage://";const i3=t=>ee().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ou.URL_SCHEME)?Eee(t.slice(ou.URL_SCHEME.length)):null;Xt.registerSaveRouter(i3);Xt.registerLoadRouter(i3);function Eee(t){return new ou(t)}class Ree{constructor(){T(ee().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),T(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Qu+gi,s=gi+s3;for(let r=0;r<this.LS.length;++r){const o=this.LS.key(r);if(o.startsWith(n)&&o.endsWith(s)){const i=$ee(o);e[i]=JSON.parse(this.LS.getItem(o))}}return e}async removeModel(e){e=Iee(e);const n=r3(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(n.info));return o3(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wc="://";class ms{constructor(){this.managers={}}static getInstance(){return ms.instance==null&&(ms.instance=new ms),ms.instance}static registerManager(e,n){T(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(wc)&&(e=e.slice(0,e.indexOf(wc))),T(e.length>0,()=>"scheme must not be an empty string.");const s=ms.getInstance();T(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=n}static getManager(e){const n=ms.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(ms.getInstance().managers)}}function Ky(t){if(t.indexOf(wc)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${ms.getSchemes().join(",")}`);return{scheme:t.split(wc)[0],path:t.split(wc)[1]}}async function a3(t,e,n=!1){T(t!==e,()=>`Old path and new path are the same: '${t}'`);const s=Xt.getLoadHandlers(t);T(s.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),T(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${t}.`);const r=s[0],o=Xt.getSaveHandlers(e);T(o.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),T(o.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${e}.`);const i=o[0],a=Ky(t).scheme,l=Ky(t).path,u=a===Ky(t).scheme,c=await r.load();n&&u&&await ms.getManager(a).removeModel(l);const d=await i.save(c);return n&&!u&&await ms.getManager(a).removeModel(l),d.modelArtifactsInfo}async function _ee(){const t=ms.getSchemes(),e={};for(const n of t){const s=await ms.getManager(n).listModels();for(const r in s){const o=n+wc+r;e[o]=s[r]}}return e}async function Aee(t){const e=Ky(t);return ms.getManager(e.scheme).removeModel(e.path)}async function Dee(t,e){return a3(t,e,!1)}async function Oee(t,e){return a3(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fee{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!ee().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return RP(e)}}if(ee().get("IS_BROWSER")){ee().setPlatform("browser",new Fee);try{ms.registerManager(ou.URL_SCHEME,new Ree)}catch{}try{ms.registerManager(ru.URL_SCHEME,new See)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lee={importFetch:()=>require("node-fetch")};let w1;class Pee{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return ee().global.fetch!=null?ee().global.fetch(e,n):(w1==null&&(w1=Lee.importFetch()),w1(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}ee().get("IS_NODE")&&!ee().get("IS_BROWSER")&&ee().setPlatform("node",new Pee);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ze(t,e="float32",n){return e=e||"float32",or(t),new xn(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mee(t,e){const n=$(t,"x","cast");if(!xP(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:e};return D.runKernel(_d,s,r)}const be=O({cast_:Mee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zee(t){const n={x:$(t,"x","clone","string_or_numeric")};return D.runKernel(jd,n)}const Ho=O({clone_:zee});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eT(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */GP();const Bee={buffer:Ze,cast:be,clone:Ho,print:eT};MJ(Bee);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vee(t,e){let n=$(t,"a","add"),s=$(e,"b","add");[n,s]=en(n,s);const r={a:n,b:s};return D.runKernel(Tu,r)}const ce=O({add_:Vee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uee(t,e){let n=$(t,"a","floorDiv"),s=$(e,"b","floorDiv");[n,s]=en(n,s);const r={a:n,b:s};return D.runKernel(Ud,r)}const mx=O({floorDiv_:Uee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wee(t,e){let n=$(t,"a","div"),s=$(e,"b","div");if([n,s]=en(n,s),n.dtype==="int32"&&s.dtype==="int32")return mx(n,s);const r={a:n,b:s},o={};return D.runKernel(Ld,r,o)}const Fe=O({div_:Wee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jee(t,e){let n=$(t,"a","mul"),s=$(e,"b","mul");[n,s]=en(n,s);const r={a:n,b:s};return D.runKernel(Jd,r)}const L=O({mul_:jee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gee(t){const e=$(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return D.runKernel(lm,n)}else{const n={x:e};return D.runKernel(Jp,n)}}const bn=O({abs_:Gee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hee(t){const n={x:$(t,"x","acos")};return D.runKernel(Cd,n)}const tT=O({acos_:Hee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qee(t){const n={x:$(t,"x","acosh")};return D.runKernel(Nd,n)}const nT=O({acosh_:qee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kee(t){T(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),T(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((r,o)=>$(r,`tensors${o}`,"addN")),n=e[0];e.forEach(r=>{if(r.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(r=>{if(!ut(r.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=e;return D.runKernel(em,s)}const l3=O({addN_:Kee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xee(t,e=null,n=!1){const r={x:$(t,"x","all","bool")},o={axis:e,keepDims:n};return D.runKernel(av,r,o)}const gx=O({all_:Xee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yee(t,e=null,n=!1){const r={x:$(t,"x","any","bool")},o={axis:e,keepDims:n};return D.runKernel(lv,r,o)}const hp=O({any_:Yee});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qee(t,e=0){const s={x:$(t,"x","argMax")},r={axis:e};return D.runKernel(tm,s,r)}const iu=O({argMax_:Qee});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zee(t,e=0){const s={x:$(t,"x","argMin")},r={axis:e};return D.runKernel(nm,s,r)}const sT=O({argMin_:Zee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jee(t){const n={x:$(t,"x","asin")};return D.runKernel(Td,n)}const rT=O({asin_:Jee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ete(t){const n={x:$(t,"x","asinh")};return D.runKernel($d,n)}const oT=O({asinh_:ete});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tte(t){const n={x:$(t,"x","atan")};return D.runKernel(Id,n)}const iT=O({atan_:tte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nte(t,e){let n=$(t,"a","atan2"),s=$(e,"b","atan2");[n,s]=en(n,s);const r={a:n,b:s};return D.runKernel(Rd,r)}const aT=O({atan2_:nte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ste(t){const n={x:$(t,"x","atanh")};return D.runKernel(Ed,n)}const lT=O({atanh_:ste});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rg(t,e,n,s,r="NHWC",o){const i=t[3],a=[...e,i],l=zi(r);return zn(t,a,n,o,s,null,null,l)}function eo(t,e,n,s,r,o,i="channelsLast"){const[a,l]=fp(e);let u;if(i==="channelsLast")u=[a,l,t[3],t[3]];else if(i==="channelsFirst")u=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return zn(t,u,n,s,r,o,!1,i)}function Mi(t,e,n,s,r,o,i="NDHWC"){const[a,l,u]=Ek(e);let c,d;if(i==="NDHWC")d="channelsLast",c=[a,l,u,t[4],t[4]];else if(i==="NCDHW")d="channelsFirst",c=[a,l,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return el(t,c,n,s,r,!1,d,o)}function zn(t,e,n,s,r,o,i=!1,a="channelsLast"){let[l,u,c,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,u,c,d]=t;else if(a==="channelsFirst")[l,d,u,c]=t;else throw new Error(`Unknown dataFormat ${a}`);const[h,f,,p]=e,[m,g]=fp(n),[y,b]=fp(s),v=Sc(h,y),x=Sc(f,b),{padInfo:w,outHeight:S,outWidth:C}=ite(r,u,c,m,g,v,x,o,a),N=i?p*d:p;let I;return a==="channelsFirst"?I=[l,N,S,C]:a==="channelsLast"&&(I=[l,S,C,N]),{batchSize:l,dataFormat:a,inHeight:u,inWidth:c,inChannels:d,outHeight:S,outWidth:C,outChannels:N,padInfo:w,strideHeight:m,strideWidth:g,filterHeight:h,filterWidth:f,effectiveFilterHeight:v,effectiveFilterWidth:x,dilationHeight:y,dilationWidth:b,inShape:t,outShape:I,filterShape:e}}function el(t,e,n,s,r,o=!1,i="channelsLast",a){let[l,u,c,d,h]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,u,c,d,h]=t;else if(i==="channelsFirst")[l,h,u,c,d]=t;else throw new Error(`Unknown dataFormat ${i}`);const[f,p,m,,g]=e,[y,b,v]=Ek(n),[x,w,S]=Ek(s),C=Sc(f,x),N=Sc(p,w),I=Sc(m,S),{padInfo:E,outDepth:A,outHeight:z,outWidth:V}=ate(r,u,c,d,y,b,v,C,N,I,a),P=o?g*h:g;let K;return i==="channelsFirst"?K=[l,P,A,z,V]:i==="channelsLast"&&(K=[l,A,z,V,P]),{batchSize:l,dataFormat:i,inDepth:u,inHeight:c,inWidth:d,inChannels:h,outDepth:A,outHeight:z,outWidth:V,outChannels:P,padInfo:E,strideDepth:y,strideHeight:b,strideWidth:v,filterDepth:f,filterHeight:p,filterWidth:m,effectiveFilterDepth:C,effectiveFilterHeight:N,effectiveFilterWidth:I,dilationDepth:x,dilationHeight:w,dilationWidth:S,inShape:t,outShape:K,filterShape:e}}function rte(t,e,n,s,r){s==null&&(s=uT(t,e,n));const o=t[0],i=t[1],a=pp((o-e+2*s)/n+1,r),l=pp((i-e+2*s)/n+1,r);return[a,l]}function ote(t,e,n,s,r,o){r==null&&(r=uT(t,e[0],s[0]));const i=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*r>=e[a]&&(i[a]=pp((t[a]-e[a]+2*r)/s[a]+1,o));return i}function uT(t,e,n,s=1){const r=Sc(e,s);return Math.floor((t[0]*(n-1)-n+r)/2)}function fp(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function Ek(t){return typeof t=="number"?[t,t,t]:t}function Sc(t,e){return e<=1?t:t+(t-1)*(e-1)}function ite(t,e,n,s,r,o,i,a,l){let u,c,d;if(typeof t=="number"){u={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=rte([e,n],o,s,t,a);c=f[0],d=f[1]}else if(t==="same"){c=Math.ceil(e/s),d=Math.ceil(n/r);const h=Math.max(0,(c-1)*s+o-e),f=Math.max(0,(d-1)*r+i-n),p=Math.floor(h/2),m=h-p,g=Math.floor(f/2),y=f-g;u={top:p,bottom:m,left:g,right:y,type:"SAME"}}else if(t==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-o+1)/s),d=Math.ceil((n-i+1)/r);else if(typeof t=="object"){const h=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],m=l==="channelsLast"?t[2][1]:t[3][1];u={top:h,bottom:f,left:p,right:m,type:h===0&&f===0&&p===0&&m===0?"VALID":"EXPLICIT"},c=pp((e-o+h+f)/s+1,a),d=pp((n-i+p+m)/r+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outHeight:c,outWidth:d}}function ate(t,e,n,s,r,o,i,a,l,u,c){let d,h,f,p;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const g=ote([e,n,s,1],[a,l,u],1,[r,o,i],t,c);h=g[0],f=g[1],p=g[2]}else if(t==="same"){h=Math.ceil(e/r),f=Math.ceil(n/o),p=Math.ceil(s/i);const m=(h-1)*r+a-e,g=(f-1)*o+l-n,y=(p-1)*i+u-s,b=Math.floor(m/2),v=m-b,x=Math.floor(g/2),w=g-x,S=Math.floor(y/2),C=y-S;d={top:x,bottom:w,left:S,right:C,front:b,back:v,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:h,outHeight:f,outWidth:p}}function pp(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function za(t){const[e,n,s]=fp(t);return e===1&&n===1&&s===1}function Jn(t,e){return za(t)||za(e)}function au(t){return fp(t).every(e=>e>0)}function zi(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function Ss(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")T(nu(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{T(nu(r),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lte(t,e){const s={x:$(t,"x","reshape","string_or_numeric")},r={shape:e};return D.runKernel(Um,s,r)}const B=O({reshape_:lte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ute(t,e,n,s,r){const o=$(t,"x","avgPool","float32"),i=1;T(Jn(n,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let a=o,l=!1;o.rank===3&&(l=!0,a=B(o,[1,o.shape[0],o.shape[1],o.shape[2]])),T(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),Ss("avgPool",s,r);const u={x:a},c={filterSize:e,strides:n,pad:s,dimRoundingMode:r};let d=D.runKernel(sm,u,c);return d=be(d,o.dtype),l?B(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const og=O({avgPool_:ute});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cte(t,e,n,s,r,o="NDHWC"){const i=$(t,"x","avgPool3d","float32");let a=i,l=!1;i.rank===4&&(l=!0,a=B(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),T(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),T(o==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),T(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Ss("avgPool3d",s,r);const u={x:a},c={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:o};let d=D.runKernel(rm,u,c);return d=be(d,a.dtype),l?B(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const cT=O({avgPool3d_:cte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dte(t,e=0){T(t.length>=1,()=>"Pass at least one tensor to concat");const n=dp(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),n.length===1)return Ho(n[0]);const s=n,r={axis:e};return D.runKernel(um,s,r)}const hn=O({concat_:dte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hte(t,e,n=!1,s=!1){let r=$(t,"a","matMul"),o=$(e,"b","matMul");[r,o]=en(r,o);const i={a:r,b:o},a={transposeA:n,transposeB:s};return D.runKernel(om,i,a)}const nt=O({matMul_:hte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fte(t){const n={x:$(t,"x","sigmoid","float32")};return D.runKernel(ch,n)}const vo=O({sigmoid_:fte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pte(t,e,n){const s=$(t,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},o={begin:e,size:n};return D.runKernel(qm,r,o)}const ct=O({slice_:pte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mte(t){const n={x:$(t,"x","tanh","float32")};return D.runKernel(gh,n)}const Ba=O({tanh_:mte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gte(t,e,n,s,r,o){const i=$(t,"forgetBias","basicLSTMCell"),a=$(e,"lstmKernel","basicLSTMCell"),l=$(n,"lstmBias","basicLSTMCell"),u=$(s,"data","basicLSTMCell"),c=$(r,"c","basicLSTMCell"),d=$(o,"h","basicLSTMCell"),h=hn([u,d],1),f=nt(h,a),p=ce(f,l),m=p.shape[0],g=p.shape[1]/4,y=[m,g],b=ct(p,[0,0],y),v=ct(p,[0,g],y),x=ct(p,[0,g*2],y),w=ct(p,[0,g*3],y),S=ce(L(vo(b),Ba(v)),L(c,vo(ce(i,x)))),C=L(Ba(S),vo(w));return[S,C]}const u3=O({basicLSTMCell_:gte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yte(t,e,n){const s=$(t,"x","batchToSpaceND"),r=e.reduce((a,l)=>a*l);T(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),T(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),T(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const o={x:s},i={blockShape:e,crops:n};return D.runKernel(im,o,i)}const ig=O({batchToSpaceND_:yte});function bte(t){let e;return t.rank===0||t.rank===1?e=B(t,[1,1,1,t.size]):t.rank===2?e=B(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=B(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vte(t,e,n,s,r,o){o==null&&(o=.001);const i=$(t,"x","batchNorm"),a=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let u;r!=null&&(u=$(r,"scale","batchNorm"));let c;s!=null&&(c=$(s,"offset","batchNorm")),T(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:bte(i),scale:u,offset:c,mean:a,variance:l},f={varianceEpsilon:o},p=D.runKernel(bm,h,f);return B(p,i.shape)}const vh=O({batchNorm_:vte});function xte(t,e,n,s,r,o){const i=$(t,"x","batchNorm"),a=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let u;r!=null&&(u=$(r,"scale","batchNorm"));let c;return s!=null&&(c=$(s,"offset","batchNorm")),T(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),T(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),T(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&T(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&T(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),vh(i,a,l,c,u,o)}const dT=O({batchNorm2d_:xte});function wte(t,e,n,s,r,o){const i=$(t,"x","batchNorm"),a=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let u;r!=null&&(u=$(r,"scale","batchNorm"));let c;return s!=null&&(c=$(s,"offset","batchNorm")),T(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),T(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),T(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&T(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&T(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),vh(i,a,l,c,u,o)}const hT=O({batchNorm3d_:wte});function Ste(t,e,n,s,r,o){const i=$(t,"x","batchNorm"),a=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let u;r!=null&&(u=$(r,"scale","batchNorm"));let c;return s!=null&&(c=$(s,"offset","batchNorm")),T(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),T(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),T(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&T(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&T(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),vh(i,a,l,c,u,o)}const fT=O({batchNorm4d_:Ste});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kte(t,e,n){const s=$(t,"x","bincount"),r=$(e,"weights","bincount");T(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),T(n>=0,()=>`size must be non-negative, but got ${n}.`),T(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const o={x:s,weights:r},i={size:n};return D.runKernel(dv,o,i)}const pT=O({bincount_:kte});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cte(t,e){const n=$(t,"x","bitwiseAnd"),s=$(e,"y","bitwiseAnd");if(!ut(n.shape,s.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${s.shape}`);if(n.dtype!=="int32"||s.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${s.dtype}`);const r={a:n,b:s};return D.runKernel(am,r)}const c3=O({bitwiseAnd_:Cte});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nte(t,e){const n=$(t,"s0","broadcastArgs","int32"),s=$(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const r={s0:n,s1:s};return D.runKernel(hv,r)}const d3=O({broadcastArgs_:Nte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tte(t,e){let n=$(t,"broadcastTo","x");const s=n.shape;if(or(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const u=n.shape.slice();for(;u.length<e.length;)u.unshift(1);n=B(n,u)}const r=n.shape,o=Array.from(e);for(let u=e.length-1;u>=0;u--)if(r[u]===e[u])o[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(o.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return Ho(n);const a={x:n},l={reps:o};return D.runKernel(yh,a,l)}const Gl=O({broadcastTo_:Tte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $te(t){const n={x:$(t,"x","ceil","float32")};return D.runKernel(Ad,n)}const mT=O({ceil_:$te});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iu(t,e,n){or(t),n=n||Cu(e);const s={shape:t,value:e,dtype:n};return D.runKernel(Iv,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ite(t,e,n){const s=$(t,"x","clipByValue");if(T(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Iu(s.shape,e,s.dtype);const r={x:s},o={clipValueMin:e,clipValueMax:n};return D.runKernel(Dd,r,o)}const Os=O({clipByValue_:Ite});function Ete(t){return hn(t,0)}const gT=O({concat1d_:Ete});function Rte(t,e){return hn(t,e)}const yT=O({concat2d_:Rte});function _te(t,e){return hn(t,e)}const bT=O({concat3d_:_te});function Ate(t,e){return hn(t,e)}const vT=O({concat4d_:Ate});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dte(t,e,n,s,r="NHWC",o=[1,1],i){const a=$(t,"x","conv2d","float32"),l=$(e,"filter","conv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=B(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),T(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Ss("conv2d",s,i);const d=r==="NHWC"?u.shape[3]:u.shape[1];T(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),T(Jn(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),T(au(o),()=>"Error in conv2D: Dilated rates should be larger than 0."),T(au(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:u,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i},p=D.runKernel(cm,h,f);return c?B(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Ri=O({conv2d_:Dte});function Ote(t,e,n,s,r="NWC",o=1,i){const a=$(t,"x","conv1d"),l=$(e,"filter","conv1d");let u=a,c=!1;a.rank===2&&(c=!0,u=B(a,[1,a.shape[0],a.shape[1]])),T(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),T(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Ss("conv1d",s,i),T(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),T(Jn(n,o),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${o}'`),T(au(o),()=>"Error in conv1D: Dilated rates should be larger than 0."),T(au(n),()=>"Error in conv1D: Stride should be larger than 0."),T(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const d=B(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=B(u,[u.shape[0],1,u.shape[1],u.shape[2]]),g=Ri(h,d,[1,n],s,"NHWC",[1,o],i);return c?B(g,[g.shape[2],g.shape[3]]):B(g,[g.shape[0],g.shape[2],g.shape[3]])}const yx=O({conv1d_:Ote});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fte(t,e,n,s,r,o="NHWC",i){T(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,u=!1;e.rank===3&&(u=!0,l=B(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),T(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),T(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),T(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=o==="NHWC"?a[3]:a[1],d=o==="NHWC"?l.shape[3]:l.shape[1];T(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),T(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),Ss("conv2dDerInput",r,i);const h={dy:l,filter:n},f={strides:s,pad:r,dataFormat:o,dimRoundingMode:i,inputShape:a},p=D.runKernel(dm,h,f);return u?B(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const xT=O({conv2DBackpropInput_:Fte});function Lte(t,e,n,s,r,o){const i=$(t,"x","conv2dTranspose"),a=$(e,"filter","conv2dTranspose");return xT(n,i,a,s,r,"NHWC",o)}const bx=O({conv2dTranspose_:Lte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pte(t,e,n,s,r="NDHWC",o=[1,1,1]){const i=$(t,"x","conv3d"),a=$(e,"filter","conv3d");let l=i,u=!1;i.rank===4&&(u=!0,l=B(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),T(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),T(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),T(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),T(Jn(n,o),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),T(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),T(au(o),()=>"Error in conv3D: Dilated rates should be larger than 0."),T(au(n),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:l,filter:a},d={strides:n,pad:s,dataFormat:r,dilations:o},h=D.runKernel(hm,c,d);return u?B(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const wT=O({conv3d_:Pte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mte(t,e,n,s,r){T(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let o=t,i=e,a=!1;e.rank===4&&(a=!0,i=B(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,t[0],t[1],t[2],t[3]]);const l=o[4],u=i.shape[4];T(o.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`),T(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),T(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),T(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),T(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c={dy:i,filter:n},d={pad:r,strides:s,inputShape:o},h=D.runKernel(gv,c,d);return a?B(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const h3=O({conv3DBackpropInput_:Mte});function zte(t,e,n,s,r){const o=$(t,"x","conv3dTranspose"),i=$(e,"filter","conv3dTranspose");return h3(n,o,i,s,r)}const ST=O({conv3dTranspose_:zte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bte(t){const n={x:$(t,"x","cos","float32")};return D.runKernel(Od,n)}const ag=O({cos_:Bte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vte(t){const n={x:$(t,"x","cosh","float32")};return D.runKernel(Fd,n)}const vx=O({cosh_:Vte});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ute(t,e=0,n=!1,s=!1){const o={x:$(t,"x","cumprod")},i={axis:e,exclusive:n,reverse:s};return D.runKernel(yv,o,i)}const mp=O({cumprod_:Ute});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wte(t,e=0,n=!1,s=!1){const o={x:$(t,"x","cumsum")},i={axis:e,exclusive:n,reverse:s};return D.runKernel(fm,o,i)}const xx=O({cumsum_:Wte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jte(t,e,n,s=!1){const r=$(t,"x","denseBincount"),o=$(e,"weights","denseBincount");T(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),T(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),T(n>=0,()=>`size must be non-negative, but got ${n}.`),T(o.size===r.size||o.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${o.shape}.`);const i={x:r,weights:o},a={size:n,binaryOutput:s};return D.runKernel(vv,i,a)}const z0=O({denseBincount_:jte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gte(t,e,n="NHWC"){const s=$(t,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],o=n==="NHWC"?s.shape[2]:s.shape[3],i=n==="NHWC"?s.shape[3]:s.shape[1];T(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),T(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),T(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e} for depthToSpace with input shape
        ${s.shape}`),T(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${s.shape}`);const a={x:s},l={blockSize:e,dataFormat:n};return D.runKernel(xv,a,l)}const kT=O({depthToSpace_:Gte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hte(t,e,n,s,r="NHWC",o=[1,1],i){const a=$(t,"x","depthwiseConv2d","float32"),l=$(e,"filter","depthwiseConv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=B(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),T(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=r==="NHWC"?u.shape[3]:u.shape[1];T(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),Ss("depthwiseConv2d",s,i);const h={x:u,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i},p=D.runKernel(pm,h,f);return c?B(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const xh=O({depthwiseConv2d_:Hte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qte(t){const n={x:$(t,"x","diag")};return D.runKernel(kv,n)}const f3=O({diag_:qte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kte(t,e,n,s,r=[1,1],o="NHWC"){const i=$(t,"x","dilation2d"),a=$(e,"filter","dilation2d");T(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),T(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),T(o==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`);let l=i,u=!1;i.rank===3&&(l=B(i,[1,i.shape[0],i.shape[1],i.shape[2]]),u=!0),T(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const c={x:l,filter:a},d={strides:n,pad:s,dilations:r},h=D.runKernel(mm,c,d);return u?B(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const CT=O({dilation2d_:Kte});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lu(t,e){const n=t.length,s=[];for(let r=0;r<n;r++){const o=n-1-r,i=t[o]||1;(e[e.length-1-r]||1)>1&&i===1&&s.unshift(o)}return s}function Sn(t,e){const n=[];for(let s=0;s<e.length;s++){const r=t[t.length-s-1],o=e.length-s-1,i=e[o];(r==null||r===1&&i>1)&&n.unshift(o)}return n}function qe(t,e){const n=Math.max(t.length,e.length),s=new Array(n);for(let r=0;r<n;r++){let o=t[t.length-r-1];o==null&&(o=1);let i=e[e.length-r-1];if(i==null&&(i=1),o===1)s[n-r-1]=i;else if(i===1)s[n-r-1]=o;else if(o!==i){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else s[n-r-1]=o}return s}const Xte=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:qe,getBroadcastDims:lu,getReductionAxes:Sn},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yte(t,e){let n=$(t,"a","equal","string_or_numeric"),s=$(e,"b","equal","string_or_numeric");[n,s]=en(n,s),qe(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(gm,r)}const Zr=O({equal_:Yte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qte(t,e,n){const s=$(e,"a","where"),r=$(n,"b","where"),o=$(t,"condition","where","bool"),i=qe(qe(o.shape,s.shape),r.shape),a=Gl(o,i),l=Gl(s,i),u=Gl(r,i),c={condition:a,t:l,e:u};return D.runKernel(Hm,c)}const Xn=O({where_:Qte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zte(t){const n={x:$(t,"x","zerosLike")};return D.runKernel(tg,n)}const ft=O({zerosLike_:Zte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jte(t,e){let n=$(t,"a","div"),s=$(e,"b","div");[n,s]=en(n,s);const r=Fe(n,s),o=ft(r),i=Zr(s,o);return Xn(i,o,r)}const NT=O({divNoNan_:Jte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ene(t,e){const n=$(t,"t1","dot"),s=$(e,"t2","dot");T((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],o=s.rank===1?s.size:s.shape[0];if(T(r===o,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${o}.`),n.rank===1&&s.rank===1){const i=B(n,[1,-1]),a=B(s,[-1,1]),l=nt(i,a);return B(l,[])}else if(n.rank===1&&s.rank===2){const i=B(n,[1,-1]),a=B(s,[s.shape[0],s.shape[1]]),l=nt(i,a);return B(l,[l.size])}else if(n.rank===2&&s.rank===1){const i=B(s,[-1,1]),a=nt(n,i);return B(a,[a.size])}else{const i=B(s,[s.shape[0],s.shape[1]]);return nt(n,i)}}const TT=O({dot_:ene});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tne(t,...e){const n=e.map((r,o)=>$(r,`tensors${o}`,"einsum")),s={equation:t};return D.runKernel(Nv,n,s)}const xl=O({einsum_:tne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nne(t){const n={x:$(t,"x","elu","float32")};return D.runKernel(Pd,n)}const wh=O({elu_:nne});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sne(t,e){const n=$(t,"x","ensureShape","string_or_numeric");if(!bP(n.shape,e))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${e}`);return t}const p3=O({ensureShape_:sne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rne(t){let e=$(t,"x","erf");T(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=be(e,"float32"));const n={x:e};return D.runKernel(Md,n)}const wx=O({erf_:rne});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $T(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function m3(t,e,n){const s=t.length+e.length,r=[];let o=0,i=0;for(let a=0;a<s;a++)n.indexOf(a)===-1?r.push(t[o++]):r.push(e[i++]);return r}function Bn(t,e){const n=[],s=t.length;for(let o=0;o<s;o++)e.indexOf(o)===-1&&n.push(t[o]);const r=e.map(o=>t[o]);return[n,r]}function fn(t,e){const n=e.map(s=>1);return m3(t,n,e)}function es(t,e,n){T($T(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function tn(t,e){if($T(t,e))return null;const n=[];for(let s=0;s<e;++s)t.indexOf(s)===-1&&n.push(s);return t.forEach(s=>n.push(s)),n}function tl(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function pn(t,e){const n=[];for(let s=e-t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function one(t,e=null,n=!1){const r={x:$(t,"x","max")},o={reductionIndices:e,keepDims:n};return D.runKernel(Im,r,o)}const Sr=O({max_:one});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ine(t,e=null,n=!1){const r={x:$(t,"x","min")},o={axis:e,keepDims:n};return D.runKernel(Am,r,o)}const rd=O({min_:ine});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ane(t,e){let n=$(t,"base","pow"),s=$(e,"exp","pow");[n,s]=en(n,s);const r={a:n,b:s};return D.runKernel(eh,r)}const Zo=O({pow_:ane});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ze(t,e){if((On(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&On(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ja(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lne(t){const n={x:$(t,"x","sqrt","float32")};return D.runKernel(hh,n)}const Mn=O({sqrt_:lne});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function une(t){const e=$(t,"x","square"),n={};return D.runKernel("Square",{x:e},n)}const Tt=O({square_:une});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cne(t,e=null,n=!1){let s=$(t,"x","sum");s.dtype==="bool"&&(s=be(s,"int32"));const r={x:s},o={axis:e,keepDims:n};return D.runKernel(Km,r,o)}const _e=O({sum_:cne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dne(t,e="euclidean",n=null,s=!1){t=$(t,"x","norm");const r=g3(t,e,n);let o=r.shape;if(s){const i=st(n,t.shape);o=fn(r.shape,i)}return B(r,o)}function g3(t,e,n=null){if(t.rank===0)return bn(t);if(t.rank!==1&&n===null)return g3(B(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return _e(bn(t),n);if(e===1/0)return Sr(bn(t),n);if(e===-1/0)return rd(bn(t),n);if(e==="euclidean"||e===2)return Mn(_e(Zo(bn(t),ze(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Sr(_e(bn(t),n[0]),n[1]-1);if(e===1/0)return Sr(_e(bn(t),n[1]),n[0]);if(e===-1/0)return rd(_e(bn(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Mn(_e(Tt(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Sh=O({norm_:dne});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hne(t,e=null,n=!1){return Sh(t,"euclidean",e,n)}const IT=O({euclideanNorm_:hne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fne(t){const n={x:$(t,"x","exp")};return D.runKernel(zd,n)}const Fs=O({exp_:fne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pne(t,e=0){const n=$(t,"x","expandDims","string_or_numeric");T(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:e};return D.runKernel(ym,s,r)}const jn=O({expandDims_:pne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mne(t){const n={x:$(t,"x","expm1")};return D.runKernel(Bd,n)}const ET=O({expm1_:mne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gne(t,e){const n=$(t,"x","tile","string_or_numeric");T(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},r={reps:e};return D.runKernel(yh,s,r)}const yr=O({tile_:gne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yne(t,e,n,s="float32"){e==null&&(e=t);const r=Ze([t,e],s),o=t<=e?t:e;for(let a=0;a<o;++a)r.set(1,a,a);const i=B(r.toTensor(),[t,e]);if(n==null)return i;if(n.length===1)return yr(jn(i,0),[n[0],1,1]);if(n.length===2)return yr(jn(jn(i,0),0),[n[0],n[1],1,1]);if(n.length===3)return yr(jn(jn(jn(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const Sx=O({eye_:yne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bne(t){const n={x:$(t,"x","floor","float32")};return D.runKernel(Vd,n)}const kh=O({floor_:bne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vne(t,e,n=0,s=0){const r=$(t,"x","gather"),o=$(e,"indices","gather","int32"),i={x:r,indices:o},a={axis:n,batchDims:s};return D.runKernel(vm,i,a)}const Ch=O({gather_:vne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xne(t,e){let n=$(t,"a","greater","string_or_numeric"),s=$(e,"b","greater","string_or_numeric");[n,s]=en(n,s),qe(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(xm,r)}const Bs=O({greater_:xne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wne(t,e){let n=$(t,"a","greaterEqual","string_or_numeric"),s=$(e,"b","greaterEqual","string_or_numeric");[n,s]=en(n,s),qe(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(Wd,r)}const Bi=O({greaterEqual_:wne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sne(t){const n={input:$(t,"input","imag")};return D.runKernel(Av,n)}const lg=O({imag_:Sne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kne(t){const n={x:$(t,"x","isFinite")};return D.runKernel(Gd,n)}const RT=O({isFinite_:kne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cne(t){const n={x:$(t,"x","isInf")};return D.runKernel(Hd,n)}const _T=O({isInf_:Cne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nne(t){const n={x:$(t,"x","isNaN")};return D.runKernel(qd,n)}const AT=O({isNaN_:Nne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tne(t,e=.2){const s={x:$(t,"x","leakyRelu")},r={alpha:e};return D.runKernel(wm,s,r)}const ug=O({leakyRelu_:Tne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ne(t,e){let n=$(t,"a","less","string_or_numeric"),s=$(e,"b","less","string_or_numeric");[n,s]=en(n,s),qe(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(Sm,r)}const od=O({less_:$ne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ine(t,e){let n=$(t,"a","lessEqual","string_or_numeric"),s=$(e,"b","lessEqual","string_or_numeric");[n,s]=en(n,s),qe(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(km,r)}const nl=O({lessEqual_:Ine});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y3(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const s={start:t,stop:e,num:n};return D.runKernel(Dv,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ene(t,e=5,n=1,s=1,r=.5){const o=$(t,"x","localResponseNormalization");T(o.rank===4||o.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${o.rank}.`),T(nu(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=o,a=!1;o.rank===3&&(a=!0,i=B(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const l={x:i},u={depthRadius:e,bias:n,alpha:s,beta:r},c=D.runKernel($m,l,u);return a?B(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const DT=O({localResponseNormalization_:Ene});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rne(t){const n={x:$(t,"x","log","float32")};return D.runKernel(Kd,n)}const er=O({log_:Rne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ne(t){const n={x:$(t,"x","log1p")};return D.runKernel(Xd,n)}const cg=O({log1p_:_ne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ane(t){return T(La(t),()=>"The f passed in grad(f) must be a function"),(e,n)=>{const s=$(e,"x","tf.grad","string_or_numeric"),r=n!=null?$(n,"dy","tf.grad"):null;return D.tidy(()=>{const{value:o,grads:i}=D.gradients(()=>t(s),[s],r);return r!=null&&Zn(o.shape,r.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),kx(i),i[0]})}}function Dne(t){return T(La(t),()=>"The f passed in grads(f) must be a function"),(e,n)=>{T(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const s=dp(e,"args","tf.grads","string_or_numeric"),r=n!=null?$(n,"dy","tf.grads"):null;return D.tidy(()=>{const{value:o,grads:i}=D.gradients(()=>t(...s),s,r);return r!=null&&Zn(o.shape,r.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),kx(i),i})}}function One(t){return T(La(t),()=>"The f passed in valueAndGrad(f) must be a function"),(e,n)=>{T(e instanceof vt,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),T(n==null||n instanceof vt,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:s,value:r}=D.gradients(()=>t(e),[e],n);return kx(s),{grad:s[0],value:r}}}function Fne(t){return T(La(t),()=>"The f passed in valueAndGrads(f) must be a function"),(e,n)=>{T(Array.isArray(e)&&e.every(r=>r instanceof vt),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),T(n==null||n instanceof vt,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const s=D.gradients(()=>t(...e),e,n);return n!=null&&Zn(s.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),kx(s.grads),s}}function b3(t,e){T(La(t),()=>"The f passed in variableGrads(f) must be a function"),T(e==null||Array.isArray(e)&&e.every(u=>u instanceof cp),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const u in D.registeredVariables)e.push(D.registeredVariables[u])}const s=n?e.filter(u=>!u.trainable):null,r=e.length;e=e.filter(u=>u.trainable),T(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const o=!0,{value:i,grads:a}=D.gradients(t,e,null,o);T(a.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),T(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return e.forEach((u,c)=>{a[c]!=null&&(l[u.name]=a[c])}),s!=null&&s.forEach(u=>l[u.name]=null),{value:i,grads:l}}function Jo(t){return D.customGrad(t)}function kx(t){if(t.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lne(t){const n={x:$(t,"x","neg")};return D.runKernel(Om,n)}const Dt=O({neg_:Lne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pne(t){const n={x:$(t,"x","softplus")};return D.runKernel(dh,n)}const Eu=O({softplus_:Pne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mne(t){const e=$(t,"x","logSigmoid");return Jo(s=>({value:Dt(Eu(Dt(s))),gradFunc:i=>L(i,vo(Dt(s)))}))(e)}const OT=O({logSigmoid_:Mne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zne(t,e){let n=$(t,"a","sub"),s=$(e,"b","sub");[n,s]=en(n,s);const r={a:n,b:s};return D.runKernel(ph,r)}const Te=O({sub_:zne});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bne(t,e=-1){const n=$(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Jo((r,o)=>{const a=Sr(r,e,!0),l=Te(r,a),u=Te(be(l,"float32"),er(_e(Fs(l),e,!0)));return o([u]),{value:u,gradFunc:(d,h)=>{const[f]=h,p=!0,m=Fs(f);return Te(d,L(_e(d,e,p),m))}}})(n)}const Cx=O({logSoftmax_:Bne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vne(t,e=null,n=!1){const s=$(t,"x","logSumExp"),r=st(e,s.shape),o=Sr(s,r,!0),i=Te(s,o),a=Fs(i),l=_e(a,r),u=er(l),c=ce(B(o,u.shape),u);if(n){const d=fn(c.shape,r);return B(c,d)}return c}const dg=O({logSumExp_:Vne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Une(t,e){const n=$(t,"a","logicalAnd","bool"),s=$(e,"b","logicalAnd","bool");qe(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(Cm,r)}const So=O({logicalAnd_:Une});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wne(t){const n={x:$(t,"x","logicalNot","bool")};return D.runKernel(Nm,n)}const hg=O({logicalNot_:Wne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jne(t,e){const n=$(t,"a","logicalOr","bool"),s=$(e,"b","logicalOr","bool");qe(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(Tm,r)}const Nx=O({logicalOr_:jne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gne(t,e){const n=$(t,"a","logicalXor","bool"),s=$(e,"b","logicalXor","bool");return qe(n.shape,s.shape),So(Nx(t,e),hg(So(t,e)))}const FT=O({logicalXor_:Gne});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const py=2147483648;function Hne(t,e,n="left"){const s=$(t,"sortedSequence","searchSorted"),r=$(e,"values","searchSorted"),o=s.shape[s.shape.length-1],i=r.shape[r.shape.length-1],a=B(s,[-1,o]),l=B(r,[-1,i]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(oe(l.shape)>=py)throw new Error(`values tensor size must less than ${py}`);if(a.shape[1]>=py)throw new Error(`trailing dim_size must less than ${py} for int32 output type, was ${a.shape[1]}`);const u={sortedSequence:a,values:l},c={side:n};return D.runKernel(Qv,u,c)}const Tx=O({searchSorted_:Hne});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v3(t,e){return Tx(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qne(t,e,n,s,r){const o=$(t,"x","maxPool"),i=1;let a=o,l=!1;o.rank===3&&(l=!0,a=B(o,[1,o.shape[0],o.shape[1],o.shape[2]])),T(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),T(Jn(n,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),Ss("maxPool",s,r);const u={x:a},c={filterSize:e,strides:n,pad:s,dimRoundingMode:r},d=D.runKernel(Em,u,c);return l?B(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const fg=O({maxPool_:qne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kne(t,e=[1,1,1],n,s,r,o="NDHWC"){const i=$(t,"x","maxPool3d");let a=i,l=!1;i.rank===4&&(l=!0,a=B(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),T(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),T(o==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),Ss("maxPool3d",s,r);const u={x:a},c={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:o},d=D.runKernel(Rm,u,c);return l?B(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const LT=O({maxPool3d_:Kne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xne(t,e,n,s,r=!1){const i={x:$(t,"x","maxPoolWithArgmax")},a={filterSize:e,strides:n,pad:s,includeBatchInIndex:r},l=D.runKernel(Pv,i,a);return{result:l[0],indexes:l[1]}}const x3=O({maxPoolWithArgmax_:Xne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yne(t,e){let n=$(t,"a","maximum"),s=$(e,"b","maximum");[n,s]=en(n,s),n.dtype==="bool"&&(n=be(n,"int32"),s=be(s,"int32")),qe(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(Yd,r)}const ii=O({maximum_:Yne});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qne(t,e=null,n=!1){const r={x:$(t,"x","mean")},o={axis:e,keepDims:n};return D.runKernel(_m,r,o)}const Zt=O({mean_:Qne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dn(t,e="float32"){if(or(t),e==="complex64"){const s=dn(t,"float32"),r=dn(t,"float32");return Ei(s,r)}const n=Qn(oe(t),e);return D.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Es(t,e="float32"){if(or(t),e==="complex64"){const s=Es(t,"float32"),r=dn(t,"float32");return Ei(s,r)}const n=iv(oe(t),e);return D.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w3(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let s=$(t,"x","meshgrid",t instanceof vt?t.dtype:"float32");if(e===void 0)return[s];let r=$(e,"y","meshgrid",e instanceof vt?e.dtype:"float32");const o=oe(s.shape),i=oe(r.shape);return n==="xy"?(s=B(s,[1,-1]),r=B(r,[-1,1]),[nt(Es([i,1],s.dtype),s),nt(r,Es([1,o],r.dtype))]):(s=B(s,[-1,1]),r=B(r,[1,-1]),[nt(s,Es([1,i],s.dtype)),nt(Es([o,1],r.dtype),r)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zne(t,e){let n=$(t,"a","minimum"),s=$(e,"b","minimum");[n,s]=en(n,s),n.dtype==="bool"&&(n=be(n,"int32"),s=be(s,"int32")),qe(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(Qd,r)}const Va=O({minimum_:Zne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jne(t,e,n){T(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=$(t,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");T(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=n==="reflect"?1:0;for(let a=0;a<s.rank;a++)T(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),T(e[a][0]>=0&&e[a][0]<=s.shape[a]-r&&e[a][1]>=0&&e[a][1]<=s.shape[a]-r,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-r} or less than 0 for input of shape ${s.shape}`);const o={paddings:e,mode:n},i={x:s};return D.runKernel(Dm,i,o)}const PT=O({mirrorPad_:Jne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ese(t,e){let n=$(t,"a","mod"),s=$(e,"b","mod");[n,s]=en(n,s);const r={a:n,b:s};return D.runKernel(Zd,r)}const MT=O({mod_:ese});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tse(t,e=null,n=!1){t=$(t,"x","moments");const s=st(e,t.shape),r=Zt(t,s,n);let o=r.shape;n||(o=fn(r.shape,s));const i=Tt(Te(be(t,"float32"),B(r,o))),a=Zt(i,s,n);return{mean:r,variance:a}}const pg=O({moments_:tse});function nse(t,e,n,s){const r=$(e,"data","multiRNNCell"),o=dp(n,"c","multiRNNCell"),i=dp(s,"h","multiRNNCell");let a=r;const l=[];for(let d=0;d<t.length;d++){const h=t[d](a,o[d],i[d]);l.push(h[0]),l.push(h[1]),a=h[1]}const u=[],c=[];for(let d=0;d<l.length;d+=2)u.push(l[d]),c.push(l[d+1]);return[u,c]}const S3=O({multiRNNCell_:nse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sse(t,e,n,s=!1){const r=$(t,"logits","multinomial"),o=r.size,i=r.rank;if(o<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${o}.`);if(i>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${i}`);n=n||Math.random();const l={logits:i===1?B(r,[1,-1]):r},u={numSamples:e,seed:n,normalized:s},c=D.runKernel(Mv,l,u);return i===1?B(c,[c.size]):c}const k3=O({multinomial_:sse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rse(t,e){let n=$(t,"a","notEqual","string_or_numeric"),s=$(e,"b","notEqual","string_or_numeric");[n,s]=en(n,s),qe(n.shape,s.shape);const r={a:n,b:s};return D.runKernel(Fm,r)}const uu=O({notEqual_:rse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ose(t,e,n=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:$(t,"indices","oneHot","int32")},a={dtype:r,depth:e,onValue:n,offValue:s};return D.runKernel(Pm,i,a)}const id=O({oneHot_:ose});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ise(t){const n={x:$(t,"x","onesLike")};return D.runKernel(Lm,n)}const tr=O({onesLike_:ise});function ase(t,e){const n=$(t,"v1","outerProduct"),s=$(e,"v2","outerProduct");T(n.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${s.rank}.`);const r=B(n,[-1,1]),o=B(s,[1,-1]);return nt(r,o)}const C3=O({outerProduct_:ase});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lse(t,e,n=0){const s=$(t,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:n},o={x:s};return D.runKernel(zm,o,r)}const Vi=O({pad_:lse});function use(t,e,n=0){return T(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Vi(t,[e],n)}const N3=O({pad1d_:use});function cse(t,e,n=0){return T(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Vi(t,e,n)}const T3=O({pad2d_:cse});function dse(t,e,n=0){return T(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Vi(t,e,n)}const $3=O({pad3d_:dse});function hse(t,e,n=0){return T(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Vi(t,e,n)}const I3=O({pad4d_:hse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fse(t,e,n){const s=$(t,"x","spaceToBatchND");T(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),T(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),T(s.shape.reduce((i,a,l)=>l>0&&l<=e.length?i&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:i,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},o={blockShape:e,paddings:n};return D.runKernel(Xm,r,o)}const mg=O({spaceToBatchND_:fse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pse(t,e,n,s,r,o,i){r==null&&(r=[1,1]),o==null&&(o=1),s===0&&(s="valid");const a=$(t,"x","maxPool");let l=a,u=!1;a.rank===3&&(u=!0,l=B(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(Jn(o,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${r}'`);const c=eo(l.shape,e,o,r,s),d=[c.dilationHeight,c.dilationWidth];let h;s==="same"?h=gse([c.filterHeight,c.filterWidth],d):h=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[p,m]=mse([c.inHeight,c.inWidth],d,h),g=f?s:"valid",y=f?l:mg(l,d,p),v=(n==="avg"?()=>og(y,e,o,g,i):()=>fg(y,e,o,g,i))(),x=f?v:ig(v,d,m);return u?B(x,[x.shape[1],x.shape[2],x.shape[3]]):x}function mse(t,e,n){const s=n.map(c=>c[0]),r=n.map(c=>c[1]),o=t.concat(s,r),i=e.map((c,d)=>(c-o[d]%c)%c),a=r.map((c,d)=>c+i[d]),l=e.map((c,d)=>[s[d],a[d]]),u=e.map((c,d)=>[0,i[d]]);return[l,u]}function gse(t,e){const s=t.map((i,a)=>i+(i-1)*(e[a]-1)).map(i=>i-1),r=s.map(i=>Math.floor(i/2)),o=s.map((i,a)=>i-r[a]);return s.map((i,a)=>[r[a],o[a]])}const zT=O({pool_:pse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yse(t,e){const n=$(t,"x","prelu"),s=$(e,"alpha","prelu"),r={x:n,alpha:s};return D.runKernel(Bm,r)}const gg=O({prelu_:yse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bse(t,e=null,n=!1){let s=$(t,"x","prod");s.dtype==="bool"&&(s=be(s,"int32"));const r={x:s},o={axis:e,keepDims:n};return D.runKernel(Vm,r,o)}const BT=O({prod_:bse});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vse(t,e,n,s){const r=t.map((c,d)=>$(c,`tensors${d}`,"raggedGather","int32")),o=$(e,"paramsDenseValues","raggedGather"),i=$(n,"indices","raggedGather","int32"),a={paramsNestedSplits:r,paramsDenseValues:o,indices:i},l={outputRaggedRank:s},u=D.runKernel(Uv,a,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const E3=O({raggedGather_:vse});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xse(t,e,n){const s=$(t,"starts","raggedRange"),r=$(e,"limits","raggedRange",s.dtype),o=$(n,"deltas","raggedRange",s.dtype),i={starts:s,limits:r,deltas:o},a=D.runKernel(Wv,i);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}const R3=O({raggedRange_:xse});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wse(t,e,n,s,r){const o=$(t,"shape","raggedTensorToTensor","int32"),i=$(e,"values","raggedTensorToTensor"),a=$(n,"defaultValue","raggedTensorToTensor",i.dtype),l=s.map((d,h)=>$(d,`tensors${h}`,"raggedTensorToTensor","int32")),u={shape:o,values:i,defaultValue:a,rowPartitionTensors:l},c={rowPartitionTypes:r};return D.runKernel(jv,u,c)}const _3=O({raggedTensorToTensor_:wse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sse(t,e,n){or(t);const s=oe(t);let r=null;if(n==null||n==="float32")r=new Float32Array(s);else if(n==="int32")r=new Int32Array(s);else if(n==="bool")r=new Uint8Array(s);else throw new Error(`Unknown data type ${n}`);for(let o=0;o<s;o++)r[o]=e();return D.makeTensor(r,t,n)}const A3=O({rand_:Sse});var VT={exports:{}};VT.exports;(function(t){(function(e,n,s){function r(l){var u=this,c=a();u.next=function(){var d=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=d-(u.c=d|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function o(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function i(l,u){var c=new r(l),d=u&&u.state,h=c.next;return h.int32=function(){return c.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,d&&(typeof d=="object"&&o(d,c),h.state=function(){return o(c,{})}),h}function a(){var l=4022871197,u=function(c){c=String(c);for(var d=0;d<c.length;d++){l+=c.charCodeAt(d);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=i:s&&s.amd?s(function(){return i}):this.alea=i})(yu,t,!1)})(VT);var kse=VT.exports,UT={exports:{}};UT.exports;(function(t){(function(e,n,s){function r(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function i(a,l){var u=new r(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:s&&s.amd?s(function(){return i}):this.xor128=i})(yu,t,!1)})(UT);var Cse=UT.exports,WT={exports:{}};WT.exports;(function(t){(function(e,n,s){function r(a){var l=this,u="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function i(a,l){var u=new r(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:s&&s.amd?s(function(){return i}):this.xorwow=i})(yu,t,!1)})(WT);var Nse=WT.exports,jT={exports:{}};jT.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var c=l.x,d=l.i,h,f;return h=c[d],h^=h>>>7,f=h^h<<24,h=c[d+1&7],f^=h^h>>>10,h=c[d+3&7],f^=h^h>>>3,h=c[d+4&7],f^=h^h<<7,h=c[d+7&7],h=h^h<<13,f^=h^h<<9,c[d]=f,l.i=d+1&7,f};function u(c,d){var h,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,h=0;h<d.length;++h)f[h&7]=f[h&7]<<15^d.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?f[7]=-1:f[h],c.x=f,c.i=0,h=256;h>0;--h)c.next()}u(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function i(a,l){a==null&&(a=+new Date);var u=new r(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(c.x&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:s&&s.amd?s(function(){return i}):this.xorshift7=i})(yu,t,!1)})(jT);var Tse=jT.exports,GT={exports:{}};GT.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var c=l.w,d=l.X,h=l.i,f,p;return l.w=c=c+1640531527|0,p=d[h+34&127],f=d[h=h+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=d[h]=p^f,l.i=h,p+(c^c>>>16)|0};function u(c,d){var h,f,p,m,g,y=[],b=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,b=Math.max(b,d.length)),p=0,m=-32;m<b;++m)d&&(f^=d.charCodeAt((m+32)%d.length)),m===0&&(g=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(g=g+1640531527|0,h=y[m&127]^=f+g,p=h==0?p+1:0);for(p>=128&&(y[(d&&d.length||0)&127]=-1),p=127,m=4*128;m>0;--m)f=y[p+34&127],h=y[p=p+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,y[p]=f^h;c.w=g,c.X=y,c.i=p}u(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function i(a,l){a==null&&(a=+new Date);var u=new r(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(c.X&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:s&&s.amd?s(function(){return i}):this.xor4096=i})(yu,t,!1)})(GT);var $se=GT.exports,HT={exports:{}};HT.exports;(function(t){(function(e,n,s){function r(a){var l=this,u="";l.next=function(){var d=l.b,h=l.c,f=l.d,p=l.a;return d=d<<25^d>>>7^h,h=h-f|0,f=f<<24^f>>>8^p,p=p-d|0,l.b=d=d<<20^d>>>12^h,l.c=h=h-f|0,l.d=f<<16^h>>>16^p,l.a=p-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function i(a,l){var u=new r(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var h=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:s&&s.amd?s(function(){return i}):this.tychei=i})(yu,t,!1)})(HT);var Ise=HT.exports,D3={exports:{}};const Ese={},Rse=Object.freeze(Object.defineProperty({__proto__:null,default:Ese},Symbol.toStringTag,{value:"Module"})),_se=EU(Rse);(function(t){(function(e,n,s){var r=256,o=6,i=52,a="random",l=s.pow(r,o),u=s.pow(2,i),c=u*2,d=r-1,h;function f(x,w,S){var C=[];w=w==!0?{entropy:!0}:w||{};var N=y(g(w.entropy?[x,v(n)]:x??b(),3),C),I=new p(C),E=function(){for(var A=I.g(o),z=l,V=0;A<u;)A=(A+V)*r,z*=r,V=I.g(1);for(;A>=c;)A/=2,z/=2,V>>>=1;return(A+V)/z};return E.int32=function(){return I.g(4)|0},E.quick=function(){return I.g(4)/4294967296},E.double=E,y(v(I.S),n),(w.pass||S||function(A,z,V,P){return P&&(P.S&&m(P,I),A.state=function(){return m(I,{})}),V?(s[a]=A,z):A})(E,N,"global"in w?w.global:this==s,w.state)}function p(x){var w,S=x.length,C=this,N=0,I=C.i=C.j=0,E=C.S=[];for(S||(x=[S++]);N<r;)E[N]=N++;for(N=0;N<r;N++)E[N]=E[I=d&I+x[N%S]+(w=E[N])],E[I]=w;(C.g=function(A){for(var z,V=0,P=C.i,K=C.j,Y=C.S;A--;)z=Y[P=d&P+1],V=V*r+Y[d&(Y[P]=Y[K=d&K+z])+(Y[K]=z)];return C.i=P,C.j=K,V})(r)}function m(x,w){return w.i=x.i,w.j=x.j,w.S=x.S.slice(),w}function g(x,w){var S=[],C=typeof x,N;if(w&&C=="object")for(N in x)try{S.push(g(x[N],w-1))}catch{}return S.length?S:C=="string"?x:x+"\0"}function y(x,w){for(var S=x+"",C,N=0;N<S.length;)w[d&N]=d&(C^=w[d&N]*19)+S.charCodeAt(N++);return v(w)}function b(){try{var x;return h&&(x=h.randomBytes)?x=x(r):(x=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(x)),v(x)}catch{var w=e.navigator,S=w&&w.plugins;return[+new Date,e,S,e.screen,v(n)]}}function v(x){return String.fromCharCode.apply(0,x)}if(y(s.random(),n),t.exports){t.exports=f;try{h=_se}catch{}}else s["seed"+a]=f})(typeof self<"u"?self:yu,[],Math)})(D3);var Ase=D3.exports,Dse=kse,Ose=Cse,Fse=Nse,Lse=Tse,Pse=$se,Mse=Ise,Ru=Ase;Ru.alea=Dse;Ru.xor128=Ose;Ru.xorwow=Fse;Ru.xorshift7=Lse;Ru.xor4096=Pse;Ru.tychei=Mse;var yg=Ru;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zse=.001,O3=.1;function Bse(t,e,n){return n==null&&(n=qT()),Rk(t,e,(s,r)=>KT(s,r,n))}function qT(){return D.backend.floatPrecision()===32?zse:O3}function Rk(t,e,n){let s=!0;if((On(t)||On(e))&&(s=!1),On(t)&&On(e)&&(s=!0),s){const i=t.constructor.name,a=e.constructor.name;if(i!==a)throw new Error(`Arrays are of different type. Actual: ${i}. Expected: ${a}`)}if(Array.isArray(t)&&Array.isArray(e)){const i=Qo(t),a=Qo(e);if(!ut(i,a))throw new Error(`Arrays have different shapes. Actual: [${i}]. Expected: [${a}]`)}const r=On(t)?t:Yo(t),o=On(e)?e:Yo(e);if(r.length!==o.length)throw new Error(`Arrays have different lengths actual: ${r.length} vs expected: ${o.length}.
Actual:   ${r}.
Expected: ${o}.`);for(let i=0;i<o.length;++i){const a=r[i],l=o[i];if(!n(a,l))throw new Error(`Arrays differ: actual[${i}] = ${a}, expected[${i}] = ${l}.
Actual:   ${r}.
Expected: ${o}.`)}typeof expect<"u"&&expect().nothing()}function Vse(t,e){t().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function Use(t,e){const n=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return Vo(t)||Vo(t[0])||Vo(e)||Vo(e[0])?Rk(t,n,(s,r)=>s==r):Rk(t,e,(s,r)=>KT(s,r,0))}function Wse(t,e,n){if(n==null&&(n=qT()),!KT(t,e,n))throw new Error(`Numbers differ: actual === ${t}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function KT(t,e,n){return!isFinite(t)&&!isFinite(e)?!0:!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function jse(t,e,n){for(let s=0;s<t.length;s++)if(t[s]<e||t[s]>n)throw new Error(`Value out of range:${t[s]} low: ${e}, high: ${n}`)}function Gse(t,e){const n=new Float32Array(t),s=new Float32Array(e);if(n.length!==s.length)throw new Error(`Expected ArrayBuffer to be of length ${s.length}, but it was ${n.length}`);for(let r=0;r<s.length;r++)if(n[r]!==s[r])throw new Error(`Expected ArrayBuffer value at ${r} to be ${s[r]} but got ${n[r]} instead`)}function F3(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?F3(n):t[e]=Go(n)}return t}function Hse(t){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(t),new Promise(n=>{e.addEventListener("loadeddata",s=>n(e)),e.load()})}async function qse(t){await t.play(),"requestVideoFrameCallback"in t&&await new Promise(e=>{t.requestVideoFrameCallback(e)})}const Kse=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:O3,createVideoElement:Hse,encodeStrings:F3,expectArrayBuffersEqual:Gse,expectArraysClose:Bse,expectArraysEqual:Use,expectNumbersClose:Wse,expectPromiseToFail:Vse,expectValuesInRange:jse,play:qse,testEpsilon:qT},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XT{constructor(e,n,s,r,o){this.mean=e,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=o||Math.random();this.random=yg.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,n,s=!1;for(;!s;){let r,o,i;do r=2*this.random()-1,o=2*this.random()-1,i=r*r+o*o;while(i>=1||i===0);const a=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*r*a,n=this.mean+this.stdDev*o*a,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class Xse{constructor(e,n,s,r){this.alpha=e,this.beta=1/n,this.dtype=s;const o=r||Math.random();this.randu=yg.alea(o.toString()),this.randn=new XT(0,1,s,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,s,r,o,i;for(;;){do r=this.randn.nextValue(),i=1+this.c*r;while(i<=0);if(i*=i*i,e=r*r,n=1-.331*e*e,s=.5*e+this.d*(1-i+Math.log(i)),o=this.randu(),o<n||Math.log(o)<s)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class Yse{constructor(e=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=yg.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qse(t,e,n=1,s="float32",r){if(or(t),n==null&&(n=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const o=new Xse(e,n,s,r),i=Ze(t,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const L3=O({randomGamma_:Qse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zse(t,e=0,n=1,s,r){if(or(t),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const o=new XT(e,n,s,!1,r),i=Ze(t,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const $x=O({randomNormal_:Zse});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jse(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return $x(t,0,1,e,n)}const P3=O({randomStandardNormal_:Jse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ere(t,e=0,n=1,s="float32",r){or(t);const o=Ze(t,s),i=new Yse(e,n,null,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const sl=O({randomUniform_:ere});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tre(t,e,n,s){return sl(t,e,n,"int32",s)}const M3=O({randomUniformInt_:tre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cu(t,e,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:t,stop:e,step:n,dtype:s};return D.runKernel(Gv,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nre(t){const n={input:$(t,"input","real")};return D.runKernel(Hv,n)}const ad=O({real_:nre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sre(t){const n={x:$(t,"x","reciprocal")};return D.runKernel(th,n)}const YT=O({reciprocal_:sre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rre(t){const n={x:$(t,"x","relu")};return D.runKernel(nh,n)}const Io=O({relu_:rre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ore(t){const n={x:$(t,"x","relu6")};return D.runKernel(sh,n)}const Ix=O({relu6_:ore});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ire(t,e){const s={x:$(t,"x","reverse")},r={dims:e};return D.runKernel(Gm,s,r)}const Cr=O({reverse_:ire});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function are(t){const e=$(t,"x","reverse");return T(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Cr(e,0)}const z3=O({reverse1d_:are});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lre(t,e){const n=$(t,"x","reverse");return T(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Cr(n,e)}const B3=O({reverse2d_:lre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ure(t,e){const n=$(t,"x","reverse");return T(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Cr(n,e)}const V3=O({reverse3d_:ure});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cre(t,e){const n=$(t,"x","reverse");return T(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Cr(n,e)}const U3=O({reverse4d_:cre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dre(t){const n={x:$(t,"x","round")};return D.runKernel(rh,n)}const Ex=O({round_:dre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hre(t){const n={x:$(t,"x","rsqrt","float32")};return D.runKernel(oh,n)}const Rx=O({rsqrt_:hre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fre(t){const n={x:$(t,"x","selu")};return D.runKernel(ih,n)}const _x=O({selu_:fre});function pre(t,e,n,s,r,o=[1,1],i="NHWC"){const a=$(t,"x","separableConv2d"),l=$(e,"depthwiseFilter","separableConv2d"),u=$(n,"pointwiseFilter","separableConv2d");let c=a,d=!1;if(a.rank===3&&(d=!0,c=B(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");T(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),T(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),T(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),T(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),T(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const h=l.shape[2],f=l.shape[3];T(u.shape[2]===h*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*f}, but got ${u.shape[2]}.`);const p=xh(c,l,s,r,i,o),g=Ri(p,u,1,"valid",i);return d?B(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const Ax=O({separableConv2d_:pre});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function mre(t,e){const n=$(t,"x","setdiff1d"),s=$(e,"y","setdiff1d");T(n.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${s.dtype}).`),T(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),T(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const r=await n.data(),o=await s.data(),i=new Set(o);let a=0;for(let c=0;c<r.length;c++)i.has(r[c])||a++;const l=new xn([a],n.dtype),u=new xn([a],"int32");for(let c=0,d=0;c<r.length;c++)i.has(r[c])||(l.values[d]=r[c],u.values[d]=c,d++);return[l.toTensor(),u.toTensor()]}const W3=mre;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gre(t){const n={x:$(t,"x","sign")};return D.runKernel(uh,n)}const QT=O({sign_:gre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yre(t){const n={x:$(t,"x","sin","float32")};return D.runKernel(ah,n)}const Dx=O({sin_:yre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bre(t){const n={x:$(t,"x","sinh")};return D.runKernel(lh,n)}const Ox=O({sinh_:bre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vre(t,e,n){const s=$(t,"x","slice1d");return T(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),ct(s,[e],[n])}const bg=O({slice1d_:vre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xre(t,e,n){const s=$(t,"x","slice2d");return T(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),ct(s,e,n)}const Fx=O({slice2d_:xre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wre(t,e,n){const s=$(t,"x","slice3d");return T(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),ct(s,e,n)}const vg=O({slice3d_:wre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sre(t,e,n){const s=$(t,"x","slice4d");return T(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),ct(s,e,n)}const ld=O({slice4d_:Sre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kre(t,e=-1){const n=$(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const s={logits:n},r={dim:e};return D.runKernel(Qm,s,r)}const Nh=O({softmax_:kre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cre(t){T(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return D.runKernel($v,e)}const xg=O({fft_:Cre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nre(t){T(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return D.runKernel(_v,e)}const ud=O({ifft_:Nre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tre(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const r=B(t,[n,e]);s=ud(r)}else{const r=[n,2*(e-1)],o=B(ad(t),[n,e]),i=B(lg(t),[n,e]),a=Cr(ct(o,[0,1],[n,e-2]),1),l=L(Cr(ct(i,[0,1],[n,e-2]),1),ze(-1)),u=hn([o,a],1),c=hn([i,l],1),d=B(Ei(u,c),[r[0],r[1]]);s=ud(d)}if(s=ad(s),t.rank===3&&t.shape[0]!==0){const r=s,o=t.shape[0];s=B(s,[o,s.shape[0]/o,s.shape[1]]),r.dispose()}return s}const Lx=O({irfft_:Tre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $re(t,e,n=0){const r={x:$(t,"x","split")},o={numOrSizeSplits:e,axis:n};return D.runKernel(Ym,r,o)}const _s=O({split_:$re});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ire(t,e){T(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const s=t.size/n;let r;if(e!=null&&e<n){const p=t.shape.map(g=>0),m=t.shape.map(g=>g);m[t.shape.length-1]=e,r=ct(t,p,m),n=e}else if(e!=null&&e>n){const p=t.shape.map(m=>m);p[t.shape.length-1]=e-n,r=hn([t,dn(p)],t.shape.length-1),n=e}else r=t;const o=ft(r),i=B(Ei(r,o),[s,n]),a=xg(i),l=Math.floor(n/2)+1,u=ad(a),c=lg(a),d=_s(u,[l,n-l],u.shape.length-1),h=_s(c,[l,n-l],c.shape.length-1),f=r.shape.slice();return f[r.shape.length-1]=l,B(Ei(d[0],h[0]),f)}const wg=O({rfft_:Ire});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ere(t,e){let n=$(t,"a","squaredDifference"),s=$(e,"b","squaredDifference");[n,s]=en(n,s),qe(n.shape,s.shape);const r={a:n,b:s},o={};return D.runKernel(fh,r,o)}const Px=O({squaredDifference_:Ere});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rre(t,e){const n=$(t,"x","squeeze","string_or_numeric");return B(n,Li(n.shape,e).newShape)}const Ui=O({squeeze_:Rre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _re(t,e=0){const n=dp(t,"tensors","stack","string_or_numeric");T(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&T(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:e};return D.runKernel(Mm,s,r)}const Ls=O({stack_:_re});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Are(t,e=0){const s={x:$(t,"x","step")},r={alpha:e};return D.runKernel(bh,s,r)}const _u=O({step_:Are});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dre(t,e,n,s,r=0,o=0,i=0,a=0,l=0){const c={x:$(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:s,beginMask:r,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};return D.runKernel(rx,c,d)}const ZT=O({stridedSlice_:Dre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ore(t){const n={x:$(t,"x","tan","float32")};return D.runKernel(mh,n)}const JT=O({tan_:Ore});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qn(t,e){ku(t);const n=Qo(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ja(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ra(t,e,n){if(ku(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Qo(t,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ja(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e$(t,e,n){if(ku(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=Qo(t,n);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Ja(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j3(t,e,n){if(ku(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=Qo(t,n);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Ja(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G3(t,e,n){if(ku(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=Qo(t,n);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Ja(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H3(t,e,n){if(ku(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=Qo(t,n);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||s,Ja(t,e,s,n)}function t$(t,e,n){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(o+` update.rank < ${r}. `);if(t.length<s+(n.rank-r))throw new Error(o+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+t.length-s)throw new Error(o+` update.rank != ${r+t.length-s}`);for(let i=0;i<r;++i)if(n.shape[i]!==e.shape[i])throw new Error(o+` updates.shape[${i}] (${n.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<n.rank-r;++i)if(n.shape[i+r]!==t[i+s])throw new Error(o+` updates.shape[${i+r}] (${n.shape[i+r]}) != shape[${i+r}] (${t[i+r]})`)}function Mx(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}t$(n,e,t)}function rl(t,e,n){const s=e.shape.length,r=s>1?e.shape[s-1]:1,o=n.length;let i=1;for(let d=r;d<o;++d)i*=n[d];const a=r<1?1:r,l=oe(e.shape)/a,u=[...Le(n.slice(0,r)),1],c=oe(n);return{sliceRank:r,numUpdates:l,sliceSize:i,strides:u,outputSize:c}}const Fre=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:rl,validateInput:Mx,validateUpdateShape:t$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lre(t,e,n){const s=$(t,"tensor","tensorScatterupdate"),r=$(e,"indices","tensorScatterupdate","int32"),o=$(n,"updates","tensorScatterupdate");if(Mx(o,r,s.shape),s.dtype!==o.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${s.dtype} and ${o.dtype}.`);const i={tensor:s,indices:r,updates:o},a={};return D.runKernel(Yv,i,a)}const q3=O({tensorScatterUpdate_:Lre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pre(t,e=1,n=!0){const s=$(t,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const o={x:s},i={k:e,sorted:n},[a,l]=D.runKernel(lx,o,i);return{values:a,indices:l}}const n$=O({topk_:Pre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mre(t,e=0,n=1,s,r){if(or(t),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new XT(e,n,s,!0,r),i=Ze(t,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const zx=O({truncatedNormal_:Mre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zre(t,e=0){const n=$(t,"x","unique","string_or_numeric");T(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:e},[o,i]=D.runKernel(cx,s,r);return{values:o,indices:i}}const s$=O({unique_:zre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bre(t,e,n){const s=$(t,"x","unsortedSegmentSum"),r=$(e,"segmentIds","unsortedSegmentSum","int32");T(nu(n),()=>"numSegments must be of dtype int");const o={x:s,segmentIds:r},i={numSegments:n};return D.runKernel(eg,o,i)}const Bx=O({unsortedSegmentSum_:Bre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vre(t,e=0){const n=$(t,"x","unstack","string_or_numeric");T(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:e};return D.runKernel(Jm,s,r)}const Nr=O({unstack_:Vre});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K3(t,e){return Tx(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r$(t,e=!0,n,s){return D.makeVariable(t,e,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vx(t,e){const n=[];for(let o=0;o<e.length;o++)e[o]&&n.push(o);const s=Ze(t,"int32"),r=Ze([n.length,t.length],"int32");for(let o=0;o<n.length;o++){const i=s.indexToLoc(n[o]),a=o*t.length;r.values.set(i,a)}return r.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Ure(t){const e=$(t,"condition","whereAsync","bool"),n=await e.data(),s=Vx(e.shape,n);return t!==e&&e.dispose(),s}const o$=Ure;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Wre(t,e,n){const s=$(t,"tensor","boolMask"),r=$(e,"mask","boolMask","bool"),o=n??0,i=r.rank,a=s.shape;T(i>0,()=>"mask cannot be scalar"),Zn(a.slice(o,o+i),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let m=o;m<o+i;m++)l*=a[m];const u=a.slice(0,o).concat([l],a.slice(o+i)),c=B(s,u),d=B(r,[-1]),h=await o$(d),f=Ui(h,[1]),p=Ch(c,f,o);return t!==s&&s.dispose(),e!==r&&r.dispose(),f.dispose(),c.dispose(),d.dispose(),h.dispose(),p}const X3=Wre;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jre(t,e,n){const s=$(t,"x","transpose");if(e==null&&(e=s.shape.map((i,a)=>a).reverse()),T(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(i=>{T(i>=0&&i<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},o={perm:e};return s.dtype==="complex64"?Q(()=>{let i=ad(s),a=lg(s);return i=D.runKernel(jl,{x:i},o),a=D.runKernel(jl,{x:a},o),n&&(a=Dt(a)),Ei(i,a)}):D.runKernel(jl,r,o)}const dt=O({transpose_:jre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gre(t,e,n,s,r=!0){const o=$(t,"v","movingAverage"),i=$(e,"x","movingAverage"),a=$(n,"decay","movingAverage");WP(o,i),T(ut(o.shape,i.shape),()=>"Shape mismatch in v and x");const l=ze(1),u=Te(l,a);let c=L(Te(i,o),u);if(r){T(s!=null,()=>"When using zeroDebias: true, step is required.");const d=$(s,"step","movingAverage");c=Fe(c,Te(l,Zo(a,d)))}return ce(o,c)}const Y3=O({movingAverage_:Gre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hre(t,e,n){or(n);const s=$(t,"indices","scatterND","int32"),r=$(e,"updates","scatterND");Mx(r,s,n);const o={indices:s,updates:r},i={shape:n};return D.runKernel(Xv,o,i)}const Q3=O({scatterND_:Hre});function qre(t,e,n,s){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const r=t.rank>0?t.shape[0]:1,o=t.rank>1?t.shape[1]:1;if(n.length!==o)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${o}.`);const i=e.size;if(!(e.rank===0||e.rank===1&&i===r))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${r}]`);if(e.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kre(t,e,n,s=0){or(n);const r=$(t,"sparseIndices","sparseToDense","int32"),o=$(e,"sparseValues","sparseToDense","string_or_numeric"),i=$(s,"defaultValue","sparseToDense",o.dtype);qre(r,o,n,i);const a={sparseIndices:r,sparseValues:o,defaultValue:i},l={outputShape:n};return D.runKernel(nx,a,l)}const Z3=O({sparseToDense_:Kre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xre(t,e){const n=$(e,"indices","gatherND","int32"),r={params:$(t,"x","gatherND","string_or_numeric"),indices:n};return D.runKernel(Rv,r)}const J3=O({gatherND_:Xre});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yre(t,e){if(e==null)return t.shape.slice();if(ut(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let s=0;s<t.shape.length;s++)e[s]==null&&t.shape[s]!=null?n.push(t.shape[s]):n.push(e[s]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qre(t,e,n,s){const r=$(t,"x","dropout");if(T(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),T(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof vt?r.clone():r;const o=Yre(r,n),i=1-e,a=Fe(kh(ce(sl(o,0,1,"float32",s),i)),i);return L(r,a)}const i$=O({dropout_:Qre});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a$(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function Ux(t,e,n){const s=1-t%2,r=new Float32Array(t);for(let o=0;o<t;++o){const i=2*Math.PI*o/(t+s-1);r[o]=e-n*Math.cos(i)}return qn(r,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Zre(t,e,n=1){const s=$(t,"predictions","inTopK"),r=$(e,"targets","inTopK");T(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),T(s.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${r.rank}`),Zn(s.shape.slice(0,s.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const o=s.shape[s.shape.length-1];T(n>0&&n<=o,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${o}), but got ${n}`);const i=await s.data(),a=await r.data(),[l,u]=[i.length/o,o],c=Pn("bool",l);for(let d=0;d<l;d++){const h=d*u,f=i.subarray(h,h+u),p=[];for(let m=0;m<f.length;m++)p.push({value:f[m],index:m});p.sort((m,g)=>g.value-m.value),c[d]=0;for(let m=0;m<n;m++)if(p[m].index===a[d]){c[d]=1;break}}return t!==s&&s.dispose(),e!==r&&r.dispose(),Xr(c,r.shape,"bool")}const eM=Zre;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jre(t,e,n,s,r,o="NHWC",i){let a=t;t.rank===3&&(a=B(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=B(e,[1,e.shape[0],e.shape[1],e.shape[2]])),T(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),T(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),T(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=o==="NHWC"?a.shape[3]:a.shape[1],c=o==="NHWC"?l.shape[3]:l.shape[1];T(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),T(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),Ss("conv2dDerFilter",r,i);const d={x:a,dy:l},h={strides:s,pad:r,dataFormat:o,dimRoundingMode:i,filterShape:n};return D.runKernel(pv,d,h)}const l$=O({conv2DBackpropFilter_:Jre});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wx(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return L(t,_u(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function jx(t,e){let n=e;const s=Sn(t.shape,e.shape);return s.length>0&&(n=_e(n,s)),B(n,t.shape)}function Gx(t,e,n,s){if(e==="linear")return t;if(e==="relu")return Io(t);if(e==="elu")return wh(t);if(e==="relu6")return Ix(t);if(e==="prelu")return gg(t,n);if(e==="leakyrelu")return ug(t,s);if(e==="sigmoid")return vo(t);throw new Error(`Unknown fused activation ${e}.`)}const Hx=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eoe({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",Hx(D.state.gradientDepth,l)===!1){T(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let S=Ri(t,e,n,s,r,o,i);return a!=null&&(S=ce(S,a)),Gx(S,l,u,c)}const d=$(t,"x","conv2d","float32"),h=$(e,"filter","conv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=B(d,[1,d.shape[0],d.shape[1],d.shape[2]])),T(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),T(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),Ss("fused conv2d",s,i);const m=r==="NHWC"?f.shape[3]:f.shape[1];T(h.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${h.shape[2]}.`),T(Jn(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);const g=zn(f.shape,h.shape,n,o,s,i);let y;a!=null&&(y=$(a,"bias","fused conv2d"),[y]=en(y,d),r==="NHWC"?qe(g.outShape,y.shape):(T(y.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${y.shape.length}.`),T(y.shape.length===0||y.shape[0]===g.outChannels||y.shape[0]===1,()=>`Error in fused conv2d: bias shape (${y.shape}) is not compatible with the number of output channels (${g.outChannels})`)));let b;if(u!=null){const S=u.shape;if(T(S.length<=1||S.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${S.length}.`),S.length===1)T(S[0]===1||S[0]===g.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the number of output channels (${g.outChannels}).`);else if(S.length===3)try{qe(S,g.outShape)}catch{const N=`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the output shape of the conv2d (${g.outShape}).`;throw Error(N)}b=$(u,"prelu weights","fused conv2d")}const v=(S,C)=>{T(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[N,I,E,A]=C,z=Wx(S,E,l);T(za(o),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const V=xT(I.shape,z,N,n,s),P=l$(I,z,N.shape,n,s),K=[V,P];if(A!=null){const Y=jx(A,z);K.push(Y)}return K},x={x:f,filter:h,bias:y,preluActivationWeights:b},w={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i,activation:l,leakyreluAlpha:c};return a==null?Jo((C,N,I)=>{let E=D.runKernel(ip,x,w);return I([N,C,E]),p&&(E=B(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:v}})(f,h):Jo((C,N,I,E)=>{let A=D.runKernel(ip,x,w);return E([N,C,A,I]),p&&(A=B(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:v}})(f,h,y)}const tM=O({fusedConv2d_:eoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function toe(t,e,n,s,r,o=[1,1],i){let a=t;t.rank===3&&(a=B(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=B(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:a,dy:l},c={strides:s,pad:r,dimRoundingMode:i,dilations:o,filterShape:n};return D.runKernel(wv,u,c)}const nM=O({depthwiseConv2dNativeBackpropFilter_:toe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function noe(t,e,n,s,r,o=[1,1],i){let a=e,l=!1;e.rank===3&&(l=!0,a=B(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:a,filter:n},c={strides:s,pad:r,dimRoundingMode:i,dilations:o,inputShape:t},d=D.runKernel(Sv,u,c);return l?B(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const sM=O({depthwiseConv2dNativeBackpropInput_:noe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function soe({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(Hx(D.state.gradientDepth,l)===!1){let w=xh(t,e,n,s,r,o,i);return a!=null&&(w=ce(w,a)),Gx(w,l,u,c)}const d=$(t,"x","depthwiseConv2d","float32"),h=$(e,"filter","depthwiseConv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=B(d,[1,d.shape[0],d.shape[1],d.shape[2]])),T(f.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`),T(h.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`),T(f.shape[3]===h.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),o==null&&(o=[1,1]),T(Jn(n,o),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),Ss("fused depthwiseConv2d",s,i);const m=zn(f.shape,h.shape,n,o,s,i,!0);let g;a!=null&&(g=$(a,"bias","fused conv2d"),[g]=en(g,d),qe(m.outShape,g.shape));let y;u!=null&&(y=$(u,"prelu weights","fused depthwiseConv2d"));const b=(w,S)=>{T(za(o),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[C,N,I,E]=S,A=Wx(w,I,l),z=sM(N.shape,A,C,n,s,o,i),V=nM(N,A,C.shape,n,s,o,i);if(E!=null){const P=jx(g,A);return[z,V,P]}return[z,V]},v={x:f,filter:h,bias:g,preluActivationWeights:y},x={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i,activation:l,leakyreluAlpha:c};return a==null?Jo((S,C,N)=>{let I=D.runKernel(ap,v,x);return N([C,S,I]),p&&(I=B(I,[I.shape[1],I.shape[2],I.shape[3]])),{value:I,gradFunc:b}})(f,h):Jo((S,C,N,I)=>{let E=D.runKernel(ap,v,x);return I([C,S,E,N]),p&&(E=B(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:b}})(f,h,g)}const roe=O({fusedDepthwiseConv2d_:soe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ooe({a:t,b:e,transposeA:n=!1,transposeB:s=!1,bias:r,activation:o="linear",preluActivationWeights:i,leakyreluAlpha:a=.2}){if(Hx(D.state.gradientDepth,o)===!1){let A=nt(t,e,n,s);return r!=null&&(A=ce(A,r)),Gx(A,o,i,a)}let l=$(t,"a","fused matMul"),u=$(e,"b","fused matMul");[l,u]=en(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=s?u.shape[u.rank-1]:u.shape[u.rank-2],h=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=s?u.shape[u.rank-2]:u.shape[u.rank-1],p=l.shape.slice(0,-2),m=u.shape.slice(0,-2),g=oe(p),y=oe(m);T(c===d,()=>`Error in fused matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${s} must match.`);const v=qe(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([h,f]),x=n?B(l,[g,c,h]):B(l,[g,h,c]),w=s?B(u,[y,f,d]):B(u,[y,d,f]);let S;r!=null&&(S=$(r,"bias","fused matMul"),[S]=en(S,l),qe(v,S.shape));let C;i!=null&&(C=$(i,"prelu weights","fused matMul"));const N=(A,z)=>{const[V,P,K,Y]=z,te=Wx(B(A,K.shape),K,o);let F,j;if(!n&&!s?(F=nt(te,P,!1,!0),j=nt(V,te,!0,!1)):!n&&s?(F=nt(te,P,!1,!1),j=nt(te,V,!0,!1)):n&&!s?(F=nt(P,te,!1,!0),j=nt(V,te,!1,!1)):(F=nt(P,te,!0,!0),j=nt(te,V,!0,!0)),r!=null){const q=jx(Y,te);return[F,j,q]}else return[F,j]},I={a:x,b:w,bias:S,preluActivationWeights:C},E={transposeA:n,transposeB:s,activation:o,leakyreluAlpha:a};return r==null?Jo((z,V,P)=>{const K=D.runKernel(op,I,E);return P([z,V,K]),{value:B(K,v),gradFunc:N}})(x,w):Jo((z,V,P,K)=>{const Y=D.runKernel(op,I,E);return K([z,V,Y,P]),{value:B(Y,v),gradFunc:N}})(x,w,S)}const _k=O({fusedMatMul_:ooe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rM=Object.freeze(Object.defineProperty({__proto__:null,conv2d:tM,depthwiseConv2d:roe,matMul:_k},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ioe(t){return Ux(t,.54,.46)}const aoe=O({hammingWindow_:ioe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function loe(t){return Ux(t,.5,.5)}const oM=O({hannWindow_:loe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uoe(t,e,n,s=!1,r=0){let o=0;const i=[];for(;o+e<=t.size;)i.push(ct(t,o,e)),o+=n;if(s)for(;o<t.size;){const a=o+e-t.size,l=hn([ct(t,o,e-a),Iu([a],r)]);i.push(l),o+=n}return i.length===0?Ra([],[0,e]):B(hn(i),[i.length,e])}const iM=O({frame_:uoe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function coe(t,e,n,s,r=oM){s==null&&(s=a$(e));const o=iM(t,e,n),i=L(o,r(e));return wg(i,s)}const doe=O({stft_:coe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hoe(t,e,n,s,r="bilinear",o=0){const i=$(t,"image","cropAndResize"),a=$(e,"boxes","cropAndResize","float32"),l=$(n,"boxInd","cropAndResize","int32"),u=a.shape[0];T(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),T(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${a.shape}.`),T(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${a.shape}.`),T(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),T(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),T(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const c={image:i,boxes:a,boxInd:l},d={method:r,extrapolationValue:o,cropSize:s};return D.runKernel(bv,c,d)}const foe=O({cropAndResize_:hoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function poe(t){const e=$(t,"image","flipLeftRight","float32");T(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return D.runKernel(Ev,n,{})}const moe=O({flipLeftRight_:poe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function goe(t){const e=$(t,"image","grayscaleToRGB"),n=e.rank-1,s=e.shape[n];T(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),T(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,n),r[n]=3,yr(e,r)}const yoe=O({grayscaleToRGB_:goe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function boe(t){const e=$(t,"image","RGBToGrayscale"),n=e.rank-1,s=e.shape[n];T(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),T(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,o=be(e,"float32"),i=qn([.2989,.587,.114]);let a;switch(e.rank){case 2:a=xl("ij,j->i",o,i);break;case 3:a=xl("ijk,k->ij",o,i);break;case 4:a=xl("ijkl,l->ijk",o,i);break;case 5:a=xl("ijklm,m->ijkl",o,i);break;case 6:a=xl("ijklmn,n->ijklm",o,i);break;default:throw new Error("Not a valid tensor rank.")}return a=jn(a,-1),be(a,r)}const voe=O({rgbToGrayscale_:boe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xoe(t,e,n=0,s=.5){const r=$(t,"image","rotateWithOffset","float32");T(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const o={image:r},i={radians:e,fillValue:n,center:s};return D.runKernel(dx,o,i)}const woe=O({rotateWithOffset_:xoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Th(t,e,n,s,r,o){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),o==null&&(o=0);const i=t.shape[0];return n=Math.min(n,i),T(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),T(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),T(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),T(e.rank===1,()=>"scores must be a 1D tensor"),T(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),T(0<=o&&o<=1,()=>`softNmsSigma must be in [0, 1], but was '${o}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Soe(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const o=$(t,"boxes","nonMaxSuppression","float32"),i=$(e,"scores","nonMaxSuppression","float32"),a=Th(o,i,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return D.runKernel(zv,{boxes:o,scores:i},l)}const koe=O({nonMaxSuppression_:Soe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Coe(t,e,n){const s=Noe(t,e,n),r=s<0?-(s+1):s;t.splice(r,0,e)}function Noe(t,e,n){return $oe(t,e,n||Toe)}function Toe(t,e){return t>e?1:t<e?-1:0}function $oe(t,e,n){let s=0,r=t.length,o=0,i=!1;for(;s<r;){o=s+(r-s>>>1);const a=n(e,t[o]);a>0?s=o+1:(r=o,i=!a)}return i?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qx(t,e,n,s,r){return u$(t,e,n,s,r,0)}function Kx(t,e,n,s,r,o){return u$(t,e,n,s,r,0,!1,o,!0)}function Xx(t,e,n,s,r,o){return u$(t,e,n,s,r,o,!0)}function u$(t,e,n,s,r,o,i=!1,a=!1,l=!1){const u=[];for(let g=0;g<e.length;g++)e[g]>r&&u.push({score:e[g],boxIndex:g,suppressBeginIndex:0});u.sort(xR);const c=o>0?-.5/o:0,d=[],h=[];for(;d.length<n&&u.length>0;){const g=u.pop(),{score:y,boxIndex:b,suppressBeginIndex:v}=g;if(y<r)break;let x=!1;for(let w=d.length-1;w>=v;--w){const S=Ioe(t,b,d[w]);if(S>=s){x=!0;break}if(g.score=g.score*Eoe(s,c,S),g.score<=r)break}g.suppressBeginIndex=d.length,x||(g.score===y?(d.push(b),h.push(g.score)):g.score>r&&Coe(u,g,xR))}const f=d.length,p=n-f;a&&p>0&&(d.push(...new Array(p).fill(0)),h.push(...new Array(p).fill(0)));const m={selectedIndices:d};return i&&(m.selectedScores=h),l&&(m.validOutputs=f),m}function Ioe(t,e,n){const s=t.subarray(e*4,e*4+4),r=t.subarray(n*4,n*4+4),o=Math.min(s[0],s[2]),i=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),u=Math.min(r[0],r[2]),c=Math.min(r[1],r[3]),d=Math.max(r[0],r[2]),h=Math.max(r[1],r[3]),f=(a-o)*(l-i),p=(d-u)*(h-c);if(f<=0||p<=0)return 0;const m=Math.max(o,u),g=Math.max(i,c),y=Math.min(a,d),b=Math.min(l,h),v=Math.max(y-m,0)*Math.max(b-g,0);return v/(f+p-v)}function Eoe(t,e,n){const s=Math.exp(e*n*n);return n<=t?s:0}function xR(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Roe(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const o=$(t,"boxes","nonMaxSuppressionAsync"),i=$(e,"scores","nonMaxSuppressionAsync"),a=Th(o,i,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l=await Promise.all([o.data(),i.data()]),u=l[0],c=l[1],{selectedIndices:d}=qx(u,c,n,s,r);return o!==t&&o.dispose(),i!==e&&i.dispose(),qn(d,"int32")}const _oe=Roe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aoe(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,o=0){const i=$(t,"boxes","nonMaxSuppression"),a=$(e,"scores","nonMaxSuppression"),l=Th(i,a,n,s,r,o);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,o=l.softNmsSigma;const u={boxes:i,scores:a},c={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:o},d=D.runKernel(Vv,u,c);return{selectedIndices:d[0],selectedScores:d[1]}}const Doe=O({nonMaxSuppressionWithScore_:Aoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Ooe(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,o=0){const i=$(t,"boxes","nonMaxSuppressionAsync"),a=$(e,"scores","nonMaxSuppressionAsync"),l=Th(i,a,n,s,r,o);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,o=l.softNmsSigma;const u=await Promise.all([i.data(),a.data()]),c=u[0],d=u[1],{selectedIndices:h,selectedScores:f}=Xx(c,d,n,s,r,o);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:qn(h,"int32"),selectedScores:qn(f)}}const Foe=Ooe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Loe(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,o=!1){const i=$(t,"boxes","nonMaxSuppression"),a=$(e,"scores","nonMaxSuppression"),l=Th(i,a,n,s,r,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,h={boxes:i,scores:a},f={maxOutputSize:u,iouThreshold:c,scoreThreshold:d,padToMaxOutputSize:o},p=D.runKernel(Bv,h,f);return{selectedIndices:p[0],validOutputs:p[1]}}const Poe=O({nonMaxSuppressionPadded_:Loe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Moe(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,o=!1){const i=$(t,"boxes","nonMaxSuppressionAsync"),a=$(e,"scores","nonMaxSuppressionAsync"),l=Th(i,a,n,s,r,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,[h,f]=await Promise.all([i.data(),a.data()]),{selectedIndices:p,validOutputs:m}=Kx(h,f,u,c,d,o);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:qn(p,"int32"),validOutputs:ze(m,"int32")}}const zoe=Moe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Boe(t,e,n=!1,s=!1){const r=$(t,"images","resizeBilinear");T(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),T(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),T(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=r,i=!1;r.rank===3&&(i=!0,o=B(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:s,size:e},u=D.runKernel(jm,a,l);return i?B(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const aM=O({resizeBilinear_:Boe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Voe(t,e,n=!1,s=!1){const r=$(t,"images","resizeNearestNeighbor");T(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),T(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),T(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),T(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=r,i=!1;r.rank===3&&(i=!0,o=B(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:s,size:e},u=D.runKernel(Wm,a,l);return i?B(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const lM=O({resizeNearestNeighbor_:Voe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uoe(t,e="binary",n=!1,s=.5){const r=$(t,"image","threshold"),o=.2989,i=.587,a=.114,l=r.shape[0]*r.shape[1];let u=L(qn([s]),255),c,d,h,f;if(T(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),T(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),T(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),T(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[c,d,h]=_s(r,[1,1,1],-1);const g=L(c,o),y=L(d,i),b=L(h,a);f=ce(ce(g,y),b)}else f=t;if(e==="otsu"){const g=pT(be(Ex(f),"int32"),Xr([]),256);u=Woe(g,l)}const p=n?nl(f,u):Bs(f,u);return be(L(p,255),"int32")}function Woe(t,e){let n=qn([-1]),s=qn([0]),r=qn([0]),o,i,a,l,u,c;for(let d=0;d<t.size-1;d++){o=ct(t,0,d+1),i=ct(t,d+1),u=Fe(_e(o),e),c=Fe(_e(i),e);const h=_e(L(o,cu(0,o.size)));a=Fe(h,_e(o));const f=Iu(i.shape,o.size),p=ce(cu(0,i.size),f),m=L(i,p);l=Fe(_e(m),_e(i));const g=Te(a,l),y=Te(a,l),b=L(u,c);r=L(L(b,g),y);const v=Bs(r,s);s=Xn(v,r,s),n=Xn(v,qn([d]),n)}return n}const joe=O({threshold_:Uoe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Goe(t,e,n="nearest",s="constant",r=0,o){const i=$(t,"image","transform","float32"),a=$(e,"transforms","transform","float32");T(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),T(a.rank===2&&(a.shape[0]===i.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),T(o==null||o.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`);const l={image:i,transforms:a},u={interpolation:n,fillMode:s,fillValue:r,outputShape:o};return D.runKernel(ux,l,u)}const Hoe=O({transform_:Goe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qoe(t,e,n){const s=$(t,"a","bandPart");T(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[o,i]=s.shape.slice(-2);let a,l;typeof e=="number"?(T(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),T(e<=o,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${o}).`),a=$(e<0?o:e,"numLower","bandPart")):(T(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Xn(od(e,0),o,Va(e,o))),typeof n=="number"?(T(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),T(n<=i,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${i}).`),l=$(n<0?i:n,"numUpper","bandPart")):(T(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Xn(od(n,0),i,Va(n,i)));const u=B(cu(0,o,1,"int32"),[-1,1]),c=cu(0,i,1,"int32"),d=Te(u,c),h=So(nl(d,a),Bi(d,Dt(l))),f=dn([o,i],s.dtype);return B(Ls(Nr(B(s,[-1,o,i])).map(p=>Xn(h,p,f))),r)}const Koe=O({bandPart_:qoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xoe(t){let e;if(Array.isArray(t)){e=!1,T(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=t[0].shape[0];for(let o=1;o<t.length;++o)T(t[o].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[o].shape[0]} vs. ${r})`)}else e=!0,t=_s(t,t.shape[0],0).map(r=>Ui(r,[0]));T(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],s=t;for(let r=0;r<t.length;++r)n.push(D.tidy(()=>{let o=s[r];if(r>0)for(let i=0;i<r;++i){const a=L(_e(L(n[i],o)),n[i]);o=Te(o,a)}return Fe(o,Sh(o,"euclidean"))}));return e?Ls(n,0):n}const Yoe=O({gramSchmidt_:Xoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qoe(t,e=!1){if(T(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return wR(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,u)=>l*u),s=Nr(B(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),r=[],o=[];s.forEach(l=>{const[u,c]=wR(l,e);r.push(u),o.push(c)});const i=B(Ls(r,0),t.shape),a=B(Ls(o,0),t.shape);return[i,a]}}function wR(t,e=!1){return D.tidy(()=>{T(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],s=t.shape[1];let r=Sx(n),o=Ho(t);const i=Ra([[1]],[1,1]);let a=Ho(i);const l=n>=s?s:n;for(let u=0;u<l;++u){const c=o,d=a,h=r;[a,o,r]=D.tidy(()=>{const f=ct(o,[u,u],[n-u,1]),p=Sh(f),m=ct(o,[u,u],[1,1]),g=Xn(Bs(m,0),Ra([[-1]]),Ra([[1]])),y=Te(m,L(g,p)),b=Fe(f,y);b.shape[0]===1?a=Ho(i):a=hn([i,ct(b,[1,0],[b.shape[0]-1,b.shape[1]])],0);const v=Dt(Fe(nt(g,y),p)),x=ct(o,[u,0],[n-u,s]),w=L(v,a),S=dt(a);if(u===0)o=Te(x,nt(w,nt(S,x)));else{const I=Te(x,nt(w,nt(S,x)));o=hn([ct(o,[0,0],[u,s]),I],0)}const C=dt(w),N=ct(r,[0,u],[n,r.shape[1]-u]);if(u===0)r=Te(N,nt(nt(N,a),C));else{const I=Te(N,nt(nt(N,a),C));r=hn([ct(r,[0,0],[n,u]),I],1)}return[a,o,r]}),Qe([c,d,h])}return!e&&n>s&&(r=ct(r,[0,0],[n,s]),o=ct(o,[0,0],[s,s])),[r,o]})}const Zoe=O({qr_:Qoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var bs;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(bs||(bs={}));function Joe(t,e,n=bs.SUM_BY_NONZERO_WEIGHTS){const s=$(t,"losses","computeWeightedLoss");let r=null;e!=null&&(r=$(e,"weights","computeWeightedLoss"));const o=r==null?s:L(s,r);if(n===bs.NONE)return o;if(n===bs.SUM)return _e(o);if(n===bs.MEAN){if(r==null)return Zt(o);{const i=s.size/r.size,a=Fe(_e(o),_e(r));return i>1?Fe(a,ze(i)):a}}if(n===bs.SUM_BY_NONZERO_WEIGHTS){if(r==null)return Fe(_e(o),ze(s.size));{const i=L(r,Es(s.shape)),a=be(_e(uu(i,ze(0))),"float32");return Fe(_e(o),a)}}throw Error(`Unknown reduction: ${n}`)}const Wi=O({computeWeightedLoss_:Joe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eie(t,e,n,s=bs.SUM_BY_NONZERO_WEIGHTS){const r=$(t,"labels","absoluteDifference"),o=$(e,"predictions","absoluteDifference");let i=null;n!=null&&(i=$(n,"weights","absoluteDifference")),Zn(r.shape,o.shape,"Error in absoluteDifference: ");const a=bn(Te(r,o));return Wi(a,i,s)}const tie=O({absoluteDifference_:eie});function nie(t,e,n,s,r=bs.SUM_BY_NONZERO_WEIGHTS){const o=$(t,"labels","cosineDistance"),i=$(e,"predictions","cosineDistance");let a=null;s!=null&&(a=$(s,"weights","cosineDistance")),Zn(o.shape,i.shape,"Error in cosineDistance: ");const l=ze(1),u=Te(l,_e(L(o,i),n,!0));return Wi(u,a,r)}const sie=O({cosineDistance_:nie});function rie(t,e,n,s=bs.SUM_BY_NONZERO_WEIGHTS){let r=$(t,"labels","hingeLoss");const o=$(e,"predictions","hingeLoss");let i=null;n!=null&&(i=$(n,"weights","hingeLoss")),Zn(r.shape,o.shape,"Error in hingeLoss: ");const a=ze(1);r=Te(L(ze(2),r),a);const l=Io(Te(a,L(r,o)));return Wi(l,i,s)}const oie=O({hingeLoss_:rie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iie(t,e,n,s=1,r=bs.SUM_BY_NONZERO_WEIGHTS){const o=$(t,"labels","huberLoss"),i=$(e,"predictions","huberLoss");let a=null;n!=null&&(a=$(n,"weights","huberLoss")),Zn(o.shape,i.shape,"Error in huberLoss: ");const l=ze(s),u=bn(Te(i,o)),c=Va(u,l),d=Te(u,c),h=ce(L(ze(.5),Tt(c)),L(l,d));return Wi(h,a,r)}const aie=O({huberLoss_:iie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lie(t,e,n,s=1e-7,r=bs.SUM_BY_NONZERO_WEIGHTS){const o=$(t,"labels","logLoss"),i=$(e,"predictions","logLoss");let a=null;n!=null&&(a=$(n,"weights","logLoss")),Zn(o.shape,i.shape,"Error in logLoss: ");const l=ze(1),u=ze(s),c=Dt(L(o,er(ce(i,u)))),d=L(Te(l,o),er(ce(Te(l,i),u))),h=Te(c,d);return Wi(h,a,r)}const uie=O({logLoss_:lie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cie(t,e,n,s=bs.SUM_BY_NONZERO_WEIGHTS){const r=$(t,"labels","meanSquaredError"),o=$(e,"predictions","meanSquaredError");let i=null;n!=null&&(i=$(n,"weights","meanSquaredError")),Zn(r.shape,o.shape,"Error in meanSquaredError: ");const a=Px(r,o);return Wi(a,i,s)}const die=O({meanSquaredError_:cie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hie(t,e){const n=$(t,"labels","sigmoidCrossEntropyWithLogits"),s=$(e,"logits","sigmoidCrossEntropyWithLogits");Zn(n.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=Io(s),o=L(s,n),i=cg(Fs(Dt(bn(s))));return ce(Te(r,o),i)}function fie(t,e,n,s=0,r=bs.SUM_BY_NONZERO_WEIGHTS){let o=$(t,"multiClassLabels","sigmoidCrossEntropy");const i=$(e,"logits","sigmoidCrossEntropy");let a=null;if(n!=null&&(a=$(n,"weights","sigmoidCrossEntropy")),Zn(o.shape,i.shape,"Error in sigmoidCrossEntropy: "),s>0){const u=ze(s),c=ze(1),d=ze(.5);o=ce(L(o,Te(c,u)),L(d,u))}const l=hie(o,i);return Wi(l,a,r)}const pie=O({sigmoidCrossEntropy_:fie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mie(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return Jo((r,o,i)=>{const l=dg(o,[n],!0),u=Te(be(o,"float32"),l);i([r,u]);const c=Dt(L(u,r));return{value:_e(c,[n]),gradFunc:(f,p)=>{const[m,g]=p,y=fn(f.shape,[n]);return[L(B(f,y),Te(be(m,"float32"),Fs(g))),L(B(f,y),Te(Fs(g),be(m,"float32")))]}}})(t,e)}function gie(t,e,n,s=0,r=bs.SUM_BY_NONZERO_WEIGHTS){let o=$(t,"onehotLabels","softmaxCrossEntropy");const i=$(e,"logits","softmaxCrossEntropy");let a=null;if(n!=null&&(a=$(n,"weights","softmaxCrossEntropy")),Zn(o.shape,i.shape,"Error in softmaxCrossEntropy: "),s>0){const u=ze(s),c=ze(1),d=ze(o.shape[1]);o=ce(L(o,Te(c,u)),Fe(u,d))}const l=mie(o,i);return Wi(l,a,r)}const yie=O({softmaxCrossEntropy_:gie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bie(t,e,n,s){const r=$(t,"indices","sparseFillEmptyRows","int32"),o=$(e,"values","sparseFillEmptyRows"),i=$(n,"denseShape","sparseFillEmptyRows","int32"),a=$(s,"defaultValue","sparseFillEmptyRows",o.dtype);if(r.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${r.shape}`);if(o.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${o.shape}`);if(i.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const l={indices:r,values:o,denseShape:i,defaultValue:a},u=D.runKernel(Zv,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const vie=O({sparseFillEmptyRows_:bie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xie(t,e,n){const s=$(t,"inputIndices","sparseReshape","int32"),r=$(e,"inputShape","sparseReshape","int32"),o=$(n,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(r.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${r.shape}`);if(o.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${o.shape}`);const i={inputIndices:s,inputShape:r,newShape:o},a=D.runKernel(Jv,i);return{outputIndices:a[0],outputShape:a[1]}}const wie=O({sparseReshape_:xie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sie(t,e,n){const s=$(t,"data","sparseSegmentMean"),r=$(e,"indices","sparseSegmentMean","int32"),o=$(n,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${r.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${o.shape}`);const i={data:s,indices:r,segmentIds:o};return D.runKernel(ex,i)}const kie=O({sparseSegmentMean_:Sie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cie(t,e,n){const s=$(t,"data","sparseSegmentSum"),r=$(e,"indices","sparseSegmentSum","int32"),o=$(n,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${r.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${o.shape}`);const i={data:s,indices:r,segmentIds:o};return D.runKernel(tx,i)}const Nie=O({sparseSegmentSum_:Cie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tie(t,e,n,s,r,o,i,a){const l=$(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=$(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const c={separator:n,nGramWidths:s,leftPad:r,rightPad:o,padWidth:i,preserveShortSequences:a},d={data:l,dataSplits:u},h=D.runKernel(ox,d,c);return{nGrams:h[0],nGramsSplits:h[1]}}const $ie=O({stringNGrams_:Tie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iie(t,e,n=!0){const s=$(t,"input","stringSplit","string"),r=$(e,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(r.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${r.shape}`);const o={skipEmpty:n},i={input:s,delimiter:r},a=D.runKernel(ix,i,o);return{indices:a[0],values:a[1],shape:a[2]}}const Eie=O({stringSplit_:Iie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rie(t,e){const n=$(t,"input","stringToHashBucketFast","string"),s={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const r={input:n};return D.runKernel(ax,r,s)}const _ie=O({stringToHashBucketFast_:Rie});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aie(t,e,n,s=!0){const r=$(t,"input","staticRegexReplace","string"),o={pattern:e,rewrite:n,replaceGlobal:s};return D.runKernel(Zm,{x:r},o)}const Die=O({staticRegexReplace_:Aie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uM={fft:xg,ifft:ud,rfft:wg,irfft:Lx},cM={hammingWindow:aoe,hannWindow:oM,frame:iM,stft:doe},br={flipLeftRight:moe,grayscaleToRGB:yoe,resizeNearestNeighbor:lM,resizeBilinear:aM,rgbToGrayscale:voe,rotateWithOffset:woe,cropAndResize:foe,nonMaxSuppression:koe,nonMaxSuppressionAsync:_oe,nonMaxSuppressionWithScore:Doe,nonMaxSuppressionWithScoreAsync:Foe,nonMaxSuppressionPadded:Poe,nonMaxSuppressionPaddedAsync:zoe,threshold:joe,transform:Hoe},c$={bandPart:Koe,gramSchmidt:Yoe,qr:Zoe},dM={absoluteDifference:tie,computeWeightedLoss:Wi,cosineDistance:sie,hingeLoss:oie,huberLoss:aie,logLoss:uie,meanSquaredError:die,sigmoidCrossEntropy:pie,softmaxCrossEntropy:yie},hM={sparseFillEmptyRows:vie,sparseReshape:wie,sparseSegmentMean:kie,sparseSegmentSum:Nie},fM={stringNGrams:$ie,stringSplit:Eie,stringToHashBucketFast:_ie,staticRegexReplace:Die};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oie=new Map,Ak=new Map;class Au{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class mr{constructor(){this.classNameMap={}}static getMap(){return mr.instance==null&&(mr.instance=new mr),mr.instance}static register(e){mr.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function he(t,e,n){T(t.className!=null,()=>"Class being registered does not have the static className property defined."),T(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),T(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const s=n,r=e+">"+s;return mr.register(t),Oie.set(r,t),Ak.set(t,r),t}function Fie(t){return Ak.has(t)?Ak.get(t):t.className}const Lie=Object.freeze(Object.defineProperty({__proto__:null,Serializable:Au,SerializationMap:mr,getRegisteredName:Fie,registerClass:he},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ji extends Au{minimize(e,n=!1,s){const{value:r,grads:o}=this.computeGradients(e,s);if(s!=null){const i=s.map(a=>({name:a.name,tensor:o[a.name]}));this.applyGradients(i)}else this.applyGradients(o);return Qe(o),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return b3(e,n)}dispose(){this.iterations_!=null&&Qe(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:ze(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(ji,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d$ extends ji{static get className(){return"Adadelta"}constructor(e,n,s=null){super(),this.learningRate=e,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=D.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=D.registeredVariables[s],i=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:Q(()=>ft(o).variable(i))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:Q(()=>ft(o).variable(i))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedGrads[r].variable,u=this.accumulatedUpdates[r].variable;Q(()=>{const c=ce(L(l,this.rho),L(Tt(a),1-this.rho)),d=L(Fe(Mn(ce(u,this.epsilon)),Mn(ce(l,this.epsilon))),a),h=ce(L(u,this.rho),L(Tt(d),1-this.rho));l.assign(c),u.assign(h);const f=ce(L(d,-this.learningRate),o);o.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Qe(this.accumulatedGrads.map(e=>e.variable)),Qe(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h$ extends ji{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=D.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:Q(()=>Iu(o.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const a=this.accumulatedGrads[r].variable;Q(()=>{const l=ce(a,Tt(i));a.assign(l);const u=ce(L(Fe(i,Mn(ce(l,D.backend.epsilon()))),-this.learningRate),o);o.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Qe(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f$ extends ji{static get className(){return"Adam"}constructor(e,n,s,r=null){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Q(()=>{this.accBeta1=ze(n).variable(),this.accBeta2=ze(s).variable()}),r==null&&(this.epsilon=D.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);Q(()=>{const s=Te(1,this.accBeta1),r=Te(1,this.accBeta2);n.forEach((o,i)=>{const a=D.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:Q(()=>ft(a).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${o}/v`,variable:Q(()=>ft(a).variable(l))});const u=Array.isArray(e)?e[i].tensor:e[o];if(u==null)return;const c=this.accumulatedFirstMoment[i].variable,d=this.accumulatedSecondMoment[i].variable,h=ce(L(c,this.beta1),L(u,1-this.beta1)),f=ce(L(d,this.beta2),L(Tt(u),1-this.beta2)),p=Fe(h,s),m=Fe(f,r);c.assign(h),d.assign(f);const g=ce(L(Fe(p,ce(Mn(m),this.epsilon)),-this.learningRate),a);a.assign(g)}),this.accBeta1.assign(L(this.accBeta1,this.beta1)),this.accBeta2.assign(L(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Qe(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Qe(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),Q(()=>{this.accBeta1.assign(Zo(this.beta1,this.iterations_+1)),this.accBeta2.assign(Zo(this.beta2,this.iterations_+1))});const n=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p$ extends ji{static get className(){return"Adamax"}constructor(e,n,s,r=null,o=0){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Q(()=>{this.iteration=ze(0).variable(),this.accBeta1=ze(n).variable()}),r==null&&(this.epsilon=D.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);Q(()=>{const s=Te(1,this.accBeta1),r=Fe(-this.learningRate,ce(L(this.iteration,this.decay),1));n.forEach((o,i)=>{const a=D.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:ft(a).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${o}/v`,variable:ft(a).variable(l)});const u=Array.isArray(e)?e[i].tensor:e[o];if(u==null)return;const c=this.accumulatedFirstMoment[i].variable,d=this.accumulatedWeightedInfNorm[i].variable,h=ce(L(c,this.beta1),L(u,1-this.beta1)),f=L(d,this.beta2),p=bn(u),m=ii(f,p);c.assign(h),d.assign(m);const g=ce(L(Fe(r,s),Fe(h,ce(m,this.epsilon))),a);a.assign(g)}),this.iteration.assign(ce(this.iteration,1)),this.accBeta1.assign(L(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Qe(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Qe(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yx extends ji{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const i=D.registeredVariables[s];Q(()=>{const a=ce(L(this.c,o),i);i.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Cn(ze(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class m$ extends Yx{static get className(){return"Momentum"}constructor(e,n,s=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=ze(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=D.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:Q(()=>ft(o).variable(!1))});const i=this.accumulations[r].variable,a=Array.isArray(e)?e[r].tensor:e[s];a!=null&&Q(()=>{let l;const u=ce(L(this.m,i),a);this.useNesterov?l=ce(L(this.c,ce(a,L(u,this.m))),o):l=ce(L(this.c,u),o),i.assign(u),o.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Qe(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g$ extends ji{static get className(){return"RMSProp"}constructor(e,n=.9,s=0,r=null,o=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,r==null&&(this.epsilon=D.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=D.registeredVariables[s],i=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:Q(()=>ft(o).variable(i))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:Q(()=>ft(o).variable(i))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:Q(()=>ft(o).variable(i))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedMeanSquares[r].variable,u=this.accumulatedMoments[r].variable;Q(()=>{const c=ce(L(l,this.decay),L(Tt(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[r].variable,h=ce(L(d,this.decay),L(a,1-this.decay)),f=Fe(L(a,this.learningRate),Mn(Te(c,ce(Tt(h),this.epsilon)))),p=ce(L(u,this.momentum),f);l.assign(c),d.assign(h),u.assign(p);const m=Te(o,p);o.assign(m)}else{const d=ce(L(l,this.decay),L(Tt(a),1-this.decay)),h=ce(L(u,this.momentum),Fe(L(a,this.learningRate),Mn(ce(d,this.epsilon))));l.assign(d),u.assign(h);const f=Te(o,h);o.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Qe(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Qe(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Qe(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pie=[d$,h$,f$,p$,m$,g$,Yx];function Mie(){for(const t of Pie)he(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zie="model",Bie=".json",Vie=".weights.bin";function SR(t){return new Promise(e=>setTimeout(e)).then(t)}class du{constructor(e){if(!ee().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(du.URL_SCHEME)&&(e=e.slice(du.URL_SCHEME.length)),(e==null||e.length===0)&&(e=zie),this.modelJsonFileName=e+Bie,this.weightDataFileName=e+Vie}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=$o.join(e.weightData),s=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],o=ZP(e,r),i=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=i,await SR(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=s,await SR(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:sg(e)}}}}du.URL_SCHEME="downloads://";class Uie{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const s=new FileReader;s.onload=r=>{const o=JSON.parse(r.target.result),i=o.modelTopology;if(i==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(o.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:i});return}const l=JN(o,u=>this.loadWeights(u));e(l)},s.onerror=r=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(e){const n=[],s=[];for(const i of e)n.push(...i.weights),s.push(...i.paths);const r=this.checkManifestAndWeightFiles(e),o=s.map(i=>this.loadWeightsFile(i,r[i]));return Promise.all(o).then(i=>[n,i])}loadWeightsFile(e,n){return new Promise((s,r)=>{const o=new FileReader;o.onload=i=>{const a=i.target.result;s(a)},o.onerror=i=>r(`Failed to weights data from file of path '${e}'.`),o.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],s=this.weightsFiles.map(o=>vR(o.name)),r={};for(const o of e)o.paths.forEach(i=>{const a=vR(i);if(n.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(n.push(a),s.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);r[i]=this.weightsFiles[s.indexOf(a)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const Wie=t=>ee().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(du.URL_SCHEME)?jie(t.slice(du.URL_SCHEME.length)):null;Xt.registerSaveRouter(Wie);function jie(t="model"){return new du(t)}function Gie(t){return new Uie(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kR(t,e,n,s){i(t),n=n??0,s=s??1,a(n,s);let r=0;const o=l=>(l.then(u=>{const c=n+ ++r/t.length*(s-n);return e(c),u}),l);function i(l){T(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,u){T(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),T(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),T(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(t.map(o))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function pM(t,e){e==null&&(e={});const n=e.fetchFunc==null?ee().platform.fetch:e.fetchFunc,s=t.map(d=>n(d,e.requestInit,{isBinary:!0})),a=(e.onProgress==null?await Promise.all(s):await kR(s,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(a):await kR(a,e.onProgress,.5,1)}function Hie(t,e){var n;const s=e.fetchFunc==null?ee().platform.fetch:e.fetchFunc;let r=0,o;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async i=>{for(var a;r<t.length;){o||(o=(await s(t[r],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:u}=await o.read();if(l){r++,o=void 0,(a=e.onProgress)===null||a===void 0||a.call(e,r/t.length);continue}i.enqueue(u);return}i.close()}})}async function qie(t,e="",n,s){return mM(i=>pM(i,{requestInit:s}))(t,e,n)}function mM(t){return async(e,n="",s)=>{const r=e.map(()=>!1),o={},i=s!=null?s.map(()=>!1):[],a=[];if(e.forEach((f,p)=>{let m=0;f.weights.forEach(g=>{const y="quantization"in g?g.quantization.dtype:g.dtype,b=su[y]*oe(g.shape),v=()=>{r[p]=!0,o[p]==null&&(o[p]=[]),o[p].push({manifestEntry:g,groupOffset:m,sizeBytes:b})};s!=null?s.forEach((x,w)=>{x===g.name&&(v(),i[w]=!0)}):v(),a.push(g.name),m+=b})}),!i.every(f=>f)){const f=s.filter((p,m)=>!i[m]);throw new Error(`Could not find weights in manifest with names: ${f.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const l=r.reduce((f,p,m)=>(p&&f.push(m),f),[]),u=[];l.forEach(f=>{e[f].paths.forEach(p=>{const m=n+(n.endsWith("/")?"":"/")+p;u.push(m)})});const c=await t(u),d={};let h=0;return l.forEach(f=>{const p=e[f].paths.length,m=new $o(c.slice(h,h+p));o[f].forEach(y=>{const b=m.slice(y.groupOffset,y.groupOffset+y.sizeBytes),v=KP(b,[y.manifestEntry]);for(const x in v)d[x]=v[x]}),h+=p}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kie="application/octet-stream",Xie="application/json";class y${constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(T(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=ee().platform.fetch,T(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&T(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=ZP(e,s);if(n.body.append("model.json",new Blob([JSON.stringify(r)],{type:Xie}),"model.json"),e.weightData!=null){const i=$o.join(e.weightData);n.body.append("model.weights.bin",new Blob([i],{type:Kie}),"model.weights.bin")}const o=await this.fetch(this.path,n);if(o.ok)return{modelArtifactsInfo:sg(e),responses:[o]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${o.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const s=n.modelTopology,r=n.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return JN(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),s=Nk(e.weightsManifest),r=()=>Hie(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:s,getWeightStream:r})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=Yie(n),o=this.weightPathPrefix||s,i=[],a=[];for(const l of e)for(const u of l.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(u)):i.push(o+u+r);return this.weightUrlConverter&&i.push(...await Promise.all(a)),i}async loadWeights(e){const n=await this.getWeightUrls(e),s=Nk(e),r=await pM(n,this.loadOptions);return[s,r]}}y$.URL_SCHEME_REGEX=/^https?:\/\//;function Yie(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),s=t.substring(0,e),r=n>e?t.substring(n):"";return[s+"/",r]}function Dk(t){return t.match(y$.URL_SCHEME_REGEX)!=null}const gM=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(s=>Dk(s)):n=Dk(t),n)return b$(t,e)}return null};Xt.registerSaveRouter(gM);Xt.registerLoadRouter(gM);function b$(t,e){return new y$(t,e)}function Qie(t,e){return b$(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S1{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class yM{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class Zie{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function Jie(t,e,n,s){const r=arguments;return new Zie(bM(...r))}function bM(t,e,n,s){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new S1(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new S1({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new S1({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:s}))}function eae(t){return new yM(t)}function tae(t){return new yM(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v$=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:$o,browserFiles:Gie,browserHTTPRequest:Qie,concatenateArrayBuffers:QP,copyModel:Dee,decodeWeights:KP,decodeWeightsStream:YP,encodeWeights:Ck,fromMemory:Jie,fromMemorySync:bM,getLoadHandlers:vee,getModelArtifactsForJSON:JN,getModelArtifactsForJSONSync:JP,getModelArtifactsInfoForJSON:sg,getSaveHandlers:e3,getWeightSpecs:Nk,http:b$,isHTTPScheme:Dk,listModels:_ee,loadWeights:qie,moveModel:Oee,registerLoadRouter:bee,registerSaveRouter:yee,removeModel:Aee,weightsLoaderFactory:mM,withSaveHandler:eae,withSaveHandlerSync:tae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nae(t,e,n){const s=$(t,"labels","confusionMatrix"),r=$(e,"predictions","confusionMatrix");T(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),T(s.rank===1,()=>`Expected the rank of labels to be 1, but got ${s.rank}`),T(r.rank===1,()=>`Expected the rank of predictions to be 1, but got ${r.rank}`),T(s.shape[0]===r.shape[0],()=>`Mismatch in the number of examples: ${s.shape[0]} vs. ${r.shape[0]}. Labels and predictions should have the same number of elements.`),T(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const o=id(be(s,"int32"),n),i=id(be(r,"int32"),n),a=dt(o),l=nt(a,i);return be(l,"int32")}const sae=O({confusionMatrix_:nae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rae=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:sae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let cl,CR=!1;function vM(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,s=!1,r=!1,o=!1,i=!1,a=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)o=!0;else if(t.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(up(F0,D.backendName)!=null){const p={pixels:t},m={numChannels:e};return D.runKernel(F0,p,m)}const[u,c]=r?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d;if(i)d=t.getContext("2d").getImageData(0,0,u,c).data;else if(s||n)d=t.data;else if(o||r||a){if(cl==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")cl=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else cl=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});cl.canvas.width=u,cl.canvas.height=c,cl.drawImage(t,0,0,u,c),d=cl.getImageData(0,0,u,c).data}let h;if(e===4)h=new Int32Array(d);else{const p=u*c;h=new Int32Array(p*e);for(let m=0;m<p;m++)for(let g=0;g<e;++g)h[m*e+g]=d[m*4+g]}return e$(h,[c,u,e],"int32")}function oae(t){return t!=null&&t.data instanceof Uint8Array}function iae(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function aae(t){return t!=null&&t.width!==0&&t.height!==0}function lae(t){return iae()&&!(t instanceof ImageBitmap)&&aae(t)&&!oae(t)}async function uae(t,e=3){let n=null;if(ee().getBool("WRAP_TO_IMAGEBITMAP")&&lae(t)){let s;try{s=await createImageBitmap(t,{premultiplyAlpha:"none"})}catch{s=null}s!=null&&s.width===t.width&&s.height===t.height?n=s:n=t}else n=t;return vM(n,e)}function xM(t){if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const e=t.rank===2?1:t.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`)}function cae(t){const e=(t==null?void 0:t.alpha)||1;if(e>1||e<0)throw new Error(`Alpha value ${e} is suppoed to be in range [0 - 1].`)}async function dae(t,e){let n=$(t,"img","toPixels");if(!(t instanceof vt)){const u=n;n=be(u,"int32"),u.dispose()}xM(n);const[s,r]=n.shape.slice(0,2),o=n.rank===2?1:n.shape[2],i=await n.data(),a=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(r*s*4);for(let u=0;u<s*r;++u){const c=[0,0,0,255];for(let h=0;h<o;h++){const f=i[u*o+h];if(n.dtype==="float32"){if(f<0||f>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${f}.`)}else if(n.dtype==="int32"&&(f<0||f>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${f}.`);o===1?(c[0]=f*a,c[1]=f*a,c[2]=f*a):c[h]=f*a}const d=u*4;l[d+0]=Math.round(c[0]),l[d+1]=Math.round(c[1]),l[d+2]=Math.round(c[2]),l[d+3]=Math.round(c[3])}if(e!=null){CR||up(Cv,D.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),CR=!0),e.width=r,e.height=s;const u=e.getContext("2d"),c=new ImageData(l,r,s);u.putImageData(c,0,0)}return n!==t&&n.dispose(),l}function hae(t,e,n){let s=$(t,"img","draw");if(!(t instanceof vt)){const i=s;s=be(i,"int32"),i.dispose()}xM(s),cae(n==null?void 0:n.imageOptions);const r={image:s},o={canvas:e,options:n};D.runKernel(Cv,r,o)}const x$=O({fromPixels_:vM}),fae=Object.freeze(Object.defineProperty({__proto__:null,draw:hae,fromPixels:x$,fromPixelsAsync:uae,toPixels:dae},Symbol.toStringTag,{value:"Module"}));function Qx(t,e){const n=t.shape.length,s=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${n}`);if(oe(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const r=e.shape,o=r[r.length-1];let i=1;for(let d=0;d<r.length-1;++d)i*=r[d];const a=t.shape,l=r.slice();l.pop();let u=1;for(let d=o;d<n;++d)u*=a[d],l.push(a[d]);const c=[...Le(t.shape).map(d=>d/u),1].slice(0,o);return[l,i,u,c]}const pae=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:Qx},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ok=-2,mae=-1;function w$(t,e,n){const s=t.shape.length;T(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),T(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)T(e[r]+n[r]<=t.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+n[r]}) would overflow input.shape[${r}] (${t.shape[r]})`)}function gae(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function S$(t,e,n){const s=[];for(let r=0;r<t.length;r++)s[r]=Math.ceil((e[r]-t[r])/n[r]);return s}function wM(t,e,n,s){const r=[...t];for(let o=r.length;o<s.length;o++)r.push(1);for(let o=0;o<n;o++)o===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function SM(t,e,n){return n<=t?n:n-(e-1)}function kM(t,e){const n=[];for(let s=0;s<t;s++)n.push(e+s);return n}function yae(t,e,n,s,r,o,i,a,l){const u=t.length;let c=new Array(u),d=new Array(u),h=new Array(u);if(e.length&&n>0){const f=e[0],p=n+1;c=CM(i,f,p,s,t),d=NM(a,f,p,r,t),h=wM(o,f,p,t)}else for(let f=0;f<u;f++)c[f]=$M(i,s,o,t,f,l),d[f]=IM(a,r,o,t,f,l),h[f]=TM(o,f,l);return{begin:c,end:d,strides:h}}function CM(t,e,n,s,r){const o=[...r],i=kM(n,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=0;else{const l=SM(e,n,a);let u=s[l];t&1<<l&&(u=0),o[a]=u}return o}function NM(t,e,n,s,r){const o=[...r],i=kM(n,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=Number.MAX_SAFE_INTEGER;else{const l=SM(e,n,a);let u=s[l];t&1<<l&&(u=Number.MAX_SAFE_INTEGER),o[a]=u}for(let a=0;a<o.length;a++){const l=r[a];o[a]<0&&(o[a]+=l),o[a]=Fa(0,o[a],r[a])}return o}function TM(t,e,n){let s=t[e];return(n&1<<e||s==null)&&(s=1),s}function $M(t,e,n,s,r,o){let i=e[r];const a=n[r]||1;(t&1<<r||o&1<<r||i==null)&&(a>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const l=s[r];return i<0&&(i+=l),i=Fa(0,i,l-1),i}function IM(t,e,n,s,r,o){let i=e[r];const a=n[r]||1;(t&1<<r||o&1<<r||i==null)&&(a>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const l=s[r];return i<0&&(i+=l),a>0?i=Fa(0,i,l):i=Fa(-1,i,l-1),i}function k$(t,e,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(e[r]>0||n[r]!==t[r])return!1;return!0}function C$(t,e){let n=t.length>0?t[t.length-1]:1;for(let s=0;s<t.length-1;s++)n+=t[s]*e[s];return n}function Zx(t,e,n){let s;const r=t.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(i=>{T(i!==-1,()=>"slice() does not support negative begin indexing.")});let o;return n==null?o=new Array(r).fill(-1):typeof n=="number"?o=[n,...new Array(r-1).fill(-1)]:n.length<r?o=n.concat(new Array(r-n.length).fill(-1)):o=n,o=o.map((i,a)=>i>=0?i:(T(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),t.shape[a]-s[a])),[s,o]}function N$(t,e,n,s,r,o,i,a,l){let u;if(s==null?(u=new Array(e.length),u.fill(1)):u=s,i!=null&&i&i-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:r,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};for(let v=0;v<d.dims;v++)c&&1<<v&a&&d.numAddAxisAfterEllipsis++,1<<v&i&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};bae(d,h);let f=!0,p=!0,m=!0;const g=[],y=[];for(let v=0;v<t.length;++v){if(h.strides[v]===0)throw Error(`strides[${v}] must be non-zero`);const x=!!(h.shrinkAxisMask&1<<v),w=t[v];if(w===-1){g.push(x?1:-1);continue}const S=[h.beginMask&1<<v,h.endMask&1<<v],C=[h.strides[v]>0?0:-1,h.strides[v]>0?w:w-1];if(x&&h.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&h.strides[v]===1;const N=!!(h.beginMask&1<<v&&h.endMask&1<<v);if(h.beginValid&&h.endValid){if(x){const z=h.begin[v]<0?w+h.begin[v]:h.begin[v];if(h.begin[v]=z,h.end[v]=h.begin[v]+1,z<0||z>=w)throw Error(`slice index ${h.begin[v]} of dimension ${v} out of bounds.`)}else h.begin[v]=NR(h.begin[v],0,h.strides[v],w,S,C),h.end[v]=NR(h.end[v],1,h.strides[v],w,S,C);const A=h.strides[v]===1&&h.begin[v]===0&&h.end[v]===w;f=f&&A,p=p&&(v===0&&h.strides[v]===1||A)}else f=f&&h.strides[v]===1&&N,p=p&&(v===0&&h.strides[v]===1||N);let I,E=!1;if(h.beginValid&&h.endValid?(I=h.end[v]-h.begin[v],E=!0):x?(I=1,E=!0):N&&w>=0&&(h.strides[v]<0?I=-w:I=w,E=!0),E){let A;I===0||I<0!=h.strides[v]<0?A=0:A=Math.trunc(I/h.strides[v])+(I%h.strides[v]!==0?1:0),g.push(A)}else g.push(-1)}for(let v=0;v<h.finalShapeGatherIndices.length;++v){const x=h.finalShapeGatherIndices[v];x>=0?y.push(g[x]):x===Ok&&y.push(1)}return{finalShapeSparse:y.filter((v,x)=>h.finalShapeGatherIndices[x]!==Ok),finalShape:y,isIdentity:f,sliceDim0:p,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function bae(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<t.dims;s++)if(1<<s&t.ellipsisMask){const r=Math.min(e.dims-(t.dims-s)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<r;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&t.newAxisMask)e.finalShapeGatherIndices.push(Ok),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[s]),t.end!=null&&(e.end[n]=t.end[s]),e.strides[n]=t.strides[s],t.beginMask&1<<s&&(e.beginMask|=1<<n),t.endMask&1<<s&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(mae),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[n]=s,n++}}function NR(t,e,n,s,r,o){if(r[e])return n>0?o[e]:o[e+1&1];{const i=t<0?s+t:t;return i<o[0]?o[0]:i>o[1]?o[1]:i}}const EM=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:w$,computeFlatOffset:C$,computeOutShape:S$,getNormalizedAxes:yae,isSliceContinous:k$,maskToAxes:gae,parseSliceParams:Zx,sliceInfo:N$,startForAxis:$M,startIndicesWithElidedDims:CM,stopForAxis:IM,stopIndicesWithElidedDims:NM,stridesForAxis:TM,stridesWithElidedDims:wM},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const vae="4.20.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RM{static sgd(e){return new Yx(e)}static momentum(e,n,s=!1){return new m$(e,n,s)}static rmsprop(e,n=.9,s=0,r=null,o=!1){return new g$(e,n,s,r,o)}static adam(e=.001,n=.9,s=.999,r=null){return new f$(e,n,s,r)}static adadelta(e=.001,n=.95,s=null){return new d$(e,n,s)}static adamax(e=.002,n=.9,s=.999,r=null,o=0){return new p$(e,n,s,r,o)}static adagrad(e,n=.1){return new h$(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yl=RM;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xae=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function T$(){return new Promise(t=>xae(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $$(t,e){const n=t[0].length;t.forEach((r,o)=>{T(r.length===n,()=>`Error in concat${n}D: rank of tensors[${o}] must be the same as the rank of the rest (${n})`)}),T(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=t[0];t.forEach((r,o)=>{for(let i=0;i<n;i++)T(i===e||r[i]===s[i],()=>`Error in concat${n}D: Shape of tensors[${o}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${o}.`)})}function qo(t,e){const n=t[0].slice();for(let s=1;s<t.length;s++)n[e]+=t[s][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var mo;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(mo||(mo={}));function _M(t,e,n){let s=new Array;if(n==null&&e==null)return s;if(e==null)for(;s.length<t+n.length;)s.push(-1);else s=e.slice();if(n==null)return s;if(t+n.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const o=n[r],i=s[s.length-n.length+r],a=s[i];if(o>=0)if(a>=0){if(a!==o)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+t}] = ${o} but shape[${r+t}] = ${a}`)}else s[i]=o}return s}function AM(t){const e={FIRST_DIM_SIZE:mo.FIRST_DIM_SIZE,VALUE_ROWIDS:mo.VALUE_ROWIDS,ROW_LENGTHS:mo.ROW_LENGTHS,ROW_SPLITS:mo.ROW_SPLITS,ROW_LIMITS:mo.ROW_LIMITS,ROW_STARTS:mo.ROW_STARTS},n=[];for(const s of t)if(s in e)n.push(e[s]);else break;return n}function DM(t){return t.length===0?0:t[0]===mo.FIRST_DIM_SIZE?t.length-1:t.length}function OM(t,e){if(t==null||e==null)return;const n=t.length,s=e.length;if(n>=s)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const o=t[r],i=e[r+1];if(o>=0&&i>=0&&o!==1&&o!==i)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-t.length}] = ${o} but ragged tensor input.flatValues.shape[${r-t.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I$=30;function Jx(t){return t<=I$?t:A0(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E$(t,e,n){const s=n*(typeof t=="number"?t:t[0]),r=e*(typeof t=="number"?t:t[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sg(t,e,n,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const o=e.length;for(let i=0;i<o;++i)r=r.concat([t[i+1]/e[i],e[i]]);r=r.concat(t.slice(o+1))}return r}function kg(t,e,n=!0){const s=[];if(n){s.push(e);for(let r=e+1;r<t;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],o=[];for(let i=1;i<t;++i)i>=e*2+1||i%2===1?o.push(i):r.push(i);s.push(...r),s.push(0),s.push(...o)}return s}function Cg(t,e,n,s=!0){const r=[];s?r.push(t[0]/n):r.push(t[0]*n);for(let o=1;o<t.length;++o)o<=e.length?s?r.push(e[o-1]*t[o]):r.push(t[o]/e[o-1]):r.push(t[o]);return r}function R$(t,e){const n=[0];for(let s=0;s<e;++s)n.push(t[s][0]);return n}function _$(t,e,n){const s=t.slice(0,1);for(let r=0;r<n;++r)s.push(t[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ew=1.7580993408473768,tw=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A$=.3275911,D$=.254829592,O$=-.284496736,F$=1.421413741,L$=-1.453152027,P$=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _i(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let s=0;s<n.length;s+=2)n[s]=t[s/2],n[s+1]=e[s/2];return n}function FM(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let s=0;s<t.length;s+=2)e[s/2]=t[s],n[s/2]=t[s+1];return{real:e,imag:n}}function LM(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function PM(t){const e=Math.floor(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function M$(t,e){const n=t[e*2],s=t[e*2+1];return{real:n,imag:s}}function MM(t,e,n,s){t[s*2]=e,t[s*2+1]=n}function zM(t,e){const n=new Float32Array(t/2),s=new Float32Array(t/2);for(let r=0;r<Math.ceil(t/2);r++){const o=(e?2:-2)*Math.PI*(r/t);n[r]=Math.cos(o),s[r]=Math.sin(o)}return{real:n,imag:s}}function BM(t,e,n){const s=(n?2:-2)*Math.PI*(t/e),r=Math.cos(s),o=Math.sin(s);return{real:r,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k1="->",wae=/->/g,TR=",",$R="...";function z$(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(wae,"").length)/k1.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${k1}").`);const[s,r]=t.split(k1);T(s.indexOf($R)===-1,()=>`The ellipsis notation ("${$R}") is not supported yet.`);const o=s.split(TR),i=o.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<r.length;++h){const f=r[h];if(!o.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let h=0;h<s.length;++h){const f=s[h];a.indexOf(f)===-1&&f!==TR&&a.push(f)}const l=new Array(o.length);for(let h=0;h<i;++h){if(new Set(o[h].split("")).size!==o[h].length)throw new Error(`Found duplicate axes in input component ${o[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let f=0;f<o[h].length;++f)l[h].push(a.indexOf(o[h][f]))}const u=a.length,c=r.length,d=[];for(let h=c;h<u;++h)d.push(h);return{allDims:a,summedDims:d,idDims:l}}function B$(t,e){let n=new Array(t);n.fill(-1);for(let r=0;r<e.length;++r)n[e[r]]=r;const s=[];for(let r=0;r<t;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function V$(t,e,n){const s=new Array(t);for(let r=0;r<n.length;++r){const o=n[r].shape;for(let i=0;i<e[r].length;++i)s[e[r][i]]===void 0?s[e[r][i]]=o[i]:T(s[e[r][i]]===o[i],()=>`Expected dimension ${s[e[r][i]]} at axis ${i} of input shaped ${JSON.stringify(o)}, but got dimension ${o[i]}`)}}function U$(t,e){const n=t,s=[];let r=0;t.length===0&&n.push(-1),r=t.length+1;for(let i=0;i<r;++i)s.push([]);const o=[];for(let i=0;i<n.length;++i){const a=n[i],l=Sae(e,a);for(const u of l)o.indexOf(u)===-1&&(s[i].push(u),o.push(u))}return{path:n,steps:s}}function W$(t){return t.every((e,n)=>e===n)}function Sae(t,e){const n=[];for(let s=0;s<t.length;++s)(t[s].length===0||t[s].indexOf(e)!==-1||e===-1)&&n.push(s);return n}function j$(t,e,n=0){let s=[];if(typeof e=="number")T(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(t.shape[n]/e);else{const r=e.reduce((i,a)=>(a===-1&&(i+=1),i),0);T(r<=1,()=>"There should be only one negative value in split array.");const o=e.indexOf(-1);if(o!==-1){const i=e.reduce((a,l)=>l>0?a+l:a);e[o]=t.shape[n]-i}T(t.shape[n]===e.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VM(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function UM(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function WM(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jM(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function GM(t,e){return`size ${t} must be non-negative, not ${e}`}function HM(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function qM(t,e){const n=oe(t),s=oe(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${t} outputShape= ${e}`}function KM(t,e){const n=oe(t),s=oe(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fk(){return"segment ids must be >= 0"}function XM(){return"segment ids are not increasing"}function YM(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function QM(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZM(t,e){let n=!1,s;for(t<=I$?(s=t,n=!0):s=A0(t,Math.floor(Math.sqrt(t)));!n;)s>e||s===t?n=!0:s=A0(t,s+1);return s}function JM(t,e,n){const s=[],r=t.length;for(let o=0;o<r;o++)o!==e?s.push(t[o]):s.push(n);return s}function G$(t,e,n,s){const r=e.shape.length,o=t.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>o)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${o}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let d=0;d<s;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const i=t.shape[n],a=[];let l=1,u=1,c=1;for(let d=0;d<s;++d)a.push(t.shape[d]),l*=t.shape[d];for(let d=s;d<n;d++)a.push(t.shape[d]),u*=t.shape[d];for(let d=s;d<r;d++)a.push(e.shape[d]);for(let d=n+1;d<o;d++)a.push(t.shape[d]),c*=t.shape[d];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:i,outputShape:a}}const kae=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:G$,computeOutShape:JM,segOpComputeOptimalWindowSize:ZM},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ai(t){try{return t.map(e=>$i(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function ez(t){return t.map(e=>Go(e))}const tz=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:D$,ERF_A2:O$,ERF_A3:F$,ERF_A4:L$,ERF_A5:P$,ERF_P:A$,PARALLELIZE_THRESHOLD:I$,get RowPartitionType(){return mo},SELU_SCALE:tw,SELU_SCALEALPHA:ew,applyActivation:Gx,assertAndGetBroadcastShape:qe,assertAxesAreInnerMostDims:es,assertParamsConsistent:$$,assignToTypedArray:MM,axesAreInnerMostDims:$T,calculateShapes:rl,checkEinsumDimSizes:V$,checkPadOnDimRoundingMode:Ss,combineLocations:m3,combineRaggedTensorToTensorShapes:_M,complexWithEvenIndex:LM,complexWithOddIndex:PM,computeConv2DInfo:zn,computeConv3DInfo:el,computeDefaultPad:uT,computeDilation2DInfo:rg,computeOptimalWindowSize:Jx,computeOutAndReduceShapes:Bn,computeOutShape:qo,computePool2DInfo:eo,computePool3DInfo:Mi,convertConv2DDataFormat:zi,decodeEinsumEquation:z$,eitherStridesOrDilationsAreOne:Jn,expandShapeToKeepDim:fn,exponent:BM,exponents:zM,fromStringArrayToUint8:ez,fromUint8ToStringArray:Ai,getAxesPermutation:tn,getBroadcastDims:lu,getComplexWithIndex:M$,getEinsumComputePath:U$,getEinsumPermutation:B$,getFusedBiasGradient:jx,getFusedDyActivation:Wx,getImageCenter:E$,getInnerMostAxes:pn,getPermuted:kg,getRaggedRank:DM,getReductionAxes:Sn,getReshaped:Sg,getReshapedPermuted:Cg,getRowPartitionTypesHelper:AM,getSliceBeginCoords:R$,getSliceSize:_$,getSparseFillEmptyRowsIndicesDenseShapeMismatch:VM,getSparseFillEmptyRowsNegativeIndexErrorMessage:UM,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:WM,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:HM,getSparseReshapeInputOutputMismatchErrorMessage:KM,getSparseReshapeInputOutputMultipleErrorMessage:qM,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:jM,getSparseReshapeNegativeOutputDimErrorMessage:GM,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:QM,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:Fk,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:XM,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:YM,getUndoAxesPermutation:tl,isIdentityPermutation:W$,log:yJ,mergeRealAndImagArrays:_i,prepareAndValidate:Qx,prepareSplitSize:j$,segment_util:kae,shouldFuse:Hx,slice_util:EM,splitRealAndImagArrays:FM,stridesOrDilationsArePositive:au,tupleValuesAreOne:za,upcastType:As,validateDefaultValueShape:OM,validateInput:Mx,validateUpdateShape:t$,warn:pr},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cae=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:qx,nonMaxSuppressionV4Impl:Kx,nonMaxSuppressionV5Impl:Xx,whereImpl:Vx},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Mie();const Nae=Object.freeze(Object.defineProperty({__proto__:null,Abs:Jp,Acos:Cd,Acosh:Nd,AdadeltaOptimizer:d$,AdagradOptimizer:h$,AdamOptimizer:f$,AdamaxOptimizer:p$,Add:Tu,AddN:em,All:av,Any:lv,ArgMax:tm,ArgMin:nm,Asin:Td,Asinh:$d,Atan:Id,Atan2:Rd,Atanh:Ed,AvgPool:sm,AvgPool3D:rm,AvgPool3DGrad:cv,AvgPoolGrad:uv,BatchMatMul:om,BatchToSpaceND:im,Bincount:dv,BitwiseAnd:am,BroadcastArgs:hv,BroadcastTo:$P,Cast:_d,Ceil:Ad,ClipByValue:Dd,Complex:fv,ComplexAbs:lm,Concat:um,Conv2D:cm,Conv2DBackpropFilter:pv,Conv2DBackpropInput:dm,Conv3D:hm,Conv3DBackpropFilterV2:mv,Conv3DBackpropInputV2:gv,Cos:Od,Cosh:Fd,CropAndResize:bv,Cumprod:yv,Cumsum:fm,DataStorage:MN,DenseBincount:vv,DepthToSpace:xv,DepthwiseConv2dNative:pm,DepthwiseConv2dNativeBackpropFilter:wv,DepthwiseConv2dNativeBackpropInput:Sv,Diag:kv,Dilation2D:mm,Dilation2DBackpropFilter:O0,Dilation2DBackpropInput:D0,Draw:Cv,get ENV(){return WN},Einsum:Nv,Elu:Pd,EluGrad:Tv,Environment:NP,Equal:gm,Erf:Md,Exp:zd,ExpandDims:ym,Expm1:Bd,FFT:$v,Fill:Iv,FlipLeftRight:Ev,Floor:Vd,FloorDiv:Ud,FromPixels:F0,FusedBatchNorm:bm,FusedConv2D:ip,FusedDepthwiseConv2D:ap,GatherNd:Rv,GatherV2:vm,Greater:xm,GreaterEqual:Wd,IFFT:_v,Identity:jd,Imag:Av,IsFinite:Gd,IsInf:Hd,IsNan:qd,KernelBackend:rv,LRN:$m,LRNGrad:Ov,LeakyRelu:wm,Less:Sm,LessEqual:km,LinSpace:Dv,Log:Kd,Log1p:Xd,LogSoftmax:IP,LogicalAnd:Cm,LogicalNot:Nm,LogicalOr:Tm,LogicalXor:hJ,LowerBound:fJ,MatrixBandPart:pJ,Max:Im,MaxPool:Em,MaxPool3D:Rm,MaxPool3DGrad:Lv,MaxPoolGrad:Fv,MaxPoolWithArgmax:Pv,Maximum:Yd,Mean:_m,Min:Am,Minimum:Qd,MirrorPad:Dm,Mod:Zd,MomentumOptimizer:m$,Multinomial:Mv,Multiply:Jd,Neg:Om,NonMaxSuppressionV3:zv,NonMaxSuppressionV4:Bv,NonMaxSuppressionV5:Vv,NotEqual:Fm,OP_SCOPE_SUFFIX:XN,OneHot:Pm,OnesLike:Lm,Optimizer:ji,OptimizerConstructors:RM,Pack:Mm,PadV2:zm,Pool:mJ,Pow:eh,Prelu:Bm,Prod:Vm,RMSPropOptimizer:g$,RaggedGather:Uv,RaggedRange:Wv,RaggedTensorToTensor:jv,Range:Gv,get Rank(){return bk},Real:Hv,RealDiv:Ld,Reciprocal:th,get Reduction(){return bs},Relu:nh,Relu6:sh,Reshape:Um,ResizeBilinear:jm,ResizeBilinearGrad:Kv,ResizeNearestNeighbor:Wm,ResizeNearestNeighborGrad:qv,Reverse:Gm,RotateWithOffset:dx,Round:rh,Rsqrt:oh,SGDOptimizer:Yx,ScatterNd:Xv,SearchSorted:Qv,Select:Hm,Selu:ih,Sigmoid:ch,Sign:uh,Sin:ah,Sinh:lh,Slice:qm,Softmax:Qm,Softplus:dh,SpaceToBatchND:Xm,SparseFillEmptyRows:Zv,SparseReshape:Jv,SparseSegmentMean:ex,SparseSegmentSum:tx,SparseToDense:nx,SplitV:Ym,Sqrt:hh,Square:sx,SquaredDifference:fh,StaticRegexReplace:Zm,Step:bh,StridedSlice:rx,StringNGrams:ox,StringSplit:ix,StringToHashBucketFast:ax,Sub:ph,Sum:Km,Tan:mh,Tanh:gh,Tensor:vt,TensorBuffer:xn,TensorScatterUpdate:Yv,Tile:yh,TopK:lx,Transform:ux,Transpose:jl,Unique:cx,Unpack:Jm,UnsortedSegmentSum:eg,UpperBound:gJ,Variable:cp,ZerosLike:tg,_FusedMatMul:op,abs:bn,acos:tT,acosh:nT,add:ce,addN:l3,all:gx,any:hp,argMax:iu,argMin:sT,asin:rT,asinh:oT,atan:iT,atan2:aT,atanh:lT,avgPool:og,avgPool3d:cT,backend:QN,backend_util:tz,basicLSTMCell:u3,batchNorm:vh,batchNorm2d:dT,batchNorm3d:hT,batchNorm4d:fT,batchToSpaceND:ig,bincount:pT,bitwiseAnd:c3,booleanMaskAsync:X3,broadcastArgs:d3,broadcastTo:Gl,broadcast_util:Xte,browser:fae,buffer:Ze,cast:be,ceil:mT,clipByValue:Os,clone:Ho,complex:Ei,concat:hn,concat1d:gT,concat2d:yT,concat3d:bT,concat4d:vT,conv1d:yx,conv2d:Ri,conv2dTranspose:bx,conv3d:wT,conv3dTranspose:ST,copyRegisteredKernels:xJ,cos:ag,cosh:vx,cosineWindow:Ux,cumprod:mp,cumsum:xx,customGrad:Jo,denseBincount:z0,deprecationWarn:ZJ,depthToSpace:kT,depthwiseConv2d:xh,device_util:HJ,diag:f3,dilation2d:CT,disableDeprecationWarnings:QJ,dispose:Qe,disposeVariables:JJ,div:Fe,divNoNan:NT,dot:TT,dropout:i$,einsum:xl,elu:wh,enableDebugMode:YJ,enableProdMode:XJ,enclosingPowerOfTwo:a$,engine:lo,ensureShape:p3,env:ee,equal:Zr,erf:wx,euclideanNorm:IT,exp:Fs,expandDims:jn,expm1:ET,eye:Sx,fft:xg,fill:Iu,findBackend:oee,findBackendFactory:iee,floor:kh,floorDiv:mx,fused:rM,gather:Ch,gatherND:J3,gather_util:pae,getBackend:qP,getGradient:mk,getKernel:up,getKernelsForBackend:L0,grad:Ane,grads:Dne,greater:Bs,greaterEqual:Bi,ifft:ud,imag:lg,image:br,inTopKAsync:eM,io:v$,irfft:Lx,isFinite:RT,isInf:_T,isNaN:AT,keep:Cn,kernel_impls:Cae,leakyRelu:ug,less:od,lessEqual:nl,linalg:c$,linspace:y3,localResponseNormalization:DT,log:er,log1p:cg,logSigmoid:OT,logSoftmax:Cx,logSumExp:dg,logicalAnd:So,logicalNot:hg,logicalOr:Nx,logicalXor:FT,losses:dM,lowerBound:v3,matMul:nt,math:rae,max:Sr,maxPool:fg,maxPool3d:LT,maxPoolWithArgmax:x3,maximum:ii,mean:Zt,memory:M0,meshgrid:w3,min:rd,minimum:Va,mirrorPad:PT,mod:MT,moments:pg,movingAverage:Y3,mul:L,multiRNNCell:S3,multinomial:k3,neg:Dt,nextFrame:T$,norm:Sh,notEqual:uu,oneHot:id,ones:Es,onesLike:tr,op:O,outerProduct:C3,pad:Vi,pad1d:N3,pad2d:T3,pad3d:$3,pad4d:I3,pool:zT,pow:Zo,prelu:gg,print:eT,prod:BT,profile:eee,raggedGather:E3,raggedRange:R3,raggedTensorToTensor:_3,rand:A3,randomGamma:L3,randomNormal:$x,randomStandardNormal:P3,randomUniform:sl,randomUniformInt:M3,range:cu,ready:see,real:ad,reciprocal:YT,registerBackend:YN,registerGradient:EP,registerKernel:hx,relu:Io,relu6:Ix,removeBackend:ree,reshape:B,reverse:Cr,reverse1d:z3,reverse2d:B3,reverse3d:V3,reverse4d:U3,rfft:wg,round:Ex,rsqrt:Rx,scalar:ze,scatterND:Q3,scatter_util:Fre,searchSorted:Tx,selu:_x,separableConv2d:Ax,serialization:Lie,setBackend:nee,setPlatform:aee,setdiff1dAsync:W3,sigmoid:vo,sign:QT,signal:cM,sin:Dx,sinh:Ox,slice:ct,slice1d:bg,slice2d:Fx,slice3d:vg,slice4d:ld,slice_util:EM,softmax:Nh,softplus:Eu,spaceToBatchND:mg,sparse:hM,sparseToDense:Z3,spectral:uM,split:_s,sqrt:Mn,square:Tt,squaredDifference:Px,squeeze:Ui,stack:Ls,step:_u,stridedSlice:ZT,string:fM,sub:Te,sum:_e,sumOutType:fx,tan:JT,tanh:Ba,tensor:Xr,tensor1d:qn,tensor2d:Ra,tensor3d:e$,tensor4d:j3,tensor5d:G3,tensor6d:H3,tensorScatterUpdate:q3,tensor_util:VJ,test_util:Kse,tidy:Q,tile:yr,time:tee,topk:n$,train:yl,transpose:dt,truncatedNormal:zx,unique:s$,unregisterGradient:vJ,unregisterKernel:bJ,unsortedSegmentSum:Bx,unstack:Nr,upcastType:As,upperBound:K3,util:EJ,valueAndGrad:One,valueAndGrads:Fne,variable:r$,variableGrads:b3,version_core:vae,where:Xn,whereAsync:o$,zeros:dn,zerosLike:ft},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tae=ee();Tae.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Ws;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(Ws||(Ws={}));var IR;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(IR||(IR={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ae={};function nz(t){return $ae[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k(t,e,n,s,r){const o=e.inputParams[t];if(o&&o.inputIndexStart!==void 0){const a=o.inputIndexStart,l=o.inputIndexEnd===0?void 0:o.inputIndexEnd===void 0?a+1:o.inputIndexEnd,u=a<0?e.inputNames.length+a:a;if(o.type==="tensor")return Gn(e.inputNames[u],n,s,r);if(o.type==="tensors"){const h=e.inputs.slice(a,l);return e.inputNames.slice(a,l).filter((p,m)=>{var g;return((g=h[m])===null||g===void 0?void 0:g.op)!=="NoOp"}).map(p=>Gn(p,n,s,r))}const c=Gn(e.inputNames[u],n,s,r),d=c.dataSync();return o.type==="number"?d[0]:wr(c.shape,d)}const i=e.attrParams[t];return i&&i.value}function Gn(t,e,n,s){const[r,o]=Gs(t,n);if(s!=null){const a=s.getHashTableHandleByName(r);if(a!=null)return a}const i=n.currentContextIds.find(a=>!!e[B0(r,a)]);return i!==void 0?e[B0(r,i)][o]:void 0}function ER(t,e,n){return e[B0(t,n.currentContextId)]}function hi(t,e){const[n,s,r]=Gs(t,e);return[B0(n,e&&e.currentContextId),s,r]}function B0(t,e){return e?`${t}-${e}`:t}function Gs(t,e){if(t==="")return["",0,void 0];const n=e!=null&&e.parseNodeNameCache!=null;if(n){const o=e.parseNodeNameCache.get(t);if(o!=null)return o}const s=t.split(":");let r;if(s.length===1)r=[t,0,void 0];else{const o=s[0],i=s.length===3?s[1]:void 0,a=Number(s[s.length-1]);r=[o,a,i]}return n&&e.parseNodeNameCache.set(t,r),r}function Xy(t,e,n){let s=k("pad",t,e,n);if(s==="explicit"){s=k("explicitPaddings",t,e,n);const r=[[0,0],[0,0],[0,0],[0,0]];for(let o=0;o<4;o++)r[o][0]=s[o*2],r[o][1]=s[o*2+1];return r}return s}function fi(t){return t.kept?t:Ho(t)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iae=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Eae=Object.freeze(Object.defineProperty({__proto__:null,json:Iae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rae=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],_ae=Object.freeze(Object.defineProperty({__proto__:null,json:Rae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aae=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],Dae=Object.freeze(Object.defineProperty({__proto__:null,json:Aae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oae=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],Fae=Object.freeze(Object.defineProperty({__proto__:null,json:Oae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lae=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Pae=Object.freeze(Object.defineProperty({__proto__:null,json:Lae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mae=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],zae=Object.freeze(Object.defineProperty({__proto__:null,json:Mae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bae=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Vae=Object.freeze(Object.defineProperty({__proto__:null,json:Bae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uae=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],Wae=Object.freeze(Object.defineProperty({__proto__:null,json:Uae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jae=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Gae=Object.freeze(Object.defineProperty({__proto__:null,json:jae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hae=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],qae=Object.freeze(Object.defineProperty({__proto__:null,json:Hae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kae=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],Xae=Object.freeze(Object.defineProperty({__proto__:null,json:Kae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yae=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],Qae=Object.freeze(Object.defineProperty({__proto__:null,json:Yae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zae=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],Jae=Object.freeze(Object.defineProperty({__proto__:null,json:Zae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ele=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],tle=Object.freeze(Object.defineProperty({__proto__:null,json:ele},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nle=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],sle=Object.freeze(Object.defineProperty({__proto__:null,json:nle},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rle=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],ole=Object.freeze(Object.defineProperty({__proto__:null,json:rle},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ile=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],ale=Object.freeze(Object.defineProperty({__proto__:null,json:ile},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lle=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],ule=Object.freeze(Object.defineProperty({__proto__:null,json:lle},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cle=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],dle=Object.freeze(Object.defineProperty({__proto__:null,json:cle},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RR{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[Eae,_ae,Dae,Fae,Pae,zae,Vae,Wae,Gae,qae,Xae,Qae,Jae,tle,sle,ole,ale,ule,dle],n=[].concat(...e.map(s=>s.json));this.opMappers=n.reduce((s,r)=>(s[r.tfOpName]=r,s),{})}transformGraph(e,n={}){const s=e.node,r=[],o=[],i=[],a=s.reduce((m,g)=>(m[g.name]=this.mapNode(g),g.op.startsWith("Placeholder")?r.push(m[g.name]):g.op==="Const"?o.push(m[g.name]):(g.input==null||g.input.length===0)&&i.push(m[g.name]),m),{});let l=[];const u=[];let c={},d={};n!=null&&(c=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const h=Object.keys(a);h.forEach(m=>{const g=a[m];g.inputNames.forEach((y,b)=>{const[v,,x]=hi(y),w=a[v];if(w.outputs!=null){const S=w.outputs.indexOf(x);if(S!==-1){const C=`${v}:${S}`;g.inputNames[b]=C}}g.inputs.push(w),w.children.push(g)})}),Object.keys(d).length===0?h.forEach(m=>{const g=a[m];g.children.length===0&&u.push(g)}):Object.keys(d).forEach(m=>{const[g]=hi(m),y=a[g];y!=null&&(y.signatureKey=d[m],u.push(y))}),Object.keys(c).length>0?Object.keys(c).forEach(m=>{const[g]=hi(m),y=a[g];y&&(y.signatureKey=c[m],l.push(y))}):l=r;let f={};e.library!=null&&e.library.function!=null&&(f=e.library.function.reduce((m,g)=>(m[g.signature.name]=this.mapFunction(g),m),{}));const p={nodes:a,inputs:l,outputs:u,weights:o,placeholders:r,signature:n,functions:f};return i.length>0&&(p.initNodes=i),p}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,s)=>(n[e[s].name]=s,n),{})}mapNode(e){const n=nz(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const s={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(s.inputParams=n.inputs.reduce((r,o)=>(r[o.name]={type:o.type,inputIndexStart:o.start,inputIndexEnd:o.end},r),{})),n.attrs!=null&&(s.attrParams=n.attrs.reduce((r,o)=>{const i=o.type;let a;switch(o.type){case"string":a=Lk(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Lk(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"string[]":a=Wk(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Wk(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number":a=Mk(e.attr,o.tfName,o.defaultValue||0),a===void 0&&o.tfDeprecatedName&&(a=Mk(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number[]":a=Uk(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Uk(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool":a=Pk(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Pk(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool[]":a=Gk(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Gk(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape":a=Vk(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Vk(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape[]":a=jk(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=jk(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype":a=zk(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=zk(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype[]":a=Bk(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Bk(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"func":a=_R(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=_R(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${o.type} for op: ${e.op}`)}return r[o.name]={value:a,type:i},r},{})),s}mapFunction(e){const n=e.nodeDef,s=[],r=[];let o={};n!=null&&(o=n.reduce((d,h)=>(d[h.name]=this.mapNode(h),h.op==="Const"&&r.push(d[h.name]),d),{}));const i=[],a=[];e.signature.inputArg.forEach(d=>{const[h]=hi(d.name),f={name:h,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:H$(d.type),type:"dtype"}},children:[]};f.signatureKey=d.name,i.push(f),o[h]=f}),Object.keys(o).forEach(d=>{const h=o[d];h.inputNames.forEach((f,p)=>{const[m,,g]=hi(f),y=o[m];if(y.outputs!=null){const b=y.outputs.indexOf(g);if(b!==-1){const v=`${m}:${b}`;h.inputNames[p]=v}}h.inputs.push(y),y.children.push(h)})});const u=e.ret;e.signature.outputArg.forEach(d=>{const[h,f]=hi(u[d.name]),p=o[h];p!=null&&(p.defaultOutput=f,a.push(p))});const c=this.mapArgsToSignature(e);return{nodes:o,inputs:i,outputs:a,weights:r,placeholders:s,signature:c}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s),n),{}),outputs:e.signature.outputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s,e.ret),n),{})}}mapArgToTensorInfo(e,n){let s=e.name;return n!=null&&(s=n[s]),{name:s,dtype:e.type}}}function hle(t){const e=ee().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function sz(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):hle(t);return e?n:n.toLowerCase()}function Lk(t,e,n,s=!1){const r=t[e];return r!=null?sz(r.s,s):n}function Pk(t,e,n){const s=t[e];return s?s.b:n}function Mk(t,e,n){const s=t[e]||{},r=s.i!=null?s.i:s.f!=null?s.f:n;return typeof r=="number"?r:parseInt(r,10)}function H$(t){switch(typeof t=="string"&&(t=Ws[t]),t){case Ws.DT_FLOAT:case Ws.DT_HALF:return"float32";case Ws.DT_INT32:case Ws.DT_INT64:case Ws.DT_INT8:case Ws.DT_UINT8:return"int32";case Ws.DT_BOOL:return"bool";case Ws.DT_DOUBLE:return"float32";case Ws.DT_STRING:return"string";case Ws.DT_COMPLEX64:case Ws.DT_COMPLEX128:return"complex64";default:return null}}function _R(t,e,n){const s=t[e];return s&&s.func?s.func.name:n}function zk(t,e,n){const s=t[e];return s&&s.type?H$(s.type):n}function Bk(t,e,n){const s=t[e];return s&&s.list&&s.list.type?s.list.type.map(r=>H$(r)):n}function rz(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function Vk(t,e,n){const s=t[e];return s&&s.shape?rz(s.shape):n}function Uk(t,e,n){const s=t[e];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(r=>typeof r=="number"?r:parseInt(r,10)):n}function Wk(t,e,n,s=!1){const r=t[e];return r&&r.list&&r.list.s?r.list.s.map(o=>sz(o,s)):n}function jk(t,e,n){const s=t[e];return s&&s.list&&s.list.shape?s.list.shape.map(r=>rz(r)):n}function Gk(t,e,n){const s=t[e];return s&&s.list&&s.list.b?s.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fle{constructor(e,n,s){this.node=e,this.tensorMap=n,this.context=s,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(r=>this.getInput(r)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((r,o)=>(r[o]=this.getAttr(o),r),{}))}getInput(e){return Gn(e,this.tensorMap,this.context)}getAttr(e,n){const s=this.node.rawAttrs[e];if(s.tensor!=null)return Gn(e,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return Mk(this.node.rawAttrs,e,n);if(s.s!=null)return Lk(this.node.rawAttrs,e,n);if(s.b!=null)return Pk(this.node.rawAttrs,e,n);if(s.shape!=null)return Vk(this.node.rawAttrs,e,n);if(s.type!=null)return zk(this.node.rawAttrs,e,n);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return Uk(this.node.rawAttrs,e,n);if(s.list.s!=null)return Wk(this.node.rawAttrs,e,n);if(s.list.shape!=null)return jk(this.node.rawAttrs,e,n);if(s.list.b!=null)return Gk(this.node.rawAttrs,e,n);if(s.list.type!=null)return Bk(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ts=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:XN,abs:bn,acos:tT,acosh:nT,add:ce,addN:l3,all:gx,any:hp,argMax:iu,argMin:sT,asin:rT,asinh:oT,atan:iT,atan2:aT,atanh:lT,avgPool:og,avgPool3d:cT,basicLSTMCell:u3,batchNorm:vh,batchNorm2d:dT,batchNorm3d:hT,batchNorm4d:fT,batchToSpaceND:ig,bincount:pT,bitwiseAnd:c3,booleanMaskAsync:X3,broadcastArgs:d3,broadcastTo:Gl,buffer:Ze,cast:be,ceil:mT,clipByValue:Os,clone:Ho,complex:Ei,concat:hn,concat1d:gT,concat2d:yT,concat3d:bT,concat4d:vT,conv1d:yx,conv2d:Ri,conv2dTranspose:bx,conv3d:wT,conv3dTranspose:ST,cos:ag,cosh:vx,cosineWindow:Ux,cumprod:mp,cumsum:xx,denseBincount:z0,depthToSpace:kT,depthwiseConv2d:xh,diag:f3,dilation2d:CT,div:Fe,divNoNan:NT,dot:TT,dropout:i$,einsum:xl,elu:wh,enclosingPowerOfTwo:a$,ensureShape:p3,equal:Zr,erf:wx,euclideanNorm:IT,exp:Fs,expandDims:jn,expm1:ET,eye:Sx,fft:xg,fill:Iu,floor:kh,floorDiv:mx,fused:rM,gather:Ch,gatherND:J3,greater:Bs,greaterEqual:Bi,ifft:ud,imag:lg,image:br,inTopKAsync:eM,irfft:Lx,isFinite:RT,isInf:_T,isNaN:AT,leakyRelu:ug,less:od,lessEqual:nl,linalg:c$,linspace:y3,localResponseNormalization:DT,log:er,log1p:cg,logSigmoid:OT,logSoftmax:Cx,logSumExp:dg,logicalAnd:So,logicalNot:hg,logicalOr:Nx,logicalXor:FT,losses:dM,lowerBound:v3,matMul:nt,max:Sr,maxPool:fg,maxPool3d:LT,maxPoolWithArgmax:x3,maximum:ii,mean:Zt,meshgrid:w3,min:rd,minimum:Va,mirrorPad:PT,mod:MT,moments:pg,movingAverage:Y3,mul:L,multiRNNCell:S3,multinomial:k3,neg:Dt,norm:Sh,notEqual:uu,oneHot:id,ones:Es,onesLike:tr,op:O,outerProduct:C3,pad:Vi,pad1d:N3,pad2d:T3,pad3d:$3,pad4d:I3,pool:zT,pow:Zo,prelu:gg,print:eT,prod:BT,raggedGather:E3,raggedRange:R3,raggedTensorToTensor:_3,rand:A3,randomGamma:L3,randomNormal:$x,randomStandardNormal:P3,randomUniform:sl,randomUniformInt:M3,range:cu,real:ad,reciprocal:YT,relu:Io,relu6:Ix,reshape:B,reverse:Cr,reverse1d:z3,reverse2d:B3,reverse3d:V3,reverse4d:U3,rfft:wg,round:Ex,rsqrt:Rx,scalar:ze,scatterND:Q3,searchSorted:Tx,selu:_x,separableConv2d:Ax,setdiff1dAsync:W3,sigmoid:vo,sign:QT,signal:cM,sin:Dx,sinh:Ox,slice:ct,slice1d:bg,slice2d:Fx,slice3d:vg,slice4d:ld,softmax:Nh,softplus:Eu,spaceToBatchND:mg,sparse:hM,sparseToDense:Z3,spectral:uM,split:_s,sqrt:Mn,square:Tt,squaredDifference:Px,squeeze:Ui,stack:Ls,step:_u,stridedSlice:ZT,string:fM,sub:Te,sum:_e,tan:JT,tanh:Ba,tensor:Xr,tensor1d:qn,tensor2d:Ra,tensor3d:e$,tensor4d:j3,tensor5d:G3,tensor6d:H3,tensorScatterUpdate:q3,tile:yr,topk:n$,transpose:dt,truncatedNormal:zx,unique:s$,unsortedSegmentSum:Bx,unstack:Nr,upperBound:K3,variable:r$,where:Xn,whereAsync:o$,zeros:dn,zerosLike:ft},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ple=(t,e,n,s=ts)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(k("a",t,e,n),k("b",t,e,n))];case"AddN":return[s.addN(k("tensors",t,e,n))];case"FloorMod":case"Mod":return[s.mod(k("a",t,e,n),k("b",t,e,n))];case"Mul":return[s.mul(k("a",t,e,n),k("b",t,e,n))];case"RealDiv":case"Div":return[s.div(k("a",t,e,n),k("b",t,e,n))];case"DivNoNan":return[s.divNoNan(k("a",t,e,n),k("b",t,e,n))];case"FloorDiv":return[s.floorDiv(k("a",t,e,n),k("b",t,e,n))];case"Sub":return[s.sub(k("a",t,e,n),k("b",t,e,n))];case"Minimum":return[s.minimum(k("a",t,e,n),k("b",t,e,n))];case"Maximum":return[s.maximum(k("a",t,e,n),k("b",t,e,n))];case"Pow":return[s.pow(k("a",t,e,n),k("b",t,e,n))];case"SquaredDifference":return[s.squaredDifference(k("a",t,e,n),k("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mle=(t,e,n,s=ts)=>{switch(t.op){case"Abs":case"ComplexAbs":return[s.abs(k("x",t,e,n))];case"Acos":return[s.acos(k("x",t,e,n))];case"Acosh":return[s.acosh(k("x",t,e,n))];case"Asin":return[s.asin(k("x",t,e,n))];case"Asinh":return[s.asinh(k("x",t,e,n))];case"Atan":return[s.atan(k("x",t,e,n))];case"Atan2":return[s.atan2(k("x",t,e,n),k("y",t,e,n))];case"Atanh":return[s.atanh(k("x",t,e,n))];case"Ceil":return[s.ceil(k("x",t,e,n))];case"Complex":return[s.complex(k("real",t,e,n),k("imag",t,e,n))];case"Cos":return[s.cos(k("x",t,e,n))];case"Cosh":return[s.cosh(k("x",t,e,n))];case"Elu":return[s.elu(k("x",t,e,n))];case"Erf":return[s.erf(k("x",t,e,n))];case"Exp":return[s.exp(k("x",t,e,n))];case"Expm1":return[s.expm1(k("x",t,e,n))];case"Floor":return[s.floor(k("x",t,e,n))];case"Log":return[s.log(k("x",t,e,n))];case"Log1p":return[s.log1p(k("x",t,e,n))];case"Imag":return[s.imag(k("x",t,e,n))];case"Neg":return[s.neg(k("x",t,e,n))];case"Reciprocal":return[s.reciprocal(k("x",t,e,n))];case"Real":return[s.real(k("x",t,e,n))];case"Relu":return[s.relu(k("x",t,e,n))];case"Round":return[s.round(k("x",t,e,n))];case"Selu":return[s.selu(k("x",t,e,n))];case"Sigmoid":return[s.sigmoid(k("x",t,e,n))];case"Sin":return[s.sin(k("x",t,e,n))];case"Sign":return[s.sign(k("x",t,e,n))];case"Sinh":return[s.sinh(k("x",t,e,n))];case"Softplus":return[s.softplus(k("x",t,e,n))];case"Sqrt":return[s.sqrt(k("x",t,e,n))];case"Square":return[s.square(k("x",t,e,n))];case"Tanh":return[s.tanh(k("x",t,e,n))];case"Tan":return[s.tan(k("x",t,e,n))];case"ClipByValue":return[s.clipByValue(k("x",t,e,n),k("clipValueMin",t,e,n),k("clipValueMax",t,e,n))];case"Relu6":return[s.relu6(k("x",t,e,n))];case"Rsqrt":return[s.rsqrt(Gn(t.inputNames[0],e,n))];case"LeakyRelu":return[s.leakyRelu(k("x",t,e,n),k("alpha",t,e,n))];case"Prelu":return[s.prelu(k("x",t,e,n),k("alpha",t,e,n))];case"IsNan":return[s.isNaN(Gn(t.inputNames[0],e,n))];case"IsInf":return[s.isInf(Gn(t.inputNames[0],e,n))];case"IsFinite":return[s.isFinite(Gn(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mr(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){T(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let s=0;s<t.length;s++){const r=t[s],o=e[s];T(r<0||o<0||r===o,()=>n+` Shapes ${t} and ${e} must match`)}}}function AR(t){return!(typeof t=="number"||t.some(e=>e<0))}function of(t,e,n){let s=Hk(t,n);const r=!AR(s);if(r&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(r&&e.forEach(o=>{s=Hk(o.shape,s)}),!AR(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function Hk(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let s=0;s<t.length;++s){const r=t[s],o=e[s];if(r>=0&&o>=0&&r!==o)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[s]=r>=0?r:o}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gle{constructor(e,n,s,r,o,i,a){this.name=e,this.dtype=n,this.maxSize=s,this.elementShape=r,this.identicalElementShapes=o,this.dynamicSize=i,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=ze(0),Cn(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),Mr(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);s.tensor=n,Cn(n),s.written=!0,this.tensors[e]=s}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((s,r)=>this.write(s,n[r]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let r=0;r<this.size();r++)e.push(r)}if(e.length===0)return Xr([],[0].concat(this.elementShape));const s=this.readMany(e);return Mr(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),Ls(s,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return Xr([],[0].concat(this.elementShape));const n=[];for(let r=0;r<this.size();r++)n.push(r);const s=this.readMany(n);return Mr(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),hn(s,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const s=Math.max(...e);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(e,Nr(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let s=0;const r=e.map(l=>(s+=l,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const o=s===0?0:n.size/s,i=[];Q(()=>{n=B(n,[1,s,o]);for(let l=0;l<e.length;++l){const c=[0,l===0?0:r[l-1],0],d=[1,e[l],o];i[l]=B(ct(n,c,d),this.elementShape)}return i});const a=[];for(let l=0;l<e.length;l++)a[l]=l;this.writeMany(a,i)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hu{get id(){return this.idTensor.id}constructor(e,n,s,r=-1){this.tensors=e,this.elementShape=n,this.elementDtype=s,e!=null&&e.forEach(o=>{if(s!==o.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${o.dtype}`);Mr(n,o.shape,"TensorList shape mismatch: "),Cn(o)}),this.idTensor=ze(0),this.maxNumElements=r,Cn(this.idTensor)}copy(){return new hu([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,s=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);Mr(e,this.elementShape,"TensorList shape mismatch: ");const r=of(this.elementShape,this.tensors,e);return Q(()=>{const o=this.tensors.map(i=>B(i,r));return Ls(o,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=of(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,Mr(r.shape,e,"TensorList shape mismatch: "),B(r,s)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(Mr(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Cn(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new hu([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let s=0;s<Math.min(this.tensors.length,e);++s)n.tensors[s]=this.tensors[s];return n}getItem(e,n,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);Mr(this.tensors[e].shape,n,"TensorList shape mismatch: ");const r=of(this.elementShape,this.tensors,n);return B(this.tensors[e],r)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);Mr(this.elementShape,n.shape,"TensorList shape mismatch: "),Cn(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,s){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);Mr(this.elementShape,s,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=of(this.elementShape,this.tensors,s);return e.length===0?Xr([],[0].concat(r)):Q(()=>{const o=e.map(i=>B(this.tensors[i],r));return Ls(o,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);Mr(this.elementShape,n,"TensorList shape mismatch: ");const s=of(this.elementShape,this.tensors,n);return this.size()===0?Xr([],[0].concat(s)):Q(()=>{const r=this.tensors.map(o=>B(o,s));return hn(r,0)})}}function yle(t,e,n){const s=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const r=t.shape.slice(1);Mr(r,e,"TensorList shape mismatch: ");const o=Nr(t);return new hu(o,e,s)}function ble(t,e,n,s){return new hu([],t,e,s)}function vle(t,e,n,s){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const r=Math.max(...e);if(s!=null&&s!==-1&&r>=s)throw new Error(`Max index must be < array size (${r}  vs. ${s})`);const o=new hu([],n,t.dtype,s),i=Nr(t,0);return e.forEach((a,l)=>{o.setItem(a,i[l])}),o}function xle(t,e,n){let s=0;const r=e.map(c=>(s+=c,s));if(s!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${t.shape}`);const o=t.shape.slice(1),i=Hk(o,n),a=s===0?0:t.size/s,l=Q(()=>{const c=[];t=B(t,[1,s,a]);for(let d=0;d<e.length;++d){const f=[0,d===0?0:r[d-1],0],p=[1,e[d],a];c[d]=B(ct(t,f,p),i)}return t.dispose(),c}),u=new hu([],n,t.dtype,e.length);for(let c=0;c<l.length;c++)u.setItem(c,l[c]);return u}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wle=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const s=k("thenBranch",t,e,n),r=k("elseBranch",t,e,n),o=k("cond",t,e,n),i=k("args",t,e,n);return(await o.data())[0]?n.functionMap[s].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap):n.functionMap[r].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const s=k("body",t,e,n),r=k("cond",t,e,n),o=k("args",t,e,n),i=await n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap),a=o.map(c=>c.id);let l=await i[0].data();i.forEach(c=>{!c.kept&&a.indexOf(c.id)===-1&&c.dispose()});let u=o;for(;l[0];){const c=u;u=await n.functionMap[s].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);const d=u.map(f=>f.id);c.forEach(f=>{!f.kept&&a.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()});const h=await n.functionMap[r].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);l=await h[0].data(),h.forEach(f=>{!f.kept&&a.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()})}return u}case"LoopCond":{const s=k("pred",t,e,n);return[fi(s)]}case"Switch":{const s=k("pred",t,e,n);let r=k("data",t,e,n);return r.kept||(r=fi(r)),(await s.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const s=t.inputNames.find(r=>Gn(r,e,n)!==void 0);if(s){const r=Gn(s,e,n);return[fi(r)]}return}case"Enter":{const s=k("frameName",t,e,n),r=k("tensor",t,e,n);return n.enterFrame(s),[fi(r)]}case"Exit":{const s=k("tensor",t,e,n);return n.exitFrame(),[fi(s)]}case"NextIteration":{const s=k("tensor",t,e,n);return n.nextIteration(),[fi(s)]}case"TensorArrayV3":{const s=k("size",t,e,n),r=k("dtype",t,e,n),o=k("elementShape",t,e,n),i=k("dynamicSize",t,e,n),a=k("clearAfterRead",t,e,n),l=k("identicalElementShapes",t,e,n),u=k("name",t,e,n),c=new gle(u,r,s,o,l,i,a);return n.addTensorArray(c),[c.idTensor,ze(1)]}case"TensorArrayWriteV3":{const s=k("tensorArrayId",t,e,n),r=k("index",t,e,n),o=k("tensor",t,e,n),i=n.getTensorArray(s.id);return i.write(r,o),[i.idTensor]}case"TensorArrayReadV3":{const s=k("tensorArrayId",t,e,n),r=k("index",t,e,n);return[n.getTensorArray(s.id).read(r)]}case"TensorArrayGatherV3":{const s=k("tensorArrayId",t,e,n),r=k("indices",t,e,n),o=k("dtype",t,e,n);return[n.getTensorArray(s.id).gather(r,o)]}case"TensorArrayScatterV3":{const s=k("tensorArrayId",t,e,n),r=k("indices",t,e,n),o=k("tensor",t,e,n),i=n.getTensorArray(s.id);return i.scatter(r,o),[i.idTensor]}case"TensorArrayConcatV3":{const s=k("tensorArrayId",t,e,n),r=n.getTensorArray(s.id),o=k("dtype",t,e,n);return[r.concat(o)]}case"TensorArraySplitV3":{const s=k("tensorArrayId",t,e,n),r=k("tensor",t,e,n),o=k("lengths",t,e,n),i=n.getTensorArray(s.id);return i.split(o,r),[i.idTensor]}case"TensorArraySizeV3":{const s=k("tensorArrayId",t,e,n),r=n.getTensorArray(s.id);return[ze(r.size(),"int32")]}case"TensorArrayCloseV3":{const s=k("tensorArrayId",t,e,n),r=n.getTensorArray(s.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const s=k("tensorListId",t,e,n),r=k("index",t,e,n),o=k("tensor",t,e,n),i=n.getTensorList(s.id);return i.setItem(r,o),[i.idTensor]}case"TensorListGetItem":{const s=k("tensorListId",t,e,n),r=k("index",t,e,n),o=k("elementShape",t,e,n),i=k("elementDType",t,e,n);return[n.getTensorList(s.id).getItem(r,o,i)]}case"TensorListScatterV2":case"TensorListScatter":{const s=k("indices",t,e,n),r=k("tensor",t,e,n),o=k("elementShape",t,e,n),i=k("numElements",t,e,n),a=vle(r,s,o,i);return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=k("elementShape",t,e,n),r=k("elementDType",t,e,n);let o;t.op==="TensorListReserve"?o="numElements":o="maxNumElements";const i=k(o,t,e,n),a=t.op==="TensorListReserve"?-1:i,l=ble(s,r,i,a);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const s=k("tensorListId",t,e,n),r=k("indices",t,e,n),o=k("elementShape",t,e,n),i=k("elementDType",t,e,n);return[n.getTensorList(s.id).gather(r,i,o)]}case"TensorListStack":{const s=k("tensorListId",t,e,n),r=k("elementShape",t,e,n),o=k("elementDType",t,e,n),i=k("numElements",t,e,n);return[n.getTensorList(s.id).stack(r,o,i)]}case"TensorListFromTensor":{const s=k("tensor",t,e,n),r=k("elementShape",t,e,n),o=k("elementDType",t,e,n),i=yle(s,r,o);return n.addTensorList(i),[i.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=k("tensorListId",t,e,n),r=n.getTensorList(s.id),o=k("dtype",t,e,n),i=k("elementShape",t,e,n);return[r.concat(o,i)]}case"TensorListPushBack":{const s=k("tensorListId",t,e,n),r=k("tensor",t,e,n),o=n.getTensorList(s.id);return o.pushBack(r),[o.idTensor]}case"TensorListPopBack":{const s=k("tensorListId",t,e,n),r=k("elementShape",t,e,n),o=k("elementDType",t,e,n);return[n.getTensorList(s.id).popBack(r,o)]}case"TensorListSplit":{const s=k("tensor",t,e,n),r=k("elementShape",t,e,n),o=k("lengths",t,e,n),i=xle(s,o,r);return n.addTensorList(i),[i.idTensor]}case"TensorListLength":{const s=k("tensorListId",t,e,n),r=n.getTensorList(s.id);return[ze(r.size(),"int32")]}case"TensorListResize":{const s=k("tensorListId",t,e,n),r=k("size",t,e,n),i=n.getTensorList(s.id).resize(r);return n.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DR(t,e,n){const[s,r]=k("fusedOps",t,e,n),o=s==="biasadd",i=!o,a=r==="prelu",l=s==="fusedbatchnorm",u=k("numArgs",t,e,n);if(o){if(a&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&o&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const c=k("strides",t,e,n),d=Xy(t,e,n),h=k("dataFormat",t,e,n).toUpperCase(),f=k("dilations",t,e,n);let[p,m]=k("args",t,e,n);i&&(m=p,p=void 0);const g=k("leakyreluAlpha",t,e,n);return{stride:c,pad:d,dataFormat:h,dilations:f,biasArg:p,preluArg:m,activationFunc:r,leakyreluAlpha:g}}const Sle=(t,e,n,s=ts)=>{switch(t.op){case"Conv1D":{const r=k("stride",t,e,n),o=k("pad",t,e,n),i=k("dataFormat",t,e,n).toUpperCase(),a=k("dilation",t,e,n);return[s.conv1d(k("x",t,e,n),k("filter",t,e,n),r,o,i,a)]}case"Conv2D":{const r=k("strides",t,e,n),o=Xy(t,e,n),i=k("dataFormat",t,e,n).toUpperCase(),a=k("dilations",t,e,n);return[s.conv2d(k("x",t,e,n),k("filter",t,e,n),[r[1],r[2]],o,i,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:r,pad:o,dataFormat:i,dilations:a,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=DR(t,e,n);return[s.fused.conv2d({x:k("x",t,e,n),filter:k("filter",t,e,n),strides:[r[1],r[2]],pad:o,dataFormat:i,dilations:[a[1],a[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:o,dataFormat:i,dilations:a,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=DR(t,e,n);return[s.fused.depthwiseConv2d({x:k("x",t,e,n),filter:k("filter",t,e,n),strides:[r[1],r[2]],pad:o,dataFormat:i,dilations:[a[1],a[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=k("outputShape",t,e,n),o=k("strides",t,e,n),i=Xy(t,e,n);return[s.conv2dTranspose(k("x",t,e,n),k("filter",t,e,n),r,[o[1],o[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=k("strides",t,e,n),o=Xy(t,e,n),i=k("dilations",t,e,n),a=k("dataFormat",t,e,n).toUpperCase();return[s.depthwiseConv2d(k("input",t,e,n),k("filter",t,e,n),[r[1],r[2]],o,a,[i[1],i[2]])]}case"Conv3D":{const r=k("strides",t,e,n),o=k("pad",t,e,n),i=k("dataFormat",t,e,n).toUpperCase(),a=k("dilations",t,e,n);return[s.conv3d(k("x",t,e,n),k("filter",t,e,n),[r[1],r[2],r[3]],o,i,[a[1],a[2],a[3]])]}case"AvgPool":{const r=k("strides",t,e,n),o=k("pad",t,e,n),i=k("kernelSize",t,e,n);return[s.avgPool(k("x",t,e,n),[i[1],i[2]],[r[1],r[2]],o)]}case"MaxPool":{const r=k("strides",t,e,n),o=k("pad",t,e,n),i=k("kernelSize",t,e,n);return[s.maxPool(k("x",t,e,n),[i[1],i[2]],[r[1],r[2]],o)]}case"MaxPoolWithArgmax":{const r=k("strides",t,e,n),o=k("pad",t,e,n),i=k("kernelSize",t,e,n),a=k("includeBatchInIndex",t,e,n),{result:l,indexes:u}=s.maxPoolWithArgmax(k("x",t,e,n),[i[1],i[2]],[r[1],r[2]],o,a);return[l,u]}case"AvgPool3D":{const r=k("strides",t,e,n),o=k("pad",t,e,n),i=k("kernelSize",t,e,n);return[s.avgPool3d(k("x",t,e,n),[i[1],i[2],i[3]],[r[1],r[2],r[3]],o)]}case"MaxPool3D":{const r=k("strides",t,e,n),o=k("pad",t,e,n),i=k("kernelSize",t,e,n);return[s.maxPool3d(k("x",t,e,n),[i[1],i[2],i[3]],[r[1],r[2],r[3]],o)]}case"Dilation2D":{const r=k("strides",t,e,n),o=k("pad",t,e,n),i=k("dilations",t,e,n),a=r[1],l=r[2],u=i[1],c=i[2];return[s.dilation2d(k("x",t,e,n),k("filter",t,e,n),[a,l],o,[u,c],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kle=(t,e,n,s=ts)=>{switch(t.op){case"Fill":{const r=k("shape",t,e,n),o=k("dtype",t,e,n),i=k("value",t,e,n);return[s.fill(r,i,o)]}case"LinSpace":{const r=k("start",t,e,n),o=k("stop",t,e,n),i=k("num",t,e,n);return[s.linspace(r,o,i)]}case"Multinomial":{const r=k("logits",t,e,n),o=k("numSamples",t,e,n),i=k("seed",t,e,n);return[s.multinomial(r,o,i)]}case"OneHot":{const r=k("indices",t,e,n),o=k("depth",t,e,n),i=k("onValue",t,e,n),a=k("offValue",t,e,n),l=k("dtype",t,e,n);return[s.oneHot(r,o,i,a,l)]}case"Ones":return[s.ones(k("shape",t,e,n),k("dtype",t,e,n))];case"OnesLike":return[s.onesLike(k("x",t,e,n))];case"RandomStandardNormal":return[s.randomStandardNormal(k("shape",t,e,n),k("dtype",t,e,n),k("seed",t,e,n))];case"RandomUniform":return[s.randomUniform(k("shape",t,e,n),k("minval",t,e,n),k("maxval",t,e,n),k("dtype",t,e,n))];case"RandomUniformInt":return[s.randomUniformInt(k("shape",t,e,n),k("minval",t,e,n),k("maxval",t,e,n),k("seed",t,e,n))];case"Range":{const r=k("start",t,e,n),o=k("stop",t,e,n),i=k("step",t,e,n);return[s.range(r,o,i,k("dtype",t,e,n))]}case"TruncatedNormal":{const r=k("shape",t,e,n),o=k("mean",t,e,n),i=k("stdDev",t,e,n),a=k("seed",t,e,n);return[s.truncatedNormal(r,o,i,k("dtype",t,e,n),a)]}case"Zeros":return[s.zeros(k("shape",t,e,n),k("dtype",t,e,n))];case"ZerosLike":return[s.zerosLike(k("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C1(t,e,n){const s=k("boxes",t,e,n),r=k("scores",t,e,n),o=k("maxOutputSize",t,e,n),i=k("iouThreshold",t,e,n),a=k("scoreThreshold",t,e,n),l=k("softNmsSigma",t,e,n);return{boxes:s,scores:r,maxOutputSize:o,iouThreshold:i,scoreThreshold:a,softNmsSigma:l}}const Cle=async(t,e,n,s,r=ts)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:l,scoreThreshold:u,softNmsSigma:c}=C1(t,e,n),d=await r.image.nonMaxSuppressionWithScoreAsync(o,i,a,l,u,c);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:l,scoreThreshold:u}=C1(t,e,n),c=k("padToMaxOutputSize",t,e,n),d=await r.image.nonMaxSuppressionPaddedAsync(o,i,a,l,u,c);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:l,scoreThreshold:u}=C1(t,e,n);return[await r.image.nonMaxSuppressionAsync(o,i,a,l,u)]}case"Where":{const o=r.cast(k("condition",t,e,n),"bool"),i=[await r.whereAsync(o)];return o.dispose(),i}case"ListDiff":return r.setdiff1dAsync(k("x",t,e,n),k("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nle=(t,e,n,s=ts)=>{switch(t.op){case"LowerBound":{const r=k("sortedSequence",t,e,n),o=k("values",t,e,n);return[s.lowerBound(r,o)]}case"TopKV2":{const r=k("x",t,e,n),o=k("k",t,e,n),i=k("sorted",t,e,n),a=s.topk(r,o,i);return[a.values,a.indices]}case"UpperBound":{const r=k("sortedSequence",t,e,n),o=k("values",t,e,n);return[s.upperBound(r,o)]}case"Unique":{const r=k("x",t,e,n),o=s.unique(r);return[o.values,o.indices]}case"UniqueV2":{const r=k("x",t,e,n),o=k("axis",t,e,n),i=s.unique(r,o);return[i.values,i.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tle=(t,e,n,s=ts)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const r=k("default",t,e,n);return[Gn(t.name,e,n)||r];case"Placeholder":return[Gn(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const c=k("x",t,e,n);return[fi(c)]}case"IdentityN":return k("x",t,e,n).map(c=>fi(c));case"Snapshot":const o=k("x",t,e,n);return[fi(o)];case"Shape":return[s.tensor1d(k("x",t,e,n).shape,"int32")];case"ShapeN":return k("x",t,e,n).map(c=>s.tensor1d(c.shape));case"Size":return[s.scalar(k("x",t,e,n).size,"int32")];case"Rank":return[s.scalar(k("x",t,e,n).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const i=k("x",t,e,n),a=k("data",t,e,n),l=k("message",t,e,n),u=k("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let c=0;c<a.length;c++)console.log(Array.prototype.slice.call(a[c].dataSync()).slice(0,u));return[i];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $le{get id(){return this.handle.id}constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=ze(0),this.tensorMap=new Map,Cn(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return ze(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const s=await e.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),Q(()=>{const r=Nr(n),o=s.length,i=r.length;T(o===i,()=>`The number of elements doesn't match, keys has ${o} elements, the values has ${i} elements.`);for(let a=0;a<o;a++){const l=s[a],u=r[a];Cn(u),this.tensorMap.set(l,u)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const s=await e.data();return Q(()=>{const r=[];for(let o=0;o<s.length;o++){const i=s[o],a=this.findWithDefault(i,n);r.push(a)}return Ls(r)})}findWithDefault(e,n){const s=this.tensorMap.get(e);return s??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ile=async(t,e,n,s)=>{switch(t.op){case"HashTable":case"HashTableV2":{const r=s.getHashTableHandleByName(t.name);if(r!=null)return[r];{const o=k("keyDType",t,e,n),i=k("valueDType",t,e,n),a=new $le(o,i);return s.addHashTable(t.name,a),[a.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const r=k("tableHandle",t,e,n,s),o=k("keys",t,e,n),i=k("values",t,e,n);return[await s.getHashTableById(r.id).import(o,i)]}case"LookupTableFind":case"LookupTableFindV2":{const r=k("tableHandle",t,e,n,s),o=k("keys",t,e,n),i=k("defaultValue",t,e,n);return[await s.getHashTableById(r.id).find(o,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const r=k("tableHandle",t,e,n,s);return[s.getHashTableById(r.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ele=(t,e,n,s=ts)=>{switch(t.op){case"ResizeBilinear":{const r=k("images",t,e,n),o=k("size",t,e,n),i=k("alignCorners",t,e,n),a=k("halfPixelCenters",t,e,n);return[s.image.resizeBilinear(r,[o[0],o[1]],i,a)]}case"ResizeNearestNeighbor":{const r=k("images",t,e,n),o=k("size",t,e,n),i=k("alignCorners",t,e,n),a=k("halfPixelCenters",t,e,n);return[s.image.resizeNearestNeighbor(r,[o[0],o[1]],i,a)]}case"CropAndResize":{const r=k("image",t,e,n),o=k("boxes",t,e,n),i=k("boxInd",t,e,n),a=k("cropSize",t,e,n),l=k("method",t,e,n),u=k("extrapolationValue",t,e,n);return[s.image.cropAndResize(r,o,i,a,l,u)]}case"ImageProjectiveTransformV3":{const r=k("images",t,e,n),o=k("transforms",t,e,n),i=k("outputShape",t,e,n),a=k("fillValue",t,e,n),l=k("interpolation",t,e,n),u=k("fillMode",t,e,n);return[s.image.transform(r,o,l.toLowerCase(),u.toLowerCase(),a,i)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rle=(t,e,n,s=ts)=>{switch(t.op){case"Equal":return[s.equal(k("a",t,e,n),k("b",t,e,n))];case"NotEqual":return[s.notEqual(k("a",t,e,n),k("b",t,e,n))];case"Greater":return[s.greater(k("a",t,e,n),k("b",t,e,n))];case"GreaterEqual":return[s.greaterEqual(k("a",t,e,n),k("b",t,e,n))];case"Less":return[s.less(k("a",t,e,n),k("b",t,e,n))];case"LessEqual":return[s.lessEqual(k("a",t,e,n),k("b",t,e,n))];case"LogicalAnd":return[s.logicalAnd(k("a",t,e,n),k("b",t,e,n))];case"LogicalNot":return[s.logicalNot(k("a",t,e,n))];case"LogicalOr":return[s.logicalOr(k("a",t,e,n),k("b",t,e,n))];case"Select":case"SelectV2":return[s.where(k("condition",t,e,n),k("a",t,e,n),k("b",t,e,n))];case"BitwiseAnd":return[s.bitwiseAnd(k("a",t,e,n),k("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _le=(t,e,n,s=ts)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(k("a",t,e,n),k("b",t,e,n),k("transposeA",t,e,n),k("transposeB",t,e,n))];case"Einsum":return[s.einsum(k("equation",t,e,n),...k("tensors",t,e,n))];case"Transpose":return[s.transpose(k("x",t,e,n),k("perm",t,e,n))];case"_FusedMatMul":const[r,o]=k("fusedOps",t,e,n),i=r==="biasadd",a=o==="prelu",l=k("numArgs",t,e,n),u=k("leakyreluAlpha",t,e,n);if(i){if(a&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,d]=k("args",t,e,n);return[s.fused.matMul({a:k("a",t,e,n),b:k("b",t,e,n),transposeA:k("transposeA",t,e,n),transposeB:k("transposeB",t,e,n),bias:c,activation:o,preluActivationWeights:d,leakyreluAlpha:u})];case"MatrixBandPart":return[s.linalg.bandPart(k("a",t,e,n),k("numLower",t,e,n),k("numUpper",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ale=(t,e,n,s=ts)=>{switch(t.op){case"EuclideanNorm":return[s.euclideanNorm(k("x",t,e,n),k("axis",t,e,n),k("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(k("x",t,e,n),k("mean",t,e,n),k("variance",t,e,n),k("offset",t,e,n),k("scale",t,e,n),k("epsilon",t,e,n))];case"FusedBatchNormV3":return[s.batchNorm(k("x",t,e,n),k("mean",t,e,n),k("variance",t,e,n),k("offset",t,e,n),k("scale",t,e,n),k("epsilon",t,e,n))];case"LRN":return[s.localResponseNormalization(k("x",t,e,n),k("radius",t,e,n),k("bias",t,e,n),k("alpha",t,e,n),k("beta",t,e,n))];case"Softmax":return[s.softmax(k("x",t,e,n))];case"LogSoftmax":return[s.logSoftmax(k("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dle=(t,e,n,s=ts)=>{switch(t.op){case"RaggedGather":{const{outputNestedSplits:r,outputDenseValues:o}=s.raggedGather(k("paramsNestedSplits",t,e,n),k("paramsDenseValues",t,e,n),k("indices",t,e,n),k("outputRaggedRank",t,e,n));return r.concat(o)}case"RaggedRange":{const{rtNestedSplits:r,rtDenseValues:o}=s.raggedRange(k("starts",t,e,n),k("limits",t,e,n),k("splits",t,e,n));return[r,o]}case"RaggedTensorToTensor":return[s.raggedTensorToTensor(k("shape",t,e,n),k("values",t,e,n),k("defaultValue",t,e,n),k("rowPartitionTensors",t,e,n),k("rowPartitionTypes",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ole=(t,e,n,s=ts)=>{switch(t.op){case"Max":{const a=k("axis",t,e,n),l=k("keepDims",t,e,n);return[s.max(k("x",t,e,n),a,l)]}case"Mean":{const a=k("axis",t,e,n),l=k("keepDims",t,e,n);return[s.mean(k("x",t,e,n),a,l)]}case"Min":{const a=k("axis",t,e,n),l=k("keepDims",t,e,n);return[s.min(k("x",t,e,n),a,l)]}case"Sum":{const a=k("axis",t,e,n),l=k("keepDims",t,e,n);return[s.sum(k("x",t,e,n),a,l)]}case"All":{const a=k("axis",t,e,n),l=k("keepDims",t,e,n);return[s.all(k("x",t,e,n),a,l)]}case"Any":{const a=k("axis",t,e,n),l=k("keepDims",t,e,n);return[s.any(k("x",t,e,n),a,l)]}case"ArgMax":{const a=k("axis",t,e,n);return[s.argMax(k("x",t,e,n),a)]}case"ArgMin":{const a=k("axis",t,e,n);return[s.argMin(k("x",t,e,n),a)]}case"Prod":{const a=k("axis",t,e,n),l=k("keepDims",t,e,n);return[s.prod(k("x",t,e,n),a,l)]}case"Cumprod":{const a=k("axis",t,e,n),l=k("exclusive",t,e,n),u=k("reverse",t,e,n);return[s.cumprod(k("x",t,e,n),a,l,u)]}case"Cumsum":{const a=k("axis",t,e,n),l=k("exclusive",t,e,n),u=k("reverse",t,e,n);return[s.cumsum(k("x",t,e,n),a,l,u)]}case"Bincount":const r=k("x",t,e,n),o=k("weights",t,e,n),i=k("size",t,e,n);return[s.bincount(r,o,i)];case"DenseBincount":{const a=k("x",t,e,n),l=k("weights",t,e,n),u=k("size",t,e,n),c=k("binaryOutput",t,e,n);return[s.denseBincount(a,l,u,c)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fle=(t,e,n,s=ts)=>{switch(t.op){case"ConcatV2":case"Concat":{const r=k("n",t,e,n),o=k("axis",t,e,n);let i=k("tensors",t,e,n);return i=i.slice(0,r),[s.concat(i,o)]}case"Gather":{const r=k("x",t,e,n),o=k("indices",t,e,n);return[s.gather(r,s.cast(o,"int32"),0)]}case"GatherV2":{const r=k("axis",t,e,n),o=k("batchDims",t,e,n),i=k("x",t,e,n),a=k("indices",t,e,n);return[s.gather(i,s.cast(a,"int32"),r,o)]}case"Reverse":{const r=k("dims",t,e,n),o=[];for(let a=0;a<r.length;a++)r[a]&&o.push(a);const i=k("x",t,e,n);return[s.reverse(i,o)]}case"ReverseV2":{const r=k("axis",t,e,n),o=k("x",t,e,n);return[s.reverse(o,r)]}case"Slice":{const r=k("begin",t,e,n),o=k("size",t,e,n);return[s.slice(k("x",t,e,n),r,o)]}case"StridedSlice":{const r=k("begin",t,e,n),o=k("end",t,e,n),i=k("strides",t,e,n),a=k("beginMask",t,e,n),l=k("endMask",t,e,n),u=k("ellipsisMask",t,e,n),c=k("newAxisMask",t,e,n),d=k("shrinkAxisMask",t,e,n),h=k("x",t,e,n);return[s.stridedSlice(h,r,o,i,a,l,u,c,d)]}case"Pack":return Q(()=>{const r=k("axis",t,e,n),o=k("tensors",t,e,n),i=o[0].shape,a=s.squeeze(o[0]).shape,l=o.map(u=>{const c=ut(u.shape,i);if(!c&&!ut(s.squeeze(u).shape,a))throw new Error("the input tensors shape does not match");return c?u:s.reshape(u,i)});return[s.stack(l,r)]});case"Unpack":{const r=k("axis",t,e,n),o=k("tensor",t,e,n);return s.unstack(o,r)}case"Tile":{const r=k("reps",t,e,n);return[s.tile(k("x",t,e,n),r)]}case"Split":case"SplitV":{const r=k("axis",t,e,n),o=k("numOrSizeSplits",t,e,n),i=k("x",t,e,n);return s.split(i,o,r)}case"ScatterNd":{const r=k("indices",t,e,n),o=k("values",t,e,n),i=k("shape",t,e,n);return[s.scatterND(r,o,i)]}case"GatherNd":{const r=k("x",t,e,n),o=k("indices",t,e,n);return[s.gatherND(r,o)]}case"SparseToDense":{const r=k("sparseIndices",t,e,n),o=k("outputShape",t,e,n),i=k("sparseValues",t,e,n),a=k("defaultValue",t,e,n);return[s.sparseToDense(r,i,o,i.dtype===a.dtype?a:s.cast(a,i.dtype))]}case"TensorScatterUpdate":{const r=k("indices",t,e,n),o=k("values",t,e,n),i=k("tensor",t,e,n);return[s.tensorScatterUpdate(i,r,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lle=(t,e,n,s=ts)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:o,emptyRowIndicator:i,reverseIndexMap:a}=s.sparse.sparseFillEmptyRows(k("indices",t,e,n),k("values",t,e,n),k("denseShape",t,e,n),k("defaultValue",t,e,n));return[r,o,i,a]}case"SparseReshape":{const{outputIndices:r,outputShape:o}=s.sparse.sparseReshape(k("inputIndices",t,e,n),k("inputShape",t,e,n),k("newShape",t,e,n));return[r,o]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(k("data",t,e,n),k("indices",t,e,n),k("segmentIds",t,e,n))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(k("data",t,e,n),k("indices",t,e,n),k("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ple=(t,e,n,s=ts)=>{switch(t.op){case"FFT":return[s.fft(k("x",t,e,n))];case"IFFT":return[s.ifft(k("x",t,e,n))];case"RFFT":return[s.rfft(k("x",t,e,n))];case"IRFFT":return[s.irfft(k("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mle=(t,e,n,s=ts)=>{switch(t.op){case"StaticRegexReplace":return[s.string.staticRegexReplace(k("input",t,e,n),k("pattern",t,e,n),k("rewrite",t,e,n),k("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:r,nGramsSplits:o}=s.string.stringNGrams(k("data",t,e,n),k("dataSplits",t,e,n),k("separator",t,e,n),k("nGramWidths",t,e,n),k("leftPad",t,e,n),k("rightPad",t,e,n),k("padWidth",t,e,n),k("preserveShortSequences",t,e,n));return[r,o]}case"StringSplit":{const{indices:r,values:o,shape:i}=s.string.stringSplit(k("input",t,e,n),k("delimiter",t,e,n),k("skipEmpty",t,e,n));return[r,o,i]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(k("input",t,e,n),k("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zle=(t,e,n,s=ts)=>{switch(t.op){case"Cast":return[s.cast(k("x",t,e,n),k("dtype",t,e,n))];case"ExpandDims":{const r=k("axis",t,e,n);return[s.expandDims(k("x",t,e,n),r)]}case"Squeeze":{const r=k("axis",t,e,n);return[s.squeeze(k("x",t,e,n),r)]}case"Reshape":return[s.reshape(k("x",t,e,n),k("shape",t,e,n))];case"EnsureShape":return[s.ensureShape(k("x",t,e,n),k("shape",t,e,n))];case"MirrorPad":return[s.mirrorPad(k("x",t,e,n),k("padding",t,e,n),k("mode",t,e,n))];case"PadV2":case"Pad":return[s.pad(k("x",t,e,n),k("padding",t,e,n),k("constantValue",t,e,n))];case"SpaceToBatchND":{const r=k("blockShape",t,e,n),o=k("paddings",t,e,n);return[s.spaceToBatchND(k("x",t,e,n),r,o)]}case"BatchToSpaceND":{const r=k("blockShape",t,e,n),o=k("crops",t,e,n);return[s.batchToSpaceND(k("x",t,e,n),r,o)]}case"DepthToSpace":{const r=k("blockSize",t,e,n),o=k("dataFormat",t,e,n).toUpperCase();return[s.depthToSpace(k("x",t,e,n),r,o)]}case"BroadcastTo":return[s.broadcastTo(k("x",t,e,n),k("shape",t,e,n))];case"BroadcastArgs":return[s.broadcastArgs(k("s0",t,e,n),k("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OR(t,e,n,s,r=Q){const o=((i,a,l)=>{switch(i.category){case"arithmetic":return r(()=>ple(i,a,l));case"basic_math":return r(()=>mle(i,a,l));case"control":return wle(i,a,l);case"convolution":return r(()=>Sle(i,a,l));case"creation":return r(()=>kle(i,a,l));case"dynamic":return Cle(i,a,l);case"evaluation":return r(()=>Nle(i,a,l));case"image":return r(()=>Ele(i,a,l));case"graph":return r(()=>Tle(i,a,l));case"logical":return r(()=>Rle(i,a,l));case"matrices":return r(()=>_le(i,a,l));case"normalization":return r(()=>Ale(i,a,l));case"ragged":return r(()=>Dle(i,a,l));case"reduction":return r(()=>Ole(i,a,l));case"slice_join":return r(()=>Fle(i,a,l));case"sparse":return r(()=>Lle(i,a,l));case"spectral":return r(()=>Ple(i,a,l));case"string":return r(()=>Mle(i,a,l));case"transformation":return r(()=>zle(i,a,l));case"hash_table":return Ile(i,a,l,s);case"custom":const u=nz(i.op);if(u&&u.customExecutor)return u.customExecutor(new fle(i,a,l));throw TypeError(`Custom op ${i.op} is not registered.`);default:throw TypeError(`Unknown op '${i.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return Pa(o)?o.then(i=>[].concat(i)):[].concat(o)}class FR{constructor(e={},n={},s={},r={},o){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=s,this.functionMap=r,this.parseNodeNameCache=o,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const s=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(s))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LR(t,e,n,s){const r=new Set,o=[];let i=null,a=null;const l=new Set,u=new Set(Object.keys(t).map(h=>Gs(h)[0]));s=s||[];const c=new Set(s.map(h=>Gs(h.name)[0])),d=[...e];for(;d.length>0;){const h=d.pop();if((wl(h)||qle(h)||Kle(h))&&i==null&&(i=h,a=i.children.map(f=>f.name).filter(f=>r.has(f))),r.add(h.name),n[h.name]==null&&!u.has(h.name)&&!c.has(h.name)){if(h.inputs.length===0){o.push(h.name);continue}h.inputs.forEach(f=>{l.has(f.name)||(l.add(f.name),d.push(f))})}}return{inputs:t,outputs:e,usedNodes:r,missingInputs:o,dynamicNode:i,syncInputs:a}}function Ble(t,e){const{usedNodes:n,inputs:s}=e,r=Object.keys(s).map(g=>Gs(g)[0]).map(g=>t.nodes[g]),o=t.initNodes||[],i=g=>n.has(typeof g=="string"?g:g.name);function a(g){return[...new Map(g.map(y=>[y.name,y])).values()]}const l=a([...r,...t.weights,...o]).filter(i),u=a([...l,...Object.values(t.nodes)]).filter(i),c=new Map(u.map(g=>[g.name,g])),d={};for(const g of u){d[g.name]=d[g.name]||0;for(const y of g.children)i(y)||(d[y.name]=Number.POSITIVE_INFINITY),d[y.name]=(d[y.name]||0)+1}const h=Object.entries(d).filter(([,g])=>g===0).map(([g])=>g),f=[...h];for(;h.length>0;){const g=h.pop(),y=c.get(g);for(const b of y.children.filter(i))--d[b.name]===0&&(f.push(b.name),h.push(b.name))}const p=f.map(g=>c.get(g)),m=Vle(p,l);return Ule(m,l),m}function Vle(t,e){const n=new Map(t.map(i=>[i.name,i])),s=e.map(i=>i.name),r=new Set(s);for(;s.length>0;){const i=s.pop(),a=n.get(i);for(const l of a.children)!n.has(l.name)||r.has(l.name)||(r.add(l.name),s.push(l.name))}return t.filter(i=>r.has(i.name))}class my extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function Ule(t,e){const n=new Map(t.map((a,l)=>[a.name,l])),s=new Set(e.map(a=>a.name)),r=a=>s.has(typeof a=="string"?a:a.name),o=new Set(t.map(a=>a.name)),i=a=>o.has(typeof a=="string"?a:a.name);for(const a of t){for(const l of a.children.filter(i)){if(!n.has(l.name))throw new my(`Child ${l.name} of node ${a.name} is unreachable.`);if(n.get(a.name)>n.get(l.name))throw new my(`Node ${a.name} is scheduled to run after its child ${l.name}.`)}if(!r(a))for(const l of a.inputs){if(!n.has(l.name))throw new my(`Input ${l.name} of node ${a.name} is unreachable.`);if(n.get(l.name)>n.get(a.name))throw new my(`Node ${a.name} is scheduled to run before its input ${l.name}.`)}}}function Wle(t){const e=new Map(t.map((a,l)=>[a.name,l])),n=Number.MAX_SAFE_INTEGER,s=t.map((a,l)=>wl(a)?n:l),r=a=>{const l=s[e.get(a.name)];return l??-1},o=t.map((a,l)=>a.children.map(r).reduce((u,c)=>Math.max(u,c),s[l])),i=new Map;for(let a=0;a<t.length;++a){const l=o[a];if(l===n)continue;const u=t[a],c=t[l];i.has(c.name)||i.set(c.name,[]),i.get(c.name).push(u)}return i}const jle=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),Gle=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),Hle=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function wl(t){return jle.has(t.op)}function qle(t){return Gle.has(t.op)}function Kle(t){return Hle.has(t.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V0{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(s=>e[s].map(r=>r.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(s=>{this._functionExecutorMap[s]=new V0(e.functions[s],this)})}getCompilationKey(e,n){const s=e.map(o=>o.name).sort(),r=n.map(o=>o.name).sort();return s.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(e,n){const s=LR(e,n,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:o,syncInputs:i}=s;if(o!=null)throw new Error(`This execution contains the node '${o.name}', which has the dynamic op '${o.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(r.length>0){const u=n.map(d=>d.name),c=Object.keys(e);throw new Error(`Cannot compute the outputs [${u}] from the provided inputs [${c}]. Missing the following inputs: [${r}]`)}const a=Ble(this.graph,s),l=Wle(a);return{orderedNodes:a,nodeLiveUntilMap:l}}cloneAndKeepTensor(e){if(e==null)return null;const n=e.clone();return Cn(n),n}cloneTensorList(e){return e?e.map(s=>this.cloneAndKeepTensor(s)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([n,s])=>[n,this.cloneTensorList(s)]))}execute(e,n){this.disposeIntermediateTensors(),e=this.mapInputs(e);const s=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const r=s.map(h=>this.graph.nodes[Gs(h)[0]]),o=n.map(h=>Gs(h)[0]),i=new Set(o);let a=o.map(h=>this.graph.nodes[h]);a.length===0&&(a=this._outputs);const l=this.getCompilationKey(r,a);let u=this.compiledMap.get(l);u==null&&(u=this.compile(e,a),this.compiledMap.set(l,u));try{this.keepIntermediateTensors=ee().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const c={},d={};return Q(()=>{const h=new FR(this.weightMap,c,d,this.functionExecutorMap,this.parseNodeNameCache),f=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(y=>{const[b,v]=Gs(y,h),x=[];x[v]=e[y],f[b]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[b]=this.cloneTensorList(x))});const p=this.getFrozenTensorIds(f),{orderedNodes:m,nodeLiveUntilMap:g}=u;for(const y of m){if(f[y.name])continue;const b=OR(y,f,h,this._resourceManager);if(Pa(b))throw new Error(`The execution of the op '${y.op}' returned a promise. Please use model.executeAsync() instead.`);f[y.name]=b,this.keepIntermediateTensors&&(this.clonedTensorsMap[y.name]=this.cloneTensorList(b)),this.checkTensorForDisposalWithNodeLiveUntilInfo(y,f,h,p,i,g.get(y.name))}return this.parent==null&&h.dispose(p),n.map(y=>Gn(y,f,h))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(s=>e[s]).map(s=>s.map(r=>r.id)));return new Set(n)}checkTensorForDisposal(e,n,s,r,o,i,a){if(!(wl(n)||i.has(e))){for(const l of s[e])l!=null&&(a[l.id]=(a[l.id]||0)+n.children.length);for(const l of n.inputs){if(wl(l))continue;const u=ER(l.name,s,r);if(u!=null)for(const c of u){if(!c||c.kept||o.has(c.id))continue;const d=a[c.id];d===1?(c.dispose(),delete a[c.id]):d!=null&&a[c.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,n,s,r,o,i){function a(l){return wl(l)||o.has(l.name)}if(!(wl(e)||i==null))for(const l of i){if(a(l))continue;const u=ER(l.name,n,s);for(const c of u)!c||c.kept||r.has(c.id)||c.dispose()}}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const n of e)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,n,s=!1,r={},o={}){this.disposeIntermediateTensors(),s||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=ee().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const i=new FR(this.weightMap,r,o,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const a=await this.executeWithControlFlow(e,i,n,s),l=n.map(h=>Gn(h,a,i)),u=l.map(h=>h.id),c=Object.keys(e).map(h=>e[h].id),d=new Set([...u,...c,...this.weightIds]);return Object.values(a).forEach(h=>{h.forEach(f=>{f&&!f.isDisposed&&!d.has(f.id)&&f.dispose()})}),this.parent==null&&i.dispose(d),l}async executeFunctionAsync(e,n,s){const r=e.reduce((o,i,a)=>(o[this.inputs[a].name]=i,o),{});return this._executeAsync(r,this.outputNodes,!0,n,s)}async executeWithControlFlow(e,n,s,r){const o=Object.keys(e),i=o.map(x=>this.graph.nodes[Gs(x)[0]]),a=s.map(x=>Gs(x)[0]),l=new Set(a);let u=a.map(x=>this.graph.nodes[x]);u.length===0&&(u=this._outputs);const{usedNodes:c,missingInputs:d,dynamicNode:h,syncInputs:f}=LR(e,u,this.weightMap,this._initNodes),p=[...i,...this.graph.weights,...this._initNodes||[]].map(x=>({node:x,contexts:n.currentContext})),m=Object.assign({},this.weightMap);Object.keys(e).forEach(x=>{const[w,S]=Gs(x),C=[];C[S]=e[x],m[w]=C});const g={},y=this.getFrozenTensorIds(m),b={};for(;p.length>0;){const x=this.processStack(i,p,n,m,b,y,l,g,c);await Promise.all(x)}h==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const v=u.filter(x=>!wl(x)&&!Gn(x.name,m,n)).map(x=>x.name);if(v.length>0){let x="";throw h!=null&&(x=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${f}]`),new Error(`Cannot compute the outputs [${v}] from the provided inputs [${o}]. Consider providing the following inputs: [${d}]. ${x}`)}return m}processStack(e,n,s,r,o,i,a,l,u){const c=[];for(;n.length>0;){const d=n.pop();s.currentContext=d.contexts;let h="";if(d.node.op==="Enter"&&k("isConstant",d.node,r,s)&&([h]=hi(d.node.name,s)),r[d.node.name]==null){const f=OR(d.node,r,s,this._resourceManager);h||([h]=hi(d.node.name,s));const p=s.currentContext;Pa(f)?c.push(f.then(m=>(r[h]=m,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(m)),s.currentContext=p,this.checkTensorForDisposal(h,d.node,r,s,i,a,l),this.processChildNodes(d.node,n,s,r,o,u),m))):(r[h]=f,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(f)),this.checkTensorForDisposal(h,d.node,r,s,i,a,l),this.processChildNodes(d.node,n,s,r,o,u))}else this.processChildNodes(d.node,n,s,r,o,u)}return c}processChildNodes(e,n,s,r,o,i){e.children.forEach(a=>{const[l]=hi(a.name,s);o[l]||!i.has(a.name)||(a.op==="Merge"?a.inputNames.some(u=>!!Gn(u,r,s))&&(o[l]=!0,n.push({contexts:s.currentContext,node:a})):a.inputNames.every(u=>!!Gn(u,r,s))&&(o[l]=!0,n.push({contexts:s.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const s=e[n],[r]=Gs(n),o=this.graph.nodes[r];if(o.attrParams.shape&&o.attrParams.shape.value){const i=o.attrParams.shape.value,a=i.length===s.shape.length&&s.shape.every((l,u)=>i[u]===-1||i[u]===l);T(a,()=>`The shape of dict['${o.name}'] provided in model.execute(dict) must be [${i}], but was [${s.shape}]`)}o.attrParams.dtype&&o.attrParams.dtype.value&&T(s.dtype===o.attrParams.dtype.value,()=>`The dtype of dict['${o.name}'] provided in model.execute(dict) must be ${o.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(e){var n,s;const r={};for(const o in e){const i=(s=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||s===void 0?void 0:s[o];i!=null?r[i.name]=e[o]:r[o]=e[o]}return r}checkInputs(e){const n=Object.keys(e).filter(s=>{const[r]=Gs(s);return this.graph.nodes[r]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>{var s,r;const o=(r=(s=this._signature)===null||s===void 0?void 0:s.outputs)===null||r===void 0?void 0:r[n];return o!=null?o.name:n},{})}checkOutputs(e){e.forEach(n=>{const[s]=Gs(n);if(!this.graph.nodes[s])throw new Error(`The output '${n}' is not found in the graph`)})}}class Xle{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yle="?tfjs-format=file",Qle="model.json";class Zle{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,n={},s=v$){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=s,n==null&&(this.loadOptions={}),this.resourceManager=new Xle}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Pa(e)?e.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(e)}loadSync(e){const n=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,n)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await YP(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,n)}loadWithWeightMap(e,n){this.artifacts=e;const s=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const o=this.artifacts.userDefinedMetadata;o.signature!=null&&(r=o.signature),o.structuredOutputKeys!=null&&(this.structuredOutputKeys=o.structuredOutputKeys)}if(this.signature=r,this.version=`${s.versions.producer}.${s.versions.minConsumer}`,this.executor=new V0(RR.Instance.transformGraph(s,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const o=RR.Instance.transformGraph(e.modelInitializer);this.initializer=new V0(o),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const s=this.io.getSaveHandlers(e);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${e}'`);e=s[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const n=e instanceof vt?[e]:e,s={};return n.forEach((r,o)=>s[this.structuredOutputKeys[o]]=r),s}return e}predict(e,n){const s=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(s)}async predictAsync(e,n){const s=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(s)}normalizeInputs(e){var n;if(!(e instanceof vt)&&!Array.isArray(e)){const o=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(o!=null)for(const i in o){const a=o[i];a.resourceId!=null&&(e[i]=this.resourceIdToCapturedInput[a.resourceId])}return e}e=Array.isArray(e)?e:[e];const s=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+s!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-s} non-resource placeholders, while there are ${e.length} input tensors provided.`);let r=0;return this.inputNodes.reduce((o,i)=>{var a,l,u;const c=(u=(l=(a=this.signature)===null||a===void 0?void 0:a.inputs)===null||l===void 0?void 0:l[i])===null||u===void 0?void 0:u.resourceId;return c!=null?o[i]=this.resourceIdToCapturedInput[c]:o[i]=e[r++],o},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,s=Object.keys(n);for(let r=0;r<s.length;r++){const o=s[r],i=n[o];this.resourceIdToCapturedInput[i.resourceId]=e[r]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const s=this.executor.execute(e,n);return s.length>1?s:s[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const s=await this.executor.executeAsync(e,n);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,s)=>(n[s]=[e[s]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Qe(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function PR(t,e={},n=v$){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=Jle(t));const s=new Zle(t,e,n);return await s.load(),s}function Jle(t){return t.endsWith("/")||(t=t+"/"),`${t}${Qle}${Yle}`}/**
    * @license
    * Copyright 2023 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */function U0(t,e,n,s){return new(n||(n=Promise))(function(r,o){function i(u){try{l(s.next(u))}catch(c){o(c)}}function a(u){try{l(s.throw(u))}catch(c){o(c)}}function l(u){var c;u.done?r(u.value):(c=u.value,c instanceof n?c:new n(function(d){d(c)})).then(i,a)}l((s=s.apply(t,e||[])).next())})}function W0(t,e){var n,s,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,s&&(r=2&c[0]?s.return:c[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,c[1])).done)return r;switch(s=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,s=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(c[0]===6||c[0]===2)){i=0;continue}if(c[0]===3&&(!r||c[1]>r[0]&&c[1]<r[3])){i.label=c[1];break}if(c[0]===6&&i.label<r[1]){i.label=r[1],r=c;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(c);break}r[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(t,i)}catch(d){c=[6,d],s=0}finally{n=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([l,u])}}}var eue={0:"tench, Tinca tinca",1:"goldfish, Carassius auratus",2:"great white shark, white shark, man-eater, man-eating shark, Carcharodon carcharias",3:"tiger shark, Galeocerdo cuvieri",4:"hammerhead, hammerhead shark",5:"electric ray, crampfish, numbfish, torpedo",6:"stingray",7:"cock",8:"hen",9:"ostrich, Struthio camelus",10:"brambling, Fringilla montifringilla",11:"goldfinch, Carduelis carduelis",12:"house finch, linnet, Carpodacus mexicanus",13:"junco, snowbird",14:"indigo bunting, indigo finch, indigo bird, Passerina cyanea",15:"robin, American robin, Turdus migratorius",16:"bulbul",17:"jay",18:"magpie",19:"chickadee",20:"water ouzel, dipper",21:"kite",22:"bald eagle, American eagle, Haliaeetus leucocephalus",23:"vulture",24:"great grey owl, great gray owl, Strix nebulosa",25:"European fire salamander, Salamandra salamandra",26:"common newt, Triturus vulgaris",27:"eft",28:"spotted salamander, Ambystoma maculatum",29:"axolotl, mud puppy, Ambystoma mexicanum",30:"bullfrog, Rana catesbeiana",31:"tree frog, tree-frog",32:"tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui",33:"loggerhead, loggerhead turtle, Caretta caretta",34:"leatherback turtle, leatherback, leathery turtle, Dermochelys coriacea",35:"mud turtle",36:"terrapin",37:"box turtle, box tortoise",38:"banded gecko",39:"common iguana, iguana, Iguana iguana",40:"American chameleon, anole, Anolis carolinensis",41:"whiptail, whiptail lizard",42:"agama",43:"frilled lizard, Chlamydosaurus kingi",44:"alligator lizard",45:"Gila monster, Heloderma suspectum",46:"green lizard, Lacerta viridis",47:"African chameleon, Chamaeleo chamaeleon",48:"Komodo dragon, Komodo lizard, dragon lizard, giant lizard, Varanus komodoensis",49:"African crocodile, Nile crocodile, Crocodylus niloticus",50:"American alligator, Alligator mississipiensis",51:"triceratops",52:"thunder snake, worm snake, Carphophis amoenus",53:"ringneck snake, ring-necked snake, ring snake",54:"hognose snake, puff adder, sand viper",55:"green snake, grass snake",56:"king snake, kingsnake",57:"garter snake, grass snake",58:"water snake",59:"vine snake",60:"night snake, Hypsiglena torquata",61:"boa constrictor, Constrictor constrictor",62:"rock python, rock snake, Python sebae",63:"Indian cobra, Naja naja",64:"green mamba",65:"sea snake",66:"horned viper, cerastes, sand viper, horned asp, Cerastes cornutus",67:"diamondback, diamondback rattlesnake, Crotalus adamanteus",68:"sidewinder, horned rattlesnake, Crotalus cerastes",69:"trilobite",70:"harvestman, daddy longlegs, Phalangium opilio",71:"scorpion",72:"black and gold garden spider, Argiope aurantia",73:"barn spider, Araneus cavaticus",74:"garden spider, Aranea diademata",75:"black widow, Latrodectus mactans",76:"tarantula",77:"wolf spider, hunting spider",78:"tick",79:"centipede",80:"black grouse",81:"ptarmigan",82:"ruffed grouse, partridge, Bonasa umbellus",83:"prairie chicken, prairie grouse, prairie fowl",84:"peacock",85:"quail",86:"partridge",87:"African grey, African gray, Psittacus erithacus",88:"macaw",89:"sulphur-crested cockatoo, Kakatoe galerita, Cacatua galerita",90:"lorikeet",91:"coucal",92:"bee eater",93:"hornbill",94:"hummingbird",95:"jacamar",96:"toucan",97:"drake",98:"red-breasted merganser, Mergus serrator",99:"goose",100:"black swan, Cygnus atratus",101:"tusker",102:"echidna, spiny anteater, anteater",103:"platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus",104:"wallaby, brush kangaroo",105:"koala, koala bear, kangaroo bear, native bear, Phascolarctos cinereus",106:"wombat",107:"jelly fish",108:"sea anemone, anemone",109:"brain coral",110:"flatworm, platyhelminth",111:"nematode, nematode worm, roundworm",112:"conch",113:"snail",114:"slug",115:"sea slug, nudibranch",116:"chiton, coat-of-mail shell, sea cradle, polyplacophore",117:"chambered nautilus, pearly nautilus, nautilus",118:"Dungeness crab, Cancer magister",119:"rock crab, Cancer irroratus",120:"fiddler crab",121:"king crab, Alaska crab, Alaskan king crab, Alaska king crab, Paralithodes camtschatica",122:"American lobster, Northern lobster, Maine lobster, Homarus americanus",123:"spiny lobster, langouste, rock lobster, crawfish, crayfish, sea crawfish",124:"crayfish, crawfish, crawdad, crawdaddy",125:"hermit crab",126:"isopod",127:"white stork, Ciconia ciconia",128:"black stork, Ciconia nigra",129:"spoonbill",130:"flamingo",131:"little blue heron, Egretta caerulea",132:"American egret, great white heron, Egretta albus",133:"bittern",134:"crane",135:"limpkin, Aramus pictus",136:"European gallinule, Porphyrio porphyrio",137:"American coot, marsh hen, mud hen, water hen, Fulica americana",138:"bustard",139:"ruddy turnstone, Arenaria interpres",140:"red-backed sandpiper, dunlin, Erolia alpina",141:"redshank, Tringa totanus",142:"dowitcher",143:"oystercatcher, oyster catcher",144:"pelican",145:"king penguin, Aptenodytes patagonica",146:"albatross, mollymawk",147:"grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus",148:"killer whale, killer, orca, grampus, sea wolf, Orcinus orca",149:"dugong, Dugong dugon",150:"sea lion",151:"Chihuahua",152:"Japanese spaniel",153:"Maltese dog, Maltese terrier, Maltese",154:"Pekinese, Pekingese, Peke",155:"Shih-Tzu",156:"Blenheim spaniel",157:"papillon",158:"toy terrier",159:"Rhodesian ridgeback",160:"Afghan hound, Afghan",161:"basset, basset hound",162:"beagle",163:"bloodhound, sleuthhound",164:"bluetick",165:"black-and-tan coonhound",166:"Walker hound, Walker foxhound",167:"English foxhound",168:"redbone",169:"borzoi, Russian wolfhound",170:"Irish wolfhound",171:"Italian greyhound",172:"whippet",173:"Ibizan hound, Ibizan Podenco",174:"Norwegian elkhound, elkhound",175:"otterhound, otter hound",176:"Saluki, gazelle hound",177:"Scottish deerhound, deerhound",178:"Weimaraner",179:"Staffordshire bullterrier, Staffordshire bull terrier",180:"American Staffordshire terrier, Staffordshire terrier, American pit bull terrier, pit bull terrier",181:"Bedlington terrier",182:"Border terrier",183:"Kerry blue terrier",184:"Irish terrier",185:"Norfolk terrier",186:"Norwich terrier",187:"Yorkshire terrier",188:"wire-haired fox terrier",189:"Lakeland terrier",190:"Sealyham terrier, Sealyham",191:"Airedale, Airedale terrier",192:"cairn, cairn terrier",193:"Australian terrier",194:"Dandie Dinmont, Dandie Dinmont terrier",195:"Boston bull, Boston terrier",196:"miniature schnauzer",197:"giant schnauzer",198:"standard schnauzer",199:"Scotch terrier, Scottish terrier, Scottie",200:"Tibetan terrier, chrysanthemum dog",201:"silky terrier, Sydney silky",202:"soft-coated wheaten terrier",203:"West Highland white terrier",204:"Lhasa, Lhasa apso",205:"flat-coated retriever",206:"curly-coated retriever",207:"golden retriever",208:"Labrador retriever",209:"Chesapeake Bay retriever",210:"German short-haired pointer",211:"vizsla, Hungarian pointer",212:"English setter",213:"Irish setter, red setter",214:"Gordon setter",215:"Brittany spaniel",216:"clumber, clumber spaniel",217:"English springer, English springer spaniel",218:"Welsh springer spaniel",219:"cocker spaniel, English cocker spaniel, cocker",220:"Sussex spaniel",221:"Irish water spaniel",222:"kuvasz",223:"schipperke",224:"groenendael",225:"malinois",226:"briard",227:"kelpie",228:"komondor",229:"Old English sheepdog, bobtail",230:"Shetland sheepdog, Shetland sheep dog, Shetland",231:"collie",232:"Border collie",233:"Bouvier des Flandres, Bouviers des Flandres",234:"Rottweiler",235:"German shepherd, German shepherd dog, German police dog, alsatian",236:"Doberman, Doberman pinscher",237:"miniature pinscher",238:"Greater Swiss Mountain dog",239:"Bernese mountain dog",240:"Appenzeller",241:"EntleBucher",242:"boxer",243:"bull mastiff",244:"Tibetan mastiff",245:"French bulldog",246:"Great Dane",247:"Saint Bernard, St Bernard",248:"Eskimo dog, husky",249:"malamute, malemute, Alaskan malamute",250:"Siberian husky",251:"dalmatian, coach dog, carriage dog",252:"affenpinscher, monkey pinscher, monkey dog",253:"basenji",254:"pug, pug-dog",255:"Leonberg",256:"Newfoundland, Newfoundland dog",257:"Great Pyrenees",258:"Samoyed, Samoyede",259:"Pomeranian",260:"chow, chow chow",261:"keeshond",262:"Brabancon griffon",263:"Pembroke, Pembroke Welsh corgi",264:"Cardigan, Cardigan Welsh corgi",265:"toy poodle",266:"miniature poodle",267:"standard poodle",268:"Mexican hairless",269:"timber wolf, grey wolf, gray wolf, Canis lupus",270:"white wolf, Arctic wolf, Canis lupus tundrarum",271:"red wolf, maned wolf, Canis rufus, Canis niger",272:"coyote, prairie wolf, brush wolf, Canis latrans",273:"dingo, warrigal, warragal, Canis dingo",274:"dhole, Cuon alpinus",275:"African hunting dog, hyena dog, Cape hunting dog, Lycaon pictus",276:"hyena, hyaena",277:"red fox, Vulpes vulpes",278:"kit fox, Vulpes macrotis",279:"Arctic fox, white fox, Alopex lagopus",280:"grey fox, gray fox, Urocyon cinereoargenteus",281:"tabby, tabby cat",282:"tiger cat",283:"Persian cat",284:"Siamese cat, Siamese",285:"Egyptian cat",286:"cougar, puma, catamount, mountain lion, painter, panther, Felis concolor",287:"lynx, catamount",288:"leopard, Panthera pardus",289:"snow leopard, ounce, Panthera uncia",290:"jaguar, panther, Panthera onca, Felis onca",291:"lion, king of beasts, Panthera leo",292:"tiger, Panthera tigris",293:"cheetah, chetah, Acinonyx jubatus",294:"brown bear, bruin, Ursus arctos",295:"American black bear, black bear, Ursus americanus, Euarctos americanus",296:"ice bear, polar bear, Ursus Maritimus, Thalarctos maritimus",297:"sloth bear, Melursus ursinus, Ursus ursinus",298:"mongoose",299:"meerkat, mierkat",300:"tiger beetle",301:"ladybug, ladybeetle, lady beetle, ladybird, ladybird beetle",302:"ground beetle, carabid beetle",303:"long-horned beetle, longicorn, longicorn beetle",304:"leaf beetle, chrysomelid",305:"dung beetle",306:"rhinoceros beetle",307:"weevil",308:"fly",309:"bee",310:"ant, emmet, pismire",311:"grasshopper, hopper",312:"cricket",313:"walking stick, walkingstick, stick insect",314:"cockroach, roach",315:"mantis, mantid",316:"cicada, cicala",317:"leafhopper",318:"lacewing, lacewing fly",319:"dragonfly, darning needle, devil's darning needle, sewing needle, snake feeder, snake doctor, mosquito hawk, skeeter hawk",320:"damselfly",321:"admiral",322:"ringlet, ringlet butterfly",323:"monarch, monarch butterfly, milkweed butterfly, Danaus plexippus",324:"cabbage butterfly",325:"sulphur butterfly, sulfur butterfly",326:"lycaenid, lycaenid butterfly",327:"starfish, sea star",328:"sea urchin",329:"sea cucumber, holothurian",330:"wood rabbit, cottontail, cottontail rabbit",331:"hare",332:"Angora, Angora rabbit",333:"hamster",334:"porcupine, hedgehog",335:"fox squirrel, eastern fox squirrel, Sciurus niger",336:"marmot",337:"beaver",338:"guinea pig, Cavia cobaya",339:"sorrel",340:"zebra",341:"hog, pig, grunter, squealer, Sus scrofa",342:"wild boar, boar, Sus scrofa",343:"warthog",344:"hippopotamus, hippo, river horse, Hippopotamus amphibius",345:"ox",346:"water buffalo, water ox, Asiatic buffalo, Bubalus bubalis",347:"bison",348:"ram, tup",349:"bighorn, bighorn sheep, cimarron, Rocky Mountain bighorn, Rocky Mountain sheep, Ovis canadensis",350:"ibex, Capra ibex",351:"hartebeest",352:"impala, Aepyceros melampus",353:"gazelle",354:"Arabian camel, dromedary, Camelus dromedarius",355:"llama",356:"weasel",357:"mink",358:"polecat, fitch, foulmart, foumart, Mustela putorius",359:"black-footed ferret, ferret, Mustela nigripes",360:"otter",361:"skunk, polecat, wood pussy",362:"badger",363:"armadillo",364:"three-toed sloth, ai, Bradypus tridactylus",365:"orangutan, orang, orangutang, Pongo pygmaeus",366:"gorilla, Gorilla gorilla",367:"chimpanzee, chimp, Pan troglodytes",368:"gibbon, Hylobates lar",369:"siamang, Hylobates syndactylus, Symphalangus syndactylus",370:"guenon, guenon monkey",371:"patas, hussar monkey, Erythrocebus patas",372:"baboon",373:"macaque",374:"langur",375:"colobus, colobus monkey",376:"proboscis monkey, Nasalis larvatus",377:"marmoset",378:"capuchin, ringtail, Cebus capucinus",379:"howler monkey, howler",380:"titi, titi monkey",381:"spider monkey, Ateles geoffroyi",382:"squirrel monkey, Saimiri sciureus",383:"Madagascar cat, ring-tailed lemur, Lemur catta",384:"indri, indris, Indri indri, Indri brevicaudatus",385:"Indian elephant, Elephas maximus",386:"African elephant, Loxodonta africana",387:"lesser panda, red panda, panda, bear cat, cat bear, Ailurus fulgens",388:"giant panda, panda, panda bear, coon bear, Ailuropoda melanoleuca",389:"barracouta, snoek",390:"eel",391:"coho, cohoe, coho salmon, blue jack, silver salmon, Oncorhynchus kisutch",392:"rock beauty, Holocanthus tricolor",393:"anemone fish",394:"sturgeon",395:"gar, garfish, garpike, billfish, Lepisosteus osseus",396:"lionfish",397:"puffer, pufferfish, blowfish, globefish",398:"abacus",399:"abaya",400:"academic gown, academic robe, judge's robe",401:"accordion, piano accordion, squeeze box",402:"acoustic guitar",403:"aircraft carrier, carrier, flattop, attack aircraft carrier",404:"airliner",405:"airship, dirigible",406:"altar",407:"ambulance",408:"amphibian, amphibious vehicle",409:"analog clock",410:"apiary, bee house",411:"apron",412:"ashcan, trash can, garbage can, wastebin, ash bin, ash-bin, ashbin, dustbin, trash barrel, trash bin",413:"assault rifle, assault gun",414:"backpack, back pack, knapsack, packsack, rucksack, haversack",415:"bakery, bakeshop, bakehouse",416:"balance beam, beam",417:"balloon",418:"ballpoint, ballpoint pen, ballpen, Biro",419:"Band Aid",420:"banjo",421:"bannister, banister, balustrade, balusters, handrail",422:"barbell",423:"barber chair",424:"barbershop",425:"barn",426:"barometer",427:"barrel, cask",428:"barrow, garden cart, lawn cart, wheelbarrow",429:"baseball",430:"basketball",431:"bassinet",432:"bassoon",433:"bathing cap, swimming cap",434:"bath towel",435:"bathtub, bathing tub, bath, tub",436:"beach wagon, station wagon, wagon, estate car, beach waggon, station waggon, waggon",437:"beacon, lighthouse, beacon light, pharos",438:"beaker",439:"bearskin, busby, shako",440:"beer bottle",441:"beer glass",442:"bell cote, bell cot",443:"bib",444:"bicycle-built-for-two, tandem bicycle, tandem",445:"bikini, two-piece",446:"binder, ring-binder",447:"binoculars, field glasses, opera glasses",448:"birdhouse",449:"boathouse",450:"bobsled, bobsleigh, bob",451:"bolo tie, bolo, bola tie, bola",452:"bonnet, poke bonnet",453:"bookcase",454:"bookshop, bookstore, bookstall",455:"bottlecap",456:"bow",457:"bow tie, bow-tie, bowtie",458:"brass, memorial tablet, plaque",459:"brassiere, bra, bandeau",460:"breakwater, groin, groyne, mole, bulwark, seawall, jetty",461:"breastplate, aegis, egis",462:"broom",463:"bucket, pail",464:"buckle",465:"bulletproof vest",466:"bullet train, bullet",467:"butcher shop, meat market",468:"cab, hack, taxi, taxicab",469:"caldron, cauldron",470:"candle, taper, wax light",471:"cannon",472:"canoe",473:"can opener, tin opener",474:"cardigan",475:"car mirror",476:"carousel, carrousel, merry-go-round, roundabout, whirligig",477:"carpenter's kit, tool kit",478:"carton",479:"car wheel",480:"cash machine, cash dispenser, automated teller machine, automatic teller machine, automated teller, automatic teller, ATM",481:"cassette",482:"cassette player",483:"castle",484:"catamaran",485:"CD player",486:"cello, violoncello",487:"cellular telephone, cellular phone, cellphone, cell, mobile phone",488:"chain",489:"chainlink fence",490:"chain mail, ring mail, mail, chain armor, chain armour, ring armor, ring armour",491:"chain saw, chainsaw",492:"chest",493:"chiffonier, commode",494:"chime, bell, gong",495:"china cabinet, china closet",496:"Christmas stocking",497:"church, church building",498:"cinema, movie theater, movie theatre, movie house, picture palace",499:"cleaver, meat cleaver, chopper",500:"cliff dwelling",501:"cloak",502:"clog, geta, patten, sabot",503:"cocktail shaker",504:"coffee mug",505:"coffeepot",506:"coil, spiral, volute, whorl, helix",507:"combination lock",508:"computer keyboard, keypad",509:"confectionery, confectionary, candy store",510:"container ship, containership, container vessel",511:"convertible",512:"corkscrew, bottle screw",513:"cornet, horn, trumpet, trump",514:"cowboy boot",515:"cowboy hat, ten-gallon hat",516:"cradle",517:"crane",518:"crash helmet",519:"crate",520:"crib, cot",521:"Crock Pot",522:"croquet ball",523:"crutch",524:"cuirass",525:"dam, dike, dyke",526:"desk",527:"desktop computer",528:"dial telephone, dial phone",529:"diaper, nappy, napkin",530:"digital clock",531:"digital watch",532:"dining table, board",533:"dishrag, dishcloth",534:"dishwasher, dish washer, dishwashing machine",535:"disk brake, disc brake",536:"dock, dockage, docking facility",537:"dogsled, dog sled, dog sleigh",538:"dome",539:"doormat, welcome mat",540:"drilling platform, offshore rig",541:"drum, membranophone, tympan",542:"drumstick",543:"dumbbell",544:"Dutch oven",545:"electric fan, blower",546:"electric guitar",547:"electric locomotive",548:"entertainment center",549:"envelope",550:"espresso maker",551:"face powder",552:"feather boa, boa",553:"file, file cabinet, filing cabinet",554:"fireboat",555:"fire engine, fire truck",556:"fire screen, fireguard",557:"flagpole, flagstaff",558:"flute, transverse flute",559:"folding chair",560:"football helmet",561:"forklift",562:"fountain",563:"fountain pen",564:"four-poster",565:"freight car",566:"French horn, horn",567:"frying pan, frypan, skillet",568:"fur coat",569:"garbage truck, dustcart",570:"gasmask, respirator, gas helmet",571:"gas pump, gasoline pump, petrol pump, island dispenser",572:"goblet",573:"go-kart",574:"golf ball",575:"golfcart, golf cart",576:"gondola",577:"gong, tam-tam",578:"gown",579:"grand piano, grand",580:"greenhouse, nursery, glasshouse",581:"grille, radiator grille",582:"grocery store, grocery, food market, market",583:"guillotine",584:"hair slide",585:"hair spray",586:"half track",587:"hammer",588:"hamper",589:"hand blower, blow dryer, blow drier, hair dryer, hair drier",590:"hand-held computer, hand-held microcomputer",591:"handkerchief, hankie, hanky, hankey",592:"hard disc, hard disk, fixed disk",593:"harmonica, mouth organ, harp, mouth harp",594:"harp",595:"harvester, reaper",596:"hatchet",597:"holster",598:"home theater, home theatre",599:"honeycomb",600:"hook, claw",601:"hoopskirt, crinoline",602:"horizontal bar, high bar",603:"horse cart, horse-cart",604:"hourglass",605:"iPod",606:"iron, smoothing iron",607:"jack-o'-lantern",608:"jean, blue jean, denim",609:"jeep, landrover",610:"jersey, T-shirt, tee shirt",611:"jigsaw puzzle",612:"jinrikisha, ricksha, rickshaw",613:"joystick",614:"kimono",615:"knee pad",616:"knot",617:"lab coat, laboratory coat",618:"ladle",619:"lampshade, lamp shade",620:"laptop, laptop computer",621:"lawn mower, mower",622:"lens cap, lens cover",623:"letter opener, paper knife, paperknife",624:"library",625:"lifeboat",626:"lighter, light, igniter, ignitor",627:"limousine, limo",628:"liner, ocean liner",629:"lipstick, lip rouge",630:"Loafer",631:"lotion",632:"loudspeaker, speaker, speaker unit, loudspeaker system, speaker system",633:"loupe, jeweler's loupe",634:"lumbermill, sawmill",635:"magnetic compass",636:"mailbag, postbag",637:"mailbox, letter box",638:"maillot",639:"maillot, tank suit",640:"manhole cover",641:"maraca",642:"marimba, xylophone",643:"mask",644:"matchstick",645:"maypole",646:"maze, labyrinth",647:"measuring cup",648:"medicine chest, medicine cabinet",649:"megalith, megalithic structure",650:"microphone, mike",651:"microwave, microwave oven",652:"military uniform",653:"milk can",654:"minibus",655:"miniskirt, mini",656:"minivan",657:"missile",658:"mitten",659:"mixing bowl",660:"mobile home, manufactured home",661:"Model T",662:"modem",663:"monastery",664:"monitor",665:"moped",666:"mortar",667:"mortarboard",668:"mosque",669:"mosquito net",670:"motor scooter, scooter",671:"mountain bike, all-terrain bike, off-roader",672:"mountain tent",673:"mouse, computer mouse",674:"mousetrap",675:"moving van",676:"muzzle",677:"nail",678:"neck brace",679:"necklace",680:"nipple",681:"notebook, notebook computer",682:"obelisk",683:"oboe, hautboy, hautbois",684:"ocarina, sweet potato",685:"odometer, hodometer, mileometer, milometer",686:"oil filter",687:"organ, pipe organ",688:"oscilloscope, scope, cathode-ray oscilloscope, CRO",689:"overskirt",690:"oxcart",691:"oxygen mask",692:"packet",693:"paddle, boat paddle",694:"paddlewheel, paddle wheel",695:"padlock",696:"paintbrush",697:"pajama, pyjama, pj's, jammies",698:"palace",699:"panpipe, pandean pipe, syrinx",700:"paper towel",701:"parachute, chute",702:"parallel bars, bars",703:"park bench",704:"parking meter",705:"passenger car, coach, carriage",706:"patio, terrace",707:"pay-phone, pay-station",708:"pedestal, plinth, footstall",709:"pencil box, pencil case",710:"pencil sharpener",711:"perfume, essence",712:"Petri dish",713:"photocopier",714:"pick, plectrum, plectron",715:"pickelhaube",716:"picket fence, paling",717:"pickup, pickup truck",718:"pier",719:"piggy bank, penny bank",720:"pill bottle",721:"pillow",722:"ping-pong ball",723:"pinwheel",724:"pirate, pirate ship",725:"pitcher, ewer",726:"plane, carpenter's plane, woodworking plane",727:"planetarium",728:"plastic bag",729:"plate rack",730:"plow, plough",731:"plunger, plumber's helper",732:"Polaroid camera, Polaroid Land camera",733:"pole",734:"police van, police wagon, paddy wagon, patrol wagon, wagon, black Maria",735:"poncho",736:"pool table, billiard table, snooker table",737:"pop bottle, soda bottle",738:"pot, flowerpot",739:"potter's wheel",740:"power drill",741:"prayer rug, prayer mat",742:"printer",743:"prison, prison house",744:"projectile, missile",745:"projector",746:"puck, hockey puck",747:"punching bag, punch bag, punching ball, punchball",748:"purse",749:"quill, quill pen",750:"quilt, comforter, comfort, puff",751:"racer, race car, racing car",752:"racket, racquet",753:"radiator",754:"radio, wireless",755:"radio telescope, radio reflector",756:"rain barrel",757:"recreational vehicle, RV, R.V.",758:"reel",759:"reflex camera",760:"refrigerator, icebox",761:"remote control, remote",762:"restaurant, eating house, eating place, eatery",763:"revolver, six-gun, six-shooter",764:"rifle",765:"rocking chair, rocker",766:"rotisserie",767:"rubber eraser, rubber, pencil eraser",768:"rugby ball",769:"rule, ruler",770:"running shoe",771:"safe",772:"safety pin",773:"saltshaker, salt shaker",774:"sandal",775:"sarong",776:"sax, saxophone",777:"scabbard",778:"scale, weighing machine",779:"school bus",780:"schooner",781:"scoreboard",782:"screen, CRT screen",783:"screw",784:"screwdriver",785:"seat belt, seatbelt",786:"sewing machine",787:"shield, buckler",788:"shoe shop, shoe-shop, shoe store",789:"shoji",790:"shopping basket",791:"shopping cart",792:"shovel",793:"shower cap",794:"shower curtain",795:"ski",796:"ski mask",797:"sleeping bag",798:"slide rule, slipstick",799:"sliding door",800:"slot, one-armed bandit",801:"snorkel",802:"snowmobile",803:"snowplow, snowplough",804:"soap dispenser",805:"soccer ball",806:"sock",807:"solar dish, solar collector, solar furnace",808:"sombrero",809:"soup bowl",810:"space bar",811:"space heater",812:"space shuttle",813:"spatula",814:"speedboat",815:"spider web, spider's web",816:"spindle",817:"sports car, sport car",818:"spotlight, spot",819:"stage",820:"steam locomotive",821:"steel arch bridge",822:"steel drum",823:"stethoscope",824:"stole",825:"stone wall",826:"stopwatch, stop watch",827:"stove",828:"strainer",829:"streetcar, tram, tramcar, trolley, trolley car",830:"stretcher",831:"studio couch, day bed",832:"stupa, tope",833:"submarine, pigboat, sub, U-boat",834:"suit, suit of clothes",835:"sundial",836:"sunglass",837:"sunglasses, dark glasses, shades",838:"sunscreen, sunblock, sun blocker",839:"suspension bridge",840:"swab, swob, mop",841:"sweatshirt",842:"swimming trunks, bathing trunks",843:"swing",844:"switch, electric switch, electrical switch",845:"syringe",846:"table lamp",847:"tank, army tank, armored combat vehicle, armoured combat vehicle",848:"tape player",849:"teapot",850:"teddy, teddy bear",851:"television, television system",852:"tennis ball",853:"thatch, thatched roof",854:"theater curtain, theatre curtain",855:"thimble",856:"thresher, thrasher, threshing machine",857:"throne",858:"tile roof",859:"toaster",860:"tobacco shop, tobacconist shop, tobacconist",861:"toilet seat",862:"torch",863:"totem pole",864:"tow truck, tow car, wrecker",865:"toyshop",866:"tractor",867:"trailer truck, tractor trailer, trucking rig, rig, articulated lorry, semi",868:"tray",869:"trench coat",870:"tricycle, trike, velocipede",871:"trimaran",872:"tripod",873:"triumphal arch",874:"trolleybus, trolley coach, trackless trolley",875:"trombone",876:"tub, vat",877:"turnstile",878:"typewriter keyboard",879:"umbrella",880:"unicycle, monocycle",881:"upright, upright piano",882:"vacuum, vacuum cleaner",883:"vase",884:"vault",885:"velvet",886:"vending machine",887:"vestment",888:"viaduct",889:"violin, fiddle",890:"volleyball",891:"waffle iron",892:"wall clock",893:"wallet, billfold, notecase, pocketbook",894:"wardrobe, closet, press",895:"warplane, military plane",896:"washbasin, handbasin, washbowl, lavabo, wash-hand basin",897:"washer, automatic washer, washing machine",898:"water bottle",899:"water jug",900:"water tower",901:"whiskey jug",902:"whistle",903:"wig",904:"window screen",905:"window shade",906:"Windsor tie",907:"wine bottle",908:"wing",909:"wok",910:"wooden spoon",911:"wool, woolen, woollen",912:"worm fence, snake fence, snake-rail fence, Virginia fence",913:"wreck",914:"yawl",915:"yurt",916:"web site, website, internet site, site",917:"comic book",918:"crossword puzzle, crossword",919:"street sign",920:"traffic light, traffic signal, stoplight",921:"book jacket, dust cover, dust jacket, dust wrapper",922:"menu",923:"plate",924:"guacamole",925:"consomme",926:"hot pot, hotpot",927:"trifle",928:"ice cream, icecream",929:"ice lolly, lolly, lollipop, popsicle",930:"French loaf",931:"bagel, beigel",932:"pretzel",933:"cheeseburger",934:"hotdog, hot dog, red hot",935:"mashed potato",936:"head cabbage",937:"broccoli",938:"cauliflower",939:"zucchini, courgette",940:"spaghetti squash",941:"acorn squash",942:"butternut squash",943:"cucumber, cuke",944:"artichoke, globe artichoke",945:"bell pepper",946:"cardoon",947:"mushroom",948:"Granny Smith",949:"strawberry",950:"orange",951:"lemon",952:"fig",953:"pineapple, ananas",954:"banana",955:"jackfruit, jak, jack",956:"custard apple",957:"pomegranate",958:"hay",959:"carbonara",960:"chocolate sauce, chocolate syrup",961:"dough",962:"meat loaf, meatloaf",963:"pizza, pizza pie",964:"potpie",965:"burrito",966:"red wine",967:"espresso",968:"cup",969:"eggnog",970:"alp",971:"bubble",972:"cliff, drop, drop-off",973:"coral reef",974:"geyser",975:"lakeside, lakeshore",976:"promontory, headland, head, foreland",977:"sandbar, sand bar",978:"seashore, coast, seacoast, sea-coast",979:"valley, vale",980:"volcano",981:"ballplayer, baseball player",982:"groom, bridegroom",983:"scuba diver",984:"rapeseed",985:"daisy",986:"yellow lady's slipper, yellow lady-slipper, Cypripedium calceolus, Cypripedium parviflorum",987:"corn",988:"acorn",989:"hip, rose hip, rosehip",990:"buckeye, horse chestnut, conker",991:"coral fungus",992:"agaric",993:"gyromitra",994:"stinkhorn, carrion fungus",995:"earthstar",996:"hen-of-the-woods, hen of the woods, Polyporus frondosus, Grifola frondosa",997:"bolete",998:"ear, spike, capitulum",999:"toilet tissue, toilet paper, bathroom tissue"},ea=224,tue={"1.00":"module_apply_default/MobilenetV1/Logits/global_pool","2.00":"module_apply_default/MobilenetV2/Logits/AvgPool"},Zu={"1.00":{.25:{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_025_224/classification/1",inputRange:[0,1]},"0.50":{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_050_224/classification/1",inputRange:[0,1]},.75:{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_075_224/classification/1",inputRange:[0,1]},"1.00":{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_100_224/classification/1",inputRange:[0,1]}},"2.00":{"0.50":{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_050_224/classification/2",inputRange:[0,1]},.75:{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_075_224/classification/2",inputRange:[0,1]},"1.00":{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_100_224/classification/2",inputRange:[0,1]}}};function nue(t){return t===void 0&&(t={version:1,alpha:1}),U0(this,void 0,void 0,function(){var e,n,s,r,o,i,a;return W0(this,function(l){switch(l.label){case 0:if(Nae==null)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");if(e=t.version.toFixed(2),n=t.alpha?t.alpha.toFixed(2):"",s=-1,r=1,t.modelUrl==null){if(!(e in Zu))throw new Error("Invalid version of MobileNet. Valid versions are: "+Object.keys(Zu));if(!(n in Zu[e]))throw new Error("MobileNet constructed with invalid alpha "+t.alpha+". Valid multipliers for this version are: "+Object.keys(Zu[e])+".");i=Zu[e][n].inputRange,s=i[0],r=i[1]}return t.inputRange!=null&&(a=t.inputRange,s=a[0],r=a[1]),[4,(o=new sue(e,n,t.modelUrl,s,r)).load()];case 1:return l.sent(),[2,o]}})})}var sue=function(){function t(e,n,s,r,o){r===void 0&&(r=-1),o===void 0&&(o=1),this.version=e,this.alpha=n,this.modelUrl=s,this.inputMin=r,this.inputMax=o,this.normalizationConstant=(o-r)/255}return t.prototype.load=function(){return U0(this,void 0,void 0,function(){var e,n,s,r,o=this;return W0(this,function(i){switch(i.label){case 0:return this.modelUrl?(e=this,[4,PR(this.modelUrl)]):[3,2];case 1:return e.model=i.sent(),[3,4];case 2:return n=Zu[this.version][this.alpha].url,s=this,[4,PR(n,{fromTFHub:!0})];case 3:s.model=i.sent(),i.label=4;case 4:return[4,(r=Q(function(){return o.model.predict(dn([1,ea,ea,3]))})).data()];case 5:return i.sent(),r.dispose(),[2]}})})},t.prototype.infer=function(e,n){var s=this;return n===void 0&&(n=!1),Q(function(){e instanceof vt||(e=x$(e));var r=ce(L(be(e,"float32"),s.normalizationConstant),s.inputMin),o=r;(e.shape[0]!==ea||e.shape[1]!==ea)&&(o=br.resizeBilinear(r,[ea,ea],!0));var i,a=B(o,[-1,ea,ea,3]);if(n){var l=tue[s.version],u=s.model.execute(a,l);i=Ui(u,[1,2])}else{var c=s.model.predict(a);i=ct(c,[0,1],[-1,1e3])}return i})},t.prototype.classify=function(e,n){return n===void 0&&(n=3),U0(this,void 0,void 0,function(){var s,r;return W0(this,function(o){switch(o.label){case 0:return[4,rue(s=this.infer(e),n)];case 1:return r=o.sent(),s.dispose(),[2,r]}})})},t}();function rue(t,e){return U0(this,void 0,void 0,function(){var n,s,r,o,i,a,l;return W0(this,function(u){switch(u.label){case 0:return[4,(n=Nh(t)).data()];case 1:for(s=u.sent(),n.dispose(),r=[],l=0;l<s.length;l++)r.push({value:s[l],index:l});for(r.sort(function(c,d){return d.value-c.value}),o=new Float32Array(e),i=new Int32Array(e),l=0;l<e;l++)o[l]=r[l].value,i[l]=r[l].index;for(a=[],l=0;l<i.length;l++)a.push({className:eue[i[l]],probability:o[l]});return[2,a]}})})}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oz={kernelName:Jp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(t,_u(be(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oue={kernelName:Cd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Tt(be(n,"float32")),r=Mn(Te(ze(1),s));return Dt(Fe(t,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iue={kernelName:Nd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Mn(Te(Tt(be(n,"float32")),1));return Fe(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aue={kernelName:Tu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=qe(n.shape,s.shape);return{a:()=>{let a=t;const l=Sn(n.shape,r);return l.length>0&&(a=_e(a,l)),B(a,n.shape)},b:()=>{let a=t;const l=Sn(s.shape,r);return l.length>0&&(a=_e(a,l)),B(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lue={kernelName:em,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((s,r)=>{n[r]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uue={kernelName:tm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ft(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cue={kernelName:nm,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ft(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const due={kernelName:Td,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Fe(t,Mn(Te(ze(1),Tt(be(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hue={kernelName:$d,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Mn(ce(ze(1),Tt(be(n,"float32"))));return Fe(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fue={kernelName:Rd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=qe(n.shape,s.shape);return{a:()=>{const a=ce(Tt(n),Tt(s));let l=L(t,Fe(s,a));const u=Sn(n.shape,r);return u.length>0&&(l=_e(l,u)),B(l,n.shape)},b:()=>{const a=ce(Tt(n),Tt(s));let l=Dt(L(t,Fe(n,a)));const u=Sn(s.shape,r);return u.length>0&&(l=_e(l,u)),B(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pue={kernelName:Id,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Fe(t,ce(Tt(be(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mue={kernelName:Ed,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Fe(t,Te(ze(1),Tt(be(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gue(t,e,n,s,r,o){const i=$(t,"dy","avgPool3dGrad"),a=$(e,"input","avgPool3dGrad");let l=i,u=a,c=!1;a.rank===4&&(c=!0,l=B(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),u=B(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),T(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),T(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),Ss("avgPool3dGrad",r,o);const d={dy:l,input:u},h={filterSize:n,strides:s,pad:r,dimRoundingMode:o},f=D.runKernel(cv,d,h);return c?B(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const yue=O({avgPool3dGrad_:gue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bue={kernelName:rm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:o,pad:i,dimRoundingMode:a}=n;return{x:()=>yue(t,s,r,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vue(t,e,n,s,r){const o=$(t,"dy","avgPoolGrad"),i=$(e,"input","avgPoolGrad");T(i.rank===o.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${o.rank})`);let a=i,l=o,u=!1;i.rank===3&&(u=!0,a=B(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=B(o,[1,o.shape[0],o.shape[1],o.shape[2]])),T(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),T(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const c={dy:l,input:a},d={filterSize:n,strides:s,pad:r},h=D.runKernel(uv,c,d);return u?B(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const xue=O({avgPoolGrad_:vue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wue={kernelName:sm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:o,pad:i}=n;return{x:()=>xue(t,s,r,o,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sue={kernelName:om,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[s,r]=e,{transposeA:o,transposeB:i}=n;return!o&&!i?{a:()=>nt(t,r,!1,!0),b:()=>nt(s,t,!0,!1)}:!o&&i?{a:()=>nt(t,r,!1,!1),b:()=>nt(t,s,!0,!1)}:o&&!i?{a:()=>nt(r,t,!1,!0),b:()=>nt(s,t,!1,!1)}:{a:()=>nt(r,t,!0,!0),b:()=>nt(t,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kue={kernelName:im,gradFunc:(t,e,n)=>{const{blockShape:s,crops:r}=n;return{x:()=>mg(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cue={kernelName:$P,gradFunc:(t,e,n)=>{const s=n,r=s.inputShape,o=s.shape,i=Array.from(o);for(let l=r.length-1;l>=0;l--)if(r[l]===o[l])i[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${o}].`);const a=[];for(let l=0;l<i.length;l++)i[l]>1&&a.push(l);return{x:()=>_e(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nue={kernelName:_d,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tue={kernelName:Ad,gradFunc:t=>({x:()=>ft(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ue={kernelName:Dd,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{clipValueMin:r,clipValueMax:o}=n;return{x:()=>Xn(So(Bi(s,r),nl(s,o)),t,ft(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iue={kernelName:lm,inputsToSave:["x"],gradFunc:oz.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eue={kernelName:um,saveAllInputs:!0,gradFunc:(t,e,n)=>{const s=e.map(l=>l.shape),{axis:r}=n,o=st(r,e[0].shape)[0],i=s.map(l=>l[o]);return _s(t,i,o).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rue={kernelName:cm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{dilations:o,strides:i,pad:a,dataFormat:l}=n;return T(za(o),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`),{x:()=>xT(s.shape,t,r,i,a,l),filter:()=>l$(s,t,r.shape,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ue={kernelName:dm,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{strides:o,pad:i,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>Ri(t,r,o,i,a,1,l),filter:()=>l$(t,s,r.shape,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aue(t,e,n,s,r){let o=t;t.rank===4&&(o=B(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let i=e;i.rank===4&&(i=B(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),T(o.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${o.shape}.`),T(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),T(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),T(o.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${o.shape[4]}) must match input depth in filter (${n[3]}.`),T(i.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:o,dy:i},l={strides:s,pad:r,filterShape:n};return D.runKernel(mv,a,l)}const Due=O({conv3DBackpropFilter_:Aue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oue={kernelName:hm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:o}=n;T(za(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[i,a]=e;return{x:()=>h3(i.shape,t,a,r,o),filter:()=>Due(i,t,a.shape,r,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fue={kernelName:Od,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(Dt(Dx(be(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lue={kernelName:Fd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(Ox(be(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pue={kernelName:fm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r,exclusive:o,reverse:i}=n;return{x:()=>{const a=tn([r],s.rank);let l=xx(t,r,o,!i);return a!=null&&(l=dt(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mue={kernelName:pm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:o,dimRoundingMode:i}=n,a=s??[1,1];T(za(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,u]=e;return T(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),T(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),T(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),T(Jn(r,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${a}'.`),Ss("depthwiseConv2d",o,i),{x:()=>sM(l.shape,t,u,r,o,a,i),filter:()=>nM(l,t,u.shape,r,o,a,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zue={kernelName:mm,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,o={x:s,filter:r,dy:t},i={x:s,filter:r,dy:t};return{x:()=>D.runKernel(D0,o,n),filter:()=>D.runKernel(O0,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bue={kernelName:Pd,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,s={dy:t,y:n};return{x:()=>D.runKernel(Tv,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vue={kernelName:Md,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=L(Fs(Dt(Tt(n))),2/Math.sqrt(Math.PI));return{x:()=>L(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uue={kernelName:zd,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wue={kernelName:ym,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>B(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jue={kernelName:Bd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(t,Fs(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gue={kernelName:Vd,gradFunc:t=>({x:()=>ft(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hue={kernelName:Ud,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=qe(n.shape,s.shape);return{a:()=>{const a=Fe(t,be(s,"float32")),l=Sn(n.shape,r);return l.length>0?B(_e(a,l),n.shape):a},b:()=>{let a=L(t,be(n,"float32"));const l=Sn(s.shape,r);l.length>0&&(a=B(_e(a,l),s.shape));const u=Tt(s);return Dt(Fe(a,be(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const que={kernelName:bm,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:s}=n,[r,o,i,a]=e,l=a??ze(1),u=Sn(o.shape,r.shape),c=[];if(o.rank===1){for(let x=0;x<r.shape.length-1;++x)c.push(r.shape[x]);c.push(1)}const d=Te(r,o),h=L(t,l),f=Rx(ce(i,ze(s))),p=L(L(L(f,f),f),ze(-.5));return{x:()=>o.rank===1?B(L(L(t,yr(B(f,[1,1,1,o.shape[0]]),c)),l),r.shape):B(L(L(t,f),l),r.shape),mean:()=>{let x=L(L(f,ze(-1)),h);return o.rank===1&&(x=_e(x,u)),B(x,o.shape)},variance:()=>{let x=L(L(p,d),h);return o.rank===1&&(x=_e(x,u)),B(x,o.shape)},scale:()=>{const x=L(d,f);let w=L(t,x);return o.rank===1&&(w=_e(w,u)),B(w,o.shape)},offset:()=>{let x=t;return o.rank===1&&(x=_e(x,u)),B(x,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kue={kernelName:vm,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[s,r]=e,{axis:o,batchDims:i}=n,a=st(o,s.shape)[0],l=(u,c,d)=>()=>{const h=u.shape,f=c.size,p=h.slice(0,a),m=p.length,g=h.slice(o,h.length).slice(1),y=g.length,b=MR(0,m),v=MR(m+1,m+1+y),x=zR([p,[f],g]),w=B(d,x),S=B(c,[f]),C=zR([[m],b,v]),N=dt(w,C);let I=Bx(N,S,u.shape[a]);const E=tl(C);return I=dt(I,E),I};if(i===1){const u=s.shape[0],c=s.split(u,0);return{x:()=>Ls(c.map((f,p)=>l(f,r.slice(p,1),t.slice(p,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,t),indices:()=>r}}};function MR(t,e){const n=[];for(let s=t;s<e;++s)n.push(s);return n}function zR(t){const e=[];for(let n=0;n<t.length;++n)for(let s=0;s<t[n].length;++s)e.push(t[n][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xue={kernelName:Wd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>ft(n),b:()=>ft(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yue={kernelName:jd,gradFunc:t=>({x:()=>be(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Que={kernelName:Gd,gradFunc:t=>({x:()=>ft(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zue={kernelName:Hd,gradFunc:t=>({x:()=>ft(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jue={kernelName:qd,gradFunc:t=>({x:()=>ft(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ece={kernelName:wm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{alpha:r}=n,o=Bs(s,0);return{x:()=>Xn(o,t,L(t,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tce={kernelName:Xd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Fe(t,ce(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nce={kernelName:Kd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Fe(t,be(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sce={kernelName:IP,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;return{logits:()=>{const i=Fs(s);return Te(t,L(_e(t,r,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rce(t,e,n,s=5,r=1,o=1,i=.5){const a={x:t,y:e,dy:n},l={depthRadius:s,bias:r,alpha:o,beta:i};return D.runKernel(Ov,a,l)}const oce=O({localResponseNormalizationBackprop_:rce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ice={kernelName:$m,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{depthRadius:o,bias:i,alpha:a,beta:l}=n;return{x:()=>oce(s,r,t,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iz(t,e,n,s){return e.rank<n.rank&&(e=B(e,fn(e.shape,s))),t.rank<n.rank&&(t=B(t,fn(t.shape,s))),{x:()=>L(t,be(Zr(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BR={kernelName:Im,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{reductionIndices:r}=s,o=e[0],i=e[1],a=st(r,o.shape),l=iz(t,i,o,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ace={kernelName:Yd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>L(t,be(Bi(n,s),"float32")),b:()=>L(t,be(od(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lce(t,e,n,s,r,o,i){const a=$(t,"dy","maxPool3dGrad"),l=$(e,"input","maxPool3dGrad"),u=$(n,"output","maxPool3dGrad");let c=a,d=l,h=u,f=!1;l.rank===4&&(f=!0,c=B(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),d=B(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=B(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),T(c.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),T(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),T(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),Ss("maxPool3dGrad",o,i);const p={dy:c,input:d,output:h},m={filterSize:s,strides:r,pad:o,dimRoundingMode:i},g=D.runKernel(Lv,p,m);return f?B(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const uce=O({maxPool3dGrad_:lce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cce={kernelName:Rm,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=n;return{x:()=>uce(t,s,r,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dce(t,e,n,s,r,o,i){const a=$(t,"dy","maxPoolGrad"),l=$(e,"input","maxPoolGrad"),u=$(n,"output","maxPoolGrad");T(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),T(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),T(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Ss("maxPoolGrad",o,i);const c={dy:a,input:l,output:u},d={filterSize:s,strides:r,pad:o,dimRoundingMode:i};return D.runKernel(Fv,c,d)}const hce=O({maxPoolGrad_:dce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fce={kernelName:Em,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:o,strides:i,pad:a}=n;return{x:()=>hce(t,s,r,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pce={kernelName:_m,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n,o=st(r,s.shape),a=Bn(s.shape,o)[1],l=oe(a);return{x:()=>{const c=s.shape.slice();o.forEach(f=>{c[f]=1});const d=B(t,c);return Fe(L(d,Es(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mce={kernelName:Am,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{axis:r}=s,[o,i]=e,a=st(r,o.shape),l=iz(t,i,o,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gce={kernelName:Qd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>L(t,be(nl(n,s),"float32")),b:()=>L(t,be(Bs(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yce={kernelName:Dm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,o=r.map(i=>i[0]);return{x:()=>ct(t,o,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bce={kernelName:Zd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=qe(n.shape,s.shape);return{a:()=>{const a=Sn(n.shape,r);return a.length>0?B(_e(t,a),n.shape):t},b:()=>{const a=L(t,Dt(kh(Fe(n,s)))),l=Sn(s.shape,r);return l.length>0?B(_e(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vce={kernelName:Jd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=qe(n.shape,s.shape);return{a:()=>{const a=L(t,be(s,"float32")),l=Sn(n.shape,r);return l.length>0?B(_e(a,l),n.shape):a},b:()=>{const a=L(t,be(n,"float32")),l=Sn(s.shape,r);return l.length>0?B(_e(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xce={kernelName:Om,gradFunc:t=>({x:()=>Dt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wce={kernelName:Pm,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>dn(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sce={kernelName:Lm,gradFunc:t=>({x:()=>ft(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kce={kernelName:Mm,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:s}=n;return Nr(t,s).map(o=>()=>o)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VR={kernelName:zm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,o=r.map(i=>i[0]);return{x:()=>ct(t,o,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cce={kernelName:eh,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,s,r]=e,o=n,i=s,a=qe(o.shape,i.shape);return{a:()=>{const c=be(i,"float32");let d=L(t,L(c,Zo(o,Te(c,ze(1)))));const h=Sn(o.shape,a);return h.length>0&&(d=_e(d,h)),B(d,o.shape)},b:()=>{const c=Bs(o,0),d=Xn(c,er(o),ft(o));let h=L(t,L(r,d));const f=Sn(i.shape,a);return f.length>0&&(h=_e(h,f)),B(h,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nce={kernelName:Bm,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,s]=e,r=Bs(n,0);return{x:()=>Xn(r,t,L(t,s)),alpha:()=>{let o=Xn(r,ft(t),L(t,n));const i=Sn(s.shape,t.shape);return i.length>0&&(o=_e(o,i)),B(o,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tce(t,e,n){const s=t.shape.slice();s[n]=1;const r=B(e,s),o=mp(t,n,!0,!1),i=mp(t,n,!0,!0),a=L(o,i);return L(r,a)}function $ce(t,e,n){const s=t.shape.length,r=s-n.length,o=tn(n,s);let i=t;o!=null&&(i=dt(t,o));const a=i.shape.slice(),u=a.splice(s-n.length,n.length).reduce((h,f)=>h*f,1);a.push(u);const c=i.reshape(a);let d=Tce(c,e,r);if(d=d.reshape(i.shape),o!=null){const h=tl(o);d=dt(d,h)}return d}const Ice={kernelName:Vm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;let o=[];return r==null?o=s.shape.map((i,a)=>a):typeof r=="number"?o=[r]:o=r,{x:()=>$ce(s,t,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ece={kernelName:Ld,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=qe(n.shape,s.shape);return{a:()=>{const a=Fe(t,be(s,"float32")),l=Sn(n.shape,r);return l.length>0?B(_e(a,l),n.shape):a},b:()=>{let a=L(t,be(n,"float32"));const l=Sn(s.shape,r);l.length>0&&(a=B(_e(a,l),s.shape));const u=Tt(s);return Dt(Fe(a,be(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rce={kernelName:th,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Fe(t,Dt(Tt(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ce={kernelName:sh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=L(nl(n,6),_u(n));return{x:()=>L(t,be(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ace={kernelName:nh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(t,be(_u(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dce={kernelName:Um,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>B(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oce={kernelName:jm,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>D.runKernel(Kv,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fce={kernelName:Wm,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>D.runKernel(qv,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lce={kernelName:Gm,gradFunc:(t,e,n)=>{const{dims:s}=n,r=st(s,t.shape);return{x:()=>Cr(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pce={kernelName:rh,gradFunc:t=>({x:()=>ft(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mce={kernelName:oh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Dt(Fe(t,L(Zo(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zce={kernelName:Hm,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>be(ft(n),"float32"),t:()=>L(t,be(n,t.dtype)),e:()=>L(t,be(hg(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bce={kernelName:ih,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Bs(n,ze(0)),r=ze(ew),o=ze(tw),i=L(t,o),a=L(L(t,r),Fs(be(n,"float32")));return Xn(s,i,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vce={kernelName:ch,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(t,L(n,Te(ze(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uce={kernelName:uh,gradFunc:t=>({x:()=>ft(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wce={kernelName:ah,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(ag(be(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jce={kernelName:lh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(vx(be(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gce={kernelName:qm,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{begin:r,size:o}=n,i=s.shape,[a,l]=Zx(s,r,o),u=[];for(let c=0;c<t.rank;c++)u.push([a[c],i[c]-a[c]-l[c]]);return{x:()=>Vi(t,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hce={kernelName:Qm,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{dim:r}=n,o=!0,i=L(t,s);return{logits:()=>Te(i,L(_e(i,[r],o),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qce={kernelName:dh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(t,vo(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UR={kernelName:Xm,gradFunc:(t,e,n)=>{const{blockShape:s,paddings:r}=n;return{x:()=>ig(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WR={kernelName:Ym,gradFunc:(t,e,n)=>{const{axis:s}=n;return{x:()=>hn(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kce={kernelName:hh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Fe(t,L(Mn(be(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xce={kernelName:sx,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(t,L(be(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yce={kernelName:fh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=ze(2);return{a:()=>L(t,L(r,Te(n,s))),b:()=>L(t,L(r,Te(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qce={kernelName:bh,gradFunc:t=>({x:()=>ft(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zce={kernelName:ph,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=qe(n.shape,s.shape);return{a:()=>{let a=t;const l=Sn(n.shape,r);return l.length>0&&(a=_e(a,l)),B(a,n.shape)},b:()=>{let a=t;const l=Sn(s.shape,r);return l.length>0&&(a=_e(a,l)),B(Dt(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jce={kernelName:Km,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,r=s.shape.slice(),{axis:o}=n;st(o,s.shape).forEach(u=>{r[u]=1});const a=B(t,r),l=L(a,Es(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ede={kernelName:mh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Fe(t,Tt(ag(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tde={kernelName:gh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>L(Te(ze(1),Tt(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nde={kernelName:yh,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{reps:r}=n;return{x:()=>{let i=ft(s);if(s.rank===1)for(let a=0;a<r[0];++a)i=ce(i,ct(t,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)i=ce(i,ct(t,[a*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let u=0;u<r[2];++u)i=ce(i,ct(t,[a*s.shape[0],l*s.shape[1],u*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let u=0;u<r[2];++u)for(let c=0;c<r[3];++c)i=ce(i,ct(t,[a*s.shape[0],l*s.shape[1],u*s.shape[2],c*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sde={kernelName:jl,gradFunc:(t,e,n)=>{const s=n,{perm:r}=s,o=tl(r);return{x:()=>dt(t,o)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rde={kernelName:Jm,gradFunc:(t,e,n)=>{const s=n,{axis:r}=s;return{value:()=>Ls(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ode={kernelName:eg,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ide(t,n)}}};function ide(t,e){const n=ii(e,ft(e)),s=Ch(t,n);let r=Bi(e,ze(0,"int32"));const o=s.rank-r.rank;for(let a=0;a<o;++a)r=jn(r,a+1);r=So(r,Es(s.shape,"bool"));const i=ft(s);return Xn(r,s,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ade={kernelName:tg,gradFunc:t=>({x:()=>ft(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lde=[oz,oue,iue,aue,lue,uue,cue,due,hue,fue,pue,mue,bue,wue,Sue,kue,Cue,Nue,Tue,$ue,Iue,Eue,_ue,Rue,Oue,Fue,Lue,Pue,Mue,zue,Ece,Bue,Vue,Uue,Wue,jue,Hue,Gue,que,Kue,Xue,Yue,Que,Zue,Jue,ece,tce,nce,sce,ice,BR,BR,ace,cce,fce,pce,mce,gce,yce,bce,vce,xce,wce,Sce,kce,VR,VR,Cce,Nce,Ice,Rce,_ce,Ace,Dce,Oce,Fce,Lce,Pce,Mce,zce,Bce,Vce,Uce,Wce,jce,Gce,Hce,qce,UR,UR,WR,WR,Kce,Yce,Xce,Qce,Zce,Jce,ede,tde,nde,sde,rde,ode,ade];for(const t of lde)EP(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.abs=function(){return this.throwIfDisposed(),bn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.acos=function(){return this.throwIfDisposed(),tT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.acosh=function(){return this.throwIfDisposed(),nT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.add=function(t){return this.throwIfDisposed(),ce(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.all=function(t,e){return this.throwIfDisposed(),gx(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.any=function(t,e){return this.throwIfDisposed(),hp(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.argMax=function(t){return this.throwIfDisposed(),iu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.argMin=function(t){return this.throwIfDisposed(),sT(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.asScalar=function(){return this.throwIfDisposed(),T(this.size===1,()=>"The array must have only 1 element."),B(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.asType=function(t){return this.throwIfDisposed(),be(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.as1D=function(){return this.throwIfDisposed(),B(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.as2D=function(t,e){return this.throwIfDisposed(),B(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),B(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.as4D=function(t,e,n,s){return this.throwIfDisposed(),B(this,[t,e,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.as5D=function(t,e,n,s,r){return this.throwIfDisposed(),B(this,[t,e,n,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.asin=function(){return this.throwIfDisposed(),rT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.asinh=function(){return this.throwIfDisposed(),oT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.atan=function(){return this.throwIfDisposed(),iT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.atan2=function(t){return this.throwIfDisposed(),aT(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.atanh=function(){return this.throwIfDisposed(),lT(this)};le().prototype.avgPool=function(t,e,n,s){return this.throwIfDisposed(),og(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),ig(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.batchNorm=function(t,e,n,s,r){return this.throwIfDisposed(),vh(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.broadcastTo=function(t){return this.throwIfDisposed(),Gl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.cast=function(t){return this.throwIfDisposed(),be(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.ceil=function(){return this.throwIfDisposed(),mT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Os(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof vt&&(t=[t]),hn([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.conv1d=function(t,e,n,s,r,o){return this.throwIfDisposed(),yx(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.conv2dTranspose=function(t,e,n,s,r){return this.throwIfDisposed(),bx(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.conv2d=function(t,e,n,s,r,o){return this.throwIfDisposed(),Ri(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.cos=function(){return this.throwIfDisposed(),ag(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.cosh=function(){return this.throwIfDisposed(),vx(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),mp(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),xx(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),kT(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.depthwiseConv2d=function(t,e,n,s,r,o){return this.throwIfDisposed(),xh(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.dilation2d=function(t,e,n,s,r){return this.throwIfDisposed(),CT(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.divNoNan=function(t){return this.throwIfDisposed(),NT(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.div=function(t){return this.throwIfDisposed(),Fe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.dot=function(t){return this.throwIfDisposed(),TT(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.elu=function(){return this.throwIfDisposed(),wh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.equal=function(t){return this.throwIfDisposed(),Zr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.erf=function(){return this.throwIfDisposed(),wx(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),IT(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.exp=function(){return this.throwIfDisposed(),Fs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.expandDims=function(t){return this.throwIfDisposed(),jn(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.expm1=function(){return this.throwIfDisposed(),ET(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.fft=function(){return this.throwIfDisposed(),xg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.flatten=function(){return this.throwIfDisposed(),B(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.floor=function(){return this.throwIfDisposed(),kh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.floorDiv=function(t){return this.throwIfDisposed(),mx(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.gather=function(t,e,n){return this.throwIfDisposed(),Ch(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.greaterEqual=function(t){return this.throwIfDisposed(),Bi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.greater=function(t){return this.throwIfDisposed(),Bs(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.ifft=function(){return this.throwIfDisposed(),ud(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.irfft=function(){return this.throwIfDisposed(),Lx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.isFinite=function(){return this.throwIfDisposed(),RT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.isInf=function(){return this.throwIfDisposed(),_T(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.isNaN=function(){return this.throwIfDisposed(),AT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.leakyRelu=function(t){return this.throwIfDisposed(),ug(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.lessEqual=function(t){return this.throwIfDisposed(),nl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.less=function(t){return this.throwIfDisposed(),od(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.localResponseNormalization=function(t,e,n,s){return this.throwIfDisposed(),DT(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.logSigmoid=function(){return this.throwIfDisposed(),OT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.logSoftmax=function(t){return this.throwIfDisposed(),Cx(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),dg(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.log=function(){return this.throwIfDisposed(),er(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.log1p=function(){return this.throwIfDisposed(),cg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.logicalAnd=function(t){return this.throwIfDisposed(),So(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.logicalNot=function(){return this.throwIfDisposed(),hg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.logicalOr=function(t){return this.throwIfDisposed(),Nx(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.logicalXor=function(t){return this.throwIfDisposed(),FT(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),nt(this,t,e,n)};le().prototype.maxPool=function(t,e,n,s){return this.throwIfDisposed(),fg(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.max=function(t,e){return this.throwIfDisposed(),Sr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.maximum=function(t){return this.throwIfDisposed(),ii(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.mean=function(t,e){return this.throwIfDisposed(),Zt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.min=function(t,e){return this.throwIfDisposed(),rd(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.minimum=function(t){return this.throwIfDisposed(),Va(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),PT(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.mod=function(t){return this.throwIfDisposed(),MT(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.mul=function(t){return this.throwIfDisposed(),L(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.neg=function(){return this.throwIfDisposed(),Dt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.norm=function(t,e,n){return this.throwIfDisposed(),Sh(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.notEqual=function(t){return this.throwIfDisposed(),uu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),id(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.onesLike=function(){return this.throwIfDisposed(),tr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.pad=function(t,e){return this.throwIfDisposed(),Vi(this,t,e)};le().prototype.pool=function(t,e,n,s,r,o){return this.throwIfDisposed(),zT(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.pow=function(t){return this.throwIfDisposed(),Zo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.prelu=function(t){return this.throwIfDisposed(),gg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.prod=function(t,e){return this.throwIfDisposed(),BT(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.reciprocal=function(){return this.throwIfDisposed(),YT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.relu=function(){return this.throwIfDisposed(),Io(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.relu6=function(){return this.throwIfDisposed(),Ix(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.reshapeAs=function(t){return this.throwIfDisposed(),B(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.reshape=function(t){return this.throwIfDisposed(),B(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),aM(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),lM(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.reverse=function(t){return this.throwIfDisposed(),Cr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.rfft=function(){return this.throwIfDisposed(),wg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.round=function(){return this.throwIfDisposed(),Ex(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.rsqrt=function(){return this.throwIfDisposed(),Rx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.selu=function(){return this.throwIfDisposed(),_x(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.separableConv2d=function(t,e,n,s,r,o){return this.throwIfDisposed(),Ax(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.sigmoid=function(){return this.throwIfDisposed(),vo(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.sign=function(){return this.throwIfDisposed(),QT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.sin=function(){return this.throwIfDisposed(),Dx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.sinh=function(){return this.throwIfDisposed(),Ox(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.slice=function(t,e){return this.throwIfDisposed(),ct(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.softmax=function(t){return this.throwIfDisposed(),Nh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.softplus=function(){return this.throwIfDisposed(),Eu(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),mg(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.split=function(t,e){return this.throwIfDisposed(),_s(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.sqrt=function(){return this.throwIfDisposed(),Mn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.square=function(){return this.throwIfDisposed(),Tt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.squaredDifference=function(t){return this.throwIfDisposed(),Px(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.squeeze=function(t){return this.throwIfDisposed(),Ui(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof vt?[this,t]:[this,...t];return Ls(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.step=function(t){return this.throwIfDisposed(),_u(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.stridedSlice=function(t,e,n,s,r,o,i,a){return this.throwIfDisposed(),ZT(this,t,e,n,s,r,o,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.sub=function(t){return this.throwIfDisposed(),Te(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.sum=function(t,e){return this.throwIfDisposed(),_e(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.tan=function(){return this.throwIfDisposed(),JT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.tanh=function(){return this.throwIfDisposed(),Ba(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.tile=function(t){return this.throwIfDisposed(),yr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.toBool=function(){return this.throwIfDisposed(),be(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.toFloat=function(){return this.throwIfDisposed(),be(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.toInt=function(){return this.throwIfDisposed(),be(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.topk=function(t,e){return this.throwIfDisposed(),n$(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.transpose=function(t){return this.throwIfDisposed(),dt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.unique=function(t){return this.throwIfDisposed(),s$(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),Bx(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.unstack=function(t){return this.throwIfDisposed(),Nr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.where=function(t,e){return this.throwIfDisposed(),Xn(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */le().prototype.zerosLike=function(){return this.throwIfDisposed(),ft(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Lo extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Lo.prototype)}}class Gr extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Gr.prototype)}}class U extends Error{constructor(e){super(e),Object.setPrototypeOf(this,U.prototype)}}class Ye extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ye.prototype)}}class q$ extends Error{constructor(e){super(e),Object.setPrototypeOf(this,q$.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class az{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function fu(t,e){if(Array.isArray(t)){let n=[];for(let s=0;s<e;s++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function Po(t,e){if(!t)throw new q$(e)}function jR(t,e){let n=0;for(const s of t)s===e&&n++;return n}function Is(t){return t.length===1?t[0]:t}function Ct(t){return Array.isArray(t)?t:[t]}function pi(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Sl(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let _r={};function K$(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function qk(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>qk(e));else{const e=Object.keys(t);for(const n of e){const s=t[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?t[n]=s.value:qk(s))}}}function Ng(t,e={},n={},s="object",r=!1){if(typeof t=="string"){const o=t;let i;if(o in n)i=n[o];else if(o in _r)i=_r[o];else if(i=e[o],i==null)throw new U(`Unknown ${s}: ${t}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const o=t;if(o.className==null||o.config==null)throw new U(`${s}: Improper config format: ${JSON.stringify(o)}.
'className' and 'config' must set.`);const i=o.className;let a,l;if(i in n?[a,l]=n[i]:i in _r?[a,l]=_r.className:i in e&&([a,l]=e[i]),a==null)throw new U(`Unknown ${s}: ${i}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const u={};for(const f of Object.keys(_r))u[f]=_r[f];for(const f of Object.keys(n))u[f]=n[f];const c=o.config;c.customObjects=u;const d=Object.assign({},_r);for(const f of Object.keys(n))_r[f]=n[f];qk(o.config);const h=l(a,o.config,n,r);return _r=Object.assign({},d),h}else{const u=Object.assign({},_r);for(const d of Object.keys(n))_r[d]=n[d];const c=new a(o.config);return _r=Object.assign({},u),c}}}function ude(t,e){return t<e?-1:t>e?1:0}function gy(t,e){return-1*ude(t,e)}function _a(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function cde(t){if(t==null)throw new U(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function Du(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new U(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function X$(t,e,n=0,s=1/0){return Po(n>=0),Po(s>=n),Array.isArray(t)&&t.length>=n&&t.length<=s&&t.every(r=>typeof r===e)}function Ln(t,e){Array.isArray(t)?(T(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,s)=>Ln(n,`element ${s+1} of ${e}`))):T(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${lz(t)}.`)}function lz(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>lz(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function dde(t,e,n){let s=n!=null?n():is(),r;return(...i)=>{const a=n!=null?n():is();return a-s<e||(s=a,r=t(...i)),r}}function uz(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let hde=0;function cz(){return hde++}const yy={};function nw(t=""){return t in yy||(yy[t]=0),yy[t]+=1,t+yy[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const fde=["channelsFirst","channelsLast"],pde=["nearest","bilinear"],mde=["valid","same","causal"],gde=["max","avg"],yde=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Hu=new Map;function mn(t){Du(fde,"DataFormat",t)}function bde(t){Du(pde,"InterpolationFormat",t)}function Ir(t){Du(mde,"PaddingMode",t)}function dz(t){Du(gde,"PoolMode",t)}const Ff=[],GR="/";function Hl(t,e){Ff.push(t);try{const n=e();return Ff.pop(),n}catch(n){throw Ff.pop(),n}}function vde(){return Ff.length===0?"":Ff.join(GR)+GR}function hz(t){if(!pz(t))throw new Error("Not a valid tensor name: '"+t+"'");return vde()+t}function fz(t){if(!pz(t))throw new Error("Not a valid tensor name: '"+t+"'");Hu.has(t)||Hu.set(t,0);const e=Hu.get(t);if(Hu.set(t,Hu.get(t)+1),e>0){const n=`${t}_${e}`;return Hu.set(n,1),n}else return t}const xde=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function pz(t){return!!t.match(xde)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wde(t){return t===parseInt(t.toString(),10)}function Aa(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let s=1;for(let r=e;r<n;++r)s*=t[r];return s}function cd(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s<e&&(e=s)}return e}function Ua(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s>e&&(e=s)}return e}function ko(t,e){if(e<t)throw new U(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let s=t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let N1;function Nn(){return N1==null&&(N1=QN().epsilon()),N1}function Co(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ko(t,e){return be(t,e)}function Tg(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),B(t,n)}function Sde(t,e){return Q(()=>{if(t.shape.length!==2)throw new U(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=Tg(t,1);return Kk(n,[1,e,1])})}function kde(t){const e=[Aa(t.shape)];return B(t,e)}function Cde(t){if(t.rank<=1)throw new U(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Aa(t.shape,1)];return B(t,e)}function ql(t,e,n){return Q(()=>{switch(t.rank){case 1:return bg(t,e,n);case 2:return Fx(t,[e,0],[n,t.shape[1]]);case 3:return vg(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return ld(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return ct(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return ct(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new U(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function T1(t,e,n){return Q(()=>{switch(t.rank){case 1:return bg(t,e,n);case 2:return Fx(t,[0,e],[t.shape[0],n]);case 3:return vg(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return ld(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new U(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function by(t,e,n,s){return Q(()=>{switch(t.rank){case 1:return bg(t,e,n);case 2:switch(s){case 1:return ql(t,e,n);case 2:return T1(t,e,n);default:throw new U(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return ql(t,e,n);case 2:return vg(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return T1(t,e,n);default:throw new U(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return ql(t,e,n);case 2:return ld(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return ld(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return T1(t,e,n);default:throw new U(`The axis is not within the rank of the tensor ${s}`)}default:throw new U(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Y$(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),hn(t,e)}function HR(t,e){switch(t.rank){case 1:return gT([t,e]);case 2:return yT([t,e],0);case 3:return bT([t,e],0);case 4:return vT([t,e],0);default:throw new U(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function Kk(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new U(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return yr(t,e)}function sw(t,e=0,n=1,s,r){return $x(t,e,n,s,r)}function Xo(t,e,n,s){if(t.rank<2||e.rank<2)throw new Ye(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=t.shape.slice(-1)[0],o=e.shape.slice(-2)[0];if(r!==o)throw new Ye(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return _k({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?Xk(t.rank,s,Co()):null,activation:n});{const r=t.shape.slice(),o=r.pop();t=B(t,[-1,o]);const i=e.shape.slice(),a=i.pop(),l=i.pop(),u=[...i,a],c=Array.from({length:e.rank},(p,m)=>m===0?e.rank-2:m<=e.rank-2?m-1:m);e=B(dt(e,c),[l,-1]);const d=[...r,...u];return B(_k({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?Xk(t.rank,s,Co()):null,activation:n}),d)}}function mz(t,e,n){return Q(()=>(Array.isArray(e)?e=qn(e,"int32"):e=be(e,"int32"),Ch(t,e,n)))}function $g(t){return L(t,t)}function Xk(t,e,n){const s=e.shape;if(e.rank!==1&&e.rank!==t)throw new U(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return s.length===1?B(e,[1,s[0],1,1,1]):B(e,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?B(e,[1,1,1,1,s[0]]):B(e,[1].concat(s))}else if(t===4){if(n==="channelsFirst")return s.length===1?B(e,[1,s[0],1,1]):B(e,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?B(e,[1,1,1,s[0]]):B(e,[1].concat(s))}else if(t===3){if(n==="channelsFirst")return s.length===1?B(e,[1,s[0],1]):B(e,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?B(e,[1,1,s[0]]):B(e,[1].concat(s))}else if(t<3)return e;throw new U(`Unsupported input rank by biasAdd: ${e.rank}`)}function Eo(t,e,n){return Q(()=>(n==null&&(n=Co()),mn(n),ce(t,Xk(t.rank,e,n))))}function Nde(t,e=1){if(e!==1)throw new Ye(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return wh(t)}function Tde(t){return Q(()=>Fe(t,ce(bn(t),1)))}function gz(t,e,n,s){return Q(()=>i$(t,e,n,s))}function $de(t){return Q(()=>{const e=ce(.5,L(.2,t));return Os(e,0,1)})}function Ig(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Ide=["fanIn","fanOut","fanAvg"],Ede=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Rde(t){Du(Ide,"FanMode",t)}function _de(t){Du(Ede,"Distribution",t)}class to extends Au{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class yz extends to{apply(e,n){return dn(e,n)}}yz.className="Zeros";he(yz);class Q$ extends to{apply(e,n){return Es(e,n)}}Q$.className="Ones";he(Q$);class bz extends to{constructor(e){if(super(),typeof e!="object")throw new U(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new U(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return Q(()=>L(ze(this.value),Es(e,n)))}getConfig(){return{value:this.value}}}bz.className="Constant";he(bz);class vz extends to{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return sl(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}vz.className="RandomUniform";he(vz);class xz extends to{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ye(`randomNormal does not support dType ${n}.`);return sw(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}xz.className="RandomNormal";he(xz);class wz extends to{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ye(`truncatedNormal does not support dType ${n}.`);return zx(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}wz.className="TruncatedNormal";he(wz);class Sz extends to{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return Q(()=>{if(e.length!==2||e[0]!==e[1])throw new U("Identity matrix initializer can only be used for 2D square matrices.");return L(this.gain,Sx(e[0]))})}getConfig(){return{gain:this.gain}}}Sz.className="Identity";he(Sz);function Ade(t,e="channelsLast"){let n,s;if(mn(e),t.length===2)n=t[0],s=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const r=Aa(t,2);n=t[1]*r,s=t[0]*r}else if(e==="channelsLast"){const r=Aa(t,0,t.length-2);n=t[t.length-2]*r,s=t[t.length-1]*r}}else{const r=Aa(t);n=Math.sqrt(r),s=Math.sqrt(r)}return[n,s]}class nr extends to{constructor(e){if(super(),e.scale<0)throw new U(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,Rde(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,_de(this.distribution),this.seed=e.seed}apply(e,n){const s=Ade(e),r=s[0],o=s[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,r):this.mode==="fanOut"?i/=Math.max(1,o):i/=Math.max(1,(r+o)/2),this.distribution==="normal"){const a=Math.sqrt(i);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ye(`${this.getClassName()} does not support dType ${n}.`);return zx(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*i);return sl(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}nr.className="VarianceScaling";he(nr);class Z$ extends nr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return nr.className}}Z$.className="GlorotUniform";he(Z$);class J$ extends nr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return nr.className}}J$.className="GlorotNormal";he(J$);class eI extends nr{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return nr.className}}eI.className="HeNormal";he(eI);class tI extends nr{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return nr.className}}tI.className="HeUniform";he(tI);class nI extends nr{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return nr.className}}nI.className="LeCunNormal";he(nI);class sI extends nr{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return nr.className}}sI.className="LeCunUniform";he(sI);class kz extends to{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return Q(()=>{if(e.length<2)throw new Ye("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const s=oe(e.slice(0,-1)),r=e[e.length-1],o=s*r;o>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${o}) elements: Slowness may result.`);const i=[Math.max(r,s),Math.min(r,s)],a=sw(i,0,1,n,this.seed),l=c$.qr(a,!1);let u=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return u=L(u,d.sign()),s<r&&(u=u.transpose()),L(ze(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}kz.className="Orthogonal";he(kz);const qR={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function KR(t,e={}){return Ng(t,mr.getMap().classNameMap,e,"initializer")}function Jt(t){return K$(t)}function jt(t){if(typeof t=="string"){const e=t in qR?qR[t]:t;if(e==="GlorotNormal")return new J$;if(e==="GlorotUniform")return new Z$;if(e==="HeNormal")return new eI;if(e==="HeUniform")return new tI;if(e==="LeCunNormal")return new nI;if(e==="LeCunUniform")return new sI;{const n={};return n.className=e,n.config={},KR(n)}}else return t instanceof to?t:KR(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Yk(t){return Array.isArray(t)&&Array.isArray(t[0])}function j0(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function He(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new U(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function xt(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new U(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function G0(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const XR="Variable";class Dde{constructor(e,n="float32",s=XR,r=!0,o=null){this.dtype=n??"float32",this.shape=e.shape,this.id=cz(),s=s??XR,this.originalName=hz(s),this.name=fz(this.originalName),this.trainable_=r,this.constraint=o,this.val=r$(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),Ode(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function Ode(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function Qk(t){return t.map(e=>e.read())}function rI(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Tn{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class ei{constructor(e,n,s,r,o,i,a){this.dtype=e,this.shape=n,this.sourceLayer=s,this.inputs=r,this.callArgs=o,this.outputTensorIndex=a,this.id=cz(),i!=null&&(this.originalName=hz(i),this.name=fz(this.originalName)),this.rank=n.length}}let Fde=0;class rw{constructor(e,n){this.callArgs=n,this.id=Fde++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let Lde=0;class at extends Au{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Lde++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const s=this.getClassName();n=pi(s)+"_"+nw(s)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let o=null;e.batchSize!=null&&(o=e.batchSize),s=[o].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new Gr(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new U(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Is(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Is(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Lo(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Lo(`Layer ${this.name} is not connected, no input to return.`);return Is(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Lo(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Lo(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Is(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=Ct(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=Ct(this.inputSpec);if(n.length!==s.length)throw new U(`Layer ${this.name} expects ${s.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let r=0;r<n.length;r++){const o=n[r],i=s[r];if(i==null)continue;const a=o.rank;if(i.ndim!=null&&a!==i.ndim)throw new U(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${a}`);if(i.maxNDim!=null&&a>i.maxNDim)throw new U(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${a}`);if(i.minNDim!=null&&a<i.minNDim)throw new U(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${a}.`);if(i.dtype!=null&&o.dtype!==i.dtype)throw new U(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${o.dtype}.`);if(i.axes){const l=o.shape;for(const u in i.axes){const c=Number(u),d=i.axes[u],h=c>=0?l[c]:l[l.length+c];if(d!=null&&[d,null].indexOf(h)===-1)throw new U(`Input ${r} is incompatible with layer ${this.name}: expected axis ${c} of input shape to have value ${d} but got shape ${l}.`)}}if(i.shape!=null)for(let l=0;l<i.shape.length;++l){const u=i.shape[l],c=o.shape[l];if(u!=null&&c!=null&&u!==c)throw new U(`Input ${r} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${o.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const s=Ct(e),r=zde(e),o=Bde(e);if(r===o)throw new U("Arguments to apply() must be all SymbolicTensors or all Tensors");return Hl(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const i=[];for(const a of Ct(e))i.push(a.shape);this.build(Is(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&o&&(this._refCount=1)}if(this.assertInputCompatibility(e),o){let i=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,i);const a=Ct(i),l=[];for(let u of a)s.indexOf(u)!==-1&&(u=u.clone()),l.push(u);if(i=Is(l),this.activityRegularizer!=null)throw new Ye("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=Pde(e),a=this.computeOutputShape(i);let l;const u=Mde(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((c,d)=>new ei(u,c,this,Ct(e),n,this.name,d)):l=new ei(u,a,this,Ct(e),n,this.name),this.addInboundNode(e,l,null,null,i,a,n),this._refCount++,this.activityRegularizer!=null)throw new Ye("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Lo(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new Lo(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Gr(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return G0(this.weights)}build(e){this.built=!0}getWeights(e=!1){return Qk(e?this.trainableWeights:this.weights)}setWeights(e){Q(()=>{const n=this.weights;if(n.length!==e.length)throw new U(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const s=[],r=Qk(n);for(let o=0;o<r.length;++o){const i=r[o],a=n[o],l=e[o];if(!ut(i.shape,l.shape))throw new U(`Layer weight shape ${i.shape} not compatible with provided weight shape ${l.shape}`);s.push([a,l])}rI(s)})}addWeight(e,n,s,r,o,i,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new U(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():jt("zeros"));const u=r.apply(n,s),c=new Dde(u,s,e,i,a);return u.dispose(),o!=null&&this.addLoss(()=>o.apply(c.read())),i==null&&(i=!0),i?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Ct(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s),o=Ct(n),i=Ct(r);if(o.length!==i.length)throw new Error(`${this.name} outputs ${o.length} tensors but ${o.length} masks for those tensors`);for(let a=0;a<o.length;a++)o[a].kerasMask=i[a]}addInboundNode(e,n,s,r,o,i,a=null){const l=Ct(e);n=Ct(n),s=Ct(s),r=Ct(r),o=j0(o),i=j0(i);const u=[],c=[],d=[];for(const h of l)u.push(h.sourceLayer),c.push(h.nodeIndex),d.push(h.tensorIndex);new rw({outboundLayer:this,inboundLayers:u,nodeIndices:c,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:r,inputShapes:o,outputShapes:i},a);for(let h=0;h<n.length;h++)n[h].sourceLayer=this,n[h].nodeIndex=this.inboundNodes.length-1,n[h].tensorIndex=h}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function Pde(t){t=Ct(t);const e=[];for(const n of t)e.push(n.shape);return Is(e)}function Mde(t){return"float32"}function Cz(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const s=e.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let o=0;o<s.inboundLayers.length;o++){const i=s.inputTensors[o],a=s.inboundLayers[o],l=s.nodeIndices[o],u=Cz(i,a,l);for(const c of u)r.indexOf(c)===-1&&r.push(c)}return r}}}function zde(t){let e=!0;for(const n of Ct(t))if(!(n instanceof ei)){e=!1;break}return e}function Bde(t){let e=!0;for(const n of Ct(t))if(n instanceof ei){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Eg extends at{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:nw("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new U("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new U("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new U("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const r=new ei(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new rw({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new U(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Eg.className="InputLayer";he(Eg);function Vde(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new U("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new Eg({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ude(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return be(e,t.dtype)}catch{throw new U(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class ba{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof ba)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=Ude(e,n),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new U(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof ei){if(this.id2Value[e.id]==null)throw new U(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new U(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof ei){if(this.id2Value[e.id]==null)throw new U(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new U(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Qe(this.id2Mask)}}const H0=new az,q0=new az;function Wde(t){H0!=null&&H0.setMaxEntries(t),q0!=null&&q0.setMaxEntries(t)}function yf(t,e,n,s){const r=n==null?!1:n.training,o=Array.isArray(t),i=o?t:[t],a=i.map(p=>p.name),l=[],u=e.names();for(const p of a)u.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);s!=null&&(s.maxNumTensors=-1/0,s.minNumTensors=1/0);const c=a.join(",")+"|"+e.names().sort().join(",");let d=H0.get(c),h;if(d==null){const p=jde(i,e);d=p.sorted,h=p.recipientCounts,H0.put(c,d),q0.put(c,h)}h={},r||Object.assign(h,q0.get(c));const f=new ba(e);for(let p=0;p<d.length;++p){if(s!=null){const I=M0().numTensors;I>s.maxNumTensors&&(s.maxNumTensors=I),I<s.minNumTensors&&(s.minNumTensors=I)}const m=d[p],g=m.sourceLayer;if(g instanceof Eg)continue;const y=[],b=[],v=[];let x=!1;for(const I of m.inputs){const E=f.getValue(I),A=f.getMask(I);y.push(E),b.push(A),A!=null&&(x=!0),r||(h[I.name]--,h[I.name]===0&&!e.hasKey(I)&&a.indexOf(I.name)===-1&&!E.isDisposed&&I.sourceLayer.stateful!==!0&&v.push(E))}x&&(n=n||{},n.mask=b[0]);const w=Ct(g.apply(y,n));let S=null;g.supportsMasking&&(S=g.computeMask(y,b));const C=Hde(m),N=Array.isArray(C)?C:[C];for(let I=0;I<N.length;++I){f.hasKey(N[I])||f.add(N[I],w[I],Array.isArray(S)?S[0]:S);const E=a.indexOf(N[I].name);E!==-1&&(l[E]=w[I])}r||Qe(v)}return f.disposeMasks(),o?l:l[0]}function jde(t,e){T(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(t.length===1){const r=YR(t[0],e);n=r.sorted,s=r.recipientMap}else{const r=new Set;for(const o of t){const{sorted:i,recipientMap:a}=YR(o,e);for(const l of i)r.has(l.name)||(n.push(l),r.add(l.name));for(const l in a)s[l]==null&&(s[l]=new Set),a[l].forEach(u=>s[l].add(u))}}return{sorted:n,recipientCounts:Gde(s)}}function Gde(t){const e={};for(const n in t)e[n]=t[n].size;return e}function YR(t,e){const n=new Set,s=[],r={};for(const a of e.names())n.add(a);const o=[],i=[];for(o.push(t);o.length>0;){const a=o[o.length-1];if(n.has(a.name)){o.pop();continue}const l=i[i.length-1]===o.length-1;if(a.inputs.length===0||l)o.pop(),s.push(a),n.add(a.name),l&&i.pop();else{i.push(o.length-1);for(const u of a.inputs)r[u.name]==null&&(r[u.name]=new Set),r[u.name].add(a.name),!n.has(u.name)&&o.push(u)}}return{sorted:s,recipientMap:r}}function Hde(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let s=0;s<t.sourceLayer.inboundNodes.length;++s)for(const r of t.sourceLayer.inboundNodes[s].outputTensors)if(r.id===t.id){n=s;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qde=ee();qde.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,Wde);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oI(t,e){return Q(()=>Mn(_e(L(t,t),e,!0)))}class Rg extends Au{getConfig(){return{}}}class Nz extends Rg{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return Q(()=>{const n=oI(e,this.axis),s=Os(n,0,this.maxValue);return L(e,Fe(s,ce(Nn(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}Nz.className="MaxNorm";he(Nz);class Tz extends Rg{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return Q(()=>Fe(e,ce(Nn(),oI(e,this.axis))))}getConfig(){return{axis:this.axis}}}Tz.className="UnitNorm";he(Tz);class $z extends Rg{apply(e){return Io(e)}}$z.className="NonNeg";he($z);class Iz extends Rg{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return Q(()=>{const n=oI(e,this.axis),s=ce(L(this.rate,Os(n,this.minValue,this.maxValue)),L(1-this.rate,n));return L(e,Fe(s,ce(Nn(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}Iz.className="MinMaxNorm";he(Iz);const QR={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function $n(t){return K$(t)}function ZR(t,e={}){return Ng(t,mr.getMap().classNameMap,e,"constraint")}function In(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in QR?QR[t]:t,config:{}};return ZR(n)}else return t instanceof Rg?t:ZR(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function dl(t){if(t==null)return;const e=[],n=[],s=[];for(const r in t){const o=t[r];if(typeof o!="number"){const i=o;e.push(i.data()),n.push(r),s.push(i)}}if(e.length>0){const r=await Promise.all(e);for(let o=0;o<r.length;++o)t[n[o]]=r[o][0];Qe(s)}}function Ez(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var JR;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(JR||(JR={}));const Kde=125;class gp{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class Xde{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class Yde extends gp{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const r in n){const o=n[r];if(typeof o=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+o*s;else{let i;r in this.totals?i=this.totals[r]:this.totals[r]=0;const a=Q(()=>ce(this.totals[r],L(o,s)));this.totals[r]=a,i!=null&&i.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:Q(()=>{const r=L(Fe(1,this.seen),this.totals[s]);n[s]=r,this.totals[s].dispose(),Cn(n[s])}))}}class Qde extends gp{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const e=[],n=[],s=[];for(const o in this.history){const i=this.history[o];for(let a=0;a<i.length;++a)if(typeof i[a]!="number"){const l=i[a];e.push(l.data()),n.push(o),s.push(a)}}const r=await Promise.all(e);for(let o=0;o<r.length;++o)this.history[n[o]][s[o]].dispose(),this.history[n[o]][s[o]]=r[o][0]}}class Zde extends gp{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||T$,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=Kde),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");_0(this.yieldEvery)&&(this.maybeWait=dde(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,s){const r=[];this.yield!=null&&(await dl(s),r.push(this.yield(e,n,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await dl(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const s=[];this.epochEnd!=null&&(await dl(n),s.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,n){this.batchBegin!=null&&(await dl(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const s=[];this.batchEnd!=null&&(await dl(n),s.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):_0(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await dl(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await dl(e),await this.trainEnd(e))}}function Rz(t,e){return t==null&&(t={}),t instanceof gp?[t]:Array.isArray(t)&&t[0]instanceof gp?t:Ct(t).map(s=>new Zde(s,e))}class Dr{constructor(){}static registerCallbackConstructor(e,n){T(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),Dr.checkForDuplicate(n),Dr.constructors[e]==null&&(Dr.constructors[e]=[]),Dr.constructors[e].push(n)}static checkForDuplicate(e){for(const n in Dr.constructors)Dr.constructors[+n].forEach(r=>{if(r===e)throw new U("Duplicate callback constructor.")})}static clear(){Dr.constructors={}}static createCallbacks(e){const n=[];for(const s in Dr.constructors){const r=+s;e>=r&&n.push(...Dr.constructors[r])}return n.map(s=>new s)}}Dr.constructors={};function _z(t,e,n,s,r,o,i,a,l){const u=new Qde,c=[new Yde,...Dr.createCallbacks(e)];t!=null&&c.push(...t),c.push(u);const d=new Xde(c);return d.setParams({epochs:n,initialEpoch:s,samples:r,steps:o,batchSize:i,verbose:e,doValidation:a,metrics:l}),{callbackList:d,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wi(t,e={},n=!1){return Ng(t,mr.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function K0(t,e){return Q(()=>{t.dtype!=="float32"&&(t=be(t,"float32"));const n=_e($g(t),e,!0),s=Iu(n.shape,Nn()),r=Mn(ii(n,s));return Fe(t,r)})}function ow(t,e){return Q(()=>Zt($g(Te(e,t)),-1))}function iI(t,e){return Q(()=>Zt(bn(Te(e,t)),-1))}function aI(t,e){return Q(()=>{const n=Te(t,e),s=Os(bn(t),Nn(),Number.MAX_VALUE),r=bn(Fe(n,s));return L(100,Zt(r,-1))})}function Jde(t,e){return Q(()=>{const n=Os(e,Nn(),Number.MAX_VALUE),s=er(ce(1,n)),r=Os(t,Nn(),Number.MAX_VALUE),o=er(ce(1,r));return Zt($g(Te(s,o)),-1)})}function ehe(t,e){return Q(()=>{const n=ii(0,Te(1,L(t,e)));return Zt($g(n),-1)})}function the(t,e){return Q(()=>{const n=ii(0,Te(1,L(t,e)));return Zt(n,-1)})}function nhe(t,e){return Q(()=>{const n=_e(L(t,e),-1),s=Sr(L(Te(1,t),e),-1);return ii(0,ce(1,Te(s,n)))})}function she(t,e){return Q(()=>{const n=Math.log(2),s=Te(e,t),r=Te(ce(s,Eu(L(-2,s))),n);return Zt(r,-1)})}function yp(t,e,n=!1){return Q(()=>{if(n)e=Nh(e);else{const s=_e(e,e.shape.length-1,!0);e=Fe(e,s)}return e=Os(e,Nn(),1-Nn()),Dt(_e(L(be(t,"float32"),er(e)),e.shape.length-1))})}function X0(t,e,n=!1){return Q(()=>{const s=be(kh(kde(t)),"int32");e=Os(e,Nn(),1-Nn());const r=e.shape,o=B(id(s,r[r.length-1]),r);return yp(o,e,n)})}function rhe(t,e){if(!ut(t.shape,e.shape))throw new U(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return Q(()=>{const n=Io(e),s=Dt(bn(e));return ce(Te(n,L(e,t)),cg(Fs(s)))})}function iw(t,e){return Q(()=>{let n;return n=Os(e,Nn(),1-Nn()),n=er(Fe(n,Te(1,n))),Zt(rhe(t,n),-1)})}function ohe(t,e){return Q(()=>{const n=Os(t,Nn(),1),s=Os(e,Nn(),1);return _e(L(t,er(Fe(n,s))),-1)})}function ihe(t,e){return Q(()=>{const n=er(ce(Nn(),e));return Zt(Te(e,L(t,n)),-1)})}function Az(t,e){return Q(()=>{const n=K0(t,-1),s=K0(e,-1),r=L(n,s);return Dt(_e(r,-1))})}const Y0={meanSquaredError:ow,meanAbsoluteError:iI,meanAbsolutePercentageError:aI,meanSquaredLogarithmicError:Jde,squaredHinge:ehe,hinge:the,categoricalHinge:nhe,logcosh:she,categoricalCrossentropy:yp,sparseCategoricalCrossentropy:X0,binaryCrossentropy:iw,kullbackLeiblerDivergence:ohe,poisson:ihe,cosineProximity:Az};function $1(t){if(typeof t=="string"){if(t in Y0)return Y0[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new U(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Dz(t,e){return Q(()=>{const n=L(.5,tr(e)),s=Ko(Bs(e,n),t.dtype);return Zt(Zr(t,s),-1)})}function Oz(t,e){return Q(()=>Ko(Zr(iu(t,-1),iu(e,-1)),"float32"))}function ahe(t,e){return Q(()=>be(_e(So(Zr(t,1),Zr(e,1))),"float32"))}function lhe(t,e){return Q(()=>be(_e(So(Zr(t,0),Zr(e,1))),"float32"))}function uhe(t,e){return Q(()=>{const n=ahe(t,e),s=lhe(t,e),r=ce(n,s);return be(Xn(Bs(r,0),Fe(n,r),0),"float32")})}function che(t,e){return iw(t,e)}function dhe(t,e){return t.rank===e.rank&&(t=Ui(t,[t.rank-1])),e=iu(e,-1),e.dtype!==t.dtype&&(e=be(e,t.dtype)),be(Zr(t,e),"float32")}const hhe=ow,fhe=ow,phe=iI,mhe=iI,ghe=aI,yhe=aI,Fz=yp,bhe=Az,Lz=X0,Q0={binaryAccuracy:Dz,categoricalAccuracy:Oz,precision:uhe,categoricalCrossentropy:Fz,sparseCategoricalCrossentropy:Lz,mse:hhe,MSE:fhe,mae:phe,MAE:mhe,mape:ghe,MAPE:yhe,cosine:bhe};function vhe(t){if(typeof t=="string"&&t in Q0)return Q0[t];if(typeof t!="string"&&t!=null)return t;throw new U(`Unknown metric ${t}`)}function vy(t){if(Po(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(Y0))if(Y0[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(Q0))if(Q0[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function xhe(t){const e={Adagrad:()=>yl.adagrad(.01),Adadelta:()=>yl.adadelta(1,.95,Nn()),Adam:()=>yl.adam(.001,.9,.999,Nn()),Adamax:()=>yl.adamax(.002,.9,.999,Nn(),0),RMSProp:()=>yl.rmsprop(.001,.9,0,Nn()),SGD:()=>yl.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new U(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const e_=1*1024*1024;function t_(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!Zk(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(t);s.length>e_&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${e_}.`)}}function Zk(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!Zk(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!Zk(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function whe(t,e,n,s=console.log){const r=khe(t),o=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(c=>Math.floor(e*c)));let i;if(!r){o.push("Receives inputs"),i=[];for(const c in t.nodesByDepth)i.push(...t.nodesByDepth[c])}s("_".repeat(e)),Z0(o,n,s),s("=".repeat(e));const a=t.layers;for(let c=0;c<a.length;++c)r?Che(a[c],n,s):Nhe(a[c],n,i,s),s((c===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=She(t),u=G0(t.nonTrainableWeights);s(`Total params: ${l+u}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${u}`),s("_".repeat(e))}function She(t){let e;return t.collectedTrainableWeights!=null?e=G0(t.collectedTrainableWeights):e=G0(t.trainableWeights),e}function khe(t){let e=!0;const n=[],s=[];for(const r in t.nodesByDepth)n.push(t.nodesByDepth[r]);for(const r of n){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of t.layers){let o=!1;for(const i of r.inboundNodes)if(s.indexOf(i)!==-1)if(o){e=!1;break}else o=!0;if(!e)break}return e}function Z0(t,e,n=console.log){let s="";for(let r=0;r<t.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=t[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);n(s)}function Che(t,e,n){let s,r;try{r=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const o=t.name,i=t.getClassName(),a=[`${o} (${i})`,r,s,t.countParams().toString()];Z0(a,e,n)}function Nhe(t,e,n,s){let r,o;try{o=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{o="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const i=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let h=0;h<d.inboundLayers.length;++h){const f=d.inboundLayers[h].name,p=d.nodeIndices[h],m=d.tensorIndices[h];i.push(`${f}[${p}][${m}]`)}const a=t.name,l=t.getClassName(),u=i.length===0?"":i[0],c=[`${a} (${l})`,o,r,t.countParams().toString(),u];Z0(c,e,s);for(let d=1;d<i.length;++d)Z0(["","","","",i[d]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Pz(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function Jk(t,e){if(t===null)return null;if(typeof t=="string")return Sl(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const o=t[r];Pz(e,r,o)?n.push(o):n.push(Jk(o,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s];if(s==="name"&&typeof r=="string")n[s]=r;else{const o=Sl(s);n[o]=Jk(r,o)}}return n}}function eC(t,e){if(t==null)return null;if(typeof t=="string")return pi(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const o=t[r];Pz(e,r,o)?n.push(o):n.push(eC(o,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s],o=pi(s);(s==="name"||s==="className")&&typeof r=="string"?n[o]=r:n[o]=eC(r,s)}return n}}/** @license See the LICENSE file. */const Mz="4.20.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const The=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class io extends at{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const b=this.getClassName().toLowerCase();this.name=nw(b)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],_a(this.inputs).length!==this.inputs.length)throw new U(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(b=>b.name)}`);_a(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(b=>b.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const b of this.outputs){const v=b.sourceLayer,x=b.nodeIndex,w=b.tensorIndex;this.outputLayers.push(v),this.outputLayersNodeIndices.push(x),this.outputLayersTensorIndices.push(w)}for(const b of this.inputs){const v=b.sourceLayer,x=b.nodeIndex,w=b.tensorIndex;Po(x===0,"input layer has >1 nodes"),Po(w===0,"input layer has >1 tensors"),this.inputLayers.push(v),this.inputLayersNodeIndices.push(x),this.inputLayersTensorIndices.push(w)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let b=0;b<this.inputLayers.length;b++){const v=this.inputLayers[b];if(!(v instanceof Eg))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${b} (0-based) originates from layer type ${v.getClassName()}.`);this.inputNames.push(v.name),this.feedInputShapes.push(v.batchInputShape),this.feedInputNames.push(v.name)}for(const b of this.outputLayers)this.outputNames.push(b.name);this.internalInputShapes=this.inputs.map(b=>b.shape),this.internalOutputShapes=this.outputs.map(b=>b.shape);const n={},s={},r={},o={},i={},a=[],l=(b,v,x,w,S,C)=>{(w==null||S==null||C==null)&&(w=b.sourceLayer,S=b.nodeIndex,C=b.tensorIndex);const N=w.inboundNodes[S];if(x.indexOf(N)!==-1)throw new Gr(`The tensor ${b.name} at layer "${w.name}" is part of a cycle.`);if(v.indexOf(N)!==-1)return;this.containerNodes.add(io.nodeKey(w,S)),w.id in i||(i[w.id]=Object.keys(i).length),x.indexOf(N)===-1&&x.push(N);const I=N.inboundLayers.length;for(let E=0;E<I;E++){const A=N.inputTensors[E],z=N.inboundLayers[E],V=N.nodeIndices[E],P=N.tensorIndices[E];l(A,v,x,z,V,P)}for(v.push(N);x.indexOf(N)>=0;)x.splice(x.indexOf(N),1);a.push(N)},u=[],c=[];for(const b of this.outputs)l(b,u,c);const d=a.slice().reverse();for(const b of d){s[b.id]=b,b.id in n||(n[b.id]=0);let v=n[b.id];const x=r[b.outboundLayer.id]==null?0:r[b.outboundLayer.id];v=Math.max(v,x),r[b.outboundLayer.id]=v,o[b.outboundLayer.id]=b.outboundLayer,n[b.id]=v;for(let w=0;w<b.inboundLayers.length;w++){const S=b.inboundLayers[w],C=b.nodeIndices[w],N=S.inboundNodes[C],I=n[N.id]==null?0:n[N.id];n[N.id]=Math.max(v+1,I),s[N.id]=N}}const h={};for(const b in n){const v=n[b];v in h||(h[v]=[]),h[v].push(s[b])}const f={};for(const b in r){const v=r[b];v in f||(f[v]=[]),f[v].push(o[b])}let p=Object.keys(f).map(b=>parseInt(b,10)).sort(gy);this.layers=[];for(const b of p){const v=f[b];v.sort((x,w)=>{const S=i[x.id],C=i[w.id];return S<C?-1:S>C?1:0});for(const x of v)x instanceof io&&this.internalContainerRefs.push(x),this.layers.push(x)}this.layersByDepth=f,p=Object.keys(h).map(b=>parseInt(b,10)).sort(gy);const m=this.inputs.slice(),g=[];for(const b of p)for(const v of h[b]){const x=v.outboundLayer;if(x!=null){for(const w of v.inputTensors)if(m.indexOf(w)===-1)throw new Gr(`Graph disconnected: cannot obtain value for tensor ${w} at layer "${x.name}". The following previous layers were accessed without issue: ${g}`);for(const w of v.outputTensors)m.push(w);g.push(x.name)}}this.nodesByDepth=h;const y=this.layers.map(b=>b.name);for(const b of y){const v=y.filter(x=>x===b).length;if(v!==1)throw new Gr(`The name "${b}" is used ${v} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(y))}this.outboundNodes=[],this.inboundNodes=[],new rw({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(b=>null),outputMasks:this.outputs.map(b=>null),inputShapes:this.inputs.map(b=>b.shape),outputShapes:this.outputs.map(b=>b.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new U("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const s={};let r=0;const o=The(e);o&&this.parseWeights(e);for(const a of this.layers)for(const[l,u]of a.weights.entries()){const c=o?`${u.name.split("/").slice(0,-1).join("/")+"/"}${l}`:u.originalName;if(s[c]!=null)throw new U(`Duplicate weight name: ${c}`);s[c]=u,r++}const i=[];for(const a in e){let l=a;if(s[a]==null){const u=a.split("/");l=u.slice(0,-2).concat([u[u.length-1]]).join("/")}if(s[l]!=null)i.push([s[l],e[a]]);else if(n)throw new U(`Provided weight data has no target variable: ${a}`);delete s[l]}if(n){const a=[];for(const l in s)a.push(l);if(a.length>0)throw new U(`${a.length} of ${r} weights are not set: ${a}`)}rI(i)}parseWeights(e){for(const n in Object.keys(e)){const s=n.split("/"),r=["vars","layer_checkpoint_dependencies"],o=s.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!r.includes(i)).join("/");o!==n&&(e[o]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${Mz}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const s=eC(this.updatedConfig());return n?JSON.stringify(s):s}call(e,n){return Q(()=>{e=Ct(e);const s=new ba;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return yf(this.outputs,s,n)})}computeMask(e,n){return Q(()=>{e=Ct(e);let s;return n==null?s=fu(null,e.length):s=Ct(n),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const n=j0(e);if(n.length!==this.inputLayers.length)throw new U(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],u=n[a],c=l.name+"_0_0";s[c]=u}const r=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(gy);if(r.length>1)for(const a of r){const l=this.nodesByDepth[a];for(const u of l){const c=u.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(c.id)!==-1)continue;const d=[];for(let m=0;m<u.inboundLayers.length;m++){const g=u.inboundLayers[m],y=u.nodeIndices[m],b=u.tensorIndices[m],v=`${g.name}_${y}_${b}`,x=s[v];d.push(x)}const h=c.computeOutputShape(Is(d)),f=j0(h),p=c.inboundNodes.indexOf(u);for(let m=0;m<f.length;m++){const g=`${c.name}_${p}_${m}`;s[g]=f[m]}}}const o=[],i=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],u=this.outputLayersNodeIndices[a],c=this.outputLayersTensorIndices[a],d=`${l.name}_${u}_${c}`;i.push(d)}for(let a=0;a<i.length;a++){const l=i[a];Po(l in s),o.push(s[l])}return Is(o)}runInternalGraph(e,n){n==null&&(n=fu(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const u=this.inputs[l],c=e[l],d=n[l];s[u.id]=[c,d]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(gy);for(const l of r){const u=this.nodesByDepth[l];for(const c of u){const d=c.outboundLayer,h=c.inputTensors,f=c.outputTensors,p=new Array;for(const m of h)m.id in s&&p.push(s[m.id]);if(p.length===h.length){let m={},g,y,b,v;if(c.callArgs!=null&&(m=c.callArgs),p.length===1){const[x,w]=p[0];m.mask==null&&(m.mask=w),b=Ct(d.call(x,m)),v=Ct(d.computeMask(x,w)),g=[x],y=[w]}else g=p.map(x=>x[0]),y=p.map(x=>x[1]),m.mask==null&&(m.mask=y),b=Ct(d.call(g,m)),v=Ct(d.computeMask(g,y));if(d.activityRegularizer)throw new Ye("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let x=0;x<f.length;++x){const w=f[x],S=b[x],C=v[x];s[w.id]=[S,C]}}}}const o=[],i=[],a=[];for(const l of this.outputs){Po(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[u,c]=s[l.id];a.push(u.shape),o.push(u),i.push(c)}return[o,i,a]}buildNodeConversionMap(e){const n={};let s;for(const r of this.layers){s=r instanceof io?1:0;for(let o=0;o<r.inboundNodes.length;o++){const i=io.nodeKey(r,o);this.containerNodes.has(i)&&(n[i]=s,s+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new U("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new U(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new U(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return Q(()=>{const e=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const r=io.nodeKey(n,s);this.containerNodes.has(r)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const i of this.layers){const a=i.getClassName(),l=i.getConfig(),u=[];for(let d=0;d<i.inboundNodes.length;d++){const h=i.inboundNodes[d],f=io.nodeKey(i,d);let p={};if(this.containerNodes.has(f)){if(h.callArgs)try{JSON.stringify(h.callArgs),p=h.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(h.inboundLayers.length>0){const m=[];for(let g=0;g<h.inboundLayers.length;g++){const y=h.inboundLayers[g],b=h.nodeIndices[g],v=h.tensorIndices[g],x=io.nodeKey(y,b);let w=n[x];w==null&&(w=0),m.push([y.name,w,v,p])}u.push(m)}}}const c={};c.name=i.name,c.className=a,c.config=l,c.inboundNodes=u,s.push(c)}e.layers=s;const r=[];for(let i=0;i<this.inputLayers.length;i++){const a=this.inputLayers[i],l=this.inputLayersNodeIndices[i],u=io.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const d=this.inputLayersTensorIndices[i];r.push([a.name,c,d])}e.inputLayers=r;const o=[];for(let i=0;i<this.outputLayers.length;i++){const a=this.outputLayers[i],l=this.outputLayersNodeIndices[i],u=io.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const d=this.outputLayersTensorIndices[i];o.push([a.name,c,d])}return e.outputLayers=o,e}static fromConfig(e,n,s={},r=!1){const o={},i={};function a(g,y){g.name in i?i[g.name].push(y):i[g.name]=[y]}function l(g,y){const b=[];let v;for(const x of y){const w=x[0],S=x[1],C=x[2];if(v=x[3]==null?{}:x[3],!(w in o)){a(g,y);return}const N=o[w];if(N.inboundNodes.length<=S){a(g,y);return}const I=N.inboundNodes[S];b.push(I.outputTensors[C])}b.length>0&&g.apply(Is(b),v)}function u(g){const y=g.name,b=wi(g,n.customObjects!=null?n.customObjects:{});b.setFastWeightInitDuringBuild(r),o[y]=b,g.inboundNodes.forEach(x=>{if(!(x instanceof Array))throw new U(`Corrupted configuration, expected array for nodeData: ${x}`);a(b,x)})}const c=n.name,d=n.layers;for(const g of d)u(g);for(;!cde(i);)for(const g of d){const y=o[g.name];if(y.name in i){const b=i[y.name];delete i[y.name];for(const v of b)l(y,v)}}const h=[],f=[],p=n.inputLayers;for(const g of p){const y=g[0],b=g[1],v=g[2];Po(y in o);const w=o[y].inboundNodes[b].outputTensors;h.push(w[v])}const m=n.outputLayers;for(const g of m){const y=g[0],b=g[1],v=g[2];Po(y in o);const w=o[y].inboundNodes[b].outputTensors;f.push(w[v])}return new e({inputs:h,outputs:f,name:c})}get stateful(){if(this._stateful)throw new U("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){Q(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $he(t,e,n){const s=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>null);if(s===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==s)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const r=[];return e.forEach(o=>{o in t?r.push(t[o]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function zz(t,e){return $he(t,e,"classWeight")}async function Bz(t,e,n,s){if(e!=null||s!=null)throw new Error("Support sampleWeight is not implemented yet");if(n!=null){const r=Q(()=>{if(t.shape.length===1)return Ho(t);if(t.shape.length===2){if(t.shape[1]>1)return iu(t,1);if(t.shape[1]===1)return B(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),o=Array.from(await r.data());Qe(r);const i=[];return o.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);i.push(n[a])}),qn(i,"float32")}else return null}function Ihe(t,e){return L(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Ehe=32;function Vz(t,e){let n,s;const r=e;n=r.xs,s=r.ys,T(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const o=n_("input",t.inputNames,n),i=n_("output",t.outputNames,s),a=o[0].shape[0];T(o.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${o.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),T(i.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<o.length;l++)T(o[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<i.length;l++)T(i[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:o,ys:i}}function n_(t,e,n){if(n instanceof vt)return[n];if(Array.isArray(n))return T(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const s=[];for(const r of e){if(n[r]==null)throw new U(`The feature data generated by the dataset lacks the required ${t} key '${r}'.`);s.push(n[r])}return s}}function Rhe(t){if(t.length===3)throw new Ye("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function _he(t,e,n){const s=n.batchesPerEpoch!=null;if(T(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),T(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),T(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),T(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),T(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const r=n.validationData!=null;let o,i;if(r)if(s_(n.validationData))T(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const g=Rhe(n.validationData);o=g.xs,i=g.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let u;r?u=l.slice().concat(l.map(g=>"val_"+g)):u=l.slice();const c=Rz(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:h,history:f}=_z(c,d,n.epochs,null,null,Ahe(e,n),null,r,u);h.setModel(t),t.history=f,await h.onTrainBegin(),t.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,m=await e.iterator();for(;p<n.epochs;){const g={};await h.onEpochBegin(p);let y=0,b=0;for(s||(m=await e.iterator());!s||y<n.batchesPerEpoch;){const v=await m.next();if(s&&v.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${y} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(v.value!=null){const{xs:x,ys:w}=Vz(t,v.value),S={};S.batch=b,S.size=x[0].shape[0],await h.onBatchBegin(b,S);const C=[];if(n.classWeight!=null){const E=zz(n.classWeight,t.outputNames);for(let A=0;A<E.length;++A)C.push(await Bz(w[A],null,E[A]))}const N=x.concat(w).concat(C),I=a(N);Qe(N);for(let E=0;E<l.length;++E){const A=l[E],z=I[E];S[A]=z,Cn(z)}await h.onBatchEnd(b,S),Ez(S),b++,y++}if(s?y>=n.batchesPerEpoch:v.done){if(r){let x;s_(n.validationData)?x=Ct(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):x=Ct(t.evaluate(o,i,{batchSize:n.validationBatchSize==null?Ehe:n.validationBatchSize,verbose:0}));for(let w=0;w<t.metricsNames.length;++w)g[`val_${t.metricsNames[w]}`]=x[w]}break}if(t.stopTraining_)break}if(await h.onEpochEnd(p,g),p++,t.stopTraining_)break}return await h.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function Ahe(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function s_(t){return typeof t.iterator=="function"}function Dhe(t){return typeof t.next=="function"}async function Ohe(t,e,n){n=n||{};const s=n.batches!=null,r=t.testFunction;let o=[];if(n.verbose>0)throw new Ye("Verbose mode is not implemented yet.");T(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const i=Dhe(e)?e:await e.iterator();let a=0,l=0;for(;!s||l<n.batches;){const u=await i.next();if(o=Q(()=>{if(u.value){const{xs:c,ys:d}=Vz(t,u.value),h=c.concat(d),f=Q(()=>r(h));if(Qe(h),l===0)for(let m=0;m<f.length;++m)o.push(ze(0));const p=h[0].shape[0];for(let m=0;m<f.length;++m){const g=f[m],y=o[m];o[m]=Q(()=>ce(o[m],L(p,g))),l>0&&Qe(y)}Qe(f),a+=p,++l}return o}),u.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<o.length;++u){const c=o[u];o[u]=Fe(o[u],a),Qe(c)}return Is(o)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function I1(t){T(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function af(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(s=>ql(s,e,n-e)):ql(t,e,n-e)}function tC(t,e){return Q(()=>t==null?null:Array.isArray(t)?t.map(n=>tC(n,e)):mz(t,e.dtype==="int32"?e:be(e,"int32")))}function E1(t,e){const n=[];let s=0,r=null;for(;s<t;)r=s+e,r>=t&&(r=t),n.push([s,r]),s=r;return n}function Uz(t){const e=[];t instanceof vt&&(t=[t]);for(let n=0;n<t.length;++n){const s=t[n];if(s.rank===1)e.push(Tg(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function ro(t,e){if(t==null)return;const n=[];if(e instanceof vt)n.push(e.id);else if(Array.isArray(e))e.forEach(r=>n.push(r.id));else if(e!=null)for(const r in e){const o=e[r];n.push(o.id)}const s=[];if(t instanceof vt)n.indexOf(t.id)===-1&&s.push(t);else if(Array.isArray(t))t.forEach(r=>{n.indexOf(r.id)===-1&&s.push(r)});else if(t!=null)for(const r in t){const o=t[r];n.indexOf(o.id)===-1&&s.push(o)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Fhe(t){return t instanceof vt}function nC(t){return Array.isArray(t)}function r_(t){return!Fhe(t)&&!nC(t)}function o_(t,e,n,s=!0,r=""){if(e==null||e.length===0){if(t!=null){let i=!1;if(nC(t)&&t.length>0)i=!0;else if(r_(t)){for(const a in t)if(t.hasOwnProperty(a)){i=!0;break}}else i=!0;if(i)throw new U(`Error when checking model ${r} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(i=>null);let o;if(r_(t)){t=t,o=[];for(const i of e){if(t[i]==null)throw new U(`No data provided for "${i}". Need data for each key in: ${e}`);o.push(t[i])}}else if(nC(t)){if(t=t,t.length!==e.length)throw new U(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);o=t}else{if(t=t,e.length>1)throw new U(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);o=[t]}if(o=Uz(o),n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const a=o[i];if(a.shape.length!==n[i].length)throw new U(`Error when checking ${r}: expected ${e[i]} to have ${n[i].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[i].length;++l){if(l===0&&!s)continue;const u=a.shape[l],c=n[i][l];if(c!=null&&c>=0&&u!==c)throw new U(`${r} expected a batch of elements where each example has shape [${n[i].slice(1,n[i].length)}] (i.e.,tensor shape [*,${n[i].slice(1,n[i].length)}]) but the ${r} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return o}function Lhe(t,e,n){const s=_a(t.map(o=>o.shape[0]));s.sort();const r=_a(e.map(o=>o.shape[0]));if(r.sort(),s.length>1)throw new U(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(o=>o.shape))}`);if(r.length>1)throw new U(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(o=>o.shape))}`);if(s.length>0&&r.length>0&&!ut(s,r))throw new U(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function Phe(t,e,n){const s=[ow,iw,yp];for(let r=0;r<t.length;++r){const o=t[r],i=e[r],a=n[r];if(i!=null){if(i===yp&&o.shape[o.shape.length-1]===1)throw new U(`You are passing a target array of shape ${o.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(i)!==-1){const l=o.shape.slice(1),u=a.slice(1);for(let c=0;c<l.length;++c){const d=l[c],h=u[c];if(h!=null&&d!==h)throw new U(`A target Tensor with shape ${o.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function i_(t,e,n,s=!0,r=""){let o;if(Array.isArray(t)){if(t.length!==e.length)throw new U(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);o=t}else{if(e.length>1)throw new U(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);o=[t]}if(n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const a=o[i];if(a.shape.length!==n[i].length)throw new U(`Error when checking ${r}: expected ${e[i]} to have ${n[i].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[i].length;++l){if(l===0&&!s)continue;const u=a.shape[l],c=n[i][l];if(c!=null&&c!==u)throw new U(`Error when checking ${r}: expected ${e[i]} to have shape ${JSON.stringify(n[i])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function Mhe(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(s=>n);{const s=[];for(const r of e){let o=n.hasOwnProperty(r)?n[r]:[];Array.isArray(o)||(o=[o]),s.push(o)}return s}}const zhe="layers-model";class kc extends io{constructor(e){super(e),this.isTraining=!1}summary(e,n,s=console.log){if(!this.built)throw new U("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");whe(this,e,n,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=xhe(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof ji))throw new U("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new U(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)e.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),n.push($1(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new U(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>$1(a))}else{const i=$1(e.loss);this.outputs.forEach(a=>{n.push(i)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const a=this.internalOutputShapes[i],l=this.outputNames[i];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[i])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Hl("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const a=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([a,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const r=Mhe(e.metrics,this.outputNames),o=(i,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[i]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,i])};Hl("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const a=r[i];(u=>{const c="";let d,h,f;for(const p of u){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const g=this.internalOutputShapes[i];g[g.length-1]===1||this.lossFunctions[i]===iw?["accuracy","acc"].indexOf(p)!==-1?h=Dz:["crossentropy","ce"].indexOf(p)!==-1&&(h=che):this.lossFunctions[i]===X0?["accuracy","acc"].indexOf(p)!==-1?h=dhe:["crossentropy","ce"].indexOf(p)!==-1&&(h=Lz):["accuracy","acc"].indexOf(p)!==-1?h=Oz:["crossentropy","ce"].indexOf(p)!==-1&&(h=Fz);let y;["accuracy","acc"].indexOf(p)!==-1?y="acc":["crossentropy","ce"].indexOf(p)!==-1&&(y="ce"),f=h,d=c+y}else f=vhe(p),d=c+vy(p);let m;Hl(d,()=>{m=f}),o(i,d,m)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,s={}){const r=s.batchSize==null?32:s.batchSize;I1(r);const i=this.standardizeUserDataXY(e,n,!0,r);try{const a=i[0].concat(i[1]);this.makeTestFunction();const l=this.testFunction,u=this.testLoop(l,a,r,s.verbose,s.steps);return Is(u)}finally{ro(i[0],e),ro(i[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),Ohe(this,e,n)}checkNumSamples(e,n,s,r="steps"){let o;if(s!=null){if(o=null,n!=null)throw new U(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?o=e[0].shape[0]:o=e.shape[0];else throw new U(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return o}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new U("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),r=s?n:[n],o=this.retrieveSymbolicTensors(r),i=new ba;if(e instanceof vt&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new U(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)i.add(this.inputs[l],e[l])}else for(const l of this.inputs){const u=e[l.name];if(u==null)throw new U(`No value is provided for the model's input ${l.name}`);i.add(l,u)}const a=yf(o,i);return s?a:a[0]}retrieveSymbolicTensors(e){const n=fu(null,e.length);let s=e.length;for(const r of this.layers){const o=Array.isArray(r.output)?r.output:[r.output],i=o.map(a=>a.name);for(let a=0;a<e.length;++a){const l=i.indexOf(e[a]);if(l!==-1&&(n[a]=o[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw n.forEach((o,i)=>{o==null&&r.push(e[i])}),new U(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return n}predictLoop(e,n=32,s=!1){return Q(()=>{const r=this.checkNumSamples(e);if(s)throw new Ye("Verbose predictLoop() is not implemented yet.");const o=E1(r,n),i=this.outputs.map(a=>[]);for(let a=0;a<o.length;++a)Q(()=>{const u=o[a][0],c=o[a][1],d=af(e,u,c),h=[];if(Array.isArray(d))for(let p=0;p<d.length;++p)h.push({key:this.inputs[p],value:d[p]});else h.push({key:this.inputs[0],value:d});const f=new ba(h);return yf(this.outputs,f)}).forEach((u,c)=>i[c].push(u));return Is(i.map(a=>hn(a,0)))})}predict(e,n={}){const s=Uz(e);i_(s,this.inputNames,this.feedInputShapes,!1);try{const r=n.batchSize==null?32:n.batchSize;return I1(r),this.predictLoop(s,r)}finally{ro(s,e)}}predictOnBatch(e){i_(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,s=!0,r){if(this.optimizer_==null)throw new Gr("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const o=[];for(let i=0;i<this.feedOutputShapes.length;++i){const a=this.feedOutputShapes[i];this.feedLossFns[i]===X0?o.push(a.slice(0,a.length-1).concat([1])):o.push(a)}if(e=o_(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=o_(n,this.feedOutputNames,o,!1,"target"),Lhe(e,n),Phe(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new U(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,s,r,o=!0,i){const[a,l]=this.standardizeUserDataXY(e,n,o,i);if(s!=null)throw new Error("sample weight is not supported yet.");let u=null;if(r!=null){const c=zz(r,this.outputNames);u=[];for(let d=0;d<c.length;++d)u.push(await Bz(l[d],null,c[d]))}return[a,l,u]}testLoop(e,n,s,r=0,o){return Q(()=>{const i=this.checkNumSamples(n,s,o,"steps"),a=[];if(r>0)throw new Ye("Verbose mode is not implemented yet.");if(o!=null)throw new Ye("steps mode in testLoop() is not implemented yet");{const l=E1(i,s),u=qn(ko(0,i));for(let c=0;c<l.length;++c){const d=l[c][0],h=l[c][1],f=ql(u,d,h-d),p=tC(n,f),m=e(p);if(c===0)for(let g=0;g<m.length;++g)a.push(ze(0));for(let g=0;g<m.length;++g){const y=m[g];a[g]=ce(a[g],L(h-d,y))}}for(let c=0;c<a.length;++c)a[c]=Fe(a[c],i)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let s=0;s<e.length;++s){const r=e[s];let o=r;if(jR(e,r)>1){const i=jR(e.slice(0,s),r);o+=`_${i}`}n.push(o)}return n}makeTrainFunction(){return e=>{const n=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],a=()=>{const d=[];for(let m=0;m<this.inputs.length;++m)d.push({key:this.inputs[m],value:s[m]});const h=new ba(d),f=yf(this.outputs,h,{training:!0});let p;for(let m=0;m<this.lossFunctions.length;++m){const g=this.lossFunctions[m];let y=g(r[m],f[m]);o[m]!=null&&(y=Ihe(y,o[m]));const b=Zt(y);n.push(b),m===0?p=y:p=ce(p,y)}for(let m=0;m<this.metricsTensors.length;++m){let g;if(this.outputs.length>1&&m<this.outputs.length)g=n[m];else{const y=this.metricsTensors[m][0],b=this.metricsTensors[m][1];g=Zt(y(r[b],f[b]))}Cn(g),i.push(g)}return p=Zt(p),this.calculateLosses().forEach(m=>{p=ce(p,m)}),p},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(a,!0,l)].concat(i)}}makeTestFunction(){this.testFunction=e=>Q(()=>{const n=[];let s;const r=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let u=0;u<this.inputs.length;++u)i.push({key:this.inputs[u],value:r[u]});const a=new ba(i),l=yf(this.outputs,a);for(let u=0;u<this.lossFunctions.length;++u){const c=this.lossFunctions[u],d=Zt(c(o[u],l[u]));u===0?s=d:s=ce(s,d),n.push(s)}for(let u=0;u<this.metricsTensors.length;++u){const c=this.metricsTensors[u][0],d=this.metricsTensors[u][1],h=Zt(c(o[d],l[d]));n.push(h)}return n})}async fit(e,n,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,o,i,a,l,u,c,d,h;try{const f=s.batchSize==null?32:s.batchSize;I1(f);const m=await this.standardizeUserData(e,n,s.sampleWeight,s.classWeight,!1,f);r=m[0],o=m[1],h=m[2];let g=!1,y;if(s.validationData!=null&&s.validationData.length>0){if(g=!0,s.validationData.length===2)l=s.validationData[0],u=s.validationData[1];else throw s.validationData.length===3?new Ye("validationData including sample weights is not supported yet."):new U(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const E=await this.standardizeUserData(l,u,null,null,!0,f);c=E[0],d=E[1],y=c.concat(d)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){g=!0;const I=Math.floor(r[0].shape[0]*(1-s.validationSplit)),E=r[0].shape[0];c=af(r,I,E),i=r,r=af(r,0,I),d=af(o,I,E),a=o,o=af(o,0,I),y=c.concat(d)}else s.validationSteps!=null&&(g=!0);const b=r.concat(o).concat(h);this.checkTrainableWeightsConsistency();const v=this.makeTrainFunction(),x=this.getDedupedMetricsNames();let w,S;g?(this.makeTestFunction(),w=this.testFunction,S=x.slice().concat(x.map(I=>"val_"+I))):(w=null,y=[],S=x.slice());const C=Rz(s.callbacks,s.yieldEvery);return await this.fitLoop(v,b,x,f,s.epochs,s.verbose,C,w,y,s.shuffle,S,s.initialEpoch,null,null)}finally{this.isTraining=!1,ro(r,e),ro(o,n),ro(i,e),ro(a,n),ro(c,l),ro(d,u),h!=null&&Qe(h)}}async fitLoop(e,n,s,r,o,i,a,l,u,c,d,h,f,p){r==null&&(r=32),o==null&&(o=1),c==null&&(c=!0),h==null&&(h=0);let m=!1;if(l!=null&&u!=null&&(m=!0),p!=null&&(m=!0,f==null))throw new U("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const g=this.checkNumSamples(n,r,f,"steps_per_epoch");let y;g!=null&&(y=ko(0,g)),i==null&&(i=1);const{callbackList:b,history:v}=_z(a,i,o,h,g,f,r,m,d);b.setModel(this),this.history=v,await b.onTrainBegin(),this.stopTraining_=!1;for(let x=h;x<o;++x){await b.onEpochBegin(x);const w={};if(f!=null)throw new Ye("stepsPerEpoch mode is not implemented yet.");{if(c==="batch")throw new Ye("batch shuffling is not implemneted yet");c&&zN(y);const S=qn(y),C=E1(g,r);for(let N=0;N<C.length;++N){const I={};if(await b.onBatchBegin(N,I),Q(()=>{const E=C[N][0],A=C[N][1],z=ql(S,E,A-E);I.batch=N,I.size=A-E;const V=tC(n,z),P=e(V);for(let K=0;K<s.length;++K){const Y=s[K],te=P[K];I[Y]=te,Cn(te)}if(N===C.length-1&&m){const K=this.testLoop(l,u,r);for(let Y=0;Y<s.length;++Y){const te=s[Y],F=K[Y];Cn(F),w["val_"+te]=F}}}),await b.onBatchEnd(N,I),Ez(I),this.stopTraining_)break}S.dispose()}if(await b.onEpochEnd(x,w),this.stopTraining_)break}return await b.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return _he(this,e,n)}async trainOnBatch(e,n){const s=await this.standardizeUserData(e,n),r=s[0],o=s[1],a=this.makeTrainFunction()(r.concat(o)),l=[];for(const u of a){const c=await u.data();l.push(c[0])}return Qe(a),ro(s[0],e),ro(s[1],n),Is(l)}getNamedWeights(e){const n=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,o=this.getWeights(s);for(let i=0;i<r.length;++i)s&&!r[i].trainable||n.push({name:r[i].originalName,tensor:o[i]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=M0().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-M0().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=pi(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>pi(n))}else{const n=Object.keys(this.loss);e={};const s=this.loss;for(const r of n)if(typeof s[r]=="string")e[r]=pi(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[pi(vy(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>pi(vy(e)));{const e={};for(const n in this.metrics)e[n]=pi(vy(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=Jk(e.optimizer_config),s=wi(n);let r;if(typeof e.loss=="string")r=Sl(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(i=>Sl(i));else if(e.loss!=null){r={};for(const i in e.loss)r[i]=Sl(e.loss[i])}let o;if(Array.isArray(e.metrics))o=e.metrics.map(i=>Sl(i));else if(e.metrics!=null){o={};for(const i in e.metrics)o[i]=Sl(e.metrics[i])}this.compile({loss:r,metrics:o,optimizer:s})}async save(e,n){if(typeof e=="string"){const u=e3(e);if(u.length===0)throw new U(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new U(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new U("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await Ck(this.getNamedWeights(n)),a={modelTopology:this.toJSON(null,!1),format:zhe,generatedBy:`TensorFlow.js tfjs-layers v${Mz}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:c,specs:d}=await Ck(await this.optimizer.getWeights(),u);s.specs.push(...d),s.data=QP([s.data,c])}return this.userDefinedMetadata!=null&&(t_(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,e.save(a)}setUserDefinedMetadata(e){t_(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}kc.className="Model";he(kc);class Wz extends kc{}Wz.className="Functional";he(Wz);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class bp extends kc{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:nw("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new U(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof bp||e instanceof kc;let s;if(n){if(s=e,s.outputs.length!==1)throw new U("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new U("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new U("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=Vde({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new U(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new U("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=Cz(this.outputs[0])}this.inboundNodes=[],new rw({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:fu(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(xt(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new kc({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,s=console.log){this.built||this.build(),super.summary(e,n,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,s={}){if(!this.built)throw new Gr("The model needs to be compiled before being used.");return this.model.evaluate(e,n,s)}async evaluateDataset(e,n){if(!this.built)throw new Gr("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,s={}){if(!this.built)throw new Gr("The model needs to be compiled before being used.");return this.model.fit(e,n,s)}async fitDataset(e,n){if(!this.built)throw new Gr("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,s={},r=!1){let o,i={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new U("Legacy serialization format not supported yet.");o=n}else T(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),o=n.layers,delete n.layers,i=n;const a=new e(i);if(!(a instanceof bp))throw new Ye(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of o){const c=wi(l,void 0,r);r&&c.setFastWeightInitDuringBuild(!0),a.add(c)}return a}set stopTraining(e){if(this.model==null)throw new U("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new U("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),e.push(s)}return{name:this.name,layers:e}}}bp.className="Sequential";he(bp);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let cs=class extends Au{getConfig(){return{}}};class jz extends cs{apply(e,n=1){return Nde(e,n)}}jz.className="elu";he(jz);class Gz extends cs{apply(e){return _x(e)}}Gz.className="selu";he(Gz);class Hz extends cs{apply(e){return Io(e)}}Hz.className="relu";he(Hz);class qz extends cs{apply(e){return Q(()=>Va(6,Io(e)))}}qz.className="relu6";he(qz);class Kz extends cs{apply(e){return e}}Kz.className="linear";he(Kz);class Xz extends cs{apply(e){return vo(e)}}Xz.className="sigmoid";he(Xz);class Yz extends cs{apply(e){return $de(e)}}Yz.className="hardSigmoid";he(Yz);class Qz extends cs{apply(e){return Eu(e)}}Qz.className="softplus";he(Qz);class Zz extends cs{apply(e){return Tde(e)}}Zz.className="softsign";he(Zz);class Jz extends cs{apply(e){return Ba(e)}}Jz.className="tanh";he(Jz);let lI=class extends cs{apply(e,n=-1){return Nh(e,n)}};lI.className="softmax";he(lI);class eB extends cs{apply(e,n=-1){return Cx(e,n)}}eB.className="logSoftmax";he(eB);class tB extends cs{apply(e){return Q(()=>Q(()=>{const n=Math.sqrt(2),s=L(.5,ce(1,wx(Fe(e,n))));return L(e,s)}))}}tB.className="gelu";he(tB);class nB extends cs{apply(e){return Q(()=>L(.5,L(e,ce(1,Ba(L(Mn(Fe(2,Math.PI)),ce(e,L(.044715,Zo(e,3)))))))))}}nB.className="gelu_new";he(nB);class sB extends cs{apply(e){return Q(()=>L(e,Ba(Eu(e))))}}sB.className="mish";he(sB);class rB extends cs{apply(e,n=1){return Q(()=>L(vo(L(e,n)),e))}}rB.className="swish";he(rB);function Wa(t){return t.getClassName()}function R1(t,e={}){return Ng(t,mr.getMap().classNameMap,e,"activation")}function ja(t){if(t==null){const e={};return e.className="linear",e.config={},R1(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},R1(e)}else return t instanceof cs?t:R1(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Bhe(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class oB extends Au{}class iB extends oB{constructor(e){super(),Bhe(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return Q(()=>{let n=dn([1]);return this.hasL1&&(n=ce(n,_e(L(this.l1,bn(e))))),this.hasL2&&(n=ce(n,_e(L(this.l2,$g(e))))),B(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}iB.className="L1L2";he(iB);const a_={l1l2:"L1L2"};function Rt(t){return K$(t)}function l_(t,e={}){return Ng(t,mr.getMap().classNameMap,e,"regularizer")}function Gt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in a_?a_[t]:t,config:{}};return l_(n)}else return t instanceof oB?t:l_(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class aB extends at{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=He(e);let s=Io(e);return this.maxValue!=null&&(s=Os(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}aB.className="ReLU";he(aB);class lB extends at{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=He(e);return ug(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}lB.className="LeakyReLU";he(lB);class uB extends at{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=jt(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Gt(e.alphaRegularizer),this.alphaConstraint=In(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new U(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=xt(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)n[r-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new Tn({ndim:e.length,axes:s})],this.built=!0}call(e,n){return e=He(e),gg(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Jt(this.alphaInitializer),alphaRegularizer:Rt(this.alphaRegularizer),alphaConstraint:$n(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}uB.className="PReLU";he(uB);let cB=class extends at{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Ye(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=He(e);return wh(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};cB.className="ELU";he(cB);class dB extends at{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const s=He(e);return L(s,be(Bs(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}dB.className="ThresholdedReLU";he(dB);class hB extends at{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new lI().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return Q(()=>{let s=He(e);const r=n.mask;if(r!=null){const o=L(Te(Es(s.shape),be(r,s.dtype)),ze(-1e9));s=ce(s,o)}return this.axis instanceof Array?this.axis.length>1?Fs(Te(s,dg(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}hB.className="Softmax";he(hB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Cc(t,e,n){if(typeof t=="number")return fu(t,e);if(t.length!==e)throw new U(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const r=t[s];if(!wde(r))throw new U(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${r}`)}return t}function xo(t,e,n,s,r=1){if(t==null)return t;const o=e+(e-1)*(r-1);let i;return n==="same"?i=t:i=t-o+1,Math.floor((i+s-1)/s)}function Mo(t,e,n,s){if(t==null)return null;if(s==="valid")t=t*e+Ua([n-e,0]);else if(s==="same")t=t*e;else throw new U(`Unsupport padding mode: ${s}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function uI(t,e){return Q(()=>(mn(e),e==="channelsFirst"?dt(t,[0,2,3,1]):t))}function fB(t,e){return Q(()=>(mn(e),e==="channelsFirst"?dt(t,[0,2,3,4,1]):t))}function Vhe(t,e,n,s=1,r="valid",o,i=1){return Q(()=>{if(o==null&&(o=Co()),mn(o),t.shape.length!==3)throw new U(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new U(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new U(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(o==="channelsFirst"&&(t=dt(t,[0,2,1])),r==="causal")throw new Ye("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=yx(t,e,s,r==="same"?"same":"valid","NWC",i);return n!=null&&(a=Eo(a,n)),a})}function u_(t,e,n,s=[1,1],r="valid",o,i,a=null){return Q(()=>{if(o==null&&(o=Co()),mn(o),t.rank!==3&&t.rank!==4)throw new U(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new U(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=uI(t,o);if(r==="causal")throw new Ye("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=tM({x:l,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:n,activation:a}),o==="channelsFirst"&&(l=dt(l,[0,3,1,2])),l})}function Uhe(t,e,n,s=[1,1,1],r="valid",o,i){return Q(()=>{if(o==null&&(o=Co()),mn(o),t.rank!==4&&t.rank!==5)throw new U(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new U(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=fB(t,o);if(r==="causal")throw new Ye("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=wT(a,e,s,r==="same"?"same":"valid","NDHWC",i),n!=null&&(a=Eo(a,n)),o==="channelsFirst"&&(a=dt(a,[0,4,1,2,3])),a})}class aw extends at{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",aw.verifyArgs(n),this.rank=e,Ln(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Ye(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Cc(n.kernelSize,e,"kernelSize"),this.strides=Cc(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,Ir(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,mn(this.dataFormat),this.activation=ja(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=jt(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=In(n.biasConstraint),this.biasRegularizer=Gt(n.biasRegularizer),this.activityRegularizer=Gt(n.activityRegularizer),this.dilationRate=Cc(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new U(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new U(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new U(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(Po("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!X$(e.kernelSize,"number",1,3))throw new U(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Wa(this.activation),useBias:this.useBias,biasInitializer:Jt(this.biasInitializer),biasRegularizer:Rt(this.biasRegularizer),activityRegularizer:Rt(this.activityRegularizer),biasConstraint:$n(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class $h extends aw{constructor(e,n){super(e,n),this.kernel=null,$h.verifyArgs(n),this.filters=n.filters,Ln(this.filters,"filters"),this.kernelInitializer=jt(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=In(n.kernelConstraint),this.kernelRegularizer=Gt(n.kernelRegularizer)}build(e){e=xt(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new U(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(e,n){return Q(()=>{e=He(e);let s;const r=this.bias==null?null:this.bias.read(),o=uz(this.activation.getClassName());if(o!=null&&this.rank===2)s=u_(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,o);else{if(this.rank===1)s=Vhe(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=u_(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=Uhe(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Ye("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=xt(e);const n=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let o=0;o<s.length;++o){const i=xo(s[o],this.kernelSize[o],this.padding,this.strides[o],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[o]);n.push(i)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(n),r.push(this.filters)):(r.push(this.filters),r=r.concat(n)),r}getConfig(){const e={filters:this.filters,kernelInitializer:Jt(this.kernelInitializer),kernelRegularizer:Rt(this.kernelRegularizer),kernelConstraint:$n(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new U(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class _g extends $h{constructor(e){super(2,e),_g.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!X$(e.kernelSize,"number",1,2))throw new U(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}_g.className="Conv2D";he(_g);class Ag extends $h{constructor(e){super(3,e),Ag.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new U(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}Ag.className="Conv3D";he(Ag);class pB extends _g{constructor(e){if(super(e),this.inputSpec=[new Tn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new U(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=xt(e),e.length!==4)throw new U("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new U("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Tn({ndim:4,axes:{[n]:s}})],this.built=!0}call(e,n){return Q(()=>{let s=He(e);if(s.shape.length!==4)throw new U(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,o=r[0];let i,a;this.dataFormat==="channelsFirst"?(i=2,a=3):(i=1,a=2);const l=r[i],u=r[a],c=this.kernelSize[0],d=this.kernelSize[1],h=this.strides[0],f=this.strides[1],p=Mo(l,h,c,this.padding),m=Mo(u,f,d,this.padding),g=[o,p,m,this.filters];this.dataFormat!=="channelsLast"&&(s=dt(s,[0,2,3,1]));let y=bx(s,this.kernel.read(),g,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(y=dt(y,[0,3,1,2])),this.bias!=null&&(y=Eo(y,this.bias.read(),this.dataFormat)),this.activation!=null&&(y=this.activation.apply(y)),y})}computeOutputShape(e){e=xt(e);const n=e.slice();let s,r,o;this.dataFormat==="channelsFirst"?(s=1,r=2,o=3):(s=3,r=1,o=2);const i=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],u=this.strides[1];return n[s]=this.filters,n[r]=Mo(n[r],l,i,this.padding),n[o]=Mo(n[o],u,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}pB.className="Conv2DTranspose";he(pB);class mB extends Ag{constructor(e){if(super(e),this.inputSpec=[new Tn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new U(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=xt(e),e.length!==5)throw new U("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new U("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Tn({ndim:5,axes:{[n]:s}})],this.built=!0}call(e,n){return Q(()=>{let s=He(e);if(s.shape.length!==5)throw new U(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,o=r[0];let i,a,l;this.dataFormat==="channelsFirst"?(l=2,i=3,a=4):(l=1,i=2,a=3);const u=r[l],c=r[i],d=r[a],h=this.kernelSize[0],f=this.kernelSize[1],p=this.kernelSize[2],m=this.strides[0],g=this.strides[1],y=this.strides[2],b=Mo(u,m,h,this.padding),v=Mo(c,g,f,this.padding),x=Mo(d,y,p,this.padding),w=[o,b,v,x,this.filters];this.dataFormat!=="channelsLast"&&(s=dt(s,[0,2,3,4,1]));let S=ST(s,this.kernel.read(),w,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(S=dt(S,[0,4,1,2,3])),this.bias!==null&&(S=Eo(S,this.bias.read(),this.dataFormat)),this.activation!==null&&(S=this.activation.apply(S)),S})}computeOutputShape(e){e=xt(e);const n=e.slice();let s,r,o,i;this.dataFormat==="channelsFirst"?(s=1,r=2,o=3,i=4):(s=4,r=1,o=2,i=3);const a=this.kernelSize[0],l=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],d=this.strides[1],h=this.strides[2];return n[s]=this.filters,n[r]=Mo(n[r],c,a,this.padding),n[o]=Mo(n[o],d,l,this.padding),n[i]=Mo(n[i],h,u,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}mB.className="Conv3DTranspose";he(mB);class gB extends $h{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new U("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new U("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new U(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=jt(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Gt(n.depthwiseRegularizer),this.depthwiseConstraint=In(n.depthwiseConstraint),this.pointwiseInitializer=jt(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Gt(n.pointwiseRegularizer),this.pointwiseConstraint=In(n.pointwiseConstraint)}build(e){if(e=xt(e),e.length<this.rank+2)throw new U(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new U(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const s=e[n],r=this.kernelSize.concat([s,this.depthMultiplier]),o=[];for(let a=0;a<this.rank;++a)o.push(1);o.push(s*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",o,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new Tn({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(e,n){return Q(()=>{e=He(e);let s;if(this.rank===1)throw new Ye("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=dt(e,[0,2,3,1])),s=Ax(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=Eo(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=dt(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Jt(this.depthwiseInitializer),e.pointwiseInitializer=Jt(this.pointwiseInitializer),e.depthwiseRegularizer=Rt(this.depthwiseRegularizer),e.pointwiseRegularizer=Rt(this.pointwiseRegularizer),e.depthwiseConstraint=$n(this.depthwiseConstraint),e.pointwiseConstraint=$n(this.pointwiseConstraint),e}}gB.className="SeparableConv";class yB extends gB{constructor(e){super(2,e)}}yB.className="SeparableConv2D";he(yB);class lw extends $h{constructor(e){super(1,e),lw.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!X$(e.kernelSize,"number",1,1))throw new U(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}lw.className="Conv1D";he(lw);class bB extends at{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return Q(()=>{if(e=He(e),this.dataFormat==="channelsLast"){const s=by(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return by(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=by(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return by(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}bB.className="Cropping2D";he(bB);class vB extends at{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,mn(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,bde(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,s]}else{const n=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],n,s,e[3]]}}call(e,n){return Q(()=>{let s=He(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=dt(s,[0,2,3,1]);const o=this.size[0]*r[2],i=this.size[1]*r[3],a=this.interpolation==="nearest"?br.resizeNearestNeighbor(s,[o,i]):br.resizeBilinear(s,[o,i]);return dt(a,[0,3,1,2])}else{const o=this.size[0]*r[1],i=this.size[1]*r[2];return this.interpolation==="nearest"?br.resizeNearestNeighbor(s,[o,i]):br.resizeBilinear(s,[o,i])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}vB.className="UpSampling2D";he(vB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Whe(t,e,n=[1,1],s="valid",r,o){return Q(()=>{r==null&&(r=Co()),mn(r);let i=uI(t,r);if(t.rank!==4)throw new U(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new U(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return i=xh(i,e,n,s==="same"?"same":"valid","NHWC",o),r==="channelsFirst"&&(i=dt(i,[0,3,1,2])),i})}class xB extends aw{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=jt(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=In(e.depthwiseConstraint),this.depthwiseRegularizer=Gt(e.depthwiseRegularizer)}build(e){if(e=xt(e),e.length<4)throw new U(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new U(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const s=e[n],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return Q(()=>{e=He(e);let s=Whe(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=Eo(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=xt(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,o=xo(n,this.kernelSize[0],this.padding,this.strides[0]),i=xo(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,o,i]:[e[0],o,i,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Jt(this.depthwiseInitializer),e.depthwiseRegularizer=Rt(this.depthwiseRegularizer),e.depthwiseConstraint=$n(this.depthwiseRegularizer),e}}xB.className="DepthwiseConv2D";he(xB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wB(t,e,n,s){if(Array.isArray(t)){if(e!=null||n!=null)throw new U("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=t.slice(t.length-s,t.length),t=t.slice(0,t.length-s)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function r(o){return o==null||Array.isArray(o)?o:[o]}return e=r(e),n=r(n),{inputs:t,initialState:e,constants:n}}function SB(t,e,n,s=!1,r,o,i=!1,a=!1){return Q(()=>{const l=e.shape.length;if(l<3)throw new U(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(ko(2,l));if(e=dt(e,u),o!=null)throw new Ye("The rnn() functoin of the deeplearn.js backend does not support constants yet.");i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=be(be(r,"bool"),"float32"),r.rank===l-1&&(r=jn(r,-1)),r=dt(r,u)),s&&(e=Cr(e,0),r!=null&&(r=Cr(r,0)));const c=[];let d,h=n;const f=e.shape[0],p=Nr(e);let m;r!=null&&(m=Nr(r));for(let y=0;y<f;++y){const b=p[y],v=Q(()=>t(b,h));if(r==null)d=v[0],h=v[1];else{const x=Q(()=>{const w=m[y],S=Te(tr(w),w),C=ce(L(v[0],w),L(h[0],S)),N=h.map((I,E)=>ce(L(v[1][E],w),L(I,S)));return{output:C,newStates:N}});d=x.output,h=x.newStates}a&&c.push(d)}let g;return a&&(g=Ls(c,1)),[d,g,h]})}class ol extends at{constructor(e){super(e);let n;if(e.cell==null)throw new U("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new hI({cells:e.cell}):n=e.cell,n.stateSize==null)throw new U("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Tn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return ko(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){Yk(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const o=[];for(const i of n)o.push([e[0],i]);return[r].concat(o)}else return r}computeMask(e,n){return Q(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const r=this.states.map(o=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<e;++s)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Ye("Constants support is not implemented in RNN yet.");Yk(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new Tn({shape:[n,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let o;if(Array.isArray(this.cell.stateSize)?o=this.cell.stateSize:o=[this.cell.stateSize],this.stateSpec!=null){if(!ut(this.stateSpec.map(i=>i.shape[i.shape.length-1]),o))throw new U(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=o.map(i=>new Tn({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){Q(()=>{if(!this.stateful)throw new Lo("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new U("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>dn([s,r])):this.states_=[dn([s,this.cell.stateSize])];else if(e==null)Qe(this.states_),this.keptStates!=null&&(Qe(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>dn([s,r])):this.states_[0]=dn([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new U(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):Qe(this.states_);for(let r=0;r<this.states_.length;++r){const o=e[r],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,a=[s,i];if(!ut(o.shape,a))throw new U(`State ${r} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${o.shape}`);this.states_[r]=o}}this.states_=this.states_.map(r=>Cn(r.clone()))})}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const o=wB(e,s,r,this.numConstants);e=o.inputs,s=o.initialState,r=o.constants;let i=[],a=[];if(s!=null){n.initialState=s,i=i.concat(s),this.stateSpec=[];for(const u of s)this.stateSpec.push(new Tn({shape:u.shape}));a=a.concat(this.stateSpec)}if(r!=null&&(n.constants=r,i=i.concat(r),this.numConstants=r.length),i[0]instanceof ei){const u=[e].concat(i),c=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=c;const h=super.apply(u,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return Q(()=>{const s=n==null?null:n.mask,r=n==null?null:n.training;let o=n==null?null:n.initialState;e=He(e),o==null&&(this.stateful?o=this.states_:o=this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(o.length!==i)throw new U(`RNN Layer has ${i} state(s) but was passed ${o.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:r},u=SB((p,m)=>{const g=this.cell.call([p].concat(m),a);return[g[0],g.slice(1)]},e,o,this.goBackwards,s,null,this.unroll,this.returnSequences),c=u[0],d=u[1],h=u[2];this.stateful&&this.resetStates(h,r);const f=this.returnSequences?d:c;return this.returnState?[f].concat(h):f})}getInitialState(e){return Q(()=>{let n=dn(e.shape);return n=_e(n,[1,2]),n=Tg(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?Kk(n,[1,s]):n):this.cell.stateSize>1?[Kk(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===ol.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),n)}static fromConfig(e,n,s={}){const r=n.cell,o=wi(r,s);return new e(Object.assign(n,{cell:o}))}}ol.className="RNN";he(ol);class uw extends at{}class cI extends uw{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Ln(this.units,"units"),this.activation=ja(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=jt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=jt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=jt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Gt(e.kernelRegularizer),this.recurrentRegularizer=Gt(e.recurrentRegularizer),this.biasRegularizer=Gt(e.biasRegularizer),this.kernelConstraint=In(e.kernelConstraint),this.recurrentConstraint=In(e.recurrentConstraint),this.biasConstraint=In(e.biasConstraint),this.dropout=cd([1,Ua([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=cd([1,Ua([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=xt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return Q(()=>{if(e=e,e.length!==2)throw new U(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ga({ones:()=>tr(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ga({ones:()=>tr(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let o;const i=this.dropoutMask,a=this.recurrentDropoutMask;i!=null?o=Xo(L(e,i),this.kernel.read()):o=Xo(e,this.kernel.read()),this.bias!=null&&(o=Eo(o,this.bias.read())),a!=null&&(s=L(s,a));let l=ce(o,Xo(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Wa(this.activation),useBias:this.useBias,kernelInitializer:Jt(this.kernelInitializer),recurrentInitializer:Jt(this.recurrentInitializer),biasInitializer:Jt(this.biasInitializer),kernelRegularizer:Rt(this.kernelRegularizer),recurrentRegularizer:Rt(this.recurrentRegularizer),biasRegularizer:Rt(this.biasRegularizer),activityRegularizer:Rt(this.activityRegularizer),kernelConstraint:$n(this.kernelConstraint),recurrentConstraint:$n(this.recurrentConstraint),biasConstraint:$n(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}cI.className="SimpleRNNCell";he(cI);class kB extends ol{constructor(e){e.cell=new cI(e),super(e)}call(e,n){return Q(()=>{this.cell.dropoutMask!=null&&(Qe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Qe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}static fromConfig(e,n){return new e(n)}}kB.className="SimpleRNN";he(kB);class dI extends uw{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new U("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Ln(this.units,"units"),this.activation=ja(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=ja(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=jt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=jt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=jt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Gt(e.kernelRegularizer),this.recurrentRegularizer=Gt(e.recurrentRegularizer),this.biasRegularizer=Gt(e.biasRegularizer),this.kernelConstraint=In(e.kernelConstraint),this.recurrentConstraint=In(e.recurrentConstraint),this.biasConstraint=In(e.biasConstraint),this.dropout=cd([1,Ua([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=cd([1,Ua([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=xt(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return Q(()=>{if(e=e,e.length!==2)throw new U(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training==null?!1:n.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ga({ones:()=>tr(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ga({ones:()=>tr(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,i=this.recurrentDropoutMask;let a,l,u;0<this.dropout&&this.dropout<1&&(e=L(e,o[0]));let c=Xo(e,this.kernel.read());this.useBias&&(c=Eo(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=L(r,i[0]));const d=this.recurrentKernel.read(),[h,f]=_s(d,[2*this.units,this.units],d.rank-1),p=Xo(r,h),[m,g,y]=_s(c,3,c.rank-1),[b,v]=_s(p,2,p.rank-1);a=this.recurrentActivation.apply(ce(m,b)),l=this.recurrentActivation.apply(ce(g,v));const x=Xo(L(l,r),f);u=this.activation.apply(ce(y,x));const w=ce(L(a,r),L(ce(1,Dt(a)),u));return[w,w]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Wa(this.activation),recurrentActivation:Wa(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Jt(this.kernelInitializer),recurrentInitializer:Jt(this.recurrentInitializer),biasInitializer:Jt(this.biasInitializer),kernelRegularizer:Rt(this.kernelRegularizer),recurrentRegularizer:Rt(this.recurrentRegularizer),biasRegularizer:Rt(this.biasRegularizer),activityRegularizer:Rt(this.activityRegularizer),kernelConstraint:$n(this.kernelConstraint),recurrentConstraint:$n(this.recurrentConstraint),biasConstraint:$n(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}dI.className="GRUCell";he(dI);class CB extends ol{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new dI(e),super(e)}call(e,n){return Q(()=>{this.cell.dropoutMask!=null&&(Qe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Qe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}CB.className="GRU";he(CB);class cw extends uw{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Ln(this.units,"units"),this.activation=ja(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=ja(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=jt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=jt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=jt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Gt(e.kernelRegularizer),this.recurrentRegularizer=Gt(e.recurrentRegularizer),this.biasRegularizer=Gt(e.biasRegularizer),this.kernelConstraint=In(e.kernelConstraint),this.recurrentConstraint=In(e.recurrentConstraint),this.biasConstraint=In(e.biasConstraint),this.dropout=cd([1,Ua([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=cd([1,Ua([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=xt(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const o=this.biasInitializer,i=this.units;r=new(n=class extends to{apply(l,u){const c=o.apply([i]),d=new Q$().apply([i]),h=o.apply([i*2]);return HR(HR(c,d),h)}},n.className="CustomInit",n)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return Q(()=>{const s=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new U(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const o=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ga({ones:()=>tr(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ga({ones:()=>tr(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let l,u,c,d;0<this.dropout&&this.dropout<1&&(e=L(e,i[0]));let h=Xo(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=L(r,a[0])),h=ce(h,Xo(r,this.recurrentKernel.read())),this.useBias&&(h=Eo(h,this.bias.read()));const[f,p,m,g]=_s(h,4,h.rank-1);l=this.recurrentActivation.apply(f),u=this.recurrentActivation.apply(p),c=ce(L(u,o),L(l,this.activation.apply(m))),d=this.recurrentActivation.apply(g);const y=L(d,this.activation.apply(c));return[y,y,c]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Wa(this.activation),recurrentActivation:Wa(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Jt(this.kernelInitializer),recurrentInitializer:Jt(this.recurrentInitializer),biasInitializer:Jt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Rt(this.kernelRegularizer),recurrentRegularizer:Rt(this.recurrentRegularizer),biasRegularizer:Rt(this.biasRegularizer),activityRegularizer:Rt(this.activityRegularizer),kernelConstraint:$n(this.kernelConstraint),recurrentConstraint:$n(this.recurrentConstraint),biasConstraint:$n(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}cw.className="LSTMCell";he(cw);class NB extends ol{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new cw(e),super(e)}call(e,n){return Q(()=>{this.cell.dropoutMask!=null&&(Qe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Qe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}NB.className="LSTM";he(NB);class hI extends uw{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return Q(()=>{e=e;let s=e.slice(1);const r=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?r.push(s.splice(0,a.stateSize.length)):r.push(s.splice(0,1));r.reverse();const o=[];let i;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];s=r[a],a===0?i=[e[0]].concat(s):i=[i[0]].concat(s),i=l.call(i,n),o.push(i.slice(1))}s=[];for(const a of o.slice().reverse())s.push(...a);return[i[0]].concat(s)})}build(e){Yk(e)&&(e=e[0]),e=e;let n;this.cells.forEach((s,r)=>{Hl(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=o=>({className:o.getClassName(),config:o.getConfig()}),r={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,n,s={}){const r=[];for(const o of n.cells)r.push(wi(o,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return Qk(e)}setWeights(e){const n=[];for(const s of this.cells){const r=s.weights.length,o=e.splice(r);for(let i=0;i<s.weights.length;++i)n.push([s.weights[i],o[i]])}rI(n)}}hI.className="StackedRNNCells";he(hI);function Ga(t){const{ones:e,rate:n,training:s=!1,count:r=1,dropoutFunc:o}=t,i=()=>o!=null?o(e(),n):gz(e(),n),a=()=>Ig(i,e,s);return!r||r<=1?Cn(a().clone()):Array(r).fill(void 0).map(a).map(u=>Cn(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var jhe=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};class TB extends ol{constructor(e){if(e.unroll)throw new Ye("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Ye("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Tn({ndim:5})]}call(e,n){return Q(()=>{if(this.cell.dropoutMask!=null&&(Qe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Qe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new U("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return Q(()=>{const{stateSize:n}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),o=[r[0],...r.slice(2)],i=dn(o);return Array.isArray(n)?Array(n.length).fill(i):[i]})}resetStates(e,n=!1){Q(()=>{if(!this.stateful)throw new Lo("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),o=[r[0],...r.slice(2)];if(s[0]==null)throw new U("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>dn(o)):this.states_=[dn(o)];else if(e==null)Qe(this.states_),this.keptStates!=null&&(Qe(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>dn(o)):this.states_[0]=dn(o);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new U(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):Qe(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],u=o;if(!ut(l.shape,u))throw new U(`State ${a} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>Cn(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:s,kernelSize:r,padding:o,strides:i,dilationRate:a}=this.cell,l=n==="channelsFirst",u=e[l?3:2],c=e[l?4:3],d=xo(u,r[0],o,i[0],a[0]),h=xo(c,r[1],o,i[1],a[1]);return[...e.slice(0,2),...l?[s,d,h]:[d,h,s]]}}TB.className="ConvRNN2D";class fI extends cw{constructor(e){const{filters:n,kernelSize:s,strides:r,padding:o,dataFormat:i,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,Ln(this.filters,"filters"),this.kernelSize=Cc(s,2,"kernelSize"),this.kernelSize.forEach(l=>Ln(l,"kernelSize")),this.strides=Cc(r||1,2,"strides"),this.strides.forEach(l=>Ln(l,"strides")),this.padding=o||"valid",Ir(this.padding),this.dataFormat=i||"channelsLast",mn(this.dataFormat),this.dilationRate=Cc(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>Ln(l,"dilationRate"))}build(e){var n;e=xt(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new U(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],o=4,i=this.kernelSize.concat([r,this.filters*o]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*o]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const u=this.biasInitializer,c=this.filters;l=new(n=class extends to{apply(h,f){const p=u.apply([c]),m=Es([c]),g=u.apply([c*2]);return Y$([p,m,g])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*o],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return Q(()=>{if(e.length!==3)throw new U(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training||!1,r=e[0],o=e[1],i=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ga({ones:()=>tr(r),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,u=(q,J,_)=>!J||!J[_]?q:L(J[_],q);let c=u(r,l,0),d=u(r,l,1),h=u(r,l,2),f=u(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ga({ones:()=>tr(o),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let m=u(o,p,0),g=u(o,p,1),y=u(o,p,2),b=u(o,p,3);const v=3,[x,w,S,C]=_s(this.kernel.read(),a,v),[N,I,E,A]=this.useBias?_s(this.bias.read(),a):[null,null,null,null];c=this.inputConv(c,x,N,this.padding),d=this.inputConv(d,w,I,this.padding),h=this.inputConv(h,S,E,this.padding),f=this.inputConv(f,C,A,this.padding);const[z,V,P,K]=_s(this.recurrentKernel.read(),a,v);m=this.recurrentConv(m,z),g=this.recurrentConv(g,V),y=this.recurrentConv(y,P),b=this.recurrentConv(b,K);const Y=this.recurrentActivation.apply(ce(c,m)),te=this.recurrentActivation.apply(ce(d,g)),F=ce(L(te,i),L(Y,this.activation.apply(ce(h,y)))),j=L(this.recurrentActivation.apply(ce(f,b)),this.activation.apply(F));return[j,j,F]})}getConfig(){const e=super.getConfig(),n=jhe(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),s)}inputConv(e,n,s,r){const o=Ri(e,n,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?Eo(o,s,this.dataFormat):o}recurrentConv(e,n){return Ri(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}fI.className="ConvLSTM2DCell";he(fI);class $B extends TB{constructor(e){const n=new fI(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}$B.className="ConvLSTM2D";he($B);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class pI extends at{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?n[r]:this.noiseShape[r]);return s}call(e,n){return Q(()=>{this.invokeCallHook(e,n);const s=He(e);if(0<this.rate&&this.rate<1){const r=n.training==null?!1:n.training,o=this.getNoiseShape(s);return Ig(()=>gz(s,this.rate,o,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}pI.className="Dropout";he(pI);class IB extends pI{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}IB.className="SpatialDropout1D";he(IB);class EB extends at{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,Ln(this.units,"units"),this.activation=ja(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=jt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=jt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=In(e.kernelConstraint),this.biasConstraint=In(e.biasConstraint),this.kernelRegularizer=Gt(e.kernelRegularizer),this.biasRegularizer=Gt(e.biasRegularizer),this.activityRegularizer=Gt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=xt(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=xt(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return Q(()=>{this.invokeCallHook(e,n);const s=He(e),r=uz(this.activation.getClassName());let o;return r!=null?o=Xo(s,this.kernel.read(),r,this.bias?this.bias.read():null):(o=Xo(s,this.kernel.read()),this.bias!=null&&(o=Eo(o,this.bias.read())),this.activation!=null&&(o=this.activation.apply(o))),o})}getConfig(){const e={units:this.units,activation:Wa(this.activation),useBias:this.useBias,kernelInitializer:Jt(this.kernelInitializer),biasInitializer:Jt(this.biasInitializer),kernelRegularizer:Rt(this.kernelRegularizer),biasRegularizer:Rt(this.biasRegularizer),activityRegularizer:Rt(this.activityRegularizer),kernelConstraint:$n(this.kernelConstraint),biasConstraint:$n(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}EB.className="Dense";he(EB);class RB extends at{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=xt(e);for(const n of e.slice(1))if(n==null)throw new U(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Aa(e,1)]}call(e,n){return Q(()=>{this.invokeCallHook(e,n);let s=He(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let o=2;o<s.rank;++o)r.push(o);r.push(1),s=dt(s,r)}return Cde(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}RB.className="Flatten";he(RB);class _B extends at{constructor(e){super(e),this.supportsMasking=!0,this.activation=ja(e.activation)}call(e,n){return Q(()=>{this.invokeCallHook(e,n);const s=He(e);return this.activation.apply(s)})}getConfig(){const e={activation:Wa(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}_B.className="Activation";he(_B);class AB extends at{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return Q(()=>(e=He(e),Sde(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}AB.className="RepeatVector";he(AB);class DB extends at{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const s="Total size of new array must be unchanged.",r=n.slice();let o=1,i=null;for(let l=0;l<r.length;++l){const u=r[l];if(this.isUnknown(u))if(i===null)i=l;else throw new U("Can only specifiy one unknown dimension.");else o*=u}const a=Aa(e);if(i!==null){if(o===0||a%o!==0)throw new U(s);r[i]=a/o}else if(a!==o)throw new U(s);return r}computeOutputShape(e){let n=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return Q(()=>{this.invokeCallHook(e,n);const s=He(e),r=s.shape,o=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return B(s,o)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}DB.className="Reshape";he(DB);class OB extends at{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=ko(1,e.dims.length+1);if(!ut(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Tn({ndim:this.dims.length+1})]}computeOutputShape(e){e=xt(e);const n=e.slice();return this.dims.forEach((s,r)=>{n[r+1]=e[s]}),n}call(e,n){return dt(He(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}OB.className="Permute";he(OB);class FB extends at{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const s=He(e);return hp(uu(s,this.maskValue),-1)}call(e,n){return Q(()=>{this.invokeCallHook(e,n);const s=He(e),i=hp(uu(s,this.maskValue),-1,!0);return L(s,be(i,s.dtype))})}}FB.className="Masking";he(FB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class LB extends at{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Ct(e.inputLength))}this.inputDim=e.inputDim,Ln(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Ln(this.outputDim,"outputDim"),this.embeddingsInitializer=jt(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Gt(e.embeddingsRegularizer),this.activityRegularizer=Gt(e.activityRegularizer),this.embeddingsConstraint=In(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return Q(()=>this.maskZero?(e=He(e),uu(e,ft(e))):null)}computeOutputShape(e){if(e=xt(e),this.inputLength==null)return[...e,this.outputDim];const n=Ct(this.inputLength);if(n.length!==e.length-1)throw new U(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<n.length;++r){const o=n[r],i=e[r+1];if(o!=null&&i!=null&&o!==i)throw new U(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);o==null&&(n[s]=i),s++}}return[e[0],...n,this.outputDim]}call(e,n){return Q(()=>{this.invokeCallHook(e,n);let s=He(e);s.dtype!=="int32"&&(s=Ko(s,"int32"));const r=mz(this.embeddings.read(),B(s,[s.size]));return B(r,xt(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Jt(this.embeddingsInitializer),embeddingsRegularizer:Rt(this.embeddingsRegularizer),activityRegularizer:Rt(this.activityRegularizer),embeddingsConstraint:$n(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}LB.className="Embedding";he(LB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Ou extends at{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Ye}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const s=e.slice(0,e.length-n.length);for(let r=0;r<n.length;++r){const o=e[e.length-n.length+r],i=n[r];if(o==null||i==null||o<0||i<0)s.push(null);else if(o===1)s.push(i);else if(i===1)s.push(o);else{if(o!==i)throw new U("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));s.push(o)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[xt(e)]),e=e,e.length<2)throw new U(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const o of e)o!=null&&o[0]!==null&&n.push(o[0]);if(n=_a(n),n.length>1)throw new U(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let o=1;o<e.length;++o){const i=e[o]==null?null:e[o].slice(1);s=this.computeElementwiseOpOutputShape(s,i)}const r=e.map(o=>o.length);e.indexOf(null)===-1&&_a(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return Q(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(o=>o.rank);if(r.indexOf(null)===-1){const o=Ua(r);for(let i of e){const a=i.rank;for(let l=0;l<o-a;++l)i=Tg(i,1);s.push(i)}return this.mergeFunction(s)}else{let o=!1;for(const l of e){const u=l.rank;if(u==null){const c=l.shape,d=c[0],h=c.slice(1).concat([d]);let f=B(l,[d].concat(Aa(c.slice(1))));f=dt(f,[1,0]),f=B(f,h),s.push(f),o=!0}else if(u>1){const c=ko(1,u).concat([0]);s.push(dt(l,c)),o=!0}else s.push(l)}let i=this.mergeFunction(s);const a=i.rank;if(o){if(a==null){const l=i.shape,u=l.length,c=l[u-1],d=[c].concat(l.slice(0,l.length-1));i=B(dt(B(i,[-1,c]),[1,0]),d)}else if(a>1){const l=[a-1].concat(ko(0,a-1));i=dt(i,l)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let r=1;r<e.length;++r){const o=e[r]==null?null:e[r].slice(1);n=this.computeElementwiseOpOutputShape(n,o)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=_a(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(e,n){return Q(()=>{if(n==null)return null;if(!Array.isArray(n))throw new U("`mask` should be an Array");if(!Array.isArray(e))throw new U("`inputs` should be an Array");if(n.length!==e.length)throw new U(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(r=>r==null))return null;n=n.map(r=>r==null?r:jn(r,0));let s=n[0];for(let r=1;r<n.length-1;++r)s=So(s,n[r]);return s})}}class PB extends Ou{constructor(e){super(e)}mergeFunction(e){return Q(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ce(n,e[s]);return n})}}PB.className="Add";he(PB);class MB extends Ou{constructor(e){super(e)}mergeFunction(e){return Q(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=L(n,e[s]);return n})}}MB.className="Multiply";he(MB);class zB extends Ou{constructor(e){super(e)}mergeFunction(e){return Q(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ce(n,e[s]);return L(1/e.length,n)})}}zB.className="Average";he(zB);class BB extends Ou{constructor(e){super(e)}mergeFunction(e){return Q(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=ii(n,e[s]);return n})}}BB.className="Maximum";he(BB);class VB extends Ou{constructor(e){super(e)}mergeFunction(e){return Q(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Va(n,e[s]);return n})}}VB.className="Minimum";he(VB);class UB extends Ou{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new U("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const r of e)if(r!=null){n=!1;break}if(n)return;const s=[];for(let r=0;r<e.length;++r){const o=e[r].slice();o.splice(this.axis,1);let i=!1;for(const a of s)if(ut(a,o)){i=!0;break}i||s.push(o)}if(s.length>1)throw new U("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return Q(()=>Y$(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new U("A `Concatenate` layer should be called on a list of inputs.");const n=e,s=n[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const o of n.slice(1)){if(s[r]==null||o[r]==null){s[r]=null;break}s[r]+=o[r]}return s}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new U("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new U("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new U(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return Q(()=>{let s=!0;if(n.forEach(i=>{if(i!=null){s=!1;return}}),s)return null;const r=[];for(let i=0;i<e.length;++i)n[i]==null?r.push(be(tr(e[i]),"bool")):n[i].rank<e[i].rank?r.push(jn(n[i],-1)):r.push(n[i]);const o=hn(r,this.axis);return gx(o,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}UB.className="Concatenate";he(UB);function lf(t,e){for(;t<0;)t+=e;return t}function Ghe(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Ye("batchDot is not implemented for tensors of 4D or higher rank yet");if(T(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),T(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new Ye("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,r=e.shape.length;n==null&&(n=[s-1,r-2]);const o=n;return Q(()=>{let i;if(s>r){i=s-r;const l=[];for(let u=0;u<i;++u)l.push(1);e=B(e,e.shape.concat(l))}else if(r>s){i=r-s;const l=[];for(let u=0;u<i;++u)l.push(1);t=B(t,t.shape.concat(l))}else i=0;let a;if(t.shape.length===2&&e.shape.length===2)o[0]===o[1]?a=_e(L(t,e),o[0]):a=_e(L(dt(t,[1,0]),e),o[1]);else{const l=o[0]!==t.shape.length-1,u=o[1]===e.shape.length-1;a=nt(t,e,l,u)}if(i>0){let l;s>r?l=s+r-3:l=s-1;const u=[];for(let c=l;c<l+i;++c)u.push(c);a=Ui(a,u)}return a.shape.length===1&&(a=jn(a,1)),a})}class WB extends Ou{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){T(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],s=e[1];if(n.length>3||s.length>3)throw new Ye("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);if(n[r[0]]!==s[r[1]])throw new U(`Dimension incompatibility: ${n[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new U(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((o,i)=>lf(o,e[i].shape.length)):r=[lf(this.axes,n.shape.length),lf(this.axes,s.shape.length)],this.normalize&&(n=K0(n,r[0]),s=K0(s,r[1])),Ghe(n,s,r)}interpretAxes(e,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[lf(this.axes,e.length),lf(this.axes,n.length)],s}computeOutputShape(e){T(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),s=e[1].slice();if(n.length>3||s.length>3)throw new Ye("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);n.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const o=n.concat(s);return o.length===1&&o.push(1),o}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}WB.className="Dot";he(WB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class jB extends at{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return Q(()=>{this.invokeCallHook(e,n);const s=He(e);return Ig(()=>ce(sw(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}jB.className="GaussianNoise";he(jB);class GB extends at{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return Q(()=>{this.invokeCallHook(e,n);const s=He(e);return this.rate>0&&this.rate<1?Ig(()=>{const o=Math.sqrt(this.rate/(1-this.rate));return L(s,sw(s.shape,1,o))},()=>s,n.training||!1):s})}}GB.className="GaussianDropout";he(GB);class HB extends at{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||He(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return Q(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return Ig(()=>{const o=He(e),l=-1.6732632423543772*1.0507009873554805;let u=Bi(sl(s),this.rate);u=Ko(u,"float32");const c=((1-this.rate)*(1+this.rate*l**2))**-.5,d=-c*l*this.rate,h=ce(L(o,u),L(ce(u,-1),l));return ce(L(h,c),d)},()=>He(e),n.training||!1)}return e})}}HB.className="AlphaDropout";he(HB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vp(t,e,n,s,r,o=.001){let i;if(t.rank===2)i=dT(t,e,n,s,r,o);else if(t.rank===3)i=hT(t,e,n,s,r,o);else if(t.rank===4)i=fT(t,e,n,s,r,o);else throw new Ye(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return i}function Hhe(t,e,n,s,r=.001){return Q(()=>{const o=pg(t,s),i=o.mean,a=o.variance;return[vp(t,i,a,n,e,r),i,a]})}function qhe(t,e,n,s,r=.001){return Q(()=>{const o=pg(t,s),i=o.mean,a=o.variance,l=[];for(const p of ko(0,t.rank))s.indexOf(p)!==-1?l.push(1):l.push(t.shape[p]);const u=B(i,l),c=B(a,l),d=e==null?null:B(e,l),h=n==null?null:B(n,l);return[vp(t,u,c,h,d,r),i,a]})}function Khe(t,e,n,s,r=.001){return ut(s.slice().sort(),ko(0,t.rank-1))?Hhe(t,e,n,s,r):qhe(t,e,n,s,r)}class qB extends at{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=jt(e.betaInitializer||"zeros"),this.gammaInitializer=jt(e.gammaInitializer||"ones"),this.movingMeanInitializer=jt(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=jt(e.movingVarianceInitializer||"ones"),this.betaConstraint=In(e.betaConstraint),this.gammaConstraint=In(e.gammaConstraint),this.betaRegularizer=Gt(e.betaRegularizer),this.gammaRegularizer=Gt(e.gammaRegularizer)}build(e){e=xt(e);const n=this.axis>=0?this.axis:this.axis+e.length,s=e[n];if(s==null)throw new U(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Tn({ndim:e.length,axes:{[n]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return Q(()=>{const s=n.training==null?!1:n.training,r=He(e),o=r.shape,i=o.length,a=ko(0,i),l=this.axis>=0?this.axis:this.axis+i;a.splice(l,1);const u=fu(1,i);u[l]=o[l];const c=a.slice();c.sort();const d=!ut(c,ko(0,i).slice(0,i-1)),h=()=>{if(d){const b=B(this.movingMean.read(),u),v=B(this.movingVariance.read(),u),x=this.center?B(this.beta.read(),u):null,w=this.scale?B(this.gamma.read(),u):null;return vp(r,b,v,x,w,this.epsilon)}else return vp(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return h();const[f,p,m]=Khe(r,this.gamma.read(),this.beta.read(),a,this.epsilon),g=(b,v,x)=>{Q(()=>{const w=1-x,S=b.read(),C=L(Te(S,v),w);b.write(Te(S,C))})};return(()=>{g(this.movingMean,p,this.momentum),g(this.movingVariance,m,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Jt(this.betaInitializer),gammaInitializer:Jt(this.gammaInitializer),movingMeanInitializer:Jt(this.movingMeanInitializer),movingVarianceInitializer:Jt(this.movingVarianceInitializer),betaRegularizer:Rt(this.betaRegularizer),gammaRegularizer:Rt(this.gammaRegularizer),betaConstraint:$n(this.betaConstraint),gammaConstraint:$n(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}qB.className="BatchNormalization";he(qB);class KB extends at{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=jt(e.betaInitializer||"zeros"),this.gammaInitializer=jt(e.gammaInitializer||"ones"),this.betaRegularizer=Gt(e.betaRegularizer),this.gammaRegularizer=Gt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=xt(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let o=0;o<this.axis.length;++o)this.axis[o]<0&&(this.axis[o]+=n);for(const o of this.axis)if(o<0||o>=n)throw new Error(`Invalid axis: ${o}`);if(this.axis.length!==_a(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(o=>e[o]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,n){const s=He(e),r=s.shape,o=r.length;return Q(()=>{let{mean:a,variance:l}=pg(s,this.axis,!0);const u=fu(1,o);for(const m of this.axis)u[m]=r[m];const c=m=>m!=null&&m.shape.length!==o?B(m,u):m;let d=this.scale?c(this.gamma.read()):null,h=this.center?c(this.beta.read()):null;const f=[],p=[];for(let m=0;m<o;++m)this.axis.indexOf(m)!==-1?(f.push(r[m]),p.push(1)):(f.push(1),p.push(r[m]));return a=yr(a,f),l=yr(l,f),d!=null&&(d=yr(d,p)),h!=null&&(h=yr(h,p)),vp(s,a,l,h,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Jt(this.betaInitializer),gammaInitializer:Jt(this.gammaInitializer),betaRegularizer:Rt(this.betaRegularizer),gammaRegularizer:Rt(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}KB.className="LayerNormalization";he(KB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Xhe(t,e,n){return Q(()=>{if(t.rank!==4)throw new U(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new U("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Co()),n!=="channelsLast"&&n!=="channelsFirst")throw new U(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],Vi(t,s)})}class XB extends at{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Co():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new U(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,s;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new U(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new U(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[n,s]}this.inputSpec=[new Tn({ndim:4})]}computeOutputShape(e){e=xt(e);let n,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],n,s]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],n,s,e[3]])}call(e,n){return Q(()=>Xhe(He(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}XB.className="ZeroPadding2D";he(XB);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dw(t,e,n,s,r,o){return Q(()=>{mn(r),dz(o),Ir(s),n==null&&(n=[1,1]),s==null&&(s="valid"),r==null&&(r=Co()),o==null&&(o="max"),t=uI(t,r);let i;const a=s==="same"?"same":"valid";return o==="max"?i=fg(t,e,n,a):i=og(t,e,n,a),r==="channelsFirst"&&(i=dt(i,[0,3,1,2])),i})}function YB(t,e,n,s,r,o){return Q(()=>{mn(r),dz(o),Ir(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),r==null&&(r=Co()),o==null&&(o="max"),t=fB(t,r);let i;const a=s==="same"?"same":"valid";return o==="max"?i=LT(t,e,n,a):i=cT(t,e,n,a),r==="channelsFirst"&&(i=dt(i,[0,4,1,2,3])),i})}class QB extends at{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new U(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Ln(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new U(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Ln(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Ir(this.padding),this.inputSpec=[new Tn({ndim:3})]}computeOutputShape(e){e=xt(e);const n=xo(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return Q(()=>{this.invokeCallHook(e,n),e=Tg(He(e),2);const s=this.poolingFunction(He(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Ui(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class ZB extends QB{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return mn(o),Ir(r),dw(e,n,s,r,o,"max")}}ZB.className="MaxPooling1D";he(ZB);class JB extends QB{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return mn(o),Ir(r),dw(e,n,s,r,o,"avg")}}JB.className="AveragePooling1D";he(JB);class e4 extends at{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new U(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Ln(this.poolSize,"poolSize"),Ln(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,mn(this.dataFormat),Ir(this.padding),this.inputSpec=[new Tn({ndim:4})]}computeOutputShape(e){e=xt(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=xo(n,this.poolSize[0],this.padding,this.strides[0]),s=xo(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s]:[e[0],n,s,e[3]]}call(e,n){return Q(()=>(this.invokeCallHook(e,n),this.poolingFunction(He(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class t4 extends e4{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return mn(o),Ir(r),dw(e,n,s,r,o,"max")}}t4.className="MaxPooling2D";he(t4);class n4 extends e4{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return mn(o),Ir(r),dw(e,n,s,r,o,"avg")}}n4.className="AveragePooling2D";he(n4);class s4 extends at{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new U(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Ln(this.poolSize,"poolSize"),Ln(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,mn(this.dataFormat),Ir(this.padding),this.inputSpec=[new Tn({ndim:5})]}computeOutputShape(e){e=xt(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=xo(n,this.poolSize[0],this.padding,this.strides[0]),s=xo(s,this.poolSize[1],this.padding,this.strides[1]),r=xo(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s,r]:[e[0],n,s,r,e[4]]}call(e,n){return Q(()=>(this.invokeCallHook(e,n),this.poolingFunction(He(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class r4 extends s4{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return mn(o),Ir(r),YB(e,n,s,r,o,"max")}}r4.className="MaxPooling3D";he(r4);class o4 extends s4{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return mn(o),Ir(r),YB(e,n,s,r,o,"avg")}}o4.className="AveragePooling3D";he(o4);class i4 extends at{constructor(e){super(e),this.inputSpec=[new Tn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new Ye}}class a4 extends i4{constructor(e){super(e||{})}call(e,n){return Q(()=>{const s=He(e);return Zt(s,1)})}}a4.className="GlobalAveragePooling1D";he(a4);class l4 extends i4{constructor(e){super(e||{})}call(e,n){return Q(()=>{const s=He(e);return Sr(s,1)})}}l4.className="GlobalMaxPooling1D";he(l4);class u4 extends at{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,mn(this.dataFormat),this.inputSpec=[new Tn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new Ye}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class c4 extends u4{call(e,n){return Q(()=>{const s=He(e);return this.dataFormat==="channelsLast"?Zt(s,[1,2]):Zt(s,[2,3])})}}c4.className="GlobalAveragePooling2D";he(c4);class d4 extends u4{call(e,n){return Q(()=>{const s=He(e);return this.dataFormat==="channelsLast"?Sr(s,[1,2]):Sr(s,[2,3])})}}d4.className="GlobalMaxPooling2D";he(d4);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class h4 extends at{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,s={}){const r=n.layer,o=wi(r,s);delete n.layer;const i={layer:o};return Object.assign(i,n),new e(i)}}class f4 extends h4{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=xt(e),e.length<3)throw new U(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=xt(e);const n=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(n),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,n){return Q(()=>(e=He(e),SB((i,a)=>[He(this.layer.call(i,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}f4.className="TimeDistributed";he(f4);function Yhe(t){Du(yde,"BidirectionalMergeMode",t)}const Qhe="concat";class p4 extends h4{constructor(e){super(e);const n=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=n,this.forwardLayer=wi(s),n.goBackwards=n.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=n,this.backwardLayer=wi(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?Qhe:e.mergeMode,Yhe(this.mergeMode),e.weights)throw new Ye("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,s=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,r,o;return this.returnState&&(o=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(o).concat(o.slice()):[s].concat(o).concat(o.slice()):Is(r)}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const o=wB(e,s,r,this.numConstants);if(e=o.inputs,s=o.initialState,r=o.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,n);const i=[],a=[];if(s!=null){const u=s.length;if(u%2>0)throw new U("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,i.push(...s);const c=s.map(d=>new Tn({shape:d.shape}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),a.push(...c)}if(r!=null)throw new Ye("Support for constants in Bidirectional layers is not implemented yet.");const l=i[0]instanceof ei;for(const u of i)if(u instanceof ei!==l)throw new U("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const u=[e].concat(i),c=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=c;const h=super.apply(u,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return Q(()=>{const s=n.initialState;let r,o;if(s==null)r=this.forwardLayer.call(e,n),o=this.backwardLayer.call(e,n);else{const l=s.slice(0,s.length/2),u=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),o=this.backwardLayer.call(e,Object.assign(n,{initialState:u}))}let i;this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(o.slice(1))),r=r[0],o=o[0]),this.returnSequences&&(o=Cr(o,1));let a;return this.mergeMode==="concat"?a=Y$([r,o]):this.mergeMode==="sum"?a=ce(r,o):this.mergeMode==="ave"?a=L(.5,ce(r,o)):this.mergeMode==="mul"?a=L(r,o):this.mergeMode==null&&(a=[r,o]),this.returnState?this.mergeMode==null?a.concat(i):[a].concat(i):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Hl(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Hl(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const o=this.forwardLayer.states.map(i=>null);return Array.isArray(s)?s.concat(o).concat(o):[s].concat(o).concat(o)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const s=wi(n.layer);if(delete n.layer,n.numConstants!=null)throw new Ye("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=n;return r.layer=s,new e(r)}}p4.className="Bidirectional";he(p4);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class m4 extends at{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return Q(()=>(e=He(e),e.dtype!=="float32"&&(e=Ko(e,"float32")),ce(L(e,this.scale),this.offset)))}}m4.className="Rescaling";he(m4);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:Zhe,cropAndResize:Jhe}=br;class g4 extends at{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,s,r,o,i,a,l){return Q(()=>{let u,c=!1;const d=n/i,h=s/a,f=(r+n)/i,p=(o+s)/a,m=[d,h,f,p],g=[];e.rank===3?(c=!0,u=Ls([e])):u=e;for(let w=0;w<u.shape[0];w++)g.push(m);const y=Xr(g,[g.length,4]),b=cu(0,g.length,1,"int32"),x=Jhe(u,y,b,[r,o],"nearest");return Ko(c?He(Nr(x)):x,l)})}upsize(e,n,s,r){return Q(()=>{const o=Zhe(e,[n,s]);return Ko(o,r)})}call(e,n){return Q(()=>{const s=He(e),r=s.dtype,o=s.shape,i=o[o.length-3],a=o[o.length-2];let l=0;i!==this.height&&(l=Math.floor((i-this.height)/2));let u=0;return a!==this.width&&(u=Math.floor((a-this.width)/2),u===0&&(u=1)),l>=0&&u>=0?this.centerCrop(s,l,u,this.height,this.width,i,a,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=xt(e);const n=e.length-3,s=e.length-2;return e[n]=this.height,e[s]=this.width,e}}g4.className="CenterCrop";he(g4);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function efe(t,e,n,s){let r=He(t);if(r.dtype!=="int32"&&(r=Ko(r,"int32")),e==="int")return r;const o=r.shape;if(r.rank===0&&(r=jn(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=jn(r,-1)),r.rank>2)throw new U(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${o} which would result in output rank ${r.rank}.`);const i=["multiHot","oneHot"].includes(e),a=r;let l;if(typeof s<"u"&&e==="count"?l=z0(a,s,n,i):l=z0(a,[],n,i),e!=="tfIdf")return l;if(s)return L(l,s);throw new U("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class y4 extends at{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=xt(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return Q(()=>{e=He(e),e.dtype!=="int32"&&(e=Ko(e,"int32"));let s;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new U(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);s=He(n.countWeights)}const r=Sr(e),o=rd(e),i=Bs(this.numTokens,r).bufferSync().get(0),a=Bi(o,0).bufferSync().get(0);if(!(i&&a))throw new U(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return efe(e,this.outputMode,this.numTokens,s)})}}y4.className="CategoryEncoding";he(y4);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const tfe=["bilinear","nearest"],c_=new Set(tfe);class b4 extends at{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(c_.has(e.interpolation))this.interpolation=e.interpolation;else throw new U(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=xt(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return Q(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return br.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return br.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...c_]} are supported`)})}}b4.className="Resizing";he(b4);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class v4{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}v4.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class x4 extends at{constructor(e){super(e),this.randomGenerator=new v4(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}x4.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const nfe=["bilinear","nearest"],d_=new Set(nfe);class w4 extends x4{constructor(e){super(e);const{factor:n,interpolation:s="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new U(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new U(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new U(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(d_.has(s))this.interpolation=s;else throw new U(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=xt(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return Q(()=>{const s=He(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=sl([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let o=this.widthFactor.dataSync()[0]*r;o=Math.round(o);const i=[this.imgHeight,o];switch(this.interpolation){case"bilinear":return br.resizeBilinear(e,i);case"nearest":return br.resizeNearestNeighbor(e,i);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...d_]} are supported`)}})}}w4.className="RandomWidth";he(w4);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function sfe(t,e){return S4(t,e)}function S4(t,e,n=new Map,s=new Set){if(t==null)return null;if(typeof Blob=="function"&&t instanceof Blob)return t.slice();if(s.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);const r=e(t);if(r.recurse&&r.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(r.recurse)if(hw(t)){const o=Array.isArray(t)?[]:{};s.add(t);for(const i in t){const a=t[i],l=S4(a,e,n,s);o[i]=l}return s.delete(t),t.__proto__&&(o.__proto__=t.__proto__),o}else throw new Error(`Can't recurse into non-iterable type: ${t}`);else return n.set(t,r.value),r.value}function rfe(t,e=C4){return k4(t,e)}function k4(t,e,n=new Set){const s=t[0];if(n.has(s))throw new Error("Circular references are not supported.");const r=e(t);if(r.recurse&&r.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(r.recurse)if(hw(s)){const o=Array.isArray(s)?[]:{};n.add(s);for(const i in s){const a=t.map(u=>u[i]),l=k4(a,e,n);o[i]=l}return n.delete(s),o}else throw new Error(`Can't recurse into non-iterable type: ${s}`);else return r.value}function C4(t){return t===null?null:hw(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}function hw(t){let e=!1;if(ee().get("IS_BROWSER"))e=t instanceof TextDecoder;else{const{StringDecoder:n}=require("string_decoder");e=t instanceof n}return t!=null&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||typeof t=="object"&&!(t instanceof vt)&&!(t instanceof Promise)&&!e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function ofe(t){return sfe(t,ife)}function ife(t){return t instanceof vt?{value:t.clone(),recurse:!1}:hw(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class N4{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,e==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,n){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=n}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(const n of e)this.push(n)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const n=this.wrap(this.begin+e),s=this.get(n);return this.set(n,this.pop()),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class fw extends N4{constructor(){super(fw.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){const e=this.capacity*2,n=new Array(e),s=this.length();for(let r=0;r<s;r++)n[r]=this.get(this.wrap(this.begin+r));this.data=n,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=s}}fw.INITIAL_CAPACITY=32;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function afe(t){return new lfe(t)}class Er{async toArray(){const e=[];let n=await this.next();for(;!n.done;)e.push(n.value),n=await this.next();return e}async toArrayForTest(){const e=this.prefetch(100),n=[];let s=await e.next();for(;!s.done;)n.push(s.value),s=await e.next();return n}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let n=await this.next(),s=e(n.value);for(;!n.done&&s;)n=await this.next(),s=e(n.value)}handleErrors(e){return new mfe(this,e)}filter(e){return new ffe(this,e)}map(e){return new pfe(this,e)}mapAsync(e){return new h_(this,e)}serialMapAsync(e){return new h_(this,e).serial()}flatmap(e){return new yfe(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile(n=>n===!0)}rowMajorBatch(e,n=!0){return new hfe(this,e,n)}columnMajorBatch(e,n=!0,s=C4){return this.rowMajorBatch(e,n).map(o=>rfe(o,s))}concatenate(e,n){return new bfe(afe([this,e]),n)}take(e){return e<0||e==null?this:new dfe(this,e)}skip(e){return e<0||e==null?this:new cfe(this,e)}prefetch(e){return new T4(this,e)}shuffle(e,n){return new vfe(this,e,n)}serial(){return new ufe(this)}}class lfe extends Er{constructor(e){super(),this.items=e,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const e=this.items[this.trav];return this.trav++,{value:ofe(e),done:!1}}}class ufe extends Er{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class cfe extends Er{constructor(e,n){super(),this.upstream=e,this.maxCount=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const e=await this.upstream.next();if(e.done)return e;Qe(e.value)}return this.upstream.next()}}class dfe extends Er{constructor(e,n){super(),this.upstream=e,this.maxCount=n,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class hfe extends Er{constructor(e,n,s=!0){super(),this.upstream=e,this.batchSize=n,this.enableSmallLastBatch=s,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){const e=[];for(;e.length<this.batchSize;){const n=await this.upstream.next();if(n.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(n.value)}return{value:e,done:!1}}}class ffe extends Er{constructor(e,n){super(),this.upstream=e,this.predicate=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){const e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;Qe(e.value)}}}class pfe extends Er{constructor(e,n){super(),this.upstream=e,this.transform=n}summary(){return`${this.upstream.summary()} -> Map`}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const n=Ii(e.value),s=this.transform(e.value),r=Ii(s);for(const o of n)px(o,r)||o.dispose();return{value:s,done:!1}}}class mfe extends Er{constructor(e,n){super(),this.upstream=e,this.handler=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(e){if(!this.handler(e))return{value:null,done:!0}}}}class h_ extends Er{constructor(e,n){super(),this.upstream=e,this.transform=n}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const n=Ii(e.value),s=await this.transform(e.value),r=Ii(s);for(const o of n)px(o,r)||o.dispose();return{value:s,done:!1}}}class gfe extends Er{constructor(){super(),this.outputQueue=new fw,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.outputQueue.length()===0;)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class yfe extends gfe{constructor(e,n){super(),this.upstream=e,this.transform=n}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){const e=await this.upstream.next();if(e.done)return!1;const n=Ii(e.value),s=this.transform(e.value),r=Ii(s);this.outputQueue.pushAll(s);for(const o of n)px(o,r)||o.dispose();return!0}}class bfe extends Er{constructor(e,n){super(),this.baseErrorHandler=n,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,this.iterator==null){const s=await this.moreIterators.next();if(s.done)return{value:null,done:!0};this.iterator=s.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const n=await this.iterator.next();return n.done?(this.iterator=null,this.readFromChain(e)):n}}var f_;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(f_||(f_={}));class T4 extends Er{constructor(e,n){super(),this.upstream=e,this.bufferSize=n,this.buffer=new N4(n)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){const e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}}class vfe extends T4{constructor(e,n,s){super(e,n),this.upstream=e,this.windowSize=n,this.upstreamExhausted=!1,this.random=yg.alea(s||is().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const e=this.chooseIndex(),n=await this.buffer.shuffleExcise(e);if(n.done)this.upstreamExhausted=!0;else return this.refill(),n}return{value:null,done:!0}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class mI extends Er{constructor(e,n){if(super(),this.webcamVideoElement=e,this.webcamConfig=n,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=qn([0],"int32"),this.webcamConfig.centerCrop){const s=this.webcamConfig.resizeWidth*1/this.webcamVideoElement.width,r=this.webcamConfig.resizeHeight*1/this.webcamVideoElement.height,o=(1-s)/2,i=(1-r)/2,a=o+s,l=r+i;this.cropBox=Ra([i,o,l,a],[1,4])}else this.cropBox=Ra([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(e,n={}){if(!ee().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!e){if(e=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");e.width=n.resizeWidth,e.height=n.resizeHeight}const s=new mI(e,n);return await s.start(),s}async start(){this.webcamConfig.facingMode&&T(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(e){throw e.message=`Error thrown while initializing video stream: ${e.message}`,e}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(e){console.log(e),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(e=>{this.webcamVideoElement.onloadedmetadata=()=>{e()}})}async next(){if(this.isClosed)return{value:null,done:!0};let e;try{e=x$(this.webcamVideoElement)}catch(n){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(n)}`)}if(this.resize)try{return{value:this.cropAndResizeFrame(e),done:!1}}catch(n){throw new Error(`Error thrown cropping the video: ${n.message}`)}finally{e.dispose()}else return{value:e,done:!1}}needToResize(){return!!(this.webcamConfig.resizeWidth&&this.webcamConfig.resizeHeight&&(this.webcamVideoElement.width!==this.webcamConfig.resizeWidth||this.webcamVideoElement.height!==this.webcamConfig.resizeHeight))}cropAndResizeFrame(e){return Q(()=>{const n=jn(be(e,"float32"),0);let s;s=br.cropAndResize(n,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");const r=s.shape;return B(s,r.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(n=>n.stop());try{this.webcamVideoElement.srcObject=null}catch(n){console.log(n),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */async function xfe(t,e){return mI.create(t,e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function De(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&T(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wfe=Vx;class pw extends rv{nextDataId(){return pw.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new MN(this,lo())}write(e,n,s){this.firstUse&&(this.firstUse=!1,ee().get("IS_NODE")&&pr(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&Vo(s[0])){const o=s.map(i=>Go(i));r=this.write(o,e,n)}else r=this.write(s,e,n);return{dataId:r,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,s,r,o){this.data.set(e,{values:n,dtype:r,refCount:o})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:s}=this.data.get(e);if(n==="complex64"){const r=this.readSync(s.real.dataId),o=this.readSync(s.imag.dataId);return _i(r,o)}return CP(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>$i(r));return Ze(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ze(e.shape,e.dtype,n)}makeOutput(e,n,s){return lo().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=is();return e(),{kernelMs:is()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){De([e],"where");const n=this.readSync(e.dataId);return wfe(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}pw.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $4(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const Sfe=t=>{const{x:e}=t.inputs,n=t.backend;De(e,"abs");let s=new Float32Array(oe(e.shape));const r=n.data.get(e.dataId).values;return s=$4(r),n.makeOutput(s,e.shape,e.dtype)},kfe={kernelName:Jp,backendName:"cpu",kernelFunc:Sfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gn(t){return(e,n,s,r,o)=>{const i=qe(e,n),a=i.length,l=Le(i),u=oe(i),c=Pn(o,u),d=e.length,h=n.length,f=Le(e),p=Le(n),m=lu(e,i),g=lu(n,i);if(m.length+g.length===0)for(let y=0;y<c.length;++y)c[y]=t(s[y%s.length],r[y%r.length]);else for(let y=0;y<c.length;++y){const b=Nu(y,a,l),v=b.slice(-d);m.forEach(C=>v[C]=0);const x=bo(v,d,f),w=b.slice(-h);g.forEach(C=>w[C]=0);const S=bo(w,h,p);c[y]=t(s[x],r[S])}return[c,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qs(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,o=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,a=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",o),imag:n.makeTensorInfo(r.shape,"float32",i)},a}const Cfe={kernelName:fv,backendName:"cpu",kernelFunc:qs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J0(t,e,n="float32"){if(n==="complex64"){const r=J0(t,e,"float32"),o=J0(t,e,"float32");return qs({inputs:{real:r,imag:o},backend:t})}const s=Qn(oe(e),n);return t.makeTensorInfo(e,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ti(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const Nfe={kernelName:jd,backendName:"cpu",kernelFunc:ti};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pu(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.real,o=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,o)}const Tfe={kernelName:Hv,backendName:"cpu",kernelFunc:pu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I4(t,e,n,s){if(s==="int32"){const r=Int32Array.from(t);return[e,"int32",r]}if(s==="bool"){const r=Za([0],n),[o,i]=gn((a,l)=>a!==l?1:0)(e,[],t,r,"bool");return[i,"bool",o]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function Ha(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:o}=s;if(o==="complex64"){if(r.dtype==="complex64")return ti({inputs:{x:r},backend:n});const c=J0(n,r.shape,r.dtype),d=Ha({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),h=qs({inputs:{real:d,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),h}if(r.dtype==="complex64"){const c=pu({inputs:{input:r},backend:n}),d=Ha({inputs:{x:c},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(c),d}if(!VN(r.dtype,o)){const c=ti({inputs:{x:r},backend:n});return{dataId:c.dataId,shape:c.shape,dtype:o}}const i=n.data.get(r.dataId).values,[a,l,u]=I4(i,r.shape,r.dtype,o);return n.makeTensorInfo(a,l,u)}const $fe={kernelName:_d,backendName:"cpu",kernelFunc:Ha};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function En(t,e,n,s){return n==null?({inputs:r,backend:o})=>{const{a:i,b:a}=r,l=o;De([i,a],t);const u=l.data.get(i.dataId).values,c=l.data.get(a.dataId).values,d=i.dtype==="string"?Ai(u):u,h=i.dtype==="string"?Ai(c):c,f=s||i.dtype,[p,m]=e(i.shape,a.shape,d,h,f);return l.makeTensorInfo(m,f,p)}:({inputs:r,backend:o})=>{const{a:i,b:a}=r,l=o;if(i.dtype==="complex64"||a.dtype==="complex64"){const u=Ha({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),c=l.data.get(u.dataId),d=c.complexTensorInfos.real,h=c.complexTensorInfos.imag,f=l.data.get(d.dataId).values,p=l.data.get(h.dataId).values,m=Ha({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),g=l.data.get(m.dataId),y=g.complexTensorInfos.real,b=g.complexTensorInfos.imag,v=l.data.get(y.dataId).values,x=l.data.get(b.dataId).values,[w,S,C]=n(i.shape,a.shape,f,p,v,x),N=l.makeTensorInfo(C,"float32",w),I=l.makeTensorInfo(C,"float32",S),E=qs({inputs:{real:N,imag:I},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(N),l.disposeIntermediateTensorInfo(I),E}else{const u=l.data.get(i.dataId).values,c=l.data.get(a.dataId).values,d=s||i.dtype,[h,f]=e(i.shape,a.shape,u,c,d);return l.makeTensorInfo(f,d,h)}}}function gI(t){return(e,n,s,r,o,i)=>{const a=qe(e,n),l=oe(a),u=a.length,c=Le(a),d=Pn("float32",l),h=Pn("float32",l),f=lu(e,a),p=lu(n,a),m=_i(s,r),g=_i(o,i),y=e.length,b=Le(e),v=n.length,x=Le(n);if(f.length+p.length===0)for(let w=0;w<d.length;w++){const S=w%m.length,C=w%g.length,N=t(m[S*2],m[S*2+1],g[C*2],g[C*2+1]);d[w]=N.real,h[w]=N.imag}else for(let w=0;w<d.length;w++){const S=Nu(w,u,c),C=S.slice(-y);f.forEach(z=>C[z]=0);const N=bo(C,y,b),I=S.slice(-v);p.forEach(z=>I[z]=0);const E=bo(I,v,x),A=t(m[N*2],m[N*2+1],g[E*2],g[E*2+1]);d[w]=A.real,h[w]=A.imag}return[d,h,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E4=gn((t,e)=>t+e),Ife=gI((t,e,n,s)=>({real:t+n,imag:e+s})),dd=En(Tu,E4,Ife),Efe={kernelName:Tu,backendName:"cpu",kernelFunc:dd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yI(t,e,n,s,r){const o=oe(s),i=Qn(r,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(o>0?i[l]+=e[a]:i[l]+=1)}return i}function R4(t,e,n,s=!1){const r=t.shape[0],o=t.shape[1],i=Ze([r,n],e.dtype);for(let a=0;a<r;a++)for(let l=0;l<o;l++){const u=t.get(a,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(s?i.set(1,a,u):e.size>0?i.set(i.get(a,u)+e.get(a,l),a,u):i.set(i.get(a,u)+1,a,u))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _4=gn((t,e)=>t&e),Rfe=En(am,_4),_fe={kernelName:am,backendName:"cpu",kernelFunc:Rfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ai(t){return(e,n,s)=>{const r=sn(n,e.length);for(let o=0;o<e.length;++o)r[o]=t(e[o],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nt(t,e,n){const s=ai(e);return il(t,s,n)}function il(t,e,n){return({inputs:s,attrs:r,backend:o})=>{const{x:i}=s;De(i,t);const a=o,l=a.data.get(i.dataId).values;let u;if(i.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=Ai(l)}else u=l;const c=n||i.dtype,d=e(u,c,r);return a.makeTensorInfo(i.shape,c,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A4=ai(t=>Math.ceil(t)),Afe=il(Ad,A4),Dfe={kernelName:Ad,backendName:"cpu",kernelFunc:Afe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D4(t,e,n,s){const r=sn(n,oe(e));if(s&&n!=="string"){let o=0;t.forEach(i=>{const a=oe(i.shape);r.set(i.vals,o),o+=a})}else{let o=0;t.forEach(i=>{const a=n==="string"?Ai(i.vals):i.vals;let l=0;for(let u=0;u<i.shape[0];++u){const c=u*e[1]+o;for(let d=0;d<i.shape[1];++d)r[c+d]=a[l++]}o+=i.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O4=gn((t,e)=>t===e?1:0),F4=En(gm,O4,null,"bool"),Ofe={kernelName:gm,backendName:"cpu",kernelFunc:F4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L4=ai(t=>Math.exp(t)),P4=il(zd,L4,"float32"),Ffe={kernelName:zd,backendName:"cpu",kernelFunc:P4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M4=ai(t=>Math.expm1(t)),Lfe=il(Bd,M4),Pfe={kernelName:Bd,backendName:"cpu",kernelFunc:Lfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z4=ai(t=>Math.floor(t)),Mfe=il(Vd,z4),zfe={kernelName:Vd,backendName:"cpu",kernelFunc:Mfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B4=gn((t,e)=>Math.floor(t/e)),Bfe=En(Ud,B4,null,"int32"),Vfe={kernelName:Ud,backendName:"cpu",kernelFunc:Bfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V4(t,e,n,s,r,o,i,a,l){const u=Ze([s,o],n);for(let c=0;c<s;c++){const d=[];let h=0;for(let f=0;f<r;f++){const p=t[c*r+f];h+=p*i[f],d.push(p)}if(h<0||h>=l/o)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let f=0;f<o;f++)u.values[c*o+f]=e.get(...e.indexToLoc(h*o+f))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U4(t,e,n){const s=Ze(n,t.dtype);for(let r=0;r<s.size;++r){const i=s.indexToLoc(r).slice(),a=i[0],l=i[2],u=e.locToIndex([a,l]);i[2]=e.values[u];const c=t.locToIndex(i);0<=c&&c<t.values.length&&(s.values[r]=t.values[c])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W4=gn((t,e)=>t>e?1:0),Ufe=En(xm,W4,null,"bool"),Wfe={kernelName:xm,backendName:"cpu",kernelFunc:Ufe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j4=gn((t,e)=>t>=e?1:0),jfe=En(Wd,j4,null,"bool"),Gfe={kernelName:Wd,backendName:"cpu",kernelFunc:jfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G4=gn((t,e)=>t<e?1:0),Hfe=En(Sm,G4,null,"bool"),qfe={kernelName:Sm,backendName:"cpu",kernelFunc:Hfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H4=gn((t,e)=>t<=e?1:0),Kfe=En(km,H4,null,"bool"),Xfe={kernelName:km,backendName:"cpu",kernelFunc:Kfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q4(t,e,n){const s=(e-t)/(n-1),r=Qn(n,"float32");r[0]=t;for(let o=1;o<r.length;o++)r[o]=r[o-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K4=ai(t=>Math.log(t)),Yfe=il(Kd,K4),Qfe={kernelName:Kd,backendName:"cpu",kernelFunc:Yfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X4(t,e,n,s){const r=Pn(s,oe(n));for(let o=0;o<r.length;++o){const i=o*e;let a=t[i];for(let l=0;l<e;++l){const u=t[i+l];(Number.isNaN(u)||u>a)&&(a=u)}r[o]=a}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y4=gn((t,e)=>Math.max(t,e)),Zfe=En(Yd,Y4),Jfe={kernelName:Yd,backendName:"cpu",kernelFunc:Zfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q4=gn((t,e)=>Math.min(t,e)),epe=En(Qd,Q4),tpe={kernelName:Qd,backendName:"cpu",kernelFunc:epe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bI=gn((t,e)=>t*e),npe=gI((t,e,n,s)=>({real:t*n-e*s,imag:t*s+e*n})),mw=En(Jd,bI,npe),spe={kernelName:Jd,backendName:"cpu",kernelFunc:mw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z4(t,e,n){const s=Pi(-1,n);return bI([],e,s,t,n)}function rpe(t){const{inputs:e,backend:n}=t,{x:s}=e;De(s,"neg");const r=n.data.get(s.dataId).values,[o,i]=Z4(r,s.shape,s.dtype);return n.makeTensorInfo(i,s.dtype,o)}const ope={kernelName:Om,backendName:"cpu",kernelFunc:rpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J4=gn((t,e)=>t!==e?1:0),ipe=En(Fm,J4,null,"bool"),ape={kernelName:Fm,backendName:"cpu",kernelFunc:ipe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vI(t,e,n,s,r){const o=e.length,i=oe(e),a=Le(e),l=Le(r),u=Pn(n,oe(r));for(let c=0;c<i;++c){const d=Nu(c,o,a),h=new Array(d.length);for(let p=0;p<h.length;p++)h[p]=d[s[p]];const f=bo(h,o,l);u[f]=t[c]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ps(t){const{inputs:e,attrs:n,backend:s}=t,{x:r}=e,{perm:o}=n;De(r,"transpose");const i=r.shape.length,a=new Array(i);for(let d=0;d<a.length;d++)a[d]=r.shape[o[d]];const l=s.data.get(r.dataId).values,u=vI(l,r.shape,r.dtype,o,a);return{dataId:s.write(u,a,r.dtype),shape:a,dtype:r.dtype}}const lpe={kernelName:jl,backendName:"cpu",kernelFunc:Ps};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eV(t,e,n,s){const[r,o]=Bn(t,s),i=As(e,"int32"),a=Qn(oe(r),i),l=oe(o);for(let u=0;u<a.length;++u){const c=u*l;let d=1;for(let h=0;h<l;++h)d*=n[c+h];a[u]=d}return{outVals:a,outShape:r,outDtype:i}}function upe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;De(r,"prod");const a=r.shape.length,l=st(o,r.shape),u=tn(l,a);let c=l,d=r;const h=[];u!=null&&(d=Ps({inputs:{x:r},backend:n,attrs:{perm:u}}),h.push(d),c=pn(c.length,a));const f=n.data.get(d.dataId).values,{outVals:p,outShape:m,outDtype:g}=eV(d.shape,d.dtype,f,c);let y=m;return i&&(y=fn(m,l)),h.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(y,g,p)}const cpe={kernelName:Vm,backendName:"cpu",kernelFunc:upe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dpe(t,e,n){t.forEach((s,r)=>{if(s<0||s>=n){const o=Nu(r,e.length,Le(e)).join(",");throw new Error(`indices[${o}] = ${s} is not in [0, ${n})`)}})}function hpe(t,e){for(let n=0;n<t.length;++n){const s=t[n],r=n===t.length-1?e:t[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let o=1;o<s.length;++o)if(s[o-1]>s[o])throw new Error("Ragged splits must be sorted in ascending order")}}function fpe(t,e,n,s){const r=[];let o=0;const i=e.length-1+n.length,a=new Array(i).fill(null).map(()=>[0]);hpe(n,s);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const c=e[u+1];for(let d=1;d<l+1;++d)a[u].push(d*c)}for(let u=0;u<t.length;++u){let c=t[u],d=t[u]+1;for(let h=0;h<n.length;++h){const f=n[h],p=h+e.length-1;if(p>=0){const m=a[p],g=m[m.length-1]-f[c];for(let y=c;y<d;++y)a[p].push(f[y+1]+g)}c=f[c],d=f[d]}d!==c&&(r.push([c,d]),o+=d-c)}return{outSplits:a,valueSlices:r,numValues:o}}function ppe(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n].length,r=sn("int32",s);e.push(r),t[n].forEach((o,i)=>r[i]=o)}return e}function p_(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let s=e;s<t.length;s++)n[e-1]*=t[s];return n}function mpe(t,e,n,s,r,o){const i=p_(e,2)[1],a=p_(o,2)[1];let l=0;for(const u of n)for(let c=u[0];c<u[1];++c){for(let d=0;d<s;++d)r[l*a+d]=t[c*i+d];++l}}function gpe(t,e,n,s,r){const o=e.slice();o[0]=r;const i=sn(n,oe(o)),a=t.length,l=a===0?0:a/e[0];return mpe(t,e,s,l,i,o),[i,o]}function tV(t,e,n,s,r,o,i,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(dpe(o,i,l),s.length===0)throw new Error("params.rank must be nonzero");const u=s[0],{outSplits:c,valueSlices:d,numValues:h}=fpe(o,i,t,u),f=ppe(c),p=gpe(n,s,r,d,h);return[f,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m_=2147483647;function nV(t,e,n,s,r,o,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=r.length===0,u=i.length===0,c=[];a||c.push(e[0]),l||c.push(r[0]),u||c.push(i[0]);for(let g=1;g<c.length;++g)if(c[g]!==c[g-1])throw new Error("starts, limits, and deltas must have the same shape");const d=c.length===0?1:c[0],h=sn("int32",d+1);h[0]=0;for(let g=0;g<d;++g){const y=a?t[0]:t[g],b=l?s[0]:s[g],v=u?o[0]:o[g];if(v===0)throw new Error("Requires delta != 0");let x;if(v>0&&b<y||v<0&&b>y)x=0;else if(x=Math.ceil(Math.abs((b-y)/v)),x>m_)throw new Error(`Requires ((limit - start) / delta) <= ${m_}`);h[g+1]=h[g]+x}const f=h[d],p=sn(n,f);let m=0;for(let g=0;g<d;++g){const y=h[g+1]-h[g];let b=a?t[0]:t[g];const v=u?o[0]:o[g];for(let x=0;x<y;++x)p[m++]=b,b+=v}return[h,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ar=mo;class eb{constructor(e,n,s,r,o,i,a,l,u,c){this.shape=e,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=o,this.defaultValue=i,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=AM(c),this.raggedRank=DM(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Ar.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Ar.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Ar.VALUE_ROWIDS:return eb.getMaxWidthValueRowID(n);case Ar.ROW_SPLITS:return eb.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Ar[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const o=e[r+1]-e[r];o>s&&(s=o)}return s}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let s=0,r=e[0],o=0;for(let i=1;i<n;++i){const a=e[i];a!==r&&(r=a,o=Math.max(i-s,o),s=i)}return Math.max(n-s,o)}tensorShapeFromTensor(e,n,s=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return y_(e,s)}calculateOutputSize(e){const n=this.valuesShape,s=this.defaultValueShape;OM(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=_M(this.raggedRank,r,n);i[0]<0&&(i[0]=e);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(e,n,s){const r=Math.min(e,s),o=[];let i=0;for(let a=0;a<r;++a,i+=n)o.push(i);for(let a=r;a<e;++a)o.push(-1);return T(o.length===e,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(e,n,s,r){const o=e.length,i=[];for(let a=0;a<o-1;++a){const l=e[a+1]-e[a];let u=Math.min(r,l),c=n[a];c===-1&&(u=0);for(let d=0;d<u;++d)i.push(c),c+=s;for(let d=0;d<l-u;++d)i.push(-1)}if(o>0&&i.length!==e[o-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,n,s,r){const o=e.length,i=[];if(o===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];i.push(u);for(let c=1;c<o;++c){const d=e[c];if(d===l)u>=0&&(++a,a<r?u+=s:u=-1);else{if(a=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);u=n[d]}i.push(u)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,n,s,r){const o=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case Ar.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,n,s,r);case Ar.ROW_SPLITS:if(o.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(o,n,s,r);default:throw new Error(`Unsupported partition type: ${Ar[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Ar.FIRST_DIM_SIZE:return e[0];case Ar.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Ar.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Ar[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const o=y_(s,!1),i=sn(this.valuesDType,oe(o));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,r[u],s[u]);this.setOutput(this.raggedRank,l,i,o)}return[o,i]}setOutput(e,n,s,r){if(s.length===0)return;const o=this.values,i=s;let a=r.slice();a=a.slice(e+1);const l=oe(a),u=n.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const p=this.defaultValueShape;Q(()=>{const m=B(c,p);c=Gl(m,a).dataSync()})}let d=0,h=0,f=0;for(let p=0;p<=u;++p){let m=p<u?n[p]:-1;if(m===f){++f;continue}if(h<f){const g=o.subarray(d*l),y=i.subarray(h*l),b=(f-h)*l;g_(y,g,b)}if(p>=u){const g=s.length;m=Math.floor(g/l)}if(m>f)if(this.defaultValue.length===1)i.subarray(f*l,m*l).fill(this.defaultValue[0]),f=m;else for(;m>f;){const g=i.slice(f*l);g_(g,c,l),++f}m<0?(d=p+1,h=f):(d=p,h=f,f=h+1)}}}function g_(t,e,n){for(let s=0;s<n;s++)t[s]=e[s]}function y_(t,e){const n=[];for(let s of t){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function sV(t,e,n,s,r,o,i,a,l,u){return new eb(t,e,n,s,r,o,i,a,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rV(t,e,n,s){const r=t===e,o=t<e&&n<0,i=e<t&&n>1;if(r||o||i)return Qn(0,s);const a=Math.abs(Math.ceil((e-t)/n)),l=Qn(a,s);e<t&&n===1&&(n=-1),l[0]=t;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oV=ai(t=>1/Math.sqrt(t)),ype=il(oh,oV),bpe={kernelName:oh,backendName:"cpu",kernelFunc:ype};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Al(t,e,n,s,r,o,i,a,l,u){const c=[s/r,r],d=t.values,h=e.values;if(s===0)return Ze(n,e.dtype);const f=l instanceof xn?l:Ze(c,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<o;p++){const m=[];let g=0;for(let y=0;y<i;y++){const b=d[p*i+y];m.push(b),g+=b*a[y]}if(g<0||g>=s/r)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let y=0;y<r;y++)u?f.values[g*r+y]+=h[p*r+y]:f.values[g*r+y]=e.rank===0?h[0]:h[p*r+y]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vpe=ai(t=>1/(1+Math.exp(-t))),iV=Nt(ch,t=>1/(1+Math.exp(-t))),xpe={kernelName:ch,backendName:"cpu",kernelFunc:iV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aV(t,e,n,s,r){const o=k$(s,e,n),i=oe(n),a=Le(s);if(o){const d=C$(e,a);return r==="string"?t.slice(d,d+i):t.subarray(d,d+i)}const l=r==="string"?Ai(t):t,u=Ze(s,r,l),c=Ze(n,r);for(let d=0;d<c.size;++d){const h=c.indexToLoc(d),f=h.map((p,m)=>p+e[m]);c.set(u.get(...f),...h)}return r==="string"?ez(c.values):c.values}function mu(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:o,size:i}=s;De(r,"slice");const[a,l]=Zx(r,o,i);w$(r,a,l);const u=n.data.get(r.dataId).values,c=aV(u,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,c)}const wpe={kernelName:qm,backendName:"cpu",kernelFunc:mu};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lV(t,e,n,s,r,o,i){const a=e[0],l=o[0],u=new Array(l),c=new Array(a),d=e[1];if(l===0){if(a!==0)throw new Error(VM(a));const g=sn(n,0),y=sn(r,0);return[g,[0,d],y,u,c]}let h=!0,f=0;const p=new Array(l).fill(0);for(let g=0;g<a;++g){const y=t[g*d];if(y<0)throw new Error(UM(g,y));if(y>=l)throw new Error(WM(g,y,l));++p[y],h=h&&y>=f,f=y}let m=!0;for(let g=0;g<l;++g){const y=p[g]===0;u[g]=y,m=m&&!y,p[g]=Math.max(p[g],1),g>0&&(p[g]+=p[g-1])}if(m&&h){const g=t,y=s;for(let b=0;b<a;++b)c[b]=b;return[g,[a,d],y,u,c]}else{const g=p[l-1],y=sn(n,g*d),b=sn(r,g),v=new Array(l).fill(0);for(let x=0;x<a;++x){const w=t[x*d],S=v[w],C=(w===0?0:p[w-1])+S;v[w]++;for(let N=0;N<d;++N)y[C*d+N]=t[x*d+N];b[C]=s[x],c[x]=C}for(let x=0;x<l;++x)if(v[x]===0){const S=x===0?0:p[x-1];y[S*d+0]=x;for(let C=1;C<d;++C)y[S*d+C]=0;b[S]=i}return[y,[g,d],b,u,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uV(t,e,n,s,r){const o=oe(s),i=e[0],a=r.length,l=[];let u=1,c=-1;for(let g=0;g<a;++g){const y=r[g];if(y===-1){if(c!==-1)throw new Error(jM(c,g));c=g,l.push(1)}else{if(y<0)throw new Error(GM(g,y));u*=y,l.push(y)}}if(c!==-1){if(u<=0)throw new Error(HM());const g=Math.trunc(o/u);if(u*g!==o)throw new Error(qM(s,l));l[c]=g}if(oe(l)!==o)throw new Error(KM(s,l));const h=s.length,f=[];if(h>0){f[h-1]=1;for(let g=h-2;g>=0;--g)f[g]=f[g+1]*s[g+1]}const p=[];if(a>0){p[a-1]=1;for(let g=a-2;g>=0;--g)p[g]=p[g+1]*l[g+1]}const m=sn(n,i*a);for(let g=0;g<i;++g){let y=0;for(let b=0;b<h;++b)y+=t[g*h+b]*f[b];for(let b=0;b<a;++b)m[g*a+b]=Math.trunc(y/p[b]),y%=p[b]}return[m,[i,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xI(t,e,n,s,r,o=!1,i=0){const a=s.length,l=[e[0],t.length/e[0]],u=l[1],d=a>0?r[a-1]+1:0;if(d<0)throw new Error(Fk());const h=e.slice();h[0]=d;const f=h.reduce((v,x)=>v*x,1),p=sn(n,f);if(a===0)return d>0&&p.fill(i),[p,h];if(d<=0)throw new Error(Fk());let m=0,g=1,y=0,b=r[m];for(;;){let v=0;if(g<a){if(v=r[g],b===v){++g;continue}if(b>=v)throw new Error(XM())}if(b<0||b>=d)throw new Error(YM(b,d));b>y&&p.fill(i,y*u,b*u);for(let x=m;x<g;++x){const w=s[x];if(w<0||w>=l[0])throw new Error(QM(x,s[x],l[0]));for(let S=0;S<u;S++)p[b*u+S]+=t[w*u+S]}if(o)for(let x=0;x<u;x++)p[b*u+x]/=g-m;if(m=g,++g,y=b+1,b=v,g>a)break}return y<d&&p.fill(i,y*u,d*u),[p,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Spe=ai(t=>Math.sqrt(t)),kpe=Nt(hh,t=>Math.sqrt(t)),Cpe={kernelName:hh,backendName:"cpu",kernelFunc:kpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cV=gn((t,e)=>{const n=t-e;return n*n}),Npe=En(fh,cV),Tpe={kernelName:fh,backendName:"cpu",kernelFunc:Npe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dV=ai((t,e)=>{const{pattern:n,replaceGlobal:s,rewrite:r}=e;return t.replace(new RegExp(n,s?"g":""),r)}),$pe=il(Zm,dV),Ipe={kernelName:Zm,backendName:"cpu",kernelFunc:$pe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hV(t,e,n,s){const r=Ze(t,e.dtype);for(let o=0;o<r.size;o++){const i=r.indexToLoc(o),a=new Array(i.length);for(let l=0;l<a.length;l++)a[l]=i[l]*n[l]+s[l];r.set(e.get(...a),...i)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Epe{constructor(e,n,s,r,o,i){this.separator=Go(e),this.nGramWidths=n,this.leftPad=Go(s),this.rightPad=Go(r),this.padWidth=o,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const s=this.getPadWidth(n);return Math.max(0,e+2*s-n+1)}createNGrams(e,n,s,r,o,i){for(let a=0;a<o;++a){const l=this.getPadWidth(i),u=Math.max(0,l-a),c=Math.max(0,l-(o-(a+1))),d=i-(u+c),h=n+(u>0?0:a-l);let f=0;f+=u*this.leftPad.length;for(let b=0;b<d;++b)f+=e[h+b].length;f+=c*this.rightPad.length;const p=u+c+d-1;f+=p*this.separator.length,s[r+a]=new Uint8Array(f);const m=s[r+a];let g=0;const y=b=>b.forEach(v=>m[g++]=v);for(let b=0;b<u;++b)y(this.leftPad),y(this.separator);for(let b=0;b<d-1;++b)y(e[h+b]),y(this.separator);if(d>0){y(e[h+d-1]);for(let b=0;b<c;++b)y(this.separator),y(this.rightPad)}else{for(let b=0;b<c-1;++b)y(this.rightPad),y(this.separator);y(this.rightPad)}}}compute(e,n){const s=e.length,r=n.length;if(r>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<r;++u){let c=n[u]>=l;if(c=c&&n[u]<=s,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${s}]`);l=n[u]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const o=r-1,i=sn("int32",r);if(s===0||r===0){const l=new Array(s);for(let u=0;u<=o;++u)i[u]=0;return[l,i]}i[0]=0;for(let l=1;l<=o;++l){const u=n[l]-n[l-1];let c=0;this.nGramWidths.forEach(d=>{c+=this.getNumNGrams(u,d)}),this.preserveShort&&u>0&&c===0&&(c=1),i[l]=i[l-1]+c}const a=new Array(i[o]);for(let l=0;l<o;++l){const u=n[l];let c=i[l];if(this.nGramWidths.forEach(d=>{const h=n[l+1]-n[l],f=this.getNumNGrams(h,d);this.createNGrams(e,u,a,c,f,d),c+=f}),this.preserveShort&&c===i[l]){const d=n[l+1]-n[l];if(d===0)continue;const h=d+2*this.padWidth;this.createNGrams(e,u,a,c,1,h)}}return[a,i]}}function fV(t,e,n,s,r,o,i,a){return new Epe(n,s,r,o,i,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rpe(t,e,n,s){if(!t.length)return;if(e.length===0){for(let o=0;o<t.length;++o)s.push(t.subarray(o,o+1));return}if(e.length===1){const o=e[0];let i=t.indexOf(o);for(;i!==-1;){const a=t.subarray(0,i);(!n||a.length!==0)&&s.push(a),t=t.subarray(i+1),i=t.indexOf(o)}(!n||t.length!==0)&&s.push(t);return}let r=0;for(let o=0;o<t.length+1;o++)if(o===t.length||e.indexOf(t[o])!==-1){const i=t.subarray(r,o);(!n||i.length!==0)&&s.push(i),r=o+1}}function pV(t,e,n){const s=t.length,r=[];let o=0,i=0;const a=new Array(s);for(let h=0;h<s;++h){const f=r.length;Rpe(t[h],e,n,r);const p=r.length-f;a[h]=p,o+=p,i=Math.max(i,p)}const l=sn("int32",o*2),u=new Array(o),c=[s,i];let d=0;for(let h=0;h<s;++h)for(let f=0;f<a[h];++f)l[d*2]=h,l[d*2+1]=f,u[d]=r[d],++d;return[l,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mV(t,e){const n=sn("int32",t.length);for(let s=0;s<t.length;++s)n[s]=zP(t[s]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gV=gn((t,e)=>t-e),_pe=gI((t,e,n,s)=>({real:t-n,imag:e-s})),wI=En(ph,gV,_pe),Ape={kernelName:ph,backendName:"cpu",kernelFunc:wI};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yV(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const s=Ze(n,t.dtype);for(let r=0;r<s.values.length;++r){const o=s.indexToLoc(r),i=new Array(t.rank);for(let l=0;l<i.length;l++)i[l]=o[l]%t.shape[l];const a=t.locToIndex(i);s.values[r]=t.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bf=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function bV(t,e,n=0,s=t.length-1){for(;s>n;){if(s-n>600){const a=s-n+1,l=e-n+1,u=Math.log(a),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(a-c)/a)*Math.sign(l-a/2),h=Math.max(n,Math.floor(e-l*c/a+d)),f=Math.min(s,Math.floor(e+(a-l)*c/a+d));bV(t,e,h,f)}const r=t[e];let o=n,i=s;for(mi(t,n,e),bf(t[s],r)>0&&mi(t,n,s);o<i;){for(mi(t,o,i),o++,i--;bf(t[o],r)<0;)o=o+1;for(;bf(t[i],r)>0;)i=i-1}bf(t[n],r)===0?mi(t,n,i):(i=i+1,mi(t,i,s)),i<=e&&(n=i+1),e<=i&&(s=i-1)}}function vV(t,e,n,s,r){const o=e[e.length-1],[i,a]=[t.length/o,o],l=Pn(n,i*s),u=Pn("int32",i*s);for(let d=0;d<i;d++){const h=d*a,f=t.subarray(h,h+a);let p=new Array(f.length);f.forEach((b,v)=>p[v]={value:b,index:v}),s<p.length&&(bV(p,s),p=p.slice(0,s)),r&&p.sort(bf);const m=d*s,g=l.subarray(m,m+s),y=u.subarray(m,m+s);for(let b=0;b<s;b++)g[b]=p[b].value,y[b]=p[b].index}const c=e.slice();return c[c.length-1]=s,[Ze(c,n,l),Ze(c,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xV(t,e,n,s){const r=st(e,n)[0],o=[1,n[0],1];for(let p=0;p<r;p++)o[0]*=n[p];o[1]=n[r];for(let p=r+1;p<n.length;p++)o[2]*=n[p];const i=new Map,a=new Int32Array(n[r]),l=new xn(o,s,t),u=[],c=o[0]===1&&o[2]===1;for(let p=0;p<n[r];p++){let m;if(c)m=t[p].toString();else{const y=[];for(let b=0;b<o[0];b++)for(let v=0;v<o[2];v++)y.push(l.get(b,p,v));m=y.join(",")}const g=i.get(m);if(g!=null)a[p]=g;else{const y=i.size;i.set(m,y),a[p]=y,u.push(p)}}const d=o.slice();d[1]=i.size;const h=new xn(d,s);u.forEach((p,m)=>{for(let g=0;g<o[0];g++)for(let y=0;y<o[2];y++)h.set(l.get(g,p,y),g,m,y)});const f=n.slice();return f[r]=d[1],{outputValues:h.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dpe=Object.freeze(Object.defineProperty({__proto__:null,addImpl:E4,bincountImpl:yI,bincountReduceImpl:R4,bitwiseAndImpl:_4,castImpl:I4,ceilImpl:A4,concatImpl:D4,equalImpl:O4,expImpl:L4,expm1Impl:M4,floorDivImpl:B4,floorImpl:z4,gatherNdImpl:V4,gatherV2Impl:U4,greaterEqualImpl:j4,greaterImpl:W4,lessEqualImpl:H4,lessImpl:G4,linSpaceImpl:q4,logImpl:K4,maxImpl:X4,maximumImpl:Y4,minimumImpl:Q4,multiplyImpl:bI,negImpl:Z4,notEqualImpl:J4,prodImpl:eV,raggedGatherImpl:tV,raggedRangeImpl:nV,raggedTensorToTensorImpl:sV,rangeImpl:rV,rsqrtImpl:oV,scatterImpl:Al,sigmoidImpl:vpe,simpleAbsImpl:$4,sliceImpl:aV,sparseFillEmptyRowsImpl:lV,sparseReshapeImpl:uV,sparseSegmentReductionImpl:xI,sqrtImpl:Spe,squaredDifferenceImpl:cV,staticRegexReplaceImpl:dV,stridedSliceImpl:hV,stringNGramsImpl:fV,stringSplitImpl:pV,stringToHashBucketFastImpl:mV,subImpl:gV,tileImpl:yV,topKImpl:vV,transposeImpl:vI,uniqueImpl:xV},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */YN("cpu",()=>new pw,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wV=Nt(Pd,t=>t>=0?t:Math.exp(t)-1),Ope={kernelName:Pd,backendName:"cpu",kernelFunc:wV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SV(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:o}=s;De([r],"leakyRelu");const i=oe(r.shape),a=n.data.get(r.dataId).values,l=Pn("float32",i);for(let u=0;u<a.length;u++)l[u]=a[u]<0?o*a[u]:a[u];return n.makeTensorInfo(r.shape,"float32",l)}const Fpe={kernelName:wm,backendName:"cpu",kernelFunc:SV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lpe=gn((t,e)=>t<0?e*t:t);function kV(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e;De([s,r],"prelu");const o=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,[a,l]=Lpe(s.shape,r.shape,o,i,"float32");return n.makeTensorInfo(l,"float32",a)}const Ppe={kernelName:Bm,backendName:"cpu",kernelFunc:kV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CV=Nt(nh,t=>Math.max(0,t)),Mpe={kernelName:nh,backendName:"cpu",kernelFunc:CV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NV=Nt(sh,t=>Math.min(Math.max(0,t),6)),zpe={kernelName:sh,backendName:"cpu",kernelFunc:NV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tb(t,e,n,s,r){if(n==="linear")return ti({inputs:{x:e},backend:t});if(n==="relu")return CV({inputs:{x:e},backend:t});if(n==="elu")return wV({inputs:{x:e},backend:t});if(n==="relu6")return NV({inputs:{x:e},backend:t});if(n==="prelu")return kV({inputs:{x:e,alpha:s},backend:t});if(n==="leakyrelu")return SV({inputs:{x:e},backend:t,attrs:{alpha:r}});if(n==="sigmoid")return iV({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ot(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:o}=s,i=oe(r.shape),a=BN(o,i),l=oe(a);T(i===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${r.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const u=n.data.get(r.dataId);if(u.complexTensorInfos!=null){const c=u.complexTensorInfos.real,d=u.complexTensorInfos.imag;c.shape=a,d.shape=a}return{dataId:r.dataId,shape:a,dtype:r.dtype}}const Bpe={kernelName:Um,backendName:"cpu",kernelFunc:Ot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TV(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:o}=e,{transposeA:i,transposeB:a}=s;De([r,o],"matMul");const l=r.shape.length,u=o.shape.length,c=i?r.shape[l-2]:r.shape[l-1],d=a?o.shape[u-1]:o.shape[u-2],h=i?r.shape[l-1]:r.shape[l-2],f=a?o.shape[u-2]:o.shape[u-1],p=r.shape.slice(0,-2),m=o.shape.slice(0,-2),g=oe(p),y=oe(m),v=qe(r.shape.slice(0,-2),o.shape.slice(0,-2)).concat([h,f]);T(c===d,()=>`Error in matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${r.shape} and ${o.shape} and transposeA=${i} and transposeB=${a} must match.`);const x=i?[g,c,h]:[g,h,c],w=a?[y,f,d]:[y,d,f],S=Ot({inputs:{x:r},backend:n,attrs:{shape:x}}),C=Ot({inputs:{x:o},backend:n,attrs:{shape:w}}),N=i?S.shape[1]:S.shape[2],I=i?S.shape[2]:S.shape[1],E=a?C.shape[1]:C.shape[2],A=Math.max(g,y),z=n.data.get(S.dataId).values,V=n.data.get(C.dataId).values,P=Le(S.shape),K=Le(C.shape),[Y,te,F]=i?[P[0],1,P[1]]:[P[0],P[1],1],[j,q,J]=a?[1,K[1],K[0]]:[K[1],1,K[0]],_=I*E,W=Ze([A,I,E],S.dtype),Z=W.values,ie=n.blockSize;for(let re=0;re<A;re++){const fe=re%g,ye=re%y;for(let de=0;de<I;de+=ie){const $e=Math.min(de+ie,I);for(let ke=0;ke<E;ke+=ie){const Ae=Math.min(ke+ie,E);for(let Ue=0;Ue<N;Ue+=ie){const ht=Math.min(Ue+ie,N);for(let Xe=de;Xe<$e;Xe++)for(let Ke=ke;Ke<Ae;Ke++){let rt=0;for(let kt=Ue;kt<ht;kt++){const ar=z[fe*Y+Xe*te+kt*F],Ht=V[kt*j+Ke*q+ye*J];rt+=ar*Ht}Z[re*_+(Xe*E+Ke)]+=rt}}}}}return n.disposeIntermediateTensorInfo(S),n.disposeIntermediateTensorInfo(C),n.makeTensorInfo(v,W.dtype,W.values)}const Vpe={kernelName:om,backendName:"cpu",kernelFunc:TV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Upe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=s;let h,f,p;const m=[];h=TV({inputs:{a:r,b:o},attrs:{transposeA:l,transposeB:u},backend:n}),i&&(f=dd({inputs:{a:h,b:i},backend:n}),m.push(h),h=f),c&&(p=tb(n,h,c,a,d),m.push(h),h=p);for(const y of m)n.disposeIntermediateTensorInfo(y);return h}const Wpe={kernelName:op,backendName:"cpu",kernelFunc:Upe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jpe=Nt(Cd,t=>Math.acos(t)),Gpe={kernelName:Cd,backendName:"cpu",kernelFunc:jpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hpe=Nt(Nd,t=>Math.acosh(t)),qpe={kernelName:Nd,backendName:"cpu",kernelFunc:Hpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kpe(t){const{inputs:e,backend:n}=t,s=e;De(e,"addN");const r=s.map(a=>n.data.get(a.dataId).values),o=Ze(s[0].shape,s[0].dtype),i=o.values;for(let a=0;a<s.length;a++){const l=r[a];for(let u=0;u<i.length;u++)i[u]+=l[u]}return n.makeTensorInfo(o.shape,o.dtype,o.values)}const Xpe={kernelName:em,backendName:"cpu",kernelFunc:Kpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ype(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;De(r,"all");const a=st(o,r.shape);let l=a;const u=tn(l,r.shape.length);let c=r;u!=null&&(c=Ps({inputs:{x:r},backend:n,attrs:{perm:u}}),l=pn(l.length,r.shape.length)),es("all",l,c.shape.length);const[d,h]=Bn(c.shape,l),f=oe(h),p=Qn(oe(d),c.dtype),m=n.data.get(c.dataId).values;for(let y=0;y<p.length;++y){const b=y*f;let v=m[b];for(let x=0;x<f;++x){const w=m[b+x];v=v&&w}p[y]=v}u!=null&&n.disposeIntermediateTensorInfo(c);const g=n.makeTensorInfo(d,c.dtype,p);if(i){const y=fn(d,a),b=Ot({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),b}return g}const Qpe={kernelName:av,backendName:"cpu",kernelFunc:Ype};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zpe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;De(r,"any");const a=st(o,r.shape);let l=a;const u=tn(l,r.shape.length);let c=r;u!=null&&(c=Ps({inputs:{x:r},backend:n,attrs:{perm:u}}),l=pn(l.length,r.shape.length)),es("any",l,c.shape.length);const[d,h]=Bn(c.shape,l),f=oe(h),p=Qn(oe(d),c.dtype),m=n.data.get(c.dataId).values;for(let y=0;y<p.length;++y){const b=y*f;let v=m[b];for(let x=0;x<f;++x){const w=m[b+x];v=v||w}p[y]=v}u!=null&&n.disposeIntermediateTensorInfo(c);const g=n.makeTensorInfo(d,c.dtype,p);if(i){const y=fn(d,a),b=Ot({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),b}return g}const Jpe={kernelName:lv,backendName:"cpu",kernelFunc:Zpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o}=s;De(r,"argMax");let i=st(o,r.shape);const a=tn(i,r.shape.length);let l=r;const u=[];a!=null&&(l=Ps({inputs:{x:r},backend:n,attrs:{perm:a}}),u.push(l),i=pn(i.length,l.shape.length)),i=[i[0]],es("argMax",i,l.shape.length);const[c,d]=Bn(l.shape,i),h=oe(c),f=Qn(h,"int32"),p=oe(d),m=n.data.get(l.dataId).values;for(let g=0;g<f.length;++g){const y=g*p;let b=m[y],v=0;for(let x=0;x<p;++x){const w=m[y+x];w>b&&(b=w,v=x)}f[g]=v}return u.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(c,"int32",f)}const tme={kernelName:tm,backendName:"cpu",kernelFunc:eme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o}=s;De(r,"argMin");let i=st(o,r.shape);const a=tn(i,r.shape.length);let l=r;const u=[];a!=null&&(l=Ps({inputs:{x:r},backend:n,attrs:{perm:a}}),u.push(l),i=pn(i.length,l.shape.length)),i=[i[0]],es("argMin",i,l.shape.length);const[c,d]=Bn(l.shape,i),h=oe(c),f=Qn(h,"int32"),p=oe(d),m=n.data.get(l.dataId).values;for(let g=0;g<f.length;++g){const y=g*p;let b=m[y],v=0;for(let x=0;x<p;++x){const w=m[y+x];w<b&&(b=w,v=x)}f[g]=v}return u.forEach(g=>n.disposeIntermediateTensorInfo(g)),n.makeTensorInfo(c,"int32",f)}const sme={kernelName:nm,backendName:"cpu",kernelFunc:nme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rme=Nt(Td,t=>Math.asin(t)),ome={kernelName:Td,backendName:"cpu",kernelFunc:rme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ime=Nt($d,t=>Math.asinh(t)),ame={kernelName:$d,backendName:"cpu",kernelFunc:ime};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lme=Nt(Id,t=>Math.atan(t)),ume={kernelName:Id,backendName:"cpu",kernelFunc:lme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cme=gn((t,e)=>Math.atan2(t,e)),dme=En(Rd,cme),hme={kernelName:Rd,backendName:"cpu",kernelFunc:dme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fme=Nt(Ed,t=>Math.atanh(t)),pme={kernelName:Ed,backendName:"cpu",kernelFunc:fme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SI(t,e,n,s,r,o){const i=r.strideHeight,a=r.strideWidth,l=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,f=r.padInfo.left,p=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Ze(r.outShape,n),g=m.values,y=r.outShape[1]*r.outShape[2]*r.outShape[3],b=r.outShape[2]*r.outShape[3],v=r.outShape[3];for(let x=0;x<r.batchSize;++x){const w=x*y,S=x*s[0];for(let C=0;C<r.inChannels;++C)for(let N=0;N<r.outHeight;++N){const I=N*i-h,E=Math.max(0,I),A=Math.min(r.inHeight,c+I),z=w+N*b;for(let V=0;V<r.outWidth;++V){const P=V*a-f,K=Math.max(0,P),Y=Math.min(r.inWidth,d+P);let te=p,F=0,j=0;for(let J=E;J<A;J+=l){const _=S+J*s[1];for(let W=K;W<Y;W+=u){const Z=_+W*s[2],ie=t[Z+C];o==="max"&&ie>te?te=ie:o==="avg"&&(F+=ie,j++)}if(isNaN(te))break}const q=z+V*v+C;g[q]=o==="avg"?F/j:te}}}return m}function $V(t,e,n,s,r=!1,o=!1){const i=Ze(s.outShape,"int32"),a=s.strideHeight,l=s.strideWidth,u=s.dilationHeight,c=s.dilationWidth,d=s.effectiveFilterHeight,h=s.effectiveFilterWidth,f=s.padInfo.top,p=s.padInfo.left,m=Ze(e,n,t);for(let g=0;g<s.batchSize;++g)for(let y=0;y<s.inChannels;++y)for(let b=0;b<s.outHeight;++b){const v=b*a-f;let x=v;for(;x<0;)x+=u;const w=Math.min(s.inHeight,d+v);for(let S=0;S<s.outWidth;++S){const C=S*l-p;let N=C;for(;N<0;)N+=c;const I=Math.min(s.inWidth,h+C);let E=Number.NEGATIVE_INFINITY,A=-1;for(let z=x;z<w;z+=u){const V=z-v;for(let P=N;P<I;P+=c){const K=P-C,Y=m.get(g,z,P,y);Y>E&&(E=Y,r?A=o?((g*s.inHeight+z)*s.inWidth+P)*s.inChannels+y:(z*s.inWidth+P)*s.inChannels+y:A=V*h+K)}}i.set(A,g,b,S,y)}}return i}function IV(t,e,n,s,r,o){const i=r.strideDepth,a=r.strideHeight,l=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,d=r.dilationWidth,h=r.effectiveFilterDepth,f=r.effectiveFilterHeight,p=r.effectiveFilterWidth,m=r.padInfo.front,g=r.padInfo.top,y=r.padInfo.left,b=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=Ze(r.outShape,n),x=v.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[2]*r.outShape[3]*r.outShape[4],C=r.outShape[3]*r.outShape[4],N=r.outShape[4];for(let I=0;I<r.batchSize;++I){const E=I*w,A=I*s[0];for(let z=0;z<r.inChannels;++z)for(let V=0;V<r.outDepth;++V){const P=V*i-m;let K=P;for(;K<0;)K+=u;const Y=Math.min(r.inDepth,h+P),te=E+V*S;for(let F=0;F<r.outHeight;++F){const j=F*a-g;let q=j;for(;q<0;)q+=c;const J=Math.min(r.inHeight,f+j),_=te+F*C;for(let W=0;W<r.outWidth;++W){const Z=W*l-y;let ie=Z;for(;ie<0;)ie+=d;const re=Math.min(r.inWidth,p+Z),fe=_+W*N;let ye=b,de=0,$e=0;for(let Ae=K;Ae<Y;Ae+=u){const Ue=A+Ae*s[1];for(let ht=q;ht<J;ht+=c){const Xe=Ue+ht*s[2];for(let Ke=ie;Ke<re;Ke+=d){const rt=Xe+Ke*s[3],kt=t[rt+z];if(o==="max"&&kt>ye?ye=kt:o==="avg"&&(de+=kt,$e++),isNaN(ye))break}if(isNaN(ye))break}if(isNaN(ye))break}const ke=fe+z;x[ke]=o==="avg"?de/Math.max($e,1):ye}}}}return v}function mme(t,e){const n=Ze(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,o=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left;for(let m=0;m<e.batchSize;++m)for(let g=0;g<e.inChannels;++g)for(let y=0;y<e.outDepth;++y){const b=y*s-h;let v=b;for(;v<0;)v+=i;const x=Math.min(e.inDepth,u+b);for(let w=0;w<e.outHeight;++w){const S=w*r-f;let C=S;for(;C<0;)C+=a;const N=Math.min(e.inHeight,c+S);for(let I=0;I<e.outWidth;++I){const E=I*o-p;let A=E;for(;A<0;)A+=l;const z=Math.min(e.inWidth,d+E);let V=Number.NEGATIVE_INFINITY,P=-1;for(let K=v;K<x;K+=i){const Y=K-b;for(let te=C;te<N;te+=a){const F=te-S;for(let j=A;j<z;j+=l){const q=j-E,J=t.get(m,K,te,j,g);J>=V&&(V=J,P=Y*c*d+F*c+q)}}}n.set(P,m,y,w,I,g)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;De(r,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,u=1;T(Jn(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=eo(r.shape,o,i,u,a,l);let d;if(c.filterWidth===1&&c.filterHeight===1&&ut(c.inShape,c.outShape))d=ti({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,f=Le(r.shape),p=SI(h,r.shape,r.dtype,f,c,"avg");d=n.makeTensorInfo(c.outShape,r.dtype,p.values)}return d}const yme={kernelName:sm,backendName:"cpu",kernelFunc:gme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:u}=s;De(r,"avgPool3d");const c=Mi(r.shape,o,i,1,a,l,u),d=n.data.get(r.dataId).values,h=IV(d,r.shape,r.dtype,Le(r.shape),c,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}const vme={kernelName:rm,backendName:"cpu",kernelFunc:bme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xme(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:u}=s;De([r,o],"avgPool3DGrad");const c=Mi(o.shape,i,a,1,l,u),d=c.strideDepth,h=c.strideHeight,f=c.strideWidth,p=c.filterDepth,m=c.filterHeight,g=c.filterWidth,y=c.dilationDepth,b=c.dilationHeight,v=c.dilationWidth,x=c.effectiveFilterDepth,w=c.effectiveFilterHeight,S=c.effectiveFilterWidth,C=x-1-c.padInfo.front,N=S-1-c.padInfo.left,I=w-1-c.padInfo.top,E=Ze(o.shape,"float32"),A=1/(p*m*g),z=n.bufferSync(r);for(let V=0;V<c.batchSize;++V)for(let P=0;P<c.inChannels;++P)for(let K=0;K<c.inDepth;++K)for(let Y=0;Y<c.inHeight;++Y)for(let te=0;te<c.inWidth;++te){const F=K-C,j=Y-I,q=te-N;let J=0;for(let _=0;_<x;_+=y){const W=(F+_)/d;if(!(W<0||W>=c.outDepth||Math.floor(W)!==W))for(let Z=0;Z<w;Z+=b){const ie=(j+Z)/h;if(!(ie<0||ie>=c.outHeight||Math.floor(ie)!==ie))for(let re=0;re<S;re+=v){const fe=(q+re)/f;if(fe<0||fe>=c.outWidth||Math.floor(fe)!==fe)continue;const ye=z.get(V,W,ie,fe,P);J+=ye}}}E.set(J*A,V,K,Y,te,P)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const wme={kernelName:cv,backendName:"cpu",kernelFunc:xme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sme(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,i=o;De([r,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=s,c=eo(i.shape,a,l,1,u),d=c.strideHeight,h=c.strideWidth,f=c.filterHeight,p=c.filterWidth,m=c.dilationHeight,g=c.dilationWidth,y=c.effectiveFilterHeight,b=c.effectiveFilterWidth,v=b-1-c.padInfo.left,x=y-1-c.padInfo.top,w=Ze(i.shape,"float32"),S=1/(f*p),C=n.data.get(r.dataId).values,N=Ze(r.shape,"float32",C);for(let I=0;I<c.batchSize;++I)for(let E=0;E<c.inChannels;++E)for(let A=0;A<c.inHeight;++A)for(let z=0;z<c.inWidth;++z){const V=A-x,P=z-v;let K=0;for(let Y=0;Y<y;Y+=m){const te=(V+Y)/d;if(!(te<0||te>=c.outHeight||Math.floor(te)!==te))for(let F=0;F<b;F+=g){const j=(P+F)/h;if(j<0||j>=c.outWidth||Math.floor(j)!==j)continue;const q=N.get(I,te,j,E);K+=q}}w.set(K*S,I,A,z,E)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const kme={kernelName:uv,backendName:"cpu",kernelFunc:Sme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,scale:o,offset:i,mean:a,variance:l}=e;T(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),De([r,a,l,o,i],"batchNorm");let{varianceEpsilon:u}=s;u==null&&(u=.001);const c=n.data.get(r.dataId).values,d=n.data.get(a.dataId).values,h=n.data.get(l.dataId).values,f=o?n.data.get(o.dataId).values:new Float32Array([1]),p=i?n.data.get(i.dataId).values:new Float32Array([0]),m=new Float32Array(c.length),g=p.length,y=f.length,b=h.length,v=d.length;let x=0,w=0,S=0,C=0;for(let N=0;N<c.length;++N)m[N]=p[x++]+(c[N]-d[w++])*f[S++]/Math.sqrt(h[C++]+u),x>=g&&(x=0),w>=v&&(w=0),S>=y&&(S=0),C>=b&&(C=0);return n.makeTensorInfo(r.shape,r.dtype,m)}const Nme={kernelName:bm,backendName:"cpu",kernelFunc:Cme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:o,crops:i}=s;De([r],"batchToSpaceND");const a=o.reduce((y,b)=>y*b),l=Sg(r.shape,o,a),u=kg(l.length,o.length),c=Cg(r.shape,o,a),d=R$(i,o.length),h=_$(c,i,o.length),f=Ot({inputs:{x:r},backend:n,attrs:{shape:l}}),p=Ps({inputs:{x:f},backend:n,attrs:{perm:u}}),m=Ot({inputs:{x:p},backend:n,attrs:{shape:c}}),g=mu({inputs:{x:m},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}const $me={kernelName:im,backendName:"cpu",kernelFunc:Tme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ime(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:o}=e,{size:i}=s,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,u=yI(a,l,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,u)}const Eme={kernelName:dv,backendName:"cpu",kernelFunc:Ime};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rme(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,o=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,a=qe(Array.from(o),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const _me={kernelName:hv,backendName:"cpu",kernelFunc:Rme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ame=Nt(Dd,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),Dme={kernelName:Dd,backendName:"cpu",kernelFunc:Ame};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ome=t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(oe(e.shape)),r=n.data.get(e.dataId),o=r.complexTensorInfos.real,i=r.complexTensorInfos.imag,a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values;for(let u=0;u<a.length;u++){const c=a[u],d=l[u];s[u]=Math.hypot(c,d)}return n.makeOutput(s,e.shape,"float32")},Fme={kernelName:lm,backendName:"cpu",kernelFunc:Ome};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hd(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.imag,o=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,o)}const Lme={kernelName:Av,backendName:"cpu",kernelFunc:hd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fd(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,o=st(r,e[0].shape)[0],i=e.map(m=>m.shape);$$(i,o);let a=qo(e.map(m=>m.shape),o);if(oe(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(m=>oe(m.shape)>0);if(l.length===1)return ti({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const m=l.map(x=>pu({inputs:{input:x},backend:n})),g=l.map(x=>hd({inputs:{input:x},backend:n})),y=fd({inputs:m,backend:n,attrs:{axis:o}}),b=fd({inputs:g,backend:n,attrs:{axis:o}}),v=qs({inputs:{real:y,imag:b},backend:n});return m.forEach(x=>n.disposeIntermediateTensorInfo(x)),g.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),v}const u=l.map(m=>{const y=[-1,oe(m.shape.slice(o))];return Ot({inputs:{x:m},backend:n,attrs:{shape:y}})}),c=u.map(m=>({vals:n.data.get(m.dataId).values,shape:m.shape}));a=qo(u.map(m=>m.shape),1);const d=u[0].shape[0]===1,h=D4(c,a,e[0].dtype,d),f=qo(l.map(m=>m.shape),o),p=n.makeTensorInfo(f,e[0].dtype,h);return u.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const Pme={kernelName:um,backendName:"cpu",kernelFunc:fd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EV(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=s;De([r,o],"conv2d");const d=zi(l),h=zn(r.shape,o.shape,i,u,a,c,!1,d),f=h.filterHeight,p=h.filterWidth,m=h.dilationHeight,g=h.dilationWidth,y=h.padInfo.left,b=h.padInfo.top,v=h.dataFormat==="channelsLast",x=new xn(h.outShape,r.dtype),w=Le(r.shape),S=Le(o.shape),C=w[0],N=v?w[1]:w[2],I=v?w[2]:1,E=v?1:w[1],A=x.strides[0],z=v?x.strides[1]:x.strides[2],V=v?x.strides[2]:1,P=v?1:x.strides[1],K=n.data.get(r.dataId).values,Y=n.data.get(o.dataId).values,te=x.values;for(let F=0;F<h.batchSize;++F){const j=F*C,q=F*A;for(let J=0;J<h.outHeight;++J){const _=q+J*z,W=J*h.strideHeight-b;for(let Z=0;Z<f;++Z){const ie=W+Z*m;if(ie<0||ie>=h.inHeight)continue;const re=Z*S[0],fe=j+ie*N;for(let ye=0;ye<h.outWidth;++ye){const de=_+ye*V,$e=ye*h.strideWidth-y;for(let ke=0;ke<p;++ke){const Ae=$e+ke*g;if(Ae<0||Ae>=h.inWidth)continue;const Ue=re+ke*S[1],ht=fe+Ae*I;let Xe=Ue;for(let Ke=0;Ke<h.inChannels;++Ke){const rt=K[ht+Ke*E];for(let kt=0;kt<h.outChannels;++kt)te[de+kt*P]+=rt*Y[Xe+kt];Xe+=h.outChannels}}}}}}return n.makeTensorInfo(x.shape,x.dtype,te)}const Mme={kernelName:cm,backendName:"cpu",kernelFunc:EV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=s;De([r,o],"conv2dBackpropFilter");const d=zi(l),h=zn(r.shape,c,i,1,a,u,!1,d),{strideHeight:f,strideWidth:p,filterHeight:m,filterWidth:g}=h,y=h.dataFormat==="channelsLast",b=new xn(h.filterShape,"float32"),v=h.padInfo.left,x=h.padInfo.top,w=n.data.get(r.dataId).values,S=n.data.get(o.dataId).values,C=new xn(r.shape,r.dtype,w),N=new xn(o.shape,o.dtype,S);for(let I=0;I<m;++I){const E=Math.max(0,Math.ceil((x-I)/f)),A=Math.min(h.outHeight,(h.inHeight+x-I)/f);for(let z=0;z<g;++z){const V=Math.max(0,Math.ceil((v-z)/p)),P=Math.min(h.outWidth,(h.inWidth+v-z)/p);for(let K=0;K<h.inChannels;++K)for(let Y=0;Y<h.outChannels;++Y){let te=0;for(let F=0;F<h.batchSize;++F)for(let j=E;j<A;++j){const q=I+j*f-x;for(let J=V;J<P;++J){const _=z+J*p-v;y?te+=C.get(F,q,_,K)*N.get(F,j,J,Y):te+=C.get(F,K,q,_)*N.get(F,Y,j,J)}}b.set(te,I,z,K,Y)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const Bme={kernelName:pv,backendName:"cpu",kernelFunc:zme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vme(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=s;De([r,o],"conv2dBackpropInput");const d=Le(o.shape),h=Le(r.shape);let f=zi(u);const p=zn(i,o.shape,a,1,l,c,!1,f),m=new xn(p.inShape,"float32"),g=m.values,y=n.data.get(r.dataId).values,b=n.data.get(o.dataId).values,[v,x,w]=d,{batchSize:S,filterHeight:C,filterWidth:N,inChannels:I,inHeight:E,inWidth:A,outChannels:z,outHeight:V,outWidth:P,strideHeight:K,strideWidth:Y}=p;f=p.dataFormat;const te=C-1-p.padInfo.top,F=N-1-p.padInfo.left,j=f==="channelsLast",q=m.strides[0],J=j?m.strides[1]:m.strides[2],_=j?m.strides[2]:1,W=j?1:m.strides[1],Z=h[0],ie=j?h[1]:h[2],re=j?h[2]:1,fe=j?1:h[1];for(let ye=0;ye<S;++ye)for(let de=0;de<I;++de)for(let $e=0;$e<E;++$e){const ke=$e-te,Ae=Math.max(0,Math.ceil(ke/K)),Ue=Math.min(V,(C+ke)/K);for(let ht=0;ht<A;++ht){const Xe=ht-F,Ke=Math.max(0,Math.ceil(Xe/Y)),rt=Math.min(P,(N+Xe)/Y);let kt=0;for(let Ht=Ae;Ht<Ue;++Ht){const ss=Ht*K-ke;for(let Rn=Ke;Rn<rt;++Rn){const lr=Rn*Y-Xe,qt=Z*ye+ie*Ht+re*Rn,_n=v*(C-1-ss)+x*(N-1-lr)+w*de;for(let ur=0;ur<z;++ur){const Cs=y[qt+fe*ur],Rr=b[_n+ur];kt+=Cs*Rr}}}const ar=q*ye+J*$e+_*ht+W*de;g[ar]=kt}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const Ume={kernelName:dm,backendName:"cpu",kernelFunc:Vme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l}=s;De([r,o],"conv3d");const u=el(r.shape,o.shape,i,l,a),{filterDepth:c,filterHeight:d,filterWidth:h,dilationDepth:f,dilationHeight:p,dilationWidth:m,padInfo:g}=u,y=g.front,b=g.left,v=g.top,x=new xn(u.outShape,r.dtype),w=n.data.get(r.dataId).values,S=n.data.get(o.dataId).values,C=x.values,N=Le(r.shape),I=Le(o.shape);for(let E=0;E<u.batchSize;++E){const A=E*N[0],z=E*x.strides[0];for(let V=0;V<u.outDepth;++V){const P=z+V*x.strides[1],K=V*u.strideDepth-y;for(let Y=0;Y<c;++Y){const te=K+Y*f;if(te<0||te>=u.inDepth)continue;const F=Y*I[0],j=A+te*N[1];for(let q=0;q<u.outHeight;++q){const J=P+q*x.strides[2],_=q*u.strideHeight-v;for(let W=0;W<d;++W){const Z=_+W*p;if(Z<0||Z>=u.inHeight)continue;const ie=F+W*I[1],re=j+Z*N[2];for(let fe=0;fe<u.outWidth;++fe){const ye=J+fe*u.outChannels,de=fe*u.strideWidth-b;for(let $e=0;$e<h;++$e){const ke=de+$e*m;if(ke<0||ke>=u.inWidth)continue;const Ae=ie+$e*I[2],Ue=re+ke*u.inChannels;let ht=Ae;for(let Xe=0;Xe<u.inChannels;++Xe){const Ke=w[Ue+Xe];for(let rt=0;rt<u.outChannels;++rt)C[ye+rt]+=Ke*S[ht+rt];ht+=u.outChannels}}}}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const jme={kernelName:hm,backendName:"cpu",kernelFunc:Wme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,pad:a,filterShape:l}=s;De([r,o],"conv3dBackpropFilterV2");const u=Le(r.shape),c=Le(o.shape),d=el(r.shape,l,i,1,a),h=d.strideDepth,f=d.strideHeight,p=d.strideWidth,m=d.filterDepth,g=d.filterHeight,y=d.filterWidth,b=new xn(d.filterShape,"float32"),v=b.values,[x,w,S,C]=b.strides,N=n.data.get(o.dataId).values,[I,E,A,z]=c,V=n.data.get(r.dataId).values,[P,K,Y,te]=u,F=d.padInfo.front,j=d.padInfo.left,q=d.padInfo.top;for(let J=0;J<m;++J){const _=Math.max(0,Math.ceil((F-J)/h)),W=Math.min(d.outDepth,(d.inDepth+F-J)/h),Z=J*x;for(let ie=0;ie<g;++ie){const re=Math.max(0,Math.ceil((q-ie)/f)),fe=Math.min(d.outHeight,(d.inHeight+q-ie)/f),ye=ie*w+Z;for(let de=0;de<y;++de){const $e=Math.max(0,Math.ceil((j-de)/p)),ke=Math.min(d.outWidth,(d.inWidth+j-de)/p),Ae=de*S+ye;for(let Ue=0;Ue<d.inChannels;++Ue){const ht=Ue*C+Ae;for(let Xe=0;Xe<d.outChannels;++Xe){let Ke=0;for(let rt=0;rt<d.batchSize;++rt){const kt=rt*P,ar=rt*I;for(let Ht=_;Ht<W;++Ht){const Rn=(J+Ht*h-F)*K+kt,lr=Ht*E+ar;for(let qt=re;qt<fe;++qt){const ur=(ie+qt*f-q)*Y+Rn,Cs=qt*A+lr;for(let Rr=$e;Rr<ke;++Rr){const Hi=(de+Rr*p-j)*te+ur,qi=Rr*z+Cs;Ke+=V[Hi+Ue]*N[qi+Xe]}}}}v[ht+Xe]=Ke}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const Hme={kernelName:mv,backendName:"cpu",kernelFunc:Gme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qme(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{pad:i,strides:a,inputShape:l}=s;De([r],"conv3dBackpropInputV2");const u=Le(r.shape),c=Le(o.shape),d=el(l,o.shape,a,1,i),h=new xn(d.inShape,"float32"),f=h.values,[p,m,g,y]=h.strides,b=n.data.get(r.dataId).values,[v,x,w,S]=u,C=n.data.get(o.dataId).values,[N,I,E,A]=c,{batchSize:z,filterDepth:V,filterHeight:P,filterWidth:K,inChannels:Y,inDepth:te,inHeight:F,inWidth:j,outChannels:q,outDepth:J,outHeight:_,outWidth:W,strideDepth:Z,strideHeight:ie,strideWidth:re}=d,fe=V-1-d.padInfo.front,ye=P-1-d.padInfo.top,de=K-1-d.padInfo.left;for(let $e=0;$e<z;++$e)for(let ke=0;ke<Y;++ke)for(let Ae=0;Ae<te;++Ae){const Ue=Ae-fe,ht=Math.max(0,Math.ceil(Ue/Z)),Xe=Math.min(J,(V+Ue)/Z);for(let Ke=0;Ke<F;++Ke){const rt=Ke-ye,kt=Math.max(0,Math.ceil(rt/ie)),ar=Math.min(_,(P+rt)/ie);for(let Ht=0;Ht<j;++Ht){const ss=Ht-de,Rn=Math.max(0,Math.ceil(ss/re)),lr=Math.min(W,(K+ss)/re);let qt=0;for(let _n=ht;_n<Xe;++_n){const ur=_n*Z-Ue;for(let Cs=kt;Cs<ar;++Cs){const Rr=Cs*ie-rt;for(let hs=Rn;hs<lr;++hs){const Hi=hs*re-ss,qi=v*$e+x*_n+w*Cs+S*hs,ll=N*(V-1-ur)+I*(P-1-Rr)+E*(K-1-Hi)+A*ke;for(let Ki=0;Ki<q;++Ki){const zu=b[qi+Ki],ne=C[ll+Ki];qt+=zu*ne}}}}f[p*$e+m*Ae+g*Ke+y*Ht+ke]=qt}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const Kme={kernelName:gv,backendName:"cpu",kernelFunc:qme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xme=Nt(Od,t=>Math.cos(t)),Yme={kernelName:Od,backendName:"cpu",kernelFunc:Xme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qme=Nt(Fd,t=>Math.cosh(t)),Zme={kernelName:Fd,backendName:"cpu",kernelFunc:Qme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jme(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:u}=s,[c,d,h,f]=r.shape,p=o.shape[0],[m,g]=a,y=Ze([p,m,g,f],"float32"),b=n.data.get(o.dataId).values,v=n.data.get(i.dataId).values,x=n.data.get(r.dataId).values,w=Le(r.shape),S=Le(y.shape);for(let C=0;C<p;C++){const N=C*4,I=b[N],E=b[N+1],A=b[N+2],z=b[N+3],V=v[C];if(V>=c)continue;const P=m>1?(A-I)*(d-1)/(m-1):0,K=g>1?(z-E)*(h-1)/(g-1):0;for(let Y=0;Y<m;Y++){const te=m>1?I*(d-1)+Y*P:.5*(I+A)*(d-1);if(te<0||te>d-1){for(let F=0;F<g;F++)for(let j=0;j<f;j++){const q=j+F*S[2]+Y*S[1]+C*S[0];y.values[q]=u}continue}if(l==="bilinear"){const F=Math.floor(te),j=Math.ceil(te),q=te-F;for(let J=0;J<g;J++){const _=g>1?E*(h-1)+J*K:.5*(E+z)*(h-1);if(_<0||_>h-1){for(let re=0;re<f;re++){const fe=re+J*S[2]+Y*S[1]+C*S[0];y.values[fe]=u}continue}const W=Math.floor(_),Z=Math.ceil(_),ie=_-W;for(let re=0;re<f;re++){let fe=re+W*w[2]+F*w[1]+V*w[0];const ye=x[fe];fe=re+Z*w[2]+F*w[1]+V*w[0];const de=x[fe];fe=re+W*w[2]+j*w[1]+V*w[0];const $e=x[fe];fe=re+Z*w[2]+j*w[1]+V*w[0];const ke=x[fe],Ae=ye+(de-ye)*ie,Ue=$e+(ke-$e)*ie;fe=re+J*S[2]+Y*S[1]+C*S[0],y.values[fe]=Ae+(Ue-Ae)*q}}}else for(let F=0;F<g;++F){const j=g>1?E*(h-1)+F*K:.5*(E+z)*(h-1);if(j<0||j>h-1){for(let _=0;_<f;_++){const W=_+F*S[2]+Y*S[1]+C*S[0];y.values[W]=u}continue}const q=Math.round(j),J=Math.round(te);for(let _=0;_<f;_++){const W=_+q*w[2]+J*w[1]+V*w[0],Z=_+F*S[2]+Y*S[1]+C*S[0];y.values[Z]=x[W]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const ege={kernelName:bv,backendName:"cpu",kernelFunc:Jme};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;De(r,"cumprod");const l=tn([o],r.shape.length);let u=r;l!=null&&(u=Ps({inputs:{x:r},backend:n,attrs:{perm:l}}));const c=pn(1,r.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=As(u.dtype,"int32"),h=iv(oe(u.shape),d),f=n.data.get(u.dataId).values,p=u.shape[u.shape.length-1],m=a?(y,b)=>y+p-b-1:(y,b)=>y+b;for(let y=0;y<f.length;y+=p)for(let b=0;b<p;b++){const v=m(y,b);if(b===0)h[v]=i?1:f[v];else{const x=m(y,b-1);h[v]=i?f[x]*h[x]:f[v]*h[x]}}const g=n.makeTensorInfo(u.shape,d,h);if(l!=null){const y=tl(l),b=Ps({inputs:{x:g},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(u),b}return g}const nge={kernelName:yv,backendName:"cpu",kernelFunc:tge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;De(r,"cumsum");const l=tn([o],r.shape.length);let u=r;l!=null&&(u=Ps({inputs:{x:r},backend:n,attrs:{perm:l}}));const c=pn(1,r.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=As(u.dtype,"int32"),h=Qn(oe(u.shape),d),f=n.data.get(u.dataId).values,p=u.shape[u.shape.length-1],m=a?(y,b)=>y+p-b-1:(y,b)=>y+b;for(let y=0;y<f.length;y+=p)for(let b=0;b<p;b++){const v=m(y,b);if(b===0)h[v]=i?0:f[v];else{const x=m(y,b-1);h[v]=i?f[x]+h[x]:f[v]+h[x]}}const g=n.makeTensorInfo(u.shape,d,h);if(l!=null){const y=tl(l),b=Ps({inputs:{x:g},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(u),b}return g}const rge={kernelName:fm,backendName:"cpu",kernelFunc:sge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:o}=e,{size:i,binaryOutput:a}=s;if(r.shape.length===1){const l=n.data.get(r.dataId).values,u=n.data.get(o.dataId).values,c=yI(l,u,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,c)}else if(r.shape.length===2){const l=n.bufferSync(r),u=n.bufferSync(o),c=R4(l,u,i,a);return n.makeTensorInfo(c.shape,o.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const ige={kernelName:vv,backendName:"cpu",kernelFunc:oge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function age(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:o,dataFormat:i}=s;T(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const a=r.shape[0],l=r.shape[1],u=r.shape[2],c=r.shape[3],d=l*o,h=u*o,f=c/(o*o),p=n.data.get(r.dataId).values,m=new Float32Array(a*d*h*f);let g=0;for(let y=0;y<a;++y)for(let b=0;b<d;++b){const v=Math.floor(b/o),x=b%o;for(let w=0;w<h;++w){const S=Math.floor(w/o),C=w%o,N=(x*o+C)*f;for(let I=0;I<f;++I){const A=I+N+c*(S+u*(v+l*y));m[g++]=p[A]}}}return n.makeTensorInfo([a,d,h,f],r.dtype,m)}const lge={kernelName:xv,backendName:"cpu",kernelFunc:age};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RV(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:u}=s;De([r,o],"depthwiseConv2DNative");const c=Le(r.shape),d=Le(o.shape);let h=l;h==null&&(h=[1,1]),T(Jn(i,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${h}'`);const f=zn(r.shape,o.shape,i,h,a,u,!0),{filterHeight:p,filterWidth:m,dilationHeight:g,dilationWidth:y,padInfo:b}=f,v=b.left,x=b.top,w=f.outChannels/f.inChannels,S=new xn(f.outShape,r.dtype),C=n.data.get(r.dataId).values,N=n.data.get(o.dataId).values,I=S.values;for(let E=0;E<f.batchSize;++E){const A=E*c[0],z=E*S.strides[0];for(let V=0;V<f.outHeight;++V){const P=z+V*S.strides[1],K=V*f.strideHeight-x;for(let Y=0;Y<p;++Y){const te=K+Y*g;if(te<0||te>=f.inHeight)continue;const F=Y*d[0],j=A+te*c[1];for(let q=0;q<f.outWidth;++q){const J=P+q*S.strides[2],_=q*f.strideWidth-v;for(let W=0;W<m;++W){const Z=_+W*y;if(Z<0||Z>=f.inWidth)continue;const ie=F+W*d[1],re=j+Z*f.inChannels;let fe=J,ye=ie;for(let de=0;de<f.inChannels;++de){const $e=C[re+de];for(let ke=0;ke<w;++ke)I[fe+ke]+=$e*N[ye+ke];fe+=w,ye+=w}}}}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const uge={kernelName:pm,backendName:"cpu",kernelFunc:RV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=s;De([r,o],"depthwiseConv2dNativeBackpropFilter");const d=zn(r.shape,c,i,a,l,u,!0),{strideHeight:h,strideWidth:f,filterHeight:p,filterWidth:m}=d,g=new xn(d.filterShape,"float32"),y=d.padInfo.left,b=d.padInfo.top,v=d.outChannels/d.inChannels,x=n.data.get(r.dataId).values,w=new xn(r.shape,r.dtype,x),S=n.data.get(o.dataId).values,C=new xn(o.shape,o.dtype,S);for(let N=0;N<p;++N){const I=Math.max(0,Math.ceil((b-N)/h)),E=Math.min(d.outHeight,(d.inHeight+b-N)/h);for(let A=0;A<m;++A){const z=Math.max(0,Math.ceil((y-A)/f)),V=Math.min(d.outWidth,(d.inWidth+y-A)/f);for(let P=0;P<d.outChannels;++P){const K=Math.trunc(P/v),Y=P%v;let te=0;for(let F=0;F<d.batchSize;++F)for(let j=I;j<E;++j){const q=N+j*h-b;for(let J=z;J<V;++J){const _=A+J*f-y;te+=w.get(F,q,_,K)*C.get(F,j,J,P)}}g.set(te,N,A,K,Y)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const dge={kernelName:wv,backendName:"cpu",kernelFunc:cge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hge(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=s;De([r,o],"depthwiseConv2DNativeBackpropInput");const d=Le(r.shape),h=Le(o.shape),f=zn(c,o.shape,i,a,l,u,!0),p=new xn(f.inShape,"float32"),m=p.values,[g,y,b]=p.strides,v=n.data.get(r.dataId).values,[x,w,S]=d,C=n.data.get(o.dataId).values,[N,I,E]=h,{batchSize:A,filterHeight:z,filterWidth:V,inChannels:P,inHeight:K,inWidth:Y,outChannels:te,outHeight:F,outWidth:j,strideHeight:q,strideWidth:J}=f,_=z-1-f.padInfo.top,W=V-1-f.padInfo.left,Z=te/P;for(let ie=0;ie<A;++ie)for(let re=0;re<P;++re)for(let fe=0;fe<K;++fe){const ye=fe-_,de=Math.max(0,Math.ceil(ye/q)),$e=Math.min(F,(z+ye)/q);for(let ke=0;ke<Y;++ke){const Ae=ke-W,Ue=Math.max(0,Math.ceil(Ae/J)),ht=Math.min(j,(V+Ae)/J);let Xe=0;for(let Ke=de;Ke<$e;++Ke){const rt=Ke*q-ye;for(let kt=Ue;kt<ht;++kt){const ar=kt*J-Ae,Ht=x*ie+w*Ke+S*kt,ss=N*(z-1-rt)+I*(V-1-ar)+E*re;for(let Rn=0;Rn<Z;++Rn){const lr=re*Z+Rn,qt=v[Ht+lr],_n=C[ss+Rn];Xe+=qt*_n}}}m[g*ie+y*fe+b*ke+re]=Xe}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const fge={kernelName:Sv,backendName:"cpu",kernelFunc:hge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pge(t){const{inputs:e,backend:n}=t,{x:s}=e,r=oe(s.shape),o=n.data.get(s.dataId).values,i=Ze([r,r],s.dtype),a=i.values;for(let u=0;u<o.length;u++)a[u*r+u]=o[u];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,i.dtype,i.values)}const mge={kernelName:kv,backendName:"cpu",kernelFunc:pge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gge={kernelName:mm,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r}=t,{strides:o,pad:i,dilations:a}=n,l=e,u=l.data.get(s.dataId).values,c=s.shape.length,d=l.data.get(r.dataId).values,h=r.shape.length,{batchSize:f,inHeight:p,inWidth:m,inChannels:g,outHeight:y,outWidth:b,padInfo:v,strideHeight:x,strideWidth:w,filterHeight:S,filterWidth:C,dilationHeight:N,dilationWidth:I,outShape:E}=rg(s.shape,r.shape,o,i,"NHWC",a),A=oe(E),z=E.length,V=sn(s.dtype,A);for(let K=0;K<f;++K)for(let Y=0;Y<y;++Y){const te=Y*x-v.top;for(let F=0;F<b;++F){const j=F*w-v.left;for(let q=0;q<g;++q){let J=Number.MIN_SAFE_INTEGER;for(let W=0;W<S;++W){const Z=te+W*N;if(Z>=0&&Z<p)for(let ie=0;ie<C;++ie){const re=j+ie*I;if(re>=0&&re<m){const fe=bo([K,Z,re,q],c,Le(s.shape)),ye=bo([W,ie,q],h,Le(r.shape)),de=u[fe]+d[ye];de>J&&(J=de)}}}const _=bo([K,Y,F,q],z,Le(E));V[_]=J}}}return{dataId:l.write(Za(V,s.dtype),E,s.dtype),shape:E,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yge={kernelName:O0,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:o}=t,{strides:i,pad:a,dilations:l}=n,u=e,c=wr(s.shape,u.data.get(s.dataId).values),d=wr(r.shape,u.data.get(r.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:m,outHeight:g,outWidth:y,padInfo:b,strideHeight:v,strideWidth:x,filterHeight:w,filterWidth:S,dilationHeight:C,dilationWidth:N,outShape:I}=rg(s.shape,r.shape,i,a,"NHWC",l);T(o.rank===I.length,()=>`Error in ${O0}, dy must have the same rank as output ${I.length}, but got ${o.rank}`);const E=wr(I,u.data.get(o.dataId).values),A=UN(r.shape,r.dtype);for(let V=0;V<h;++V)for(let P=0;P<g;++P){const K=P*v-b.top;for(let Y=0;Y<y;++Y){const te=Y*x-b.left;for(let F=0;F<m;++F){let j=Number.MIN_SAFE_INTEGER,q=0,J=0;for(let _=0;_<w;++_){const W=K+_*C;if(W>=0&&W<f)for(let Z=0;Z<S;++Z){const ie=te+Z*N;if(ie>=0&&ie<p){const re=c[V][W][ie][F]+d[_][Z][F];re>j&&(j=re,q=_,J=Z)}}}A[q][J][F]+=E[V][P][Y][F]}}}return{dataId:u.write(Za(A,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bge={kernelName:D0,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:o}=t,{strides:i,pad:a,dilations:l}=n,u=e,c=wr(s.shape,u.data.get(s.dataId).values),d=wr(r.shape,u.data.get(r.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:m,outHeight:g,outWidth:y,padInfo:b,strideHeight:v,strideWidth:x,filterHeight:w,filterWidth:S,dilationHeight:C,dilationWidth:N,outShape:I}=rg(s.shape,r.shape,i,a,"NHWC",l);T(o.rank===I.length,()=>`Error in ${D0}, dy must have the same rank as output ${I.length}, but got ${o.rank}`);const E=wr(I,u.data.get(o.dataId).values),A=UN(s.shape,s.dtype);for(let V=0;V<h;++V)for(let P=0;P<g;++P){const K=P*v-b.top;for(let Y=0;Y<y;++Y){const te=Y*x-b.left;for(let F=0;F<m;++F){let j=Number.MIN_SAFE_INTEGER,q=K<0?0:K,J=te<0?0:te;for(let _=0;_<w;++_){const W=K+_*C;if(W>=0&&W<f)for(let Z=0;Z<S;++Z){const ie=te+Z*N;if(ie>=0&&ie<p){const re=c[V][W][ie][F]+d[_][Z][F];re>j&&(j=re,q=W,J=ie)}}}A[V][q][J][F]+=E[V][P][Y][F]}}}return{dataId:u.write(Za(A,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vge(t){const{inputs:e,backend:n,attrs:s}=t,{image:r}=e,{canvas:o,options:i}=s,{contextOptions:a,imageOptions:l}=i||{},u=(l==null?void 0:l.alpha)||1,c=(a==null?void 0:a.contextType)||"2d";if(c!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const d=o.getContext(c,(a==null?void 0:a.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${c} type.`);const[h,f]=r.shape.slice(0,2),p=r.shape.length===2?1:r.shape[2],m=n.data.get(r.dataId).values,g=r.dtype==="float32"?255:1,y=new Uint8ClampedArray(f*h*4);for(let v=0;v<h*f;++v){const x=[0,0,0,255*u];for(let S=0;S<p;S++){const C=m[v*p+S];if(r.dtype==="float32"){if(C<0||C>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${C}.`)}else if(r.dtype==="int32"&&(C<0||C>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${C}.`);p===1?(x[0]=C*g,x[1]=C*g,x[2]=C*g):x[S]=C*g}const w=v*4;y[w+0]=Math.round(x[0]),y[w+1]=Math.round(x[1]),y[w+2]=Math.round(x[2]),y[w+3]=Math.round(x[3])}o.width=f,o.height=h;const b=new ImageData(y,f,h);return d.putImageData(b,0,0),r}const xge={kernelName:Cv,backendName:"cpu",kernelFunc:vge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dg(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;De(r,"sum");let a;r.dtype==="bool"?a=Ha({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):a=ti({inputs:{x:r},backend:n});const l=a.shape.length,u=st(o,a.shape),c=tn(u,l);let d=u,h=a;c!=null&&(h=Ps({inputs:{x:a},backend:n,attrs:{perm:c}}),d=pn(d.length,l)),es("sum",d,h.shape.length);const[f,p]=Bn(h.shape,d),m=As(h.dtype,"int32");let g=J0(n,f,m);const y=oe(p),b=n.data.get(g.dataId).values,v=n.data.get(h.dataId).values;for(let x=0;x<b.length;++x){const w=x*y;let S=0;for(let C=0;C<y;++C)S+=v[w+C];b[x]=S}if(i){const x=fn(g.shape,u),w=g;g=Ot({inputs:{x:g},backend:n,attrs:{shape:x}}),n.disposeIntermediateTensorInfo(w)}return n.disposeIntermediateTensorInfo(a),c!=null&&n.disposeIntermediateTensorInfo(h),g}const wge={kernelName:Km,backendName:"cpu",kernelFunc:Dg};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sge(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,o=e,{allDims:i,summedDims:a,idDims:l}=z$(r,o.length);V$(i.length,l,o);const{path:u,steps:c}=U$(a,l),d=c.length;let h=null,f=i.length;const p=[];for(let m=0;m<d;++m){for(const g of c[m]){const{permutationIndices:y,expandDims:b}=B$(f,l[g]);let v;W$(y)?v=o[g]:(v=Ps({inputs:{x:o[g]},backend:n,attrs:{perm:y}}),p.push(v));const x=v.shape.slice();for(let w=0;w<b.length;++w)x.splice(b[w],0,1);ut(v.shape,x)||(v=Ot({inputs:{x:v},backend:n,attrs:{shape:x}}),p.push(v)),h===null?h=v:(h=mw({inputs:{a:v,b:h},backend:n}),p.push(h))}m<d-1&&(u[m]>=0&&(h=Dg({inputs:{x:h},backend:n,attrs:{axis:u[m]-(i.length-f),keepDims:!1}}),p.push(h)),f--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const kge={kernelName:Nv,backendName:"cpu",kernelFunc:Sge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cge(t){const{inputs:e,backend:n}=t,{dy:s,y:r}=e;De([s,r],"eluGrad");const o=new Float32Array(oe(r.shape)),i=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values;for(let l=0;l<i.length;++l){const u=i[l];u>=0?o[l]=a[l]:o[l]=a[l]*(u+1)}return n.makeTensorInfo(r.shape,"float32",o)}const Nge={kernelName:Tv,backendName:"cpu",kernelFunc:Cge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tge=A$,$ge=D$,Ige=O$,Ege=F$,Rge=L$,_ge=P$,Age=Nt(Md,t=>{const e=Math.sign(t),n=Math.abs(t),s=1/(1+Tge*n);return e*(1-((((_ge*s+Rge)*s+Ege)*s+Ige)*s+$ge)*s*Math.exp(-n*n))}),Dge={kernelName:Md,backendName:"cpu",kernelFunc:Age};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nb(t){const{inputs:e,backend:n,attrs:s}=t,{input:r}=e,{dim:o}=s,i=r.shape.length,a=r.shape.slice();let l=o;return o<0&&(T(-(i+1)<=o,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+o+1),a.splice(l,0,1),Ot({inputs:{x:r},backend:n,attrs:{shape:a}})}const Oge={kernelName:ym,backendName:"cpu",kernelFunc:nb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fge=gn((t,e)=>t/e),kI=En(Ld,Fge),sC={kernelName:Ld,backendName:"cpu",kernelFunc:kI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _V(t,e,n){const s=t.shape,r=s[0],o=s[1],i=n.data.get(t.dataId),a=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,u=[r,o],c=oe(u),d=Pn("float32",c),h=Pn("float32",c);for(let g=0;g<r;g++){const y=mu({inputs:{x:a},backend:n,attrs:{begin:[g,0],size:[1,o]}}),b=mu({inputs:{x:l},backend:n,attrs:{begin:[g,0],size:[1,o]}}),v=qs({inputs:{real:y,imag:b},backend:n}),{real:x,imag:w}=Lge(v,e,n),S=_i(x,w);for(let C=0;C<o;C++){const N=M$(S,C);d[g*o+C]=N.real,h[g*o+C]=N.imag}n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(v)}const f=n.makeTensorInfo(u,"float32",d),p=n.makeTensorInfo(u,"float32",h),m=qs({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}function Lge(t,e,n){const s=oe(t.shape),r=n.data.get(t.dataId),o=n.data.get(r.complexTensorInfos.real.dataId).values,i=n.data.get(r.complexTensorInfos.imag.dataId).values;if(Pge(s)){const a=rC(o,i,s,e,n),l=[t.shape[0],t.shape[1]];if(e){const u=n.makeTensorInfo(l,"float32",a.real),c=n.makeTensorInfo(l,"float32",a.imag),d=n.makeTensorInfo([],"float32",Pi(s,"float32")),h=ti({inputs:{x:d},backend:n}),f=sC.kernelFunc({inputs:{a:u,b:d},backend:n}),p=sC.kernelFunc({inputs:{a:c,b:h},backend:n}),m=n.data.get(f.dataId).values,g=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),{real:m,imag:g}}return a}else{const a=_i(o,i),l=Mge(a,s,e);return FM(l)}}function Pge(t){return(t&t-1)===0}function rC(t,e,n,s,r){if(n===1)return{real:t,imag:e};const o=_i(t,e),i=n/2,a=LM(o),l=a.real,u=a.imag,c=[l.length],d=r.makeTensorInfo(c,"float32",l),h=r.makeTensorInfo(c,"float32",u),f=qs({inputs:{real:d,imag:h},backend:r}),p=PM(o),m=p.real,g=p.imag,y=[m.length],b=r.makeTensorInfo(y,"float32",m),v=r.makeTensorInfo(y,"float32",g),x=qs({inputs:{real:b,imag:v},backend:r}),w=rC(l,u,i,s,r),S=w.real,C=w.imag,N=[S.length],I=r.makeTensorInfo(N,"float32",S),E=r.makeTensorInfo(N,"float32",C),A=qs({inputs:{real:I,imag:E},backend:r}),z=rC(m,g,i,s,r),V=z.real,P=z.imag,K=[V.length],Y=r.makeTensorInfo(K,"float32",V),te=r.makeTensorInfo(K,"float32",P),F=qs({inputs:{real:Y,imag:te},backend:r}),j=zM(n,s),q=[j.real.length],J=r.makeTensorInfo(q,"float32",j.real),_=r.makeTensorInfo(q,"float32",j.imag),W=qs({inputs:{real:J,imag:_},backend:r}),Z=mw({inputs:{a:W,b:F},backend:r}),ie=dd({inputs:{a:A,b:Z},backend:r}),re=wI({inputs:{a:A,b:Z},backend:r}),fe=pu({inputs:{input:ie},backend:r}),ye=pu({inputs:{input:re},backend:r}),de=hd({inputs:{input:ie},backend:r}),$e=hd({inputs:{input:re},backend:r}),ke=fd({inputs:[fe,ye],backend:r,attrs:{axis:0}}),Ae=fd({inputs:[de,$e],backend:r,attrs:{axis:0}}),Ue=r.data.get(ke.dataId).values,ht=r.data.get(Ae.dataId).values;return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(x),r.disposeIntermediateTensorInfo(I),r.disposeIntermediateTensorInfo(E),r.disposeIntermediateTensorInfo(A),r.disposeIntermediateTensorInfo(Y),r.disposeIntermediateTensorInfo(te),r.disposeIntermediateTensorInfo(F),r.disposeIntermediateTensorInfo(J),r.disposeIntermediateTensorInfo(_),r.disposeIntermediateTensorInfo(W),r.disposeIntermediateTensorInfo(Z),r.disposeIntermediateTensorInfo(ie),r.disposeIntermediateTensorInfo(re),r.disposeIntermediateTensorInfo(fe),r.disposeIntermediateTensorInfo(de),r.disposeIntermediateTensorInfo(ye),r.disposeIntermediateTensorInfo($e),r.disposeIntermediateTensorInfo(ke),r.disposeIntermediateTensorInfo(Ae),{real:Ue,imag:ht}}function Mge(t,e,n){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let o=0,i=0;for(let a=0;a<e;a++){const l=BM(r*a,e,n),u=M$(t,a);o+=u.real*l.real-u.imag*l.imag,i+=u.real*l.imag+u.imag*l.real}n&&(o/=e,i/=e),MM(s,o,i,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zge(t){const{inputs:e,backend:n}=t,{input:s}=e,r=oe(s.shape),o=s.shape[s.shape.length-1],i=r/o,a=Ot({inputs:{x:s},backend:n,attrs:{shape:[i,o]}}),l=_V(a,!1,n),u=Ot({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const Bge={kernelName:$v,backendName:"cpu",kernelFunc:zge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CI(t){const{backend:e,attrs:n}=t,{shape:s,value:r,dtype:o}=n,i=o||Cu(r),a=sn(i,oe(s));return Uge(a,r,i),e.makeTensorInfo(s,i,a)}const Vge={kernelName:Iv,backendName:"cpu",kernelFunc:CI};function Uge(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wge={kernelName:Ev,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,r=n,o=Pn(s.dtype,oe(s.shape)),[i,a,l,u]=s.shape,c=r.data.get(s.dataId).values;for(let h=0;h<i;h++){const f=h*l*a*u;for(let p=0;p<a;p++){const m=p*(l*u);for(let g=0;g<l;g++){const y=g*u;for(let b=0;b<u;b++){const v=Math.round(l-g-1),x=f+m+y+b;let w=c[x];if(v>=0&&v<l){const S=v*u,C=f+m+S+b;w=c[C]}o[x]=w}}}}return{dataId:r.write(o,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s;let m=EV({inputs:{x:r,filter:o},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h}});if(i){const g=m;if(c==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const y=Ot({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});m=dd({inputs:{a:m,b:y},backend:n}),n.disposeIntermediateTensorInfo(y)}else m=dd({inputs:{a:m,b:i},backend:n});n.disposeIntermediateTensorInfo(g)}if(f){const g=m;if(c==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const y=Ot({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});m=tb(n,m,f,y,p),n.disposeIntermediateTensorInfo(y)}else m=tb(n,m,f,a,p);n.disposeIntermediateTensorInfo(g)}return m}const Gge={kernelName:ip,backendName:"cpu",kernelFunc:jge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s;let m=RV({inputs:{x:r,filter:o},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h}});if(i){const g=m;m=dd({inputs:{a:m,b:i},backend:n}),n.disposeIntermediateTensorInfo(g)}if(f){const g=m;m=tb(n,m,f,a,p),n.disposeIntermediateTensorInfo(g)}return m}const qge={kernelName:ap,backendName:"cpu",kernelFunc:Hge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kge(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,o=oe(s.shape),i=r.shape,a=i[i.length-1],[l,u,c,d]=Qx(s,r);if(u===0)return n.makeTensorInfo(l,s.dtype,[]);const h=n.data.get(r.dataId).values,f=n.bufferSync(s),p=V4(h,f,s.dtype,u,a,c,d,s.shape,o);return n.makeTensorInfo(l,s.dtype,p.values)}const Xge={kernelName:Rv,backendName:"cpu",kernelFunc:Kge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:o}=e,{axis:i,batchDims:a}=s;De([r,o],"gatherV2");const l=st(i,r.shape)[0],u=n.data.get(o.dataId).values,c=r.shape[l];for(let x=0;x<u.length;++x){const w=u[x];T(w<=c-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${c-1}]`)}let d=a;a==null&&(d=0);const h=oe(o.shape),f=G$(r,o,l,d),p=Ot({inputs:{x:r},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),m=Ot({inputs:{x:o},backend:n,attrs:{shape:[f.batchSize,h/f.batchSize]}}),g=[f.batchSize,f.outerSize,h/f.batchSize,f.sliceSize],y=n.bufferSync(m),b=n.bufferSync(p),v=U4(b,y,g);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(f.outputShape,v.dtype,v.values)}const Qge={kernelName:vm,backendName:"cpu",kernelFunc:Yge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zge(t){const{inputs:e,backend:n}=t,{input:s}=e,r=oe(s.shape),o=s.shape[s.shape.length-1],i=r/o,a=Ot({inputs:{x:s},backend:n,attrs:{shape:[i,o]}}),l=_V(a,!0,n),u=Ot({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),u}const Jge={kernelName:_v,backendName:"cpu",kernelFunc:Zge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eye=Nt(Gd,t=>Number.isFinite(t)?1:0,"bool"),tye={kernelName:Gd,backendName:"cpu",kernelFunc:eye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nye=Nt(Hd,t=>Math.abs(t)===1/0?1:0,"bool"),sye={kernelName:Hd,backendName:"cpu",kernelFunc:nye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rye=Nt(qd,t=>Number.isNaN(t)?1:0,"bool"),oye={kernelName:qd,backendName:"cpu",kernelFunc:rye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iye(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:o}=n,i=q4(s,r,o);return e.makeTensorInfo([i.length],"float32",i)}const aye={kernelName:Dv,backendName:"cpu",kernelFunc:iye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lye=Nt(Xd,t=>Math.log1p(t)),uye={kernelName:Xd,backendName:"cpu",kernelFunc:lye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cye=gn((t,e)=>t&&e),dye=En(Cm,cye,null,"bool"),hye={kernelName:Cm,backendName:"cpu",kernelFunc:dye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fye=Nt(Nm,t=>t?0:1,"bool"),pye={kernelName:Nm,backendName:"cpu",kernelFunc:fye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mye=gn((t,e)=>t||e),gye=En(Tm,mye,null,"bool"),yye={kernelName:Tm,backendName:"cpu",kernelFunc:gye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=s;De(r,"LRN");const u=r.shape[3],c=u-1,d=n.data.get(r.dataId).values,h=oe(r.shape),f=new Float32Array(h);function p(m){const g=m%u;let y=m-g+Math.max(0,g-o);const b=m-g+Math.min(g+o,c);let v=0;for(;y<=b;y++){const x=d[y];v+=x*x}return v}for(let m=0;m<h;m++){const g=p(m),y=d[m]*Math.pow(i+a*g,-l);f[m]=y}return n.makeTensorInfo(r.shape,r.dtype,f)}const vye={kernelName:$m,backendName:"cpu",kernelFunc:bye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=s;De(i,"LRNGrad");const d=oe(i.shape),h=i.shape[3],f=n.data.get(i.dataId).values,p=n.data.get(r.dataId).values,m=n.data.get(o.dataId).values,g=new Float32Array(d),y=d;for(let b=0;b<y;b++){const v=b%h,x=b-v+Math.max(0,v-a),w=b-v+Math.min(h,v+a+1);let S=0;for(let C=x;C<w;C++)S+=Math.pow(p[C],2);S=u*S+l;for(let C=x;C<w;C++){let N=-2*u*c*p[C]*m[b]/S;b===C&&(N+=Math.pow(S,-c)),N*=f[b],g[C]+=N}}return n.makeTensorInfo(i.shape,r.dtype,g)}const wye={kernelName:Ov,backendName:"cpu",kernelFunc:xye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AV(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:o,keepDims:i}=s,a=n;let l=r.shape;const u=l.length,c=st(o,l);let d=c;const h=tn(d,u);let f=a.data.get(r.dataId).values;if(h!=null){const x=new Array(u);for(let w=0;w<x.length;w++)x[w]=l[h[w]];f=vI(f,l,r.dtype,h,x),d=pn(d.length,u),l=x}De(r,"max"),es("max",d,u);const[p,m]=Bn(l,d),g=oe(m),y=X4(f,g,p,r.dtype),b=a.write(y,p,r.dtype);let v=p;return i&&(v=fn(p,c)),{dataId:b,shape:v,dtype:r.dtype}}const Sye={kernelName:Im,backendName:"cpu",kernelFunc:AV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;De(r,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,u=1;T(Jn(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=eo(r.shape,o,i,u,a,l);let d;if(c.filterWidth===1&&c.filterHeight===1&&ut(c.inShape,c.outShape))d=ti({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,f=Le(r.shape),p=SI(h,r.shape,r.dtype,f,c,"max");d=n.makeTensorInfo(c.outShape,r.dtype,p.values)}return d}const Cye={kernelName:Em,backendName:"cpu",kernelFunc:kye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:u}=s;De(r,"maxPool3d");const c=Mi(r.shape,o,i,1,a,l,u),d=n.data.get(r.dataId).values,h=IV(d,r.shape,r.dtype,Le(r.shape),c,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}const Tye={kernelName:Rm,backendName:"cpu",kernelFunc:Nye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ye(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:u}=s;De([r,o],"maxPool3DGrad");const c=Mi(o.shape,i,a,1,l,u),d=n.bufferSync(o),h=mme(d,c),f=c.strideDepth,p=c.strideHeight,m=c.strideWidth,g=c.dilationDepth,y=c.dilationHeight,b=c.dilationWidth,v=c.effectiveFilterDepth,x=c.effectiveFilterHeight,w=c.effectiveFilterWidth,S=v-1-c.padInfo.front,C=w-1-c.padInfo.left,N=x-1-c.padInfo.top,I=Ze(o.shape,"float32"),E=n.bufferSync(r);for(let A=0;A<c.batchSize;++A)for(let z=0;z<c.inChannels;++z)for(let V=0;V<c.inDepth;++V)for(let P=0;P<c.inHeight;++P)for(let K=0;K<c.inWidth;++K){const Y=V-S,te=P-N,F=K-C;let j=0;for(let q=0;q<v;q+=g){const J=(Y+q)/f;if(!(J<0||J>=c.outDepth||Math.floor(J)!==J))for(let _=0;_<x;_+=y){const W=(te+_)/p;if(!(W<0||W>=c.outHeight||Math.floor(W)!==W))for(let Z=0;Z<w;Z+=b){const ie=(F+Z)/m;if(ie<0||ie>=c.outWidth||Math.floor(ie)!==ie)continue;const re=v*x*w-1-h.get(A,J,W,ie,z),fe=q*x*w+_*w+Z,ye=re===fe?1:0;if(ye===0)continue;const de=E.get(A,J,W,ie,z);j+=de*ye}}}I.set(j,A,V,P,K,z)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const Iye={kernelName:Lv,backendName:"cpu",kernelFunc:$ye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eye(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o,output:i}=e,a=o;De([o,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=s,h=eo(a.shape,l,u,1,c,d),f=n.data.get(a.dataId).values,p=Ze(h.outShape,a.dtype,$V(f,a.shape,a.dtype,h).values),m=h.strideHeight,g=h.strideWidth,y=h.dilationHeight,b=h.dilationWidth,v=h.effectiveFilterHeight,x=h.effectiveFilterWidth,w=x-1-h.padInfo.left,S=v-1-h.padInfo.top,C=Ze(a.shape,"float32"),N=n.data.get(r.dataId).values,I=Ze(r.shape,"float32",N);for(let E=0;E<h.batchSize;++E)for(let A=0;A<h.inChannels;++A)for(let z=0;z<h.inHeight;++z)for(let V=0;V<h.inWidth;++V){const P=z-S,K=V-w;let Y=0;for(let te=0;te<v;te+=y){const F=(P+te)/m;if(!(F<0||F>=h.outHeight||Math.floor(F)!==F))for(let j=0;j<x;j+=b){const q=(K+j)/g;if(q<0||q>=h.outWidth||Math.floor(q)!==q)continue;const J=v*x-1-p.get(E,F,q,A),_=te*x+j,W=J===_?1:0;if(W===0)continue;const Z=I.get(E,F,q,A);Y+=Z*W}}C.set(Y,E,z,V,A)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const Rye={kernelName:Fv,backendName:"cpu",kernelFunc:Eye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ye(t,e,n,s,r){const o=Le(e),i=SI(t,e,n,o,r,"max"),a=$V(t,e,n,r,!0,s);return[i.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aye={kernelName:Pv,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:o,pad:i,includeBatchInIndex:a}=e,l=n;De(s,"MaxPoolWithArgmax");const u=l.data.get(s.dataId).values,c=eo(s.shape,r,o,[1,1],i),[d,h]=_ye(u,s.shape,s.dtype,a,c),f=l.write(d,c.outShape,s.dtype),p=l.write(h,c.outShape,s.dtype);return[{dataId:f,shape:c.outShape,dtype:s.dtype},{dataId:p,shape:c.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=st(o,r.shape),u=Bn(r.shape,a)[1],c=oe(u),d=[],h=n.makeTensorInfo([],"float32",new Float32Array([c]));d.push(h);const f=Ha({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});d.push(f);const p=kI({inputs:{a:f,b:h},backend:n});d.push(p);const m=Dg({inputs:{x:p},backend:n,attrs:{axis:o,keepDims:i}});return d.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}const Oye={kernelName:_m,backendName:"cpu",kernelFunc:Dye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;De(r,"min");const a=st(o,r.shape);let l=a;const u=tn(l,r.shape.length);let c=r;u!=null&&(c=Ps({inputs:{x:r},backend:n,attrs:{perm:u}}),l=pn(l.length,r.shape.length)),es("min",l,c.shape.length);const[d,h]=Bn(c.shape,l),f=oe(h),p=Qn(oe(d),c.dtype),m=n.data.get(c.dataId).values;for(let y=0;y<p.length;++y){const b=y*f;let v=m[b];for(let x=0;x<f;++x){const w=m[b+x];(Number.isNaN(w)||w<v)&&(v=w)}p[y]=v}u!=null&&n.disposeIntermediateTensorInfo(c);const g=n.makeTensorInfo(d,c.dtype,p);if(i){const y=fn(d,a),b=Ot({inputs:{x:g},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(g),b}return g}const Lye={kernelName:Am,backendName:"cpu",kernelFunc:Fye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:o,mode:i}=s;De(r,"mirrorPad");const a=o.map((v,x)=>v[0]+r.shape[x]+v[1]),l=o.map(v=>v[0]),u=o.map((v,x)=>v[0]+r.shape[x]),c=i==="reflect"?0:1,d=n.data.get(r.dataId).values,h=r.shape.length,f=Le(r.shape),p=oe(a),m=a.length,g=Le(a),y=Pn(r.dtype,p);for(let v=0;v<p;v++){let x=Nu(v,m,g);for(let S=0;S<m;S++)x[S]<l[S]?x[S]=l[S]*2-x[S]-c:x[S]>=u[S]&&(x[S]=(u[S]-1)*2-x[S]+c);x=x.map((S,C)=>S-l[C]);const w=bo(x,h,f);y[v]=d[w]}return{dataId:n.write(y,a,r.dtype),shape:a,dtype:r.dtype}}const Mye={kernelName:Dm,backendName:"cpu",kernelFunc:Pye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zye=gn((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),Bye=En(Zd,zye),Vye={kernelName:Zd,backendName:"cpu",kernelFunc:Bye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DV(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:o}=s,i=r.shape.length;let a=o;if(a===-1&&(a=i-1),a!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${a}`);const l=st([a],r.shape),u=AV({inputs:{x:r},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=fn(u.shape,l),d=Ot({inputs:{x:u},backend:n,attrs:{shape:c}}),h=wI({inputs:{a:r,b:d},backend:n}),f=P4({inputs:{x:h},backend:n}),p=Dg({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),m=Ot({inputs:{x:p},backend:n,attrs:{shape:c}}),g=kI({inputs:{a:f,b:m},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}const Uye={kernelName:Qm,backendName:"cpu",kernelFunc:DV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wye(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:o,seed:i,normalized:a}=s;De(r,"multinomial");const l=a?r:DV({inputs:{logits:r},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],d=n.data.get(l.dataId).values,h=[u,o],f=Qn(oe(h),"int32");for(let p=0;p<u;++p){const m=p*c,g=new Float32Array(c-1);g[0]=d[m];for(let v=1;v<g.length;++v)g[v]=g[v-1]+d[m+v];const y=yg.alea(i.toString()),b=p*o;for(let v=0;v<o;++v){const x=y();f[b+v]=g.length;for(let w=0;w<g.length;w++)if(x<g[w]){f[b+v]=w;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",f)}const jye={kernelName:Mv,backendName:"cpu",kernelFunc:Wye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gye=qx;function Hye(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=s;De(r,"NonMaxSuppression");const u=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,{selectedIndices:d}=Gye(u,c,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const qye={kernelName:zv,backendName:"cpu",kernelFunc:Hye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kye=Kx;function Xye(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=s;De(r,"NonMaxSuppressionPadded");const c=n.data.get(r.dataId).values,d=n.data.get(o.dataId).values,{selectedIndices:h,validOutputs:f}=Kye(c,d,i,a,l,u);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const Yye={kernelName:Bv,backendName:"cpu",kernelFunc:Xye};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qye=Xx;function Zye(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=s;De(r,"NonMaxSuppressionWithScore");const c=n.data.get(r.dataId).values,d=n.data.get(o.dataId).values,h=i,f=a,p=l,m=u,{selectedIndices:g,selectedScores:y}=Qye(c,d,h,f,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const Jye={kernelName:Vv,backendName:"cpu",kernelFunc:Zye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e0e(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:o,depth:i,onValue:a,offValue:l}=s;De(r,"oneHot");const u=oe(r.shape),c=new Float32Array(u*i);c.fill(l);const d=n.data.get(r.dataId).values;for(let h=0;h<u;++h)d[h]>=0&&d[h]<i&&(c[h*i+d[h]]=a);return n.makeTensorInfo([...r.shape,i],o,c)}const t0e={kernelName:Pm,backendName:"cpu",kernelFunc:e0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sb(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=pu({inputs:{input:s},backend:n}),o=sb({inputs:{x:r},backend:n}),i=hd({inputs:{input:s},backend:n}),a=sb({inputs:{x:i},backend:n}),l=qs({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return CI({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const n0e={kernelName:tg,backendName:"cpu",kernelFunc:sb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OV(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=pu({inputs:{input:s},backend:n}),o=OV({inputs:{x:r},backend:n}),i=hd({inputs:{input:s},backend:n}),a=sb({inputs:{x:i},backend:n}),l=qs({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return CI({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const s0e={kernelName:Lm,backendName:"cpu",kernelFunc:OV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FV(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return nb({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const o=e[0].shape,i=e[0].dtype;e.forEach(c=>{Zn(o,c.shape,"All tensors passed to stack must have matching shapes"),T(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const d=nb({inputs:{input:c},backend:n,attrs:{dim:r}});return a.push(d),d}),u=fd({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const r0e={kernelName:Mm,backendName:"cpu",kernelFunc:FV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:o,constantValue:i}=s;De(r,"pad");const a=o.map((b,v)=>b[0]+r.shape[v]+b[1]),l=o.map(b=>b[0]),u=n.data.get(r.dataId).values,c=oe(r.shape),d=r.shape.length,h=Le(r.shape),f=oe(a),p=a.length,m=Le(a),g=Pn(r.dtype,f);i!==0&&g.fill(i);for(let b=0;b<c;b++){const x=Nu(b,d,h).map((S,C)=>S+l[C]),w=bo(x,p,m);g[w]=u[b]}return{dataId:n.write(g,a,r.dtype),shape:a,dtype:r.dtype}}const LV={kernelName:zm,backendName:"cpu",kernelFunc:o0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i0e=gn((t,e)=>Math.pow(t,e)),a0e=En(eh,i0e),l0e={kernelName:eh,backendName:"cpu",kernelFunc:a0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u0e(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:o,indices:i}=e,a=r.map(g=>n.data.get(g.dataId).values),l=r.map(g=>g.shape),u=n.data.get(o.dataId).values,c=n.data.get(i.dataId).values,[d,h,f]=tV(a,l,u,o.shape,o.dtype,c,i.shape),p=d.map(g=>n.makeTensorInfo([g.length],"int32",g)),m=n.makeTensorInfo(f,o.dtype,h);return p.concat([m])}const c0e={kernelName:Uv,backendName:"cpu",kernelFunc:u0e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d0e(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:o}=e,i=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,[u,c]=nV(i,s.shape,s.dtype,a,r.shape,l,o.shape),d=n.makeTensorInfo([u.length],"int32",u),h=n.makeTensorInfo([c.length],s.dtype,c);return[d,h]}const h0e={kernelName:Wv,backendName:"cpu",kernelFunc:d0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f0e(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,u=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,d=n.data.get(i.dataId).values,h=a.map(g=>n.data.get(g.dataId).values),f=a.map(g=>g.shape),[p,m]=sV(u,r.shape,c,o.shape,o.dtype,d,i.shape,h,f,l);return n.makeTensorInfo(p,o.dtype,m)}const p0e={kernelName:jv,backendName:"cpu",kernelFunc:f0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m0e(t){const{backend:e,attrs:n}=t,{start:s,stop:r,dtype:o,step:i}=n,a=rV(s,r,i,o);return e.makeTensorInfo([a.length],o,a)}const g0e={kernelName:Gv,backendName:"cpu",kernelFunc:m0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y0e=Nt(th,t=>1/t),b0e={kernelName:th,backendName:"cpu",kernelFunc:y0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v0e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s;De(r,"resizeBilinear");const l=Le(r.shape),[u,c]=a,[d,h,f,p]=r.shape,m=n.data.get(r.dataId).values,g=new Float32Array(oe([d,u,c,p])),y=[o&&u>1?h-1:h,o&&c>1?f-1:f],b=[o&&u>1?u-1:u,o&&c>1?c-1:c];let v=0;const x=y[0]/b[0],w=y[1]/b[1];for(let S=0;S<d;S++)for(let C=0;C<u;C++){let N;i?N=x*(C+.5)-.5:N=x*C;const I=Math.max(0,Math.floor(N)),E=N-I,A=Math.min(h-1,Math.ceil(N)),z=S*l[0]+I*l[1],V=S*l[0]+A*l[1];for(let P=0;P<c;P++){let K;i?K=w*(P+.5)-.5:K=w*P;const Y=Math.max(0,Math.floor(K)),te=K-Y,F=Math.min(f-1,Math.ceil(K)),j=z+Y*l[2],q=V+Y*l[2],J=z+F*l[2],_=V+F*l[2];for(let W=0;W<p;W++){const Z=m[j+W],ie=m[q+W],re=m[J+W],fe=m[_+W],ye=Z+(re-Z)*te,de=ie+(fe-ie)*te,$e=ye+(de-ye)*E;g[v++]=$e}}}return n.makeTensorInfo([d,u,c,p],"float32",g)}const x0e={kernelName:jm,backendName:"cpu",kernelFunc:v0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w0e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:o}=e,{alignCorners:i}=s;De([o,r],"resizeBilinearGrad");const a=Le(r.shape),[l,u,c,d]=r.shape,[,h,f]=o.shape,p=new Float32Array(l*u*c*d),m=[i&&h>1?u-1:u,i&&f>1?c-1:c],g=[i&&h>1?h-1:h,i&&f>1?f-1:f],y=m[0]/g[0],b=m[1]/g[1],v=n.data.get(o.dataId).values;let x=0;for(let w=0;w<l;w++){const S=w*a[0];for(let C=0;C<h;C++){const N=C*y,I=Math.floor(N),E=Math.min(Math.ceil(N),u-1),A=S+I*a[1],z=S+E*a[1],V=N-I,P=1-V;for(let K=0;K<f;K++){const Y=K*b,te=Math.floor(Y),F=Math.min(Math.ceil(Y),c-1),j=Y-te,q=1-j,J=A+te*a[2],_=A+F*a[2],W=z+te*a[2],Z=z+F*a[2],ie=P*q,re=P*j,fe=V*q,ye=V*j;for(let de=0;de<d;de++){const $e=v[x++];p[J+de]+=$e*ie,p[_+de]+=$e*re,p[W+de]+=$e*fe,p[Z+de]+=$e*ye}}}}return n.makeTensorInfo([l,c,u,d],"float32",p)}const S0e={kernelName:Kv,backendName:"cpu",kernelFunc:w0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k0e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s;De(r,"resizeNearestNeighbor");const l=Le(r.shape),[u,c]=a,[d,h,f,p]=r.shape,m=n.data.get(r.dataId).values,g=new Float32Array(d*u*c*p),y=[o&&u>1?h-1:h,o&&c>1?f-1:f],b=[o&&u>1?u-1:u,o&&c>1?c-1:c],v=y[0]/b[0],x=y[1]/b[1];let w=0;for(let S=0;S<d;S++){const C=S*l[0];for(let N=0;N<u;N++){const I=i?v*(N+.5):v*N;let E=Math.min(h-1,o?Math.round(I):Math.floor(I));i&&(E=Math.max(0,E));const A=C+E*l[1];for(let z=0;z<c;z++){const V=i?x*(z+.5):x*z;let P=Math.min(f-1,o?Math.round(V):Math.floor(V));i&&(P=Math.max(0,P));const K=A+P*l[2];for(let Y=0;Y<p;Y++){const te=m[K+Y];g[w++]=te}}}}return n.makeTensorInfo([d,u,c,p],r.dtype,g)}const C0e={kernelName:Wm,backendName:"cpu",kernelFunc:k0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N0e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:o}=e,{alignCorners:i}=s;De([o,r],"resizeNearestNeighborGrad");const a=Le(r.shape),l=Le(o.shape),[u,c,d,h]=r.shape,[,f,p]=o.shape,m=new Float32Array(u*c*d*h),g=n.data.get(o.dataId).values,y=[i&&f>1?c-1:c,i&&p>1?d-1:d],b=[i&&f>1?f-1:f,i&&p>1?p-1:p],v=y[0]/b[0],x=y[1]/b[1],w=1/v,S=1/x,C=Math.ceil(w)*2+2,N=Math.ceil(S)*2+2;for(let I=0;I<u;I++){const E=I*a[0];for(let A=0;A<c;A++){const z=E+A*a[1],V=Math.floor(A*w),P=Math.floor(V-C/2);for(let K=0;K<d;K++){const Y=z+K*a[2],te=Math.floor(K*S),F=Math.floor(te-N/2);for(let j=0;j<h;j++){let q=0;for(let J=0;J<C;J++){const _=J+P;if(_<0||_>=f)continue;const W=E+_*l[1],Z=_*v,ie=Math.min(c-1,i?Math.round(Z):Math.floor(Z));if(A===ie)for(let re=0;re<N;re++){const fe=re+F;if(fe<0||fe>=p)continue;const ye=W+fe*l[2],de=fe*x,$e=Math.min(d-1,i?Math.round(de):Math.floor(de));K===$e&&(q+=g[ye+j])}}m[Y+j]=q}}}}return n.makeTensorInfo(r.shape,r.dtype,m)}const T0e={kernelName:qv,backendName:"cpu",kernelFunc:N0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $0e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:o}=s;De(r,"reverse");const i=r.shape.length,a=st(o,r.shape);if(i===0)return ti({inputs:{x:r},backend:n});const l=new xn(r.shape,r.dtype),u=n.bufferSync(r);for(let c=0;c<l.size;c++){const d=l.indexToLoc(c),h=d.slice();a.forEach(f=>h[f]=r.shape[f]-1-h[f]),l.set(u.get(...h),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const I0e={kernelName:Gm,backendName:"cpu",kernelFunc:$0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E0e={kernelName:dx,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:o,center:i}=e,a=n,l=Pn(s.dtype,oe(s.shape)),[u,c,d,h]=s.shape,[f,p]=E$(i,c,d),m=255,g=Math.sin(r),y=Math.cos(r),b=a.data.get(s.dataId).values;for(let x=0;x<u;x++){const w=x*d*c*h;for(let S=0;S<c;S++){const C=S*(d*h);for(let N=0;N<d;N++){const I=N*h;for(let E=0;E<h;E++){const A=[u,S,N,E],z=A[2],V=A[1];let P=(z-f)*y-(V-p)*g,K=(z-f)*g+(V-p)*y;P=Math.round(P+f),K=Math.round(K+p);let Y=o;if(typeof o!="number"&&(E===3?Y=m:Y=o[E]),P>=0&&P<d&&K>=0&&K<c){const F=K*(d*h),j=P*h,q=w+F+j+E;Y=b[q]}const te=w+C+I+E;l[te]=Y}}}}return{dataId:a.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R0e=Nt(rh,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),_0e={kernelName:rh,backendName:"cpu",kernelFunc:R0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A0e(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:o}=e,{shape:i}=s,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=rl(o,r,i),h=!0,f=n.bufferSync(r),p=n.bufferSync(o),m=Al(f,p,i,d,u,l,a,c,0,h);return n.makeTensorInfo(i,m.dtype,m.values)}const D0e={kernelName:Xv,backendName:"cpu",kernelFunc:A0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O0e(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<e?n=r+1:s=r;return s}function F0e(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<=e?n=r+1:s=r;return s}function L0e(t,e,n,s,r,o){const i=sn("int32",n*r);for(let a=0;a<n;++a){const l=t.slice(a*s,(a+1)*s),u=a*r;for(let c=0;c<r;++c)i[u+c]=o==="left"?O0e(l,e[c+u]):F0e(l,e[c+u])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P0e(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:o}=e,{side:i}=s,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,u=L0e(a,l,r.shape[0],r.shape[1],o.shape[1],i);return n.makeTensorInfo(o.shape,"int32",u)}const M0e={kernelName:Qv,backendName:"cpu",kernelFunc:P0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z0e(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:o}=e;De([s,r,o],"select");const i=s.shape.length,a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,u=n.data.get(o.dataId).values,c=As(r.dtype,o.dtype),d=Qn(oe(r.shape),c);let h=0;const f=i===0||i>1||r.shape.length===1?1:oe(r.shape.slice(1));for(let p=0;p<a.length;p++)for(let m=0;m<f;m++)a[p]===1?d[h++]=l[p]:d[h++]=u[p];return n.makeTensorInfo(r.shape,c,d)}const B0e={kernelName:Hm,backendName:"cpu",kernelFunc:z0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V0e=ew,U0e=tw,W0e=Nt(ih,t=>t>=0?U0e*t:V0e*(Math.exp(t)-1)),j0e={kernelName:ih,backendName:"cpu",kernelFunc:W0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G0e=Nt(uh,t=>t<0?-1:t>0?1:0),H0e={kernelName:uh,backendName:"cpu",kernelFunc:G0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q0e=Nt(ah,t=>Math.sin(t)),K0e={kernelName:ah,backendName:"cpu",kernelFunc:q0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X0e=Nt(lh,t=>Math.sinh(t)),Y0e={kernelName:lh,backendName:"cpu",kernelFunc:X0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q0e=11920928955078125e-23,b_=Math.log(Q0e)+2,Z0e=Nt(dh,t=>{const e=t>-b_,n=t<b_,s=Math.exp(t);let r;return n?r=s:e?r=t:r=Math.log(1+s),r}),J0e={kernelName:dh,backendName:"cpu",kernelFunc:Z0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ebe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:o,paddings:i}=s;De([r],"spaceToBatchND");const a=oe(o),l=[[0,0]];l.push(...i);for(let S=1+o.length;S<r.shape.length;++S)l.push([0,0]);const u=LV.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),c=Sg(u.shape,o,a,!1),d=kg(c.length,o.length,!1),h=Cg(u.shape,o,a,!1),m=Ot({inputs:{x:u},backend:n,attrs:{shape:c}}),b=Ps({inputs:{x:m},backend:n,attrs:{perm:d}}),w=Ot({inputs:{x:b},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(b),w}const tbe={kernelName:Xm,backendName:"cpu",kernelFunc:ebe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nbe(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${o.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,u=n.data.get(o.dataId).values,c=n.data.get(i.dataId).values[0],[d,h,f,p,m]=lV(a,s.shape,s.dtype,l,r.dtype,u,c);return[n.makeTensorInfo(h,s.dtype,d),n.makeTensorInfo([h[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),n.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}const sbe={kernelName:Zv,backendName:"cpu",kernelFunc:nbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rbe(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:o}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(n.data.get(r.dataId).values),a=n.data.get(s.dataId).values,l=Array.from(n.data.get(o.dataId).values),[u,c,d]=uV(a,s.shape,s.dtype,i,l);return[n.makeTensorInfo(c,s.dtype,u),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}const obe={kernelName:Jv,backendName:"cpu",kernelFunc:rbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ibe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${o.shape}`);if(r.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,[u,c]=xI(i,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(c,s.dtype,u)}const abe={kernelName:ex,backendName:"cpu",kernelFunc:ibe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lbe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${o.shape}`);if(r.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,[u,c]=xI(i,s.shape,s.dtype,a,l);return n.makeTensorInfo(c,s.dtype,u)}const ube={kernelName:tx,backendName:"cpu",kernelFunc:lbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cbe(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:o,defaultValue:i}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:h}=rl(o,r,a),f=!1,p=n.bufferSync(r);let m;switch(o.dtype){case"bool":{const g=n.bufferSync(o),y=!!n.data.get(i.dataId).values[0];m=Al(p,g,a,h,c,u,l,d,y,f);break}case"float32":{const g=n.bufferSync(o),y=n.data.get(i.dataId).values[0];m=Al(p,g,a,h,c,u,l,d,y,f);break}case"int32":{const g=n.bufferSync(o),y=n.data.get(i.dataId).values[0];m=Al(p,g,a,h,c,u,l,d,y,f);break}case"string":{const g=n.bufferSync(o),y=$i(n.data.get(i.dataId).values[0]);m=Al(p,g,a,h,c,u,l,d,y,f);break}default:throw new Error(`Unsupported type ${o.dtype}`)}return n.makeTensorInfo(a,m.dtype,m.values)}const dbe={kernelName:nx,backendName:"cpu",kernelFunc:cbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:o,axis:i}=s,a=st(i,r.shape)[0],l=j$(r,o,a),u=new Array(r.shape.length).fill(0),c=r.shape.slice();return l.map(d=>{const h=[...c];h[a]=d;const f=mu({inputs:{x:r},backend:n,attrs:{begin:u,size:h}});return u[a]+=d,f})}const fbe={kernelName:Ym,backendName:"cpu",kernelFunc:hbe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pbe={kernelName:sx,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,s=e;De(n,"square");const r=s.data.get(n.dataId).values,o=new Float32Array(r.length);for(let a=0;a<r.length;++a){const l=r[a];o[a]=l*l}return{dataId:s.write(o,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mbe=Nt(bh,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),gbe={kernelName:bh,backendName:"cpu",kernelFunc:mbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ybe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:h}=s;De(r,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:b,end:v,strides:x}=N$(r.shape,o,i,a,l,u,c,d,h);let w;if(m)w=Ot({inputs:{x:r},backend:n,attrs:{shape:p}});else if(g||y){T(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const S=S$(b,v,x),C=mu({inputs:{x:r},backend:n,attrs:{begin:b,size:S}});w=Ot({inputs:{x:C},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(C)}else{const S=n.bufferSync(r),C=hV(f,S,x,b);w=n.makeTensorInfo(p,C.dtype,C.values)}return w}const bbe={kernelName:rx,backendName:"cpu",kernelFunc:ybe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vbe(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:u}=s,{data:c,dataSplits:d}=e,h=n.data.get(c.dataId).values,f=n.data.get(d.dataId).values,[p,m]=fV(h,f,r,o,i,a,l,u);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const xbe={kernelName:ox,backendName:"cpu",kernelFunc:vbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wbe(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values[0],[u,c,d]=pV(a,l,r),h=c.length;return[n.makeTensorInfo([h,2],"int32",u),n.makeTensorInfo([h],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const Sbe={kernelName:ix,backendName:"cpu",kernelFunc:wbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kbe(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=n.data.get(o.dataId).values,a=mV(i,r);return n.makeTensorInfo(o.shape,"int32",a)}const Cbe={kernelName:ax,backendName:"cpu",kernelFunc:kbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nbe=Nt(mh,t=>Math.tan(t)),Tbe={kernelName:mh,backendName:"cpu",kernelFunc:Nbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $be=Nt(gh,t=>Math.tanh(t)),Ibe={kernelName:gh,backendName:"cpu",kernelFunc:$be};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ebe(t){const{inputs:e,backend:n}=t,{tensor:s,indices:r,updates:o}=e,{sliceRank:i,numUpdates:a,sliceSize:l,strides:u,outputSize:c}=rl(o,r,s.shape),d=!1,h=n.bufferSync(r),f=n.bufferSync(o),p=n.bufferSync(s),m=Al(h,f,s.shape,c,l,a,i,u,p,d);return n.makeTensorInfo(s.shape,m.dtype,m.values)}const Rbe={kernelName:Yv,backendName:"cpu",kernelFunc:Ebe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _be(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:o}=s;De(r,"tile");const i=yV(n.bufferSync(r),o);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const Abe={kernelName:yh,backendName:"cpu",kernelFunc:_be};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:o,sorted:i}=s;De(r,"topk");const a=n.data.get(r.dataId).values,[l,u]=vV(a,r.shape,r.dtype,o,i);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}const Obe={kernelName:lx,backendName:"cpu",kernelFunc:Dbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fbe(t){const{inputs:e,attrs:n,backend:s}=t,{image:r,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:u}=n,[c,d,h,f]=r.shape,[p,m]=u??[d,h],g=[c,p,m,f],y=Le(r.shape),b=y[0],v=y[1],x=y[2],w=Le(g),S=w[0],C=w[1],N=w[2],I=Pn(r.dtype,oe(g));I.fill(l);const E=s.data.get(r.dataId).values,A=s.data.get(o.dataId).values;for(let V=0;V<c;++V){const P=o.shape[0]===1?A:A.subarray(V*8,V*8+8);for(let K=0;K<p;++K)for(let Y=0;Y<m;++Y)for(let te=0;te<f;++te){let F;const j=P[6]*Y+P[7]*K+1;if(j===0)continue;const q=(P[0]*Y+P[1]*K+P[2])/j,J=(P[3]*Y+P[4]*K+P[5])/j,_=v_(q,h,a),W=v_(J,d,a);switch(i){case"nearest":F=Vbe(E,d,h,b,v,x,V,W,_,te,l);break;case"bilinear":F=Ube(E,d,h,b,v,x,V,W,_,te,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const Z=V*S+K*C+Y*N+te;I[Z]=F}return s.makeTensorInfo(g,r.dtype,I)}return{dataId:s.write(I,g,r.dtype),shape:r.shape,dtype:r.dtype}}const Lbe={kernelName:ux,backendName:"cpu",kernelFunc:Fbe};function v_(t,e,n){switch(n){case"reflect":return Pbe(t,e);case"wrap":return Mbe(t,e);case"nearest":return Bbe(t,e);case"constant":default:return zbe(t)}}function Pbe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=2*e;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-e?n+s:-n-1}else if(n>e-1)if(e<=1)n=0;else{const s=2*e;n-=s*Math.trunc(n/s),n>=e&&(n=s-n-1)}return Fa(0,n,e-1)}function Mbe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=e-1;n+=e*(Math.trunc(-n/s)+1)}else if(n>e-1)if(e<=1)n=0;else{const s=e-1;n-=e*Math.trunc(n/s)}return Fa(0,n,e-1)}function zbe(t,e){return t}function Bbe(t,e){return Fa(0,t,e-1)}function vf(t,e,n,s,r,o,i,a,l,u,c){const d=i*s+a*r+l*o+u;return 0<=a&&a<e&&0<=l&&l<n?t[d]:c}function Vbe(t,e,n,s,r,o,i,a,l,u,c){const d=Math.round(a),h=Math.round(l);return vf(t,e,n,s,r,o,i,d,h,u,c)}function Ube(t,e,n,s,r,o,i,a,l,u,c){const d=Math.floor(a),h=Math.floor(l),f=d+1,p=h+1,m=(p-l)*vf(t,e,n,s,r,o,i,d,h,u,c)+(l-h)*vf(t,e,n,s,r,o,i,d,p,u,c),g=(p-l)*vf(t,e,n,s,r,o,i,f,h,u,c)+(l-h)*vf(t,e,n,s,r,o,i,f,p,u,c);return(f-a)*m+(a-d)*g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wbe(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:o}=e;De(o,"unique");const i=s.data.get(o.dataId).values,{outputValues:a,outputShape:l,indices:u}=xV(i,r,o.shape,o.dtype);return[s.makeTensorInfo(l,o.dtype,a),s.makeTensorInfo([u.length],"int32",u)]}const jbe={kernelName:cx,backendName:"cpu",kernelFunc:Wbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gbe(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:o}=s;o<0&&(o+=r.shape.length);const i=r.shape.length,a=r.shape[o],l=new Array(i-1);let u=0;for(let f=0;f<i;f++)f!==o&&(l[u++]=r.shape[f]);const c=new Array(i).fill(0),d=r.shape.slice();d[o]=1;const h=new Array(a);for(let f=0;f<h.length;f++){c[o]=f;const p=mu({inputs:{x:r},backend:n,attrs:{begin:c,size:d}});h[f]=Ot({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return h}const Hbe={kernelName:Jm,backendName:"cpu",kernelFunc:Gbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:o}=e,{numSegments:i}=s;De(r,"unsortedSegmentSum");const a=r.shape.length,l=o.shape.length,u=[],c=[],d=a-l;let h=o;for(let p=0;p<d;++p){const m=nb({inputs:{input:h},backend:n,attrs:{dim:p+1}});h=m,c.push(m)}for(let p=0;p<i;++p){const m=Pi(p,"int32"),g=n.makeTensorInfo([],"int32",m),y=F4({inputs:{a:g,b:h},backend:n}),b=Ha({inputs:{x:y},backend:n,attrs:{dtype:"float32"}}),v=mw({inputs:{a:b,b:r},backend:n}),x=Dg({inputs:{x:v},backend:n,attrs:{axis:0,keepDims:!1}});u.push(x),c.push(g),c.push(y),c.push(b),c.push(v),c.push(x)}const f=FV({inputs:u,backend:n,attrs:{axis:0}});return c.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const Kbe={kernelName:eg,backendName:"cpu",kernelFunc:qbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xbe=[Wpe,kfe,Gpe,qpe,Efe,Xpe,Qpe,Jpe,tme,sme,ome,ame,ume,hme,pme,yme,vme,wme,kme,Vpe,Nme,$me,Eme,_fe,_me,$fe,Dfe,Dme,Cfe,Fme,Pme,Mme,Bme,Ume,jme,Hme,Kme,Yme,Zme,ege,nge,rge,ige,lge,uge,dge,fge,mge,gge,yge,bge,xge,kge,Ope,Nge,Ofe,Dge,Ffe,Oge,Pfe,Bge,Vge,Wge,zfe,Vfe,Gge,qge,Xge,Qge,Wfe,Gfe,Nfe,Jge,Lme,tye,sye,oye,Fpe,qfe,Xfe,aye,Qfe,uye,hye,pye,yye,vye,wye,Sye,Jfe,Cye,Tye,Iye,Rye,Aye,Oye,Lye,tpe,Mye,Vye,jye,spe,ope,qye,Yye,Jye,ape,t0e,s0e,r0e,LV,l0e,Ppe,cpe,c0e,h0e,p0e,g0e,Tfe,sC,b0e,Mpe,zpe,Bpe,x0e,S0e,C0e,T0e,I0e,E0e,_0e,bpe,D0e,M0e,B0e,j0e,xpe,H0e,K0e,Y0e,wpe,Uye,J0e,tbe,sbe,obe,abe,ube,dbe,fbe,Cpe,pbe,Tpe,Ipe,gbe,bbe,xbe,Sbe,Cbe,Ape,wge,Tbe,Ibe,Rbe,Abe,Obe,Lbe,lpe,jbe,Hbe,Kbe,n0e];for(const t of Xbe)hx(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kl={},xy={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Ybe(t,e){kl[t]=e}function No(t,e){if(!(t in kl)||e!=null){const s=Zbe(t,e);if(s!==null)kl[t]=s;else return console.log("Could not get context for WebGL version",t),null}const n=kl[t];return n==null||n.isContextLost()?(delete kl[t],No(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),kl[t])}function Qbe(t){if(!ee().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Zbe(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??Qbe(t);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete kl[t]},!1),ee().getBool("SOFTWARE_WEBGL_ENABLED")&&(xy.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",xy)||n.getContext("experimental-webgl",xy):n.getContext("webgl2",xy)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var xp;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(xp||(xp={}));var vr;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(vr||(vr={}));var Hn;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Hn||(Hn={}));function Og(t,e){return[e,t]}function Jbe(t,e){return t*e}function wy(t){const e=oe(t),n=Math.ceil(e/4);return R0(n)}function Ih(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function eve(t,e){const[n,s]=Ih(t,e);return n*s*4}function NI(t,e){const n=t;let s,r,o,i,a,l,u,c,d,h;return ee().getNumber("WEBGL_VERSION")===2?(s=n.R32F,r=n.R16F,o=n.RGBA16F,i=n.RGBA32F,a=n.RED,u=4,c=1,d=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(s=t.RGBA,r=t.RGBA,o=t.RGBA,i=n.RGBA,a=t.RGBA,u=4,c=4,d=e!=null?e.HALF_FLOAT_OES:null,h=t.FLOAT,l=t.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ne(t,e){const n=e();return ee().getBool("DEBUG")&&tve(t),n}function tve(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+ove(t,e))}const nve=596e-10,sve=65504;function rve(t){return!!(ee().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||nve<Math.abs(t)&&Math.abs(t)<sve)}function ove(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Sy(t,e){return Gi(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function ive(t,e){const n=Gi(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Ne(t,()=>t.shaderSource(n,e)),Ne(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function ave(t,e){const n=Gi(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Ne(t,()=>t.shaderSource(n,e)),Ne(t,()=>t.compileShader(n)),ee().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw PV(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const lve=/ERROR: [0-9]+:([0-9]+):/g;function PV(t,e){const n=lve.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const s=+n[1],r=t.split(`
`),o=r.length.toString().length+2,i=r.map((d,h)=>Wl((h+1).toString(),o)+d);let a=0;for(let d=0;d<i.length;d++)a=Math.max(i[d].length,a);const l=i.slice(0,s-1),u=i.slice(s-1,s),c=i.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Wl(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function uve(t){return Gi(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function cve(t,e){if(Ne(t,()=>t.linkProgram(e)),!ee().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function _1(t,e){if(Ne(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function dve(t,e){const n=Gi(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Ne(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),Ne(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function hve(t,e){const n=Gi(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Ne(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),Ne(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function fve(t){return Gi(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function pve(t,e){const n=ee().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const s=`[${t}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(t>n||e>n){const s=`[${t}x${e}]`,r=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function mve(t){return Gi(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function x_(t,e,n,s,r,o,i){const a=t.getAttribLocation(e,n);return a===-1?!1:(Ne(t,()=>t.bindBuffer(t.ARRAY_BUFFER,s)),Ne(t,()=>t.vertexAttribPointer(a,r,t.FLOAT,!1,o,i)),Ne(t,()=>t.enableVertexAttribArray(a)),!0)}function gve(t,e,n){wve(t,n),Ne(t,()=>t.activeTexture(t.TEXTURE0+n)),Ne(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function yve(t,e,n){return Gi(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function bve(t,e,n){return t.getUniformLocation(e,n)}function vve(t,e,n,s){Ne(t,()=>gve(t,e,s)),Ne(t,()=>t.uniform1i(n,s))}function A1(t,e,n){Ne(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),Ne(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function w_(t,e){Ne(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),Ne(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function ky(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+xve(t,e))}function xve(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Gi(t,e,n){const s=Ne(t,()=>e());if(s==null)throw new Error(n);return s}function wve(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+t.TEXTURE0;if(s<t.TEXTURE0||s>n){const r=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${r}.`)}}function pd(t,e=2){return oe(t.slice(0,t.length-e))}function md(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Cy(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[pd(t),...md(t)]),e}function Sve(t,e=!1){let n=ee().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=ee().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&ee().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),e&&(n=n*2,s=s*2,t=t.map((a,l)=>l>=t.length-2?ov(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=Li(t).newShape);let r=oe(t),o=null;t.length<=1&&r<=n?o=[1,r]:t.length===2&&t[0]<=n&&t[1]<=n?o=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?o=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?o=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?o=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(o=[t[0],t[1]*t[2]*t[3]]);const i=o!=null&&Math.max(...o)>s&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(o==null||i)if(e){const a=pd(t);let l=2,u=2;t.length&&([l,u]=md(t)),r=a*(l/2)*(u/2),o=R0(r).map(c=>c*2)}else o=R0(r);return o}function Ny(t){return t%2===0}function rb(t,e){if(t=t.slice(-2),e=e.slice(-2),ut(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],s=e[e.length-1];if(n===s||Ny(n)&&Ny(s)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&Ny(t[0])&&Ny(e[0])}let D1,O1;function kve(t){if(D1==null){const e=No(t);D1=e.getParameter(e.MAX_TEXTURE_SIZE)}return D1}function Cve(t){if(O1==null){const e=No(t);O1=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,O1)}function Nve(t){if(t===0)return 0;let e;const n=No(t);return Hr(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:Hr(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function Hr(t,e){return t.getExtension(e)!=null}function S_(t){try{if(No(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function Tve(t){if(t===0)return!1;const e=No(t);if(t===1){if(!Hr(e,"OES_texture_float"))return!1}else if(!Hr(e,"EXT_color_buffer_float"))return!1;return oC(e)}function $ve(t){if(t===0)return!1;const e=No(t);if(t===1){if(!Hr(e,"OES_texture_float")||!Hr(e,"WEBGL_color_buffer_float"))return!1}else{if(Hr(e,"EXT_color_buffer_float"))return oC(e);const s="EXT_color_buffer_half_float";if(Hr(e,s)){const r=e.getExtension(s);return Ive(e,r)}return!1}return oC(e)}function oC(t){const e=NI(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(o),i}function Ive(t,e){const n=NI(t,e),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(s),t.deleteFramebuffer(i),a}function Eve(t){return t!==2?!1:No(t).fenceSync!=null}function Fg(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&T(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oe=ee();Oe.registerFlag("HAS_WEBGL",()=>Oe.getNumber("WEBGL_VERSION")>0);Oe.registerFlag("WEBGL_VERSION",()=>S_(2)?2:S_(1)?1:0);Oe.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Oe.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Oe.get("WEBGL_VERSION")===2);Oe.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Oe.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Oe.registerFlag("WEBGL_PACK",()=>Oe.getBool("HAS_WEBGL"));Oe.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Oe.getBool("WEBGL_PACK"));Oe.registerFlag("WEBGL_PACK_CLIP",()=>Oe.getBool("WEBGL_PACK"));Oe.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Oe.getBool("WEBGL_PACK"));Oe.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Oe.getBool("WEBGL_PACK"));Oe.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Oe.getBool("WEBGL_PACK"));Oe.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Oe.getBool("WEBGL_PACK"));Oe.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Oe.getBool("WEBGL_PACK"));Oe.registerFlag("WEBGL_PACK_REDUCE",()=>Oe.getBool("WEBGL_PACK"));Oe.registerFlag("WEBGL_LAZILY_UNPACK",()=>Oe.getBool("WEBGL_PACK"));Oe.registerFlag("WEBGL_CONV_IM2COL",()=>Oe.getBool("WEBGL_PACK"));Oe.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Oe.getBool("WEBGL_PACK"));Oe.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>kve(Oe.getNumber("WEBGL_VERSION")));Oe.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Cve(Oe.getNumber("WEBGL_VERSION")));Oe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Oe.getNumber("WEBGL_VERSION");return t===0?0:Nve(t)});Oe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Oe.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!qN());Oe.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Tve(Oe.getNumber("WEBGL_VERSION")));Oe.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Oe.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Oe.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Oe.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>$ve(Oe.getNumber("WEBGL_VERSION")));Oe.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Eve(Oe.getNumber("WEBGL_VERSION")));Oe.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Oe.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Oe.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Oe.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>qN()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Oe.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Oe.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Oe.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Oe.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Oe.registerFlag("WEBGL_EXP_CONV",()=>!1);Oe.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Oe.getBool("IS_TEST"));Oe.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Oe.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Oe.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Oe.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ks(){let t,e,n,s,r,o,i,a,l,u;return ee().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",s="in",r="texture",o="outputColor",i="out vec4 outputColor;",a=ee().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",s="varying",r="texture2D",o="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:s,texture2D:r,output:o,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fu(t,e,n="index"){const s=Le(e);return s.map((r,o)=>{const i=`int ${t[o]} = ${n} / ${r}`,a=o===s.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${r}`:`index -= ${t[o]} * ${r}`;return`${i}; ${a};`}).join("")}function gw(t,e,n="index"){const s=Le(e);return s.map((r,o)=>{const i=`int ${t[o]} = ${n} / outShapeStrides[${o}]`,a=o===s.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * outShapeStrides[${o}]`:`index -= ${t[o]} * outShapeStrides[${o}]`;return`${i}; ${a};`}).join("")}function Rve(t,e){const n=t.length,s=t.map(o=>`${e}[${o}]`),r=new Array(n-1);r[n-2]=s[n-1];for(let o=n-3;o>=0;--o)r[o]=`(${r[o+1]} * ${s[o+1]})`;return r}function _ve(t,e,n="index"){const s=t.map((o,i)=>i),r=Rve(s,e);return r.map((o,i)=>{const a=`int ${t[i]} = ${n} / ${r[i]}`,l=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${r[i]}`:`index -= ${t[i]} * ${r[i]}`;return`${a}; ${l};`}).join("")}function TI(t){const e=Le(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function $I(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const MV=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:zV}=tz;function Ave(t,e,n){const s=[];if(t.forEach(f=>{const p=oe(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?s.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(s.push(`uniform sampler2D ${f.name};`),s.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:m}=II(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(m.length){case 1:s.push(`uniform int ${f.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${f.name}Shape;`);break}s.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{s.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const r=s.join(`
`),o=t.map(f=>Dve(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),i=e.texShape,a=ks(),l=Lve(a);let u,c,d=zve(a);return e.isPacked?(u=Ove(e.logicalShape,i,n.enableShapeUniforms),c=Mve(a)):(u=Fve(e.logicalShape,i,n.enableShapeUniforms),c=Pve(a)),n.packedInputs&&(d+=Wve),[d,l,c,r,u,o,n.userCode].join(`
`)}function Eh(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return txe(t,e);case 1:return sxe(t,e);case 2:return oxe(t,e);case 3:return axe(t,e);case 4:return uxe(t,e);case 5:return cxe(t);case 6:return dxe(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function BV(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return exe(t);case 1:return nxe(t,e);case 2:return rxe(t,e);case 3:return ixe(t,e);default:return lxe(t,e)}}function Dve(t,e,n=!1,s){let r="";n?r+=BV(t,s):r+=Eh(t,s);const o=t.shapeInfo.logicalShape,i=e.logicalShape;return o.length<=i.length&&(n?r+=hxe(t,e):r+=fxe(t,e)),r}function Ove(t,e,n){switch(t.length){case 0:return VV();case 1:return jve(t,e,n);case 2:return Zve(t,e,n);case 3:return Hve(t,e,n);default:return Kve(t,e,n)}}function Fve(t,e,n){switch(t.length){case 0:return VV();case 1:return Gve(t,e,n);case 2:return Jve(t,e,n);case 3:return qve(t,e,n);case 4:return Xve(t,e,n);case 5:return Yve(t,e);case 6:return Qve(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function Lve(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function Pve(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function Mve(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function zve(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Bve}
    ${Vve}
    ${Uve}
  `}const Bve=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Vve=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Uve=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Wve=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function VV(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function jve(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function Gve(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function Hve(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),o=r*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function qve(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${gw(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const s=Fu(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function Kve(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),o=r*Math.ceil(t[t.length-2]/2);let i=o,a="",l="b, r, c";for(let u=2;u<t.length-1;u++)i*=t[t.length-u-1],a=`
      int b${u} = index / ${i};
      index -= b${u} * ${i};
    `+a,l=`b${u}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${t.length}(${l});
    }
  `}function Xve(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${gw(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Fu(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function Yve(t,e){const n=Fu(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Qve(t,e){const n=Fu(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Zve(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(ut(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function Jve(t,e,n){return ut(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Lu(t){return`offset${t}`}function exe(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),s=ks();return`
    vec4 ${n}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function txe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[r,o]=t.shapeInfo.texShape;if(r===1&&o===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=Lu(n);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${i});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${i});
      return sampleTexture(${n}, uv);
    }
  `}function nxe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,o=ks();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${o.texture2D}(${n}, uv);
    }
  `;const i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${o.texture2D}(${n}, uv);
    }
  `}function sxe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${Rh(t)}
      }
    `;const r=t.shapeInfo.texShape,o=r[0],i=r[1];if(i===1&&o===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Lu(n);return i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${o}.0);
        return sampleTexture(${n}, uv);
      }
    `:o===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${o}, ${i}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function rxe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=t.shapeInfo.texShape,i=o[0],a=o[1],l=ks();if(o!=null&&ut(n,o))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${i}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function oxe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=t.shapeInfo.texShape;if(o!=null&&ut(n,o)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const h=o[0],f=o[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${h}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:i,keptDims:a}=Li(n),l=i;if(l.length<n.length){const h=_h(t,l),f=["row","col"];return`
      ${Eh(h,e)}
      float ${r}(int row, int col) {
        return ${r}(${Ah(f,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Rh(t)}
      }
    `;const u=o[0],c=o[1],d=Lu(s);return c===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${s}, uv);
    }
  `:u===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${s}, uv);
  }
`}function ixe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=t.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(n[0]===1){const h=n.slice(1),f=[1,2],p=_h(t,h),m=["b","row","col"];return`
        ${BV(p,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${Ah(m,f)});
        }
      `}const a=ks();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const l=i[0],u=i[1],c=Math.ceil(n[2]/2),d=c*Math.ceil(n[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${d}, ${c}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function axe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=n[1]*n[2],i=n[2],{newShape:a,keptDims:l}=Li(n),u=a;if(u.length<n.length){const m=_h(t,u),g=["row","col","depth"];return`
        ${Eh(m,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${Ah(g,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${o}, ${i}, 1)));
        ${Rh(t)}
      }
    `;const c=t.shapeInfo.texShape,d=c[0],h=c[1],f=t.shapeInfo.flatOffset;if(h===o&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${d}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(h===i&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `;const p=Lu(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${o} + col * ${i} + depth + ${p};
        vec2 uv = uvFromFlat(${d}, ${h}, index);
        return sampleTexture(${s}, uv);
      }
  `}function lxe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=ks();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${n}, uv);
    }
  `;const o=t.shapeInfo.logicalShape,i=o.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=l[0],c=l[1],d=Math.ceil(o[i-1]/2);let h=d*Math.ceil(o[i-2]/2),f="int b, int row, int col",p=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let m=2;m<i-1;m++)f=`int b${m}, `+f,h*=o[i-m-1],p=`b${m} * ${h} + `+p;return`
    vec4 ${s}(${f}) {
      int index = ${p};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${r.texture2D}(${n}, uv);
    }
  `}function uxe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=n[3],i=n[2]*o,a=n[1]*i,{newShape:l,keptDims:u}=Li(n);if(l.length<n.length){const b=_h(t,l),v=["row","col","depth","depth2"];return`
      ${Eh(b,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${Ah(v,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${i}, ${o}, 1)));
        ${Rh(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1],p=`int stride2 = ${s}Shape[3];`,m=`int stride1 = ${s}Shape[2] * stride2;`,g=`int stride0 = ${s}Shape[1] * stride1;`;if(f===a&&c==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${p}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(f===o&&c==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;const y=Lu(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${m}
      ${g}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${y});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} +
          depth * ${o} + depth2;
      vec2 uv = uvFromFlat(${h}, ${f}, index + ${y});
      return sampleTexture(${s}, uv);
    }
  `}function cxe(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[4],o=e[3]*r,i=e[2]*o,a=e[1]*i,{newShape:l,keptDims:u}=Li(e);if(l.length<e.length){const m=_h(t,l),g=["row","col","depth","depth2","depth3"];return`
      ${Eh(m)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${Ah(g,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${o}, ${r})) +
          depth3;
        ${Rh(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1];if(f===a&&c==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${o}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===r&&c==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=Lu(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${o} +
          depth2 * ${r} + depth3 + ${p};
      vec2 uv = uvFromFlat(${h}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function dxe(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:o}=Li(e);if(r.length<e.length){const g=_h(t,r),y=["row","col","depth","depth2","depth3","depth4"];return`
      ${Eh(g)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${Ah(y,o)});
      }
    `}const i=e[5],a=e[4]*i,l=e[3]*a,u=e[2]*l,c=e[1]*u;if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${Rh(t)}
      }
    `;const d=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,f=h[0],p=h[1];if(p===c&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===i&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=Lu(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${m};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Rh(t){const e=t.name,n=oe(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function hxe(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",o=t.shapeInfo.logicalShape.length,i=e.logicalShape.length,a=zV(t.shapeInfo.logicalShape,e.logicalShape),l=It(i),u=i-o;let c;const d=["x","y","z","w","u","v"];o===0?c="":i<2&&a.length>=1?c="coords = 0;":c=a.map(b=>`coords.${d[b+u]} = 0;`).join(`
`);let h="";i<2&&o>0?h="coords":h=t.shapeInfo.logicalShape.map((b,v)=>`coords.${d[v+u]}`).join(", ");let f="return outputValue;";const m=oe(t.shapeInfo.logicalShape)===1,y=oe(e.logicalShape)===1;if(o===1&&!m&&!y)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!y)i===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const b=o-2,v=o-1;a.indexOf(b)>-1&&a.indexOf(v)>-1?f="return vec4(outputValue.x);":a.indexOf(b)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(v)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${s}(${h});
      ${f}
    }
  `}function fxe(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",o=e.texShape,i=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&ut(i,o))return`
      float ${r}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=It(l),c=zV(t.shapeInfo.logicalShape,e.logicalShape),d=l-a;let h;const f=["x","y","z","w","u","v"];a===0?h="":l<2&&c.length>=1?h="coords = 0;":h=c.map(m=>`coords.${f[m+d]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((m,g)=>`coords.${f[g+d]}`).join(", "),`
    float ${r}() {
      ${u} coords = getOutputCoords();
      ${h}
      return get${s}(${p});
    }
  `}function It(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function II(t,e,n){const{newShape:s,keptDims:r}=Li(e),o=e.length,i=t&&o===3&&e[0]===1,a=i?e.slice(1):s,l=!t&&o>1&&!ut(e,n)&&s.length<o||i;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:r}}function _h(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Ah(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pxe(t,e,n,s){const r=n.map((c,d)=>{const h={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(h.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:h}}),o=r.map(c=>c.shapeInfo),i={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=Ave(r,i,e),l=ave(t.gl,a),u=t.createProgram(l);return ee().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(u),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:i},UV(t,e,u)))}function UV(t,e,n){const s=[],r=[];let o,i,a,l=null,u=null;u=t.getUniformLocation(n,"NAN",!1),ee().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const d of e.variableNames){const h={name:d,uniform:t.getUniformLocation(n,d,c),offset:t.getUniformLocation(n,`offset${d}`,c)};e.enableShapeUniforms&&(h.shape=t.getUniformLocation(n,`${d}Shape`,c),h.texShape=t.getUniformLocation(n,`${d}TexShape`,c)),s.push(h)}if(e.enableShapeUniforms&&(o=t.getUniformLocation(n,"outShape",c),a=t.getUniformLocation(n,"outShapeStrides",c),i=t.getUniformLocation(n,"outTexShape",c)),e.customUniforms)for(const d of e.customUniforms)r.push(t.getUniformLocation(n,d.name,c));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:u,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:i}}function k_(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,s)=>{const r=n.logicalShape,o=e[s],i=o.shape;if(!ut(r,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${i} must match`);if(n.isUniform&&o.isUniform)return;const a=n.texShape,l=o.isUniform?null:o.texData.texShape;if(!ut(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function mxe(t,e,n,s,r){e.program.enableShapeUniforms||(k_(e.inShapeInfos,n),k_([e.outShapeInfo],[s]));const o=s.texData.texture,i=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(o.texture,i[0],i[1]):t.setOutputMatrixTexture(o.texture,i[0],i[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),ee().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const u=n[l],{uniform:c,offset:d,shape:h,texShape:f}=e.variablesLocations[l];if(h){const{uniformShape:p}=II(e.program.packedInputs,u.shape,u.texData.texShape);switch(p.length){case 1:t.gl.uniform1iv(h,new Int32Array(p));break;case 2:t.gl.uniform2iv(h,new Int32Array(p));break;case 3:t.gl.uniform3iv(h,new Int32Array(p));break;case 4:t.gl.uniform4iv(h,new Int32Array(p));break}}if(f&&t.gl.uniform2i(f,u.texData.texShape[0],u.texData.texShape[1]),c!=null){if(u.isUniform){if(oe(u.shape)<2)t.gl.uniform1f(c,u.uniformValues[0]);else{let p=u.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),t.gl.uniform1fv(c,p)}continue}u.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,u.texData.slice.flatOffset),t.setInputMatrixTexture(u.texData.texture.texture,c,l)}}const a=e.outShapeLocation;if(a)switch(s.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=Le(s.shape);switch(s.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let l=0;l<e.program.customUniforms.length;++l){const u=e.program.customUniforms[l],c=e.customUniformLocations[l],d=r[l];if(u.type==="float")t.gl.uniform1fv(c,d);else if(u.type==="vec2")t.gl.uniform2fv(c,d);else if(u.type==="vec3")t.gl.uniform3fv(c,d);else if(u.type==="vec4")t.gl.uniform4fv(c,d);else if(u.type==="int")t.gl.uniform1iv(c,d);else if(u.type==="ivec2")t.gl.uniform2iv(c,d);else if(u.type==="ivec3")t.gl.uniform3iv(c,d);else if(u.type==="ivec4")t.gl.uniform4iv(c,d);else throw Error(`uniform type ${u.type} is not supported yet.`)}t.executeProgram()}function gxe(t,e,n){let s="";e.concat(n).forEach(i=>{const a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:d}=II(t.packedInputs,i.shape,l);let h="",f="",p="";if(c.length===1&&t.packedInputs){const w=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${w[0]>1}_${w[1]>1}`}else if(c.length===2&&!t.packedInputs)f=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!t.packedInputs){const w=Le(c);p=`${w[0]===l[1]}_${w[w.length-1]===l[1]}`}const m=i.shape.length,g=c.length===2&&ut(i.shape,l),y=oe(i.shape)===1,b=lu(i.shape,n.shape),v=!t.packedInputs&&m===n.shape.length&&ut(l,n.texData.texShape),x=t.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${m}_${v}_${u?d:""}_${c.length}_${y}_${b}_${g}_${h}_${f}_${p}_${x}_${a}`}else{const l=i.isUniform?"uniform":i.texData.texShape;s+=`${i.shape}_${l}_${a}`}});const r=t.userCode;let o=t.constructor.name;return o+="_"+s+"_"+r+`${ee().getNumber("WEBGL_VERSION")}`,o}function ds(t){return ee().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yxe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=xp.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ks();this.outputShape=e,this.enableShapeUniforms=ds(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?gw(["r","c","d"],e):Fu(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bxe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=xp.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ks();this.outputShape=e,this.enableShapeUniforms=ds(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?gw(["r","c","d"],e):Fu(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vxe{constructor(e){this.variableNames=["A"],this.outTexUsage=vr.DOWNLOAD;const n=ks();this.outputShape=e,this.userCode=`
      ${MV}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xxe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=vr.DOWNLOAD;const n=ks();this.outputShape=e,this.userCode=`
      ${MV}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wxe={R:0,G:1,B:2,A:3};class C_{constructor(e,n=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=ks();this.outputShape=e,this.enableShapeUniforms=ds(this.outputShape.length);let o="result";n&&(o="floor(result * 255. + 0.5)");let i="";for(let a=0;a<s.length;a++){const l=s[a];i+=`
          if(offset == ${a}) {
            result = values[${wxe[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?$I():TI(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${i}
        }
        ${r.output} = vec4(${o}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sxe{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=ks();this.outputShape=e,this.enableShapeUniforms=ds(this.outputShape.length);let r="",o="result";n&&(o="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){const l=i*2+a;r+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?$I():TI(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${o};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kxe(t){const e=ks(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return ive(t,n)}function Cxe(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return dve(t,e)}function Nxe(t){const e=new Uint16Array([0,1,2,2,1,3]);return hve(t,e)}function Lg(t,e,n,s,r,o){pve(e,n);const i=fve(t),a=t.TEXTURE_2D;return Ne(t,()=>t.bindTexture(a,i)),Ne(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),Ne(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),Ne(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),Ne(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),ee().getNumber("WEBGL_VERSION")===1?Ne(t,()=>t.texImage2D(a,0,s,e,n,0,r,o,null)):Ne(t,()=>t.texStorage2D(a,1,s,e,n)),Ne(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:i,texShape:[n,e]}}function WV(t){return t.internalFormatFloat}function Txe(t,e,n,s){const[r,o]=Og(e,n);return Lg(t,r,o,WV(s),s.textureFormatFloat,t.FLOAT)}function jV(t){return t.internalFormatHalfFloat}function $xe(t,e,n,s){const[r,o]=Og(e,n);return Lg(t,r,o,jV(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function GV(t){return t.downloadTextureFormat}function Ixe(t,e,n,s){const[r,o]=Og(e,n);return Lg(t,r,o,GV(s),t.RGBA,t.UNSIGNED_BYTE)}function HV(t){return t.internalFormatPackedFloat}function Exe(t,e,n,s){const[r,o]=Ih(e,n);return Lg(t,r,o,HV(s),t.RGBA,t.FLOAT)}function qV(t){return t.internalFormatPackedHalfFloat}function Rxe(t,e,n,s){const[r,o]=Ih(e,n);return Lg(t,r,o,qV(s),t.RGBA,s.textureTypeHalfFloat)}function _xe(t,e,n){return Ne(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),x_(t,e,"clipSpacePos",n,3,20,0)&&x_(t,e,"uv",n,2,20,12)}function Axe(t,e,n,s,r,o){Ne(t,()=>t.bindTexture(t.TEXTURE_2D,e));let i,a,l;r instanceof Uint8Array?(i=new Uint8Array(n*s*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(i=new Float32Array(n*s*4),a=t.FLOAT,l=o.internalFormatPackedFloat),i.set(r),ee().getNumber("WEBGL_VERSION")===2?Ne(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,s,t.RGBA,a,i)):Ne(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,s,0,t.RGBA,a,i)),Ne(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Dxe(t,e,n){Ne(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?ee().getNumber("WEBGL_VERSION")===2?Ne(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):Ne(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):ee().getNumber("WEBGL_VERSION")===2?Ne(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):Ne(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),Ne(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Oxe(t,e,n,s){const r=t.createBuffer();Ne(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,r));const a=4*4*e*n;return Ne(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),Ne(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),Ne(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),r}function Fxe(t,e,n){const s=t,r=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function Lxe(t,e,n,s){const[r,o]=Og(e,n),i=4,a=new Uint8Array(Jbe(e*n,i));return Ne(t,()=>t.readPixels(0,0,r,o,s.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function Pxe(t,e,n,s,r,o,i,a){const l=t,u=new Float32Array(eve(o,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function Mxe(t,e,n){const s=new Float32Array(e*n*4);return Ne(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F1{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=ee().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,Ybe(n,e)):this.gl=No(n),e=this.gl,ee().getNumber("WEBGL_VERSION")===2){const o=e;this.createVertexArray=()=>Ne(o,()=>o.createVertexArray()),this.bindVertexArray=i=>Ne(o,()=>o.bindVertexArray(i)),this.deleteVertexArray=i=>Ne(o,()=>o.deleteVertexArray(i)),this.getVertexArray=()=>Ne(o,()=>o.getParameter(o.VERTEX_ARRAY_BINDING))}else if(e!=null){const o=e.getExtension("OES_vertex_array_object");if(o==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Ne(e,()=>o.createVertexArrayOES()),this.bindVertexArray=i=>Ne(e,()=>o.bindVertexArrayOES(i)),this.deleteVertexArray=i=>Ne(e,()=>o.deleteVertexArrayOES(i)),this.getVertexArray=()=>Ne(e,()=>e.getParameter(o.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),ee().getNumber("WEBGL_VERSION")===1){const o="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=Sy(this.gl,o),Hr(this.gl,i))this.textureHalfFloatExtension=Sy(this.gl,i);else if(ee().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),Hr(this.gl,r))this.colorBufferHalfFloatExtension=Sy(this.gl,r);else if(ee().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",Hr(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(Hr(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Cxe(this.gl),this.indexBuffer=Nxe(this.gl),this.framebuffer=mve(this.gl),this.textureConfig=NI(this.gl,this.textureHalfFloatExtension)}get debug(){return ee().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Ne(e,()=>e.finish()),Ne(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Ne(e,()=>e.deleteFramebuffer(this.framebuffer)),Ne(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Ne(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Ne(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),Txe(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),$xe(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),Ixe(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),Dxe(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,s,r){this.throwIfDisposed(),Axe(this.gl,e,n,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),Rxe(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),Exe(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(w_(this.gl,this.framebuffer),this.outputTexture=null),Ne(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,s){return this.downloadMatrixDriver(e,()=>Lxe(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,s,r,o,i){return Pxe(this.gl,e,n,s,r,o,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return Fxe(this.gl,e,n)}createBufferFromTexture(e,n,s){this.bindTextureToFrameBuffer(e);const r=Oxe(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,s;if(ee().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,o=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const i=r.clientWaitSync(o,0,0);return i===r.ALREADY_SIGNALED||i===r.CONDITION_SATISFIED},n=o}else ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(e,n,s){return this.downloadMatrixDriver(e,()=>Mxe(this.gl,n,s))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=kxe(n));const s=uve(n);Ne(n,()=>n.attachShader(s,this.vertexShader)),Ne(n,()=>n.attachShader(s,e)),cve(n,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&_1(n,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;Ne(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),_xe(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(Ne(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&_1(this.gl,this.program),Ne(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,s=!0){return this.throwIfDisposed(),s?yve(this.gl,e,n):bve(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),Ne(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),vve(this.gl,e,n,s)}setOutputMatrixTexture(e,n,s){this.setOutputMatrixTextureDriver(e,s,n)}setOutputPackedMatrixTexture(e,n,s){this.throwIfDisposed();const[r,o]=Ih(n,s);this.setOutputMatrixTextureDriver(e,r,o)}setOutputMatrixWriteRegion(e,n,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,n)}setOutputPackedMatrixWriteRegion(e,n,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&_1(this.gl,this.program),ky(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Ne(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Ne(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Sy(this.gl,ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,o),o}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await pk(()=>this.disposed||this.isQueryAvailable(e,ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=zxe(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in ee().platform&&(s=ee().platform.setTimeoutCustom.bind(ee().platform)),pk(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),A1(this.gl,e,this.framebuffer),this.debug&&ky(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(A1(this.gl,this.outputTexture,this.framebuffer),this.debug&&ky(this.gl)):w_(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,n,s){this.throwIfDisposed();const r=this.gl;A1(r,e,this.framebuffer),this.debug&&ky(r),this.outputTexture=e,Ne(r,()=>r.viewport(0,0,n,s)),Ne(r,()=>r.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(e,n,s,r){this.throwIfDisposed(),Ne(this.gl,()=>this.gl.scissor(e,n,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function zxe(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Bxe,bincountImpl:KV,bincountReduceImpl:Vxe,bitwiseAndImpl:Uxe,castImpl:Wxe,ceilImpl:jxe,concatImpl:Gxe,equalImpl:Hxe,expImpl:qxe,expm1Impl:Kxe,floorImpl:Xxe,gatherNdImpl:Yxe,gatherV2Impl:Qxe,greaterImpl:Zxe,greaterEqualImpl:Jxe,lessImpl:ewe,lessEqualImpl:twe,linSpaceImpl:nwe,logImpl:swe,maxImpl:rwe,maximumImpl:owe,minimumImpl:iwe,multiplyImpl:awe,negImpl:lwe,notEqualImpl:uwe,prodImpl:cwe,raggedGatherImpl:dwe,raggedRangeImpl:hwe,raggedTensorToTensorImpl:fwe,rangeImpl:pwe,rsqrtImpl:mwe,scatterImpl:gwe,sigmoidImpl:ywe,simpleAbsImpl:XV,sliceImpl:bwe,sparseFillEmptyRowsImpl:vwe,sparseReshapeImpl:xwe,sparseSegmentReductionImpl:YV,sqrtImpl:wwe,staticRegexReplaceImpl:Swe,stridedSliceImpl:kwe,stringNGramsImpl:Cwe,stringSplitImpl:Nwe,stringToHashBucketFastImpl:Twe,subImpl:$we,tileImpl:Iwe,topKImpl:Ewe,transposeImpl:EI,uniqueImpl:Rwe}=Dpe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QV(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function vs(t,e){return e===1?[t]:QV(t,e)}function _we(t,e){if(t===1)return"rc";let n="";for(let s=0;s<t;s++)n+=e[s],s<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Awe{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=ds(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=vs("rc",this.rank),s=It(this.rank),r=this.getOutOfBoundsCondition(n),o=this.getSetup(n),i=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${o}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let o=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)o=`${e[e.length-1-i]},`+o;n.push(o)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZV{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=ds(this.outputShape.length);let s="";for(let r=0;r<4;r++){let o="thisRC = rc;";r%2===1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),s+=`
        ${o}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${Dwe(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?$I():TI(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function Dwe(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?_ve(["r","c","d"],"inputShape"):Fu(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Owe{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,s){const r=T_(n,s),o=$_(e,r,s);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const i=N_(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[o].pop();return this.usedTextures[o].push(l),l}let a;return r===Hn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Hn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Hn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Hn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Hn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(e,n,s,r){if(this.freeTextures==null)return;const o=T_(s,r),i=$_(n,o,r);i in this.freeTextures||(this.freeTextures[i]=[]);const a=N_(n,o,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=ee().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const u=this.usedTextures[i],c=u&&u.indexOf(e);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Fwe(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function N_(t,e,n,s,r){const o=Lwe(e,s);let i;if(r){const[l,u]=Ih(t[0],t[1]);i=l*u}else{const[l,u]=Og(t[0],t[1]);i=l*u}const a=Fwe(n,o);return i*a}function Lwe(t,e){switch(t){case Hn.PACKED_2X2_FLOAT32:return HV(e);case Hn.PACKED_2X2_FLOAT16:return qV(e);case Hn.UNPACKED_FLOAT32:return WV(e);case Hn.UNPACKED_FLOAT16:return jV(e);case Hn.PACKED_4X1_UNSIGNED_BYTE:return GV(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function Pwe(t){return ee().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Hn.PACKED_2X2_FLOAT32:Hn.UNPACKED_FLOAT32:t?Hn.PACKED_2X2_FLOAT16:Hn.UNPACKED_FLOAT16}function T_(t,e){if(t===vr.UPLOAD)return Hn.PACKED_2X2_FLOAT32;if(t===vr.RENDER||t==null)return Pwe(e);if(t===vr.DOWNLOAD||t===vr.PIXELS)return Hn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function $_(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uo{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=ds(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const no="if (isnan(x)) return x;",Mwe="return x;",I_="return abs(x);",zwe="return (x >= 0.0) ? x : (exp(x) - 1.0);",Bwe=no+`
  return (x < 0.0) ? 0.0 : x;
`,Vwe=no+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,ia="return x;",Uwe="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wwe="return x;",jwe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Gwe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Hwe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,qwe="return 1.0 / (1.0 + exp(-1.0 * x));";class va{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=ds(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kwe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=ds(this.outputShape.length);const n=e.length,s=vs("rc",n),r=It(n),o=_we(n,s),i=s.slice(-2),a=n<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${o});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xwe=Vx,Ywe=1e-7,Qwe=1e-4,Ty={};function Zwe(t){return t in Ty||(Ty[t]={}),Ty[t]}const Jwe=ee().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),e1e=600;function t1e(){return ee().global.screen==null?1024:ee().global.screen.height*ee().global.screen.width*window.devicePixelRatio*e1e/1024/1024}class yw extends rv{nextDataId(){return yw.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ee().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof F1)n=e;else{const s=No(ee().getNumber("WEBGL_VERSION"),e);n=new F1(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=No(ee().getNumber("WEBGL_VERSION"));n=new F1(s),this.binaryCache=Zwe(ee().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Owe(this.gpgpu),this.numMBBeforeWarning=t1e(),this.texData=new MN(this,lo())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,s,r,o,i){const a=this.makeTensorInfo(n,s),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[r,o]},l.texShape=[r,o];const u=Cy(n),c=new C_(u,!1,i),d=this.runWebGLProgram(c,[a],s,[[r,o]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(e,n,s){if((ee().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ee().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:n,dtype:s,values:e,usage:vr.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,s,r,o){if(ee().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:n,usage:vr.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:o,slice:i,shape:a,isPacked:l}=n;if(i!=null){let h;l?h=new va(a,ia):h=new Uo(a,ia);const f=this.runWebGLProgram(h,[{dataId:e,shape:a,dtype:r}],r),p=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),p}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const u=this.activeTimers!=null;let c;u&&(c=is());let d;if(r==="complex64"){const h=this.readSync(o.real.dataId),f=this.readSync(o.imag.dataId);d=_i(h,f)}else d=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=is()-c),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(m=>p.push(m))}const n=this.texData.get(e),{values:s,shape:r,slice:o,dtype:i,complexTensorInfos:a,isPacked:l}=n;if(o!=null){let p;l?p=new va(r,ia):p=new Uo(r,ia);const m=this.runWebGLProgram(p,[{dataId:e,shape:r,dtype:i}],i),g=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),g}if(s!=null)return this.convertAndCacheOnCPU(e);if(ee().getBool("DEBUG")&&!ee().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ee().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(i!=="complex64"&&ee().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const p=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(p.texture.texture,...wy(r))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(i==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=p[0],g=p[1];d=_i(m,g)}else if(u==null)d=this.getValuesFromTexture(e);else{const p=oe(r);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,p)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const p=this.gpgpu.gl;Ne(p,()=>p.deleteBuffer(u))}const h=this.convertAndCacheOnCPU(e,d),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(p=>p(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&lo().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,n={}){const s=this.texData.get(e),{values:r,shape:o,slice:i,dtype:a,isPacked:l,texture:u}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let f;l?f=new va(o,ia):f=new Uo(o,ia);const p=this.runWebGLProgram(f,[{dataId:e,shape:o,dtype:a}],a),m=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),m}if(u==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,n.customTexShape),d=lo().makeTensorFromTensorInfo(c),h=this.texData.get(c.dataId);return Object.assign({tensorRef:d},h.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>$i(r));return Ze(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ze(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const s=e[n];if(!rve(s))throw ee().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:s,isPacked:r}=this.texData.get(e),o=oe(n);if(ee().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),f=this.texData.get(h.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...wy(n)).subarray(0,o);return this.disposeIntermediateTensorInfo(h),p}const i=ee().getBool("WEBGL_PACK")&&r===!0,a=i?Cy(n):n,l=i?new xxe(a):new vxe(a),u=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:e}],"float32"),c=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const o=Yo(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=Yo(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,r&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(o);a.kernelMs=yP(l),a.getExtraProfileInfo=()=>l.map((u,c)=>({name:i[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:is(),endMs:null}}endTimer(e){return ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=is(),e)}async getQueryTime(e){if(ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:s,texShape:r,usage:o,isPacked:i,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(n,r,o,i)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=Jwe){return ee().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&oe(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){pr("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return Xwe(e.shape,n)}packedUnaryOp(e,n,s){const r=new va(e.shape,n),o=this.compileAndRun(r,[e],s);return lo().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=XV(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(ee().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,I_,e.dtype);const n=new Uo(e.shape,I_),s=this.compileAndRun(n,[e]);return lo().makeTensorFromTensorInfo(s)}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&Vo(s[0])){const o=s.map(i=>Go(i));r=this.write(o,e,n)}else r=this.write(s,e,n);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:n}}makeOutput(e,n,s){return lo().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,s),this)}unpackTensor(e){const n=new Kwe(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new Awe(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const s=[pd(e.shape),...md(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},o=[pd(n),...md(n)],i=new ZV(o,s),a=!0,l=[s],u=this.runWebGLProgram(i,[r],e.dtype,l,a);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(e,n){const s=this.texData.get(e),{isPacked:r,shape:o,dtype:i}=s;if(n!=null){const h=oe(o),f=n[0]*n[1]*4;T(h<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=Cy(o);let l;r?l=new bxe(a):l=new yxe(a);const u=!0,c=[n??wy(a)],d=this.runWebGLProgram(l,[{shape:a,dtype:i,dataId:e}],i,c,u,n);return{dtype:i,shape:o,dataId:d.dataId}}runWebGLProgram(e,n,s,r,o=!1,i){const a=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===xp.DENSE){const y=i??wy(e.outputShape);l.texShape=y.map(b=>b*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),oe(a.shape)===0)return l.values=Pn(a.dtype,0),a;const u=[],c=n.map(y=>{if(y.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let b=this.texData.get(y.dataId);if(b.texture==null){if(!e.packedInputs&&oe(y.shape)<=ee().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:y.shape,texData:null,isUniform:!0,uniformValues:b.values};e.packedInputs&&(b.isPacked=!0,b.shape=y.shape)}if(this.uploadToGPU(y.dataId),!!b.isPacked!=!!e.packedInputs)y=b.isPacked?this.unpackTensor(y):this.packTensor(y),u.push(y),b=this.texData.get(y.dataId);else if(b.isPacked&&!rb(b.shape,y.shape)){const v=y,x=y.shape;y.shape=b.shape,y=this.packedReshape(y,x),u.push(y),b=this.texData.get(y.dataId),v.shape=x}return{shape:y.shape,texData:b,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:l,isUniform:!1},h=gxe(e,c,d),f=this.getAndSaveBinary(h,()=>pxe(this.gpgpu,e,c,d)),p=this.activeTimers!=null;let m;p&&(m=this.startTimer()),ee().get("ENGINE_COMPILE_ONLY")||mxe(this.gpgpu,f,c,d,r),u.forEach(y=>this.disposeIntermediateTensorInfo(y)),p&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const g=ee().getNumber("WEBGL_FLUSH_THRESHOLD");if(g>0){const y=is();y-this.lastGlFlushTime>g&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=y)}if(!ee().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){const y=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),y}return a}compileAndRun(e,n,s,r,o=!1){return s=s||n[0].dtype,this.runWebGLProgram(e,n,s,r,o)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(ee().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Q(()=>{if(!ee().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=ee().getBool("DEBUG");ee().set("DEBUG",!1);const n=this.abs(ze(1e-8)).dataSync()[0];if(ee().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Ywe:Qwe}uploadToGPU(e){const n=this.texData.get(e),{shape:s,dtype:r,values:o,texture:i,usage:a,isPacked:l}=n;if(i!=null)return;const u=this.activeTimers!=null;let c;u&&(c=is());let d=n.texShape;if(d==null&&(d=Sve(s,l),n.texShape=d),o!=null){const h=Cy(s);let f,p=d[1],m=d[0];const g=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(l||!g)&&([p,m]=Ih(d[0],d[1])),l?f=new Sxe(h,g):f=new C_(h,g);const y=g?[m,p]:d,b=this.makeTensorInfo(y,r),v=this.texData.get(b.dataId);g?v.usage=vr.PIXELS:v.usage=vr.UPLOAD,v.texShape=y,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),p,m,o);const x=[[m,p]],S=this.runWebGLProgram(f,[b],r,x,!0),C=this.texData.get(S.dataId);n.texShape=C.texShape,n.isPacked=C.isPacked,n.usage=C.usage,ee().get("ENGINE_COMPILE_ONLY")?this.disposeData(S.dataId):(n.texture=C.texture,n.values=null,this.texData.delete(S.dataId)),this.disposeIntermediateTensorInfo(b),u&&(this.uploadWaitMs+=is()-c)}else{const h=this.acquireTexture(d,a,r,l);n.texture=h}}convertAndCacheOnCPU(e,n){const s=this.texData.get(e),{dtype:r}=s;return n!=null&&(s.values=n1e(n,r)),s.values}acquireTexture(e,n,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,r)}computeBytes(e,n){return e[0]*e[1]*rp(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(n),r(!0)}catch(o){throw o}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await T$(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(PV(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:s,infLoc:r,nanLoc:o,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:l}=UV(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=o,e.outShapeLocation=i,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,s){e.channels=e.channels||"RGBA";const{texture:r,height:o,width:i,channels:a}=e,l=lo().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(r,n,s,o,i,a);return lo().makeTensorFromDataId(u,n,s,l)}}yw.nextDataId=0;function n1e(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let s=0;s<n.length;++s)n[s]=Math.round(t[s]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */KN()&&YN("webgl",()=>new yw,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RI=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class gu{constructor(e,n,s){this.variableNames=["A","B"],this.outputShape=qe(n,s),this.enableShapeUniforms=ds(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pu=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Dh{constructor(e,n,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=qe(n,s);const o=this.outputShape.length;this.enableShapeUniforms=ds(o);let i="";if(r)if(o===0||oe(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${It(o)} coords = getOutputCoords();
        `,o===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=vs("coords",o);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= outShape[${o} - 2];
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= outShape[${o} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= ${this.outputShape[o-2]};
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= ${this.outputShape[o-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sr(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const s1e={kernelName:jd,backendName:"webgl",kernelFunc:sr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function al(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,o=n.makeTensorInfo(s.shape,"complex64"),i=n.texData.get(o.dataId),a=sr({inputs:{x:s},backend:n}),l=sr({inputs:{x:r},backend:n});return i.complexTensorInfos={real:a,imag:l},o}const r1e={kernelName:fv,backendName:"webgl",kernelFunc:al};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JV="return (a < 0.) ? b * a : a;",eU=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function o1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:o}=s,i=n.makeTensorInfo([],"float32",Pi(o,"float32")),a=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Dh(eU,r.shape,i.shape):new gu(JV,r.shape,i.shape),l=n.runWebGLProgram(a,[r,i],"float32");return n.disposeIntermediateTensorInfo(i),l}const i1e={kernelName:wm,backendName:"webgl",kernelFunc:o1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tU="return (a < 0.) ? b * a : a;",nU=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function a1e(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e,o=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Dh(nU,s.shape,r.shape):new gu(tU,s.shape,r.shape);return n.runWebGLProgram(o,[s,r],"float32")}const l1e={kernelName:Bm,backendName:"webgl",kernelFunc:a1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oh="if (isnan(x)) return x;";function yt({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:s}){return({inputs:r,backend:o})=>{const{x:i}=r,a=o,l=s||i.dtype;if(a.shouldExecuteOnCPU([i])&&n!=null){const d=a.texData.get(i.dataId),h=n(d.values,l);return a.makeTensorInfo(i.shape,l,h)}const u=ee().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return u?c=new va(i.shape,e):c=new Uo(i.shape,t),a.runWebGLProgram(c,[i],l)}}function ns({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:o}){return({inputs:i,backend:a})=>{const{a:l,b:u}=i,c=a;if(s&&l.dtype==="complex64"){const p=c.texData.get(l.dataId),m=c.texData.get(u.dataId),[g,y]=[[p.complexTensorInfos.real,m.complexTensorInfos.real],[p.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(v=>{const[x,w]=v,S={dataId:x.dataId,dtype:x.dtype,shape:l.shape},C={dataId:w.dataId,dtype:w.dtype,shape:u.shape},N=new gu(t,l.shape,u.shape);return c.runWebGLProgram(N,[S,C],As(x.dtype,w.dtype))}),b=al({inputs:{real:g,imag:y},backend:c});return c.disposeIntermediateTensorInfo(g),c.disposeIntermediateTensorInfo(y),b}const d=o||As(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&r!=null){const p=c.texData.get(l.dataId).values,m=c.texData.get(u.dataId).values,g=l.dtype==="string"?Ai(p):p,y=l.dtype==="string"?Ai(m):m,[b,v]=r(l.shape,u.shape,g,y,d),x=c.makeTensorInfo(v,d),w=c.texData.get(x.dataId);return w.values=b,x}const h=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return h?f=new Dh(e,l.shape,u.shape,n):f=new gu(t,l.shape,u.shape),c.runWebGLProgram(f,[l,u],d)}}function wp(t,e=!1){if(t==="linear")return e?Wwe:Mwe;if(t==="relu")return e?Gwe:Bwe;if(t==="elu")return e?jwe:zwe;if(t==="relu6")return e?Hwe:Vwe;if(t==="prelu")return e?nU:tU;if(t==="leakyrelu")return e?eU:JV;if(t==="sigmoid")return e?qwe:Uwe;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sU{constructor(e,n,s,r=!1,o=!1,i=!1,a=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=ds(this.outputShape.length);const c=r?e[1]:e[2],d=Math.ceil(c/2),h=r?"i * 2, rc.y":"rc.y, i * 2",f=o?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let g="",y="";a&&(l?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:u?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:g=`vec4 activation(vec4 x) {
          ${a}
        }`,y="result = activation(result);");const b=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let v="rc.x",x="rc.x";e[0]<n[0]?v=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(x=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${g}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${v};
        int batchB = ${x};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${m[0]});
          result += (${p[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${b}

        ${y}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E_={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class R_{constructor(e,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=qe(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const __="return a * b;";function _I(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,o=As(s.dtype,r.dtype);if(s.dtype==="complex64"){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),u=new R_(E_.REAL,s.shape,r.shape),c=new R_(E_.IMAG,s.shape,r.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],h=n.runWebGLProgram(u,d,"float32"),f=n.runWebGLProgram(c,d,"float32"),p=al({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}if(n.shouldExecuteOnCPU([s,r])){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),[u,c]=awe(s.shape,r.shape,a.values,l.values,o),d=n.makeTensorInfo(c,o),h=n.texData.get(d.dataId);return h.values=u,d}let i;return ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new Dh(__,s.shape,r.shape):i=new gu(__,s.shape,r.shape),n.runWebGLProgram(i,[s,r],o)}const u1e={kernelName:Jd,backendName:"webgl",kernelFunc:_I};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c1e(t,e,n){const s=[pd(t.shape),...md(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},o=[pd(e),...md(e)],i=new ZV(o,s),a=!0,l=[s],u=n.runWebGLProgram(i,[r],t.dtype,l,a);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:o}=s,i=n,a=oe(r.shape),l=BN(o,a),u=oe(l);T(a===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const c=i.texData.get(r.dataId);return c.isPacked&&!rb(r.shape,l)&&!(c.texture!==null&&rb(c.shape,l))?c1e(r,l,i):(i.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const d1e={kernelName:Um,backendName:"webgl",kernelFunc:ve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A_{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:o,outSize:i}=e;this.outputShape=[r,i];const a=Math.floor(s/4)*4,l=s%4;let u="sumValue += dot(values, ones);";if(n!=null){const d=1/n;u=`sumValue += dot(values * ${nu(d)?d.toPrecision(2):d}, ones);`}let c="";o%s>0&&(c=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h1e{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:o,outSize:i}=e;this.outputShape=[r,i];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const c=Math.floor(s/4)*4,d=s%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(a="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let p="";o%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f1e(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],s=Jx(n);e.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return e}function Mu(t,e,n,s){const r=f1e(t.shape);let o=t;for(let i=0;i<r.length;i++){const{inSize:a,windowSize:l,outSize:u}=r[i];let c,d;n==="mean"?c=i===0?new A_({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},a):new A_({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u}):c=new h1e({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},n),d=o,o=s.runWebGLProgram(c,[o],e),d.dataId!==t.dataId&&s.disposeIntermediateTensorInfo(d)}return o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p1e{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[n[i]];this.outputShape=s,this.rank=s.length;const r=It(this.rank),o=m1e(n);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${o}));
    }
    `}}function m1e(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<t.length;r++)s[t[r]]=n[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g1e{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let c=0;c<s.length;c++)s[c]=e[n[c]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=It(this.rank),o=QV("rc",this.rank),i=new Array(this.rank);for(let c=0;c<n.length;c++)i[n[c]]=o[c];const a=`vec2(${i.slice(-2).join()})`,l=`++${o[this.rank-1]} < ${s[this.rank-1]}`,u=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${o[this.rank-1]};
      if(++${o[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bw(t,e,n){const s=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new g1e(t.shape,e):new p1e(t.shape,e);return n.runWebGLProgram(s,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y1e(t,e,n,s){const r=e,o=t.shape.length,i=st(r,t.shape);let a=i;const l=tn(a,o),u=l!=null;let c=t;u&&(c=bw(t,l,s),a=pn(a.length,o)),es("sum",a,o);const[d,h]=Bn(c.shape,a);let f=d;n&&(f=fn(d,i));const p=oe(h),g=oe(t.shape)/p,y=ve({inputs:{x:c},attrs:{shape:[g,p]},backend:s}),b=fx(t.dtype),v=Mu(y,b,"sum",s),x=ve({inputs:{x:v},attrs:{shape:f},backend:s});return s.disposeIntermediateTensorInfo(y),s.disposeIntermediateTensorInfo(v),u&&s.disposeIntermediateTensorInfo(c),x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vw(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;return y1e(r,o,i,n)}const b1e={kernelName:Km,backendName:"webgl",kernelFunc:vw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ws(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{perm:o}=s,i=n,a=r.shape.length,l=new Array(a);for(let c=0;c<l.length;c++)l[c]=r.shape[o[c]];let u;if(i.shouldExecuteOnCPU([r])){const d=i.texData.get(r.dataId).values,h=EI(d,r.shape,r.dtype,o,l);u=i.makeTensorInfo(l,r.dtype);const f=i.texData.get(u.dataId);f.values=h}else u=bw(r,o,i);return u}const v1e={kernelName:jl,backendName:"webgl",kernelFunc:ws};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rU=1e3;function ob({a:t,b:e,transposeA:n,transposeB:s,backend:r,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,d=n?t.shape[u-2]:t.shape[u-1],h=s?e.shape[c-1]:e.shape[c-2],f=n?t.shape[u-1]:t.shape[u-2],p=s?e.shape[c-2]:e.shape[c-1],m=t.shape.slice(0,-2),g=e.shape.slice(0,-2),y=oe(m),b=oe(g),x=qe(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,p]);T(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const w=n?[y,d,f]:[y,f,d],S=s?[b,p,h]:[b,h,p],C=ve({inputs:{x:t},backend:r,attrs:{shape:w}}),N=ve({inputs:{x:e},backend:r,attrs:{shape:S}}),I=[C,N],E=Math.max(y,b),A=n?C.shape[1]:C.shape[2],z=o!=null,V=i!=null,P=l==="leakyrelu",K=l!=null?wp(l,!0):null,Y=z||V||P||K!=null;let te;if((f===1||p===1)&&A>rU&&Y===!1){let j=C,q=N;n&&(j=ws({inputs:{x:C},backend:r,attrs:{perm:[0,2,1]}}),I.push(j)),s&&(q=ws({inputs:{x:N},backend:r,attrs:{perm:[0,2,1]}}),I.push(q));const J=p!==1,_=p===1;let W=j;J&&(W=ve({inputs:{x:j},backend:r,attrs:{shape:[E,A,1]}}),I.push(W));const Z=p===1?2:1;let ie=q;_&&(ie=ve({inputs:{x:q},backend:r,attrs:{shape:[E,1,A]}}),I.push(ie));const re=_I({inputs:{a:W,b:ie},backend:r});te=vw({inputs:{x:re},backend:r,attrs:{axis:Z,keepDims:!0}}),I.push(re)}else{const j=As(t.dtype,e.dtype),q=new sU(w,S,[E,f,p],n,s,z,K,V,P),J=[C,N];if(o!=null&&J.push(o),V&&J.push(i),P){const _=r.makeTensorInfo([],"float32",Pi(a,"float32"));J.push(_),I.push(_)}te=r.runWebGLProgram(q,J,j)}const F=ve({inputs:{x:te},backend:r,attrs:{shape:x}});I.push(te);for(const j of I)r.disposeIntermediateTensorInfo(j);return F}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x1e(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=s;return ob({a:r,b:o,transposeA:l,transposeB:u,backend:n,bias:i,preluActivationWeights:a,leakyreluAlpha:d,activation:c})}const w1e={kernelName:op,backendName:"webgl",kernelFunc:x1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D_="return abs(x);";function S1e(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const o=n.texData.get(s.dataId),i=XV(o.values);return n.makeTensorInfo(s.shape,s.dtype,i)}let r;return ee().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new va(s.shape,D_):r=new Uo(s.shape,D_),n.runWebGLProgram(r,[s],s.dtype)}const k1e={kernelName:Jp,backendName:"webgl",kernelFunc:S1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C1e=no+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,N1e=yt({opSnippet:C1e}),T1e={kernelName:Cd,backendName:"webgl",kernelFunc:N1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $1e=no+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,I1e=yt({opSnippet:$1e}),E1e={kernelName:Nd,backendName:"webgl",kernelFunc:I1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O_="return a + b;",R1e=ns({opSnippet:O_,packedOpSnippet:O_,supportsComplex:!0,cpuKernelImpl:Bxe}),_1e={kernelName:Tu,backendName:"webgl",kernelFunc:R1e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A1e{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((o,i)=>`T${i}`);const s=[];this.variableNames.forEach(o=>{s.push(`float v${o} = get${o}AtOutCoords();`)});const r=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D1e{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((o,i)=>`T${i}`);const s=[];this.variableNames.forEach(o=>{s.push(`vec4 v${o} = get${o}AtOutCoords();`)});const r=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yy(t){const{inputs:e,backend:n}=t,s=e;if(s.length===1)return sr({inputs:{x:s[0]},backend:n});if(s.length>ee().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),u=Yy({inputs:s.slice(0,l),backend:n}),c=Yy({inputs:s.slice(l),backend:n});return Yy({inputs:[u,c],backend:n})}const r=s.map(l=>l.dtype).reduce((l,u)=>As(l,u)),o=s.map(l=>l.shape),a=ee().getBool("WEBGL_PACK")?new D1e(s[0].shape,o):new A1e(s[0].shape,o);return n.runWebGLProgram(a,s,r)}const O1e={kernelName:em,backendName:"webgl",kernelFunc:Yy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=st(o,r.shape);let u=l;const c=tn(u,a);let d=r;c!=null&&(d=ws({inputs:{x:r},backend:n,attrs:{perm:c}}),u=pn(u.length,a)),es("all",u,a);const[h,f]=Bn(d.shape,u),p=oe(f),m=ve({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),g=Mu(m,m.dtype,"all",n);let y;if(i){const b=fn(h,l);y=ve({inputs:{x:g},backend:n,attrs:{shape:b}})}else y=ve({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),c!=null&&n.disposeIntermediateTensorInfo(d),y}const L1e={kernelName:av,backendName:"webgl",kernelFunc:F1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=st(o,r.shape);let u=l;const c=tn(u,a);let d=r;c!=null&&(d=ws({inputs:{x:r},backend:n,attrs:{perm:c}}),u=pn(u.length,a)),es("any",u,a);const[h,f]=Bn(d.shape,u),p=oe(f),m=ve({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),g=Mu(m,m.dtype,"any",n);let y;if(i){const b=fn(h,l);y=ve({inputs:{x:g},backend:n,attrs:{shape:b}})}else y=ve({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),c!=null&&n.disposeIntermediateTensorInfo(d),y}const M1e={kernelName:lv,backendName:"webgl",kernelFunc:P1e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z1e{constructor(e,n,s){this.variableNames=["A"];const{windowSize:r,batchSize:o,outSize:i}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];const a=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B1e{constructor(e,n,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,T(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const o=e[e.length-1],i=Math.ceil(o/n);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,u=It(l),c=vs("coords",l);let d,h;if(i===1){h=l+1;const N=It(h);d=`
        ${N} sourceLocR = ${N}(${c.join()}, 0);
        ++${c[l-1]};
        ${N} sourceLocG = ${N}(${c.join()}, 0);
        ++${c[l-2]};
        ${N} sourceLocA = ${N}(${c.join()}, 0);
        --${c[l-1]};
        ${N} sourceLocB = ${N}(${c.join()}, 0);
        --${c[l-2]};`}else h=l,d=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,h),p="."+f[h-1],m=f.map(N=>"int "+N),g=vs("sourceLocR",h-1).concat("inIdx.r"),y=vs("sourceLocG",h-1).concat("inIdx.g"),b=vs("sourceLocB",h-1).concat("inIdx.b"),v=vs("sourceLocA",h-1).concat("inIdx.a"),x=s==="max"?"greaterThan":"lessThan",w=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${v.join()})));`,S=`vec4(
            getAChannel(${g.join()}),
            hasNextCol ? getAChannel(${y.join()}) : 0.,
            hasNextRow ? getAChannel(${b.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,C=r?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${C}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${a[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${S};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${w}
          vec4 candidate = ${S};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${x}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oU(t,e,n,s=null){let r=e.shape[0],o=e.shape[1];s!=null&&(r=s.shape[0],o=s.shape[1]);const i=Jx(o),a={windowSize:i,inSize:o,batchSize:r,outSize:Math.ceil(o/i)},l=new z1e(a,n,s==null),u=[e];s!=null&&u.push(s);const c=t.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const d=oU(t,e,n,c);return t.disposeIntermediateTensorInfo(c),d}function iU(t,e,n,s=null){const r=s!=null?s.shape:e.shape,o=r[r.length-1],i=Jx(o),a=new B1e(r,i,n,s==null),l=s==null?[e]:[e,s],u=t.runWebGLProgram(a,l,"int32");if(u.shape.length===e.shape.length){const c=iU(t,e,n,u);return t.disposeIntermediateTensorInfo(u),c}return u}function aU(t,e,n,s){const r=[n];if(es("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!ee().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const o=[],i=t.texData.get(e.dataId),a=i!==null&&i.isPacked;let l=e;a&&(l=t.unpackTensor(e),o.push(l));const[u,c]=Bn(l.shape,r),d=oe(c),h=ve({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});o.push(h);const f=oU(t,h,s);o.push(f);const p=ve({inputs:{x:f},backend:t,attrs:{shape:u}});return o.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}return iU(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o}=s;let i=st(o,r.shape);const a=tn(i,r.shape.length);let l=r;const u=[];a!=null&&(l=ws({inputs:{x:r},backend:n,attrs:{perm:a}}),u.push(l),i=pn(i.length,l.shape.length)),es("argMax",[i[0]],l.shape.length);const c=aU(n,l,i[0],"max");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const U1e={kernelName:tm,backendName:"webgl",kernelFunc:V1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o}=s;let i=st(o,r.shape);const a=tn(i,r.shape.length);let l=r;const u=[];a!=null&&(l=ws({inputs:{x:r},backend:n,attrs:{perm:a}}),u.push(l),i=pn(i.length,l.shape.length)),es("argMin",[i[0]],l.shape.length);const c=aU(n,l,i[0],"min");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const j1e={kernelName:nm,backendName:"webgl",kernelFunc:W1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G1e=no+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,H1e=yt({opSnippet:G1e}),q1e={kernelName:Td,backendName:"webgl",kernelFunc:H1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K1e=no+"return log(x + sqrt(x * x + 1.0));",X1e=yt({opSnippet:K1e}),Y1e={kernelName:$d,backendName:"webgl",kernelFunc:X1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q1e=no+`
  return atan(x);
`,Z1e=yt({opSnippet:Q1e}),J1e={kernelName:Id,backendName:"webgl",kernelFunc:Z1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eSe=RI+`
  return atan(a, b);
`,tSe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Pu+`
  return result;
`,nSe=ns({opSnippet:eSe,packedOpSnippet:tSe}),sSe={kernelName:Rd,backendName:"webgl",kernelFunc:nSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rSe=no+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,oSe=yt({opSnippet:rSe}),iSe={kernelName:Ed,backendName:"webgl",kernelFunc:oSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sp{constructor(e,n,s,r=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const m=n==="avg",g=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,y=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let b="0.0";if(m||(b="-1.0 / 1e-20"),s){const N=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${N} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?o?g:y:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const v="max";let x=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(x="avgValue / max(count, 1.0)");const w=Math.floor(i/4)*4,S=i%4,C=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${v}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${w}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${C}
          }

          int xC = xCCorner + ${w};
          if (${S===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${C}
          } else if (${S===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${C}
          } else if (${S===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${C}
          }
        }
        setOutput(${x});
      }
    `}}class AI{constructor(e,n,s,r=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,d=e.dilationHeight,h=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,m=e.effectiveFilterWidth,g=e.padInfo.front,y=e.padInfo.top,b=e.padInfo.left;this.outputShape=e.outShape;const v=n==="avg";let x="0.0";if(v||(x="-1.0 / 1e-20"),s){const E=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${u});
        const ivec3 pads = ivec3(${g}, ${y}, ${b});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${E} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?o?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let S=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(S="avgValue / max(count, 1.0)");const C=Math.floor(i/4)*4,N=i%4,I=`
      if (${v}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${u});
      const ivec3 pads = ivec3(${g}, ${y}, ${b});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${C}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${I}
            }

            int xC = xCCorner + ${C};
            if (${N===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${I}
            } else if (${N===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${I}
            } else if (${N===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${I}
            }
          }
        }
        setOutput(${S});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Fg(r,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,u=1;T(Jn(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=eo(r.shape,o,i,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&ut(c.inShape,c.outShape))return sr({inputs:{x:r},backend:n});const d=new Sp(c,"avg",!1);return n.runWebGLProgram(d,[r],"float32")}const lSe={kernelName:sm,backendName:"webgl",kernelFunc:aSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:u}=s,c=[1,1,1],d=Mi(r.shape,o,i,c,a,l,u),h=new AI(d,"avg",!1);return n.runWebGLProgram(h,[r],"float32")}const cSe={kernelName:rm,backendName:"webgl",kernelFunc:uSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dSe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=l-1-e.padInfo.top,d=u-1-e.padInfo.left,h=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${d});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class hSe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=d-1-e.padInfo.front,m=h-1-e.padInfo.top,g=f-1-e.padInfo.left,y=1/(n*s*r);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${g});
      const float avgMultiplier = float(${y});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${o}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fSe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=s,d=[1,1,1],h=Mi(i.shape,a,l,d,u,c),f=new hSe(h);return n.runWebGLProgram(f,[r],i.dtype)}const pSe={kernelName:cv,backendName:"webgl",kernelFunc:fSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mSe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,i=o;Fg([r,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=s,c=eo(i.shape,a,l,1,u),d=new dSe(c);return n.runWebGLProgram(d,[r],i.dtype)}const gSe={kernelName:uv,backendName:"webgl",kernelFunc:mSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ySe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:o}=e,{transposeA:i,transposeB:a}=s;return ob({a:r,b:o,transposeA:i,transposeB:a,backend:n})}const bSe={kernelName:om,backendName:"webgl",kernelFunc:ySe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vSe{constructor(e,n,s,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],qe(e,n),qe(e,s);let a="0.0";r!=null&&(qe(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";o!=null&&(qe(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xSe{constructor(e,n,s,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],qe(e,n),qe(e,s);let a="vec4(0.0)";r!=null&&(qe(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";o!=null&&(qe(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wSe=({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:r,variance:o,offset:i,scale:a}=t;T(r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(i==null||r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const u=[s,r,o];let c=null;i!=null&&(c=i.shape,u.push(i));let d=null;a!=null&&(d=a.shape,u.push(a));const h=ee().getBool("WEBGL_PACK_NORMALIZATION")?new xSe(s.shape,r.shape,o.shape,c,d,l):new vSe(s.shape,r.shape,o.shape,c,d,l);return e.runWebGLProgram(h,u,u[0].dtype)},SSe={kernelName:bm,backendName:"webgl",kernelFunc:wSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kSe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=It(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=CSe(this.rank);let r;const o=e.map((i,a)=>`sourceLoc.${iC[a]} = start[${a}] + coords.${iC[a]};`);r=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${o.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const iC=["x","y","z","w","u","v"];function CSe(t){if(t===1)return"sourceLoc";if(t<=6)return iC.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NSe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=It(this.rank),s=vs("coords",this.rank),r=vs("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,i=`getChannel(getSource(${r.join()}), ${o})`,a=`
      result.x = ${i};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${i};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${i};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${i};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((c,d)=>`start[${d}]`).join()});`:e.map((c,d)=>`${r[d]} = ${s[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TSe(t,e,n,s){const r=s.texData.get(t.dataId),o=s.makeTensorInfo(n,t.dtype),i=s.texData.get(o.dataId);Object.assign(i,r),i.refCount=1,i.shape=n,i.dtype=t.dtype;let a=C$(e,Le(t.shape));r.slice&&(a+=r.slice.flatOffset),i.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||t.dataId};const l=s.dataRefCount.get(i.slice.origDataId)||1;return s.dataRefCount.set(i.slice.origDataId,l+1),o}function Fh(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:o,size:i}=s,[a,l]=Zx(r,o,i);if(w$(r,a,l),oe(l)===0)return n.makeTensorInfo(l,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||r.dtype==="string"){const d=n.texData.get(r.dataId),h=bwe(d.values,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,h)}const{isPacked:u}=n.texData.get(r.dataId),c=k$(r.shape,a,l);if(u||!c){const d=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new NSe(l):new kSe(l),h=[a];return n.runWebGLProgram(d,[r],r.dtype,h)}return n.uploadToGPU(r.dataId),TSe(r,a,l,n)}const $Se={kernelName:qm,backendName:"webgl",kernelFunc:Fh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ISe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:o,crops:i}=s;T(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((b,v)=>b*v),l=Sg(r.shape,o,a),u=kg(l.length,o.length),c=Cg(r.shape,o,a),d=R$(i,o.length),h=_$(c,i,o.length),f=[],p=ve({inputs:{x:r},backend:n,attrs:{shape:l}}),m=ws({inputs:{x:p},backend:n,attrs:{perm:u}}),g=ve({inputs:{x:m},backend:n,attrs:{shape:c}}),y=Fh({inputs:{x:g},backend:n,attrs:{begin:d,size:h}});return f.push(p),f.push(m),f.push(g),f.forEach(b=>n.disposeIntermediateTensorInfo(b)),y},ESe={kernelName:im,backendName:"webgl",kernelFunc:ISe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:o}=e,{size:i}=s,a=n.readSync(r.dataId),l=n.readSync(o.dataId),u=KV(a,l,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,u)}const _Se={kernelName:dv,backendName:"webgl",kernelFunc:RSe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ASe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,DSe=`
  return float(int(a.r) & int(b.r));
`;function OSe(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,o=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=ee().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,r])||i===1){const l=n.texData.get(s.dataId).values,u=n.texData.get(r.dataId).values,[c,d]=Uxe(s.shape,r.shape,l,u,s.dtype),h=n.makeTensorInfo(d,s.dtype),f=n.texData.get(h.dataId);return f.values=c,h}let a;return o?a=new Dh(ASe,s.shape,r.shape,!1):a=new gu(DSe,s.shape,r.shape),n.runWebGLProgram(a,[s,r],s.dtype)}const FSe={kernelName:am,backendName:"webgl",kernelFunc:OSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LSe(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,o=n.readSync(s.dataId),i=n.readSync(r.dataId),a=qe(Array.from(o),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const PSe={kernelName:hv,backendName:"webgl",kernelFunc:LSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MSe="return float(a != b);",lU=ns({opSnippet:MSe,cpuKernelImpl:uwe,dtype:"bool"}),zSe={kernelName:Fm,backendName:"webgl",kernelFunc:lU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pg(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return sr({inputs:{x:r.complexTensorInfos.real},backend:n})}const BSe={kernelName:Hv,backendName:"webgl",kernelFunc:Pg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VSe="return float(int(x));";function USe(t,e){const n=new Uo(t.shape,VSe),s=e.runWebGLProgram(n,[t],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aC(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:o}=s;if(o==="complex64"){if(r.dtype==="complex64")return sr({inputs:{x:r},backend:n});const i=dn(r.shape),a=aC({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),l=al({inputs:{real:a,imag:i},backend:n});return i.dispose(),n.disposeIntermediateTensorInfo(a),l}if(r.dtype==="complex64"){const i=Pg({inputs:{input:r},backend:n}),a=aC({inputs:{x:i},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(i),a}if(!VN(r.dtype,o)){const i=sr({inputs:{x:r},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:o}}if(n.shouldExecuteOnCPU([r])){const i=n.texData.get(r.dataId).values,[a,l,u]=Wxe(i,r.shape,r.dtype,o);return n.makeTensorInfo(a,l,u)}if(o==="int32")return USe(r,n);if(o==="bool"){const i=n.makeTensorInfo([],"bool",Pn("bool",1)),l=lU({inputs:{a:r,b:i},backend:n});return n.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${o}`)}const WSe={kernelName:_d,backendName:"webgl",kernelFunc:aC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F_="return ceil(x);",jSe=yt({opSnippet:F_,packedOpSnippet:F_,cpuKernelImpl:jxe}),GSe={kernelName:Ad,backendName:"webgl",kernelFunc:jSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HSe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qSe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KSe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{clipValueMin:o,clipValueMax:i}=s;let a;ee().getBool("WEBGL_PACK_CLIP")?a=new qSe(r.shape):a=new HSe(r.shape);const l=[[o],[i]];return n.runWebGLProgram(a,[r],r.dtype,l)}const XSe={kernelName:Dd,backendName:"webgl",kernelFunc:KSe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YSe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L_(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function QSe(t){const{inputs:e,backend:n}=t,{x:s}=e,r=n.texData.get(s.dataId),o=new YSe(s.shape),i=[L_(s,r.complexTensorInfos.real),L_(s,r.complexTensorInfos.imag)];return n.runWebGLProgram(o,i,i[0].dtype)}const ZSe={kernelName:lm,backendName:"webgl",kernelFunc:QSe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JSe{constructor(e){this.outputShape=[],this.outputShape=qo(e,1),this.variableNames=e.map((i,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let i=1;i<n.length;i++)n[i]=n[i-1]+e[i][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<n.length;i++){const a=n[i-1];s.push(`else if (yC < ${n[i]}) setOutput(getT${i}(yR, yC-${a}));`)}const r=n.length,o=n[n.length-1];s.push(`else setOutput(getT${r}(yR, yC-${o}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eke{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=qo(e,n);const s=this.outputShape,r=s.length,o=It(r),i=vs("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((m,g)=>`T${g}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let m=1;m<l.length;m++)l[m]=l[m-1]+e[m][n];const u=a[n],c=a.slice(-2),d=a.join();let h=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${c.join()}));
        }`;for(let m=1;m<l.length;m++){const g=l[m-1];h+=`
        if (${u} < ${l[m]}  && ${u} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${$y(a,u,g)}),
            vec2(${$y(c,u,g)}));
        }`}const f=l.length,p=l[l.length-1];h+=`
        return getChannel(
          getT${f}(${$y(a,u,p)}),
          vec2(${$y(c,u,p)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${h}
      }

      void main() {
        ${o} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[r-1]} = ${i[r-1]} + 1;
        if (${i[r-1]} < ${s[r-1]}) {
          result.g = getValue(${i});
        }

        ${i[r-2]} = ${i[r-2]} + 1;
        if (${i[r-2]} < ${s[r-2]}) {
          result.a = getValue(${i});
        }

        ${i[r-1]} = ${i[r-1]} - 1;
        if (${i[r-2]} < ${s[r-2]} &&
            ${i[r-1]} < ${s[r-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function $y(t,e,n){const s=t.indexOf(e);return t.map((o,i)=>i===s?`${o} - ${n}`:o).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xw(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return sr({inputs:{x:r.complexTensorInfos.imag},backend:n})}const tke={kernelName:Av,backendName:"webgl",kernelFunc:xw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xf(t,e,n){const s=t[0].dtype;if(s==="complex64"){const f=t.map(b=>Pg({inputs:{input:b},backend:n})),p=t.map(b=>xw({inputs:{input:b},backend:n})),m=xf(f,e,n),g=xf(p,e,n),y=al({inputs:{real:m,imag:g},backend:n});return f.forEach(b=>n.disposeIntermediateTensorInfo(b)),p.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),y}let r=n.shouldExecuteOnCPU(t);if(s==="string"&&(r=!0),r){const f=t.map(x=>{const S=[-1,oe(x.shape.slice(e))];return ve({inputs:{x},backend:n,attrs:{shape:S}})}),p=f.map(x=>({vals:n.readSync(x.dataId),shape:x.shape})),m=qo(f.map(x=>x.shape),1),g=f[0].shape[0]===1,y=Gxe(p,m,s,g),b=qo(t.map(x=>x.shape),e),v=n.makeTensorInfo(b,s,y);return f.forEach(x=>n.disposeIntermediateTensorInfo(x)),v}const o=t.filter(f=>oe(f.shape)>0),i=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&o[0].shape.length>1;if(o.length===1){const f=i?new Uo(t[0].shape,ia):new va(t[0].shape,ia);return n.runWebGLProgram(f,t,s)}const a=ee().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(o.length>a){const f=[];for(let m=0;m<o.length;m+=a){const g=o.slice(m,m+a);f.push(xf(g,e,n))}const p=xf(f,e,n);for(const m of f)n.disposeIntermediateTensorInfo(m);return p}if(i){const f=new eke(o.map(p=>p.shape),e);return n.runWebGLProgram(f,o,s)}const{tensors2D:l,outShape:u}=nke(o,e,n),c=new JSe(l.map(f=>f.shape)),d=n.runWebGLProgram(c,l,s);l.forEach(f=>n.disposeIntermediateTensorInfo(f));const h=ve({inputs:{x:d},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(d),h}function nke(t,e,n){const s=qo(t.map(o=>o.shape),e);return{tensors2D:t.map(o=>ve({inputs:{x:o},attrs:{shape:[-1,oe(o.shape.slice(e))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uU(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,o=st(r,e[0].shape)[0],i=e.map(u=>u.shape);$$(i,o);const a=qo(e.map(u=>u.shape),o);if(oe(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(u=>oe(u.shape)>0);return l.length===1?sr({inputs:{x:l[0]},backend:n}):xf(l,o,n)}const ske={kernelName:um,backendName:"webgl",kernelFunc:uU};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cU{constructor(e,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,h=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,g=e.dataFormat==="channelsLast",y=g?1:2,b=g?2:3,v=g?3:1;let x="",w="";s&&(r?x=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?x=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:x=`
          float activation(float x) {
            ${s}
          }
        `,w="result = activation(result);");const S=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${x}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${v}];

        ivec2 xRCCorner =
            ivec2(coords[${y}], coords[${b}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${g}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${g}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${g}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${g}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${S}
        ${w}
        setOutput(result);
      }
    `}}class rke{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${o}, ${i}, ${a});
      const ivec3 pads = ivec3(${n}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dU{constructor(e,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ds(this.outputShape.length);const i=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,d=c;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<c;g++)h+=`
           vec4 xTexelC${g*2};
           int xTexelC${g*2}Ready;
           vec4 xTexelC${g*2+1};
           int xTexelC${g*2+1}Ready;
           vec4 xC${g};`;h+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let g=0;g<c;g++)h+=`
           xTexelC${g*2} = vec4(0.0);
           xTexelC${g*2}Ready = 0;
           xTexelC${g*2+1} = vec4(0.0);
           xTexelC${g*2+1}Ready = 0;
           xC${g} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let g=0;g<(d+1)/2;g++){const y=g*2;if(h+=`
           xC = xCCorner + ${y*l};
           `,a===1){if(y<c&&(i%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }
               `,l===1&&y>0?h+=`
                 xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                   } else {
                     xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xC${y} = xTexelC${y};
                 `,y+1<c)){const b=i%2===0?ov(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${b};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                     xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${y+1}.zw = vec2(0.0);
                     }
                     xTexelC${y+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                     } else {
                      xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                     }
                     `:h+=`
                     xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                     `):b===1?h+=`
                     xC${y+1} = xTexelC${y};
                     `:h+=`
                     xCOffset = xC + ${b};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                       xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${y+1}.zw = vec2(0.0);
                       }
                       xTexelC${y+1}Ready = 1;
                     }

                     xC${y+1} = xTexelC${y+1};
                     `}}else y<c&&(i%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.0);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
               `,y+1<c&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(
                   xTexelC${y}.xy, xTexelC${y+1}.xy);
               `,y+1<c&&(h+=`
                   xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                 `)));y<c&&(h+=`
             wTexel = getW(r, ${y}, d1, d2);
             dotProd += xC${y}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${y}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,y+1<c&&(h+=`
               wTexel = getW(r, ${y+1}, d1, d2);
               dotProd += xC${y+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${y+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let f="",p="";s&&(r?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:o?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:f=`vec4 activation(vec4 x) {
           ${s}
         }`,p="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oke{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=ds(this.outputShape.length);const{dataFormat:s}=n,r=ks(),o=s==="channelsLast",i=o?1:2,a=o?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let d=0;d<=1;d++)u+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${o}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ib(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function hU({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const l=t.shape,u=s.texData.get(t.dataId),c=n.inChannels,d=l[0]*l[1]*l[2],h=n.outChannels,f=n.dataFormat==="channelsLast",p=!1,m=!1;let g;const y=[];if(o!=null){const x=ib(o.shape,f);x!=null&&(o=ve({inputs:{x:o},backend:s,attrs:{shape:x}}),y.push(o))}if(r!=null){const x=ib(r.shape,f);x!=null&&(r=ve({inputs:{x:r},backend:s,attrs:{shape:x}}),y.push(r))}if(!((d===1||h===1)&&c>rU)&&u.isPacked&&f&&u.texture!=null&&l[2]%2!==0&&ut(u.shape.slice(-3),l.slice(-3))){const x=l[0]*l[1]*(l[2]+1),w={dataId:t.dataId,shape:[1,x,n.inChannels],dtype:t.dtype},S=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,T(rb(u.shape,w.shape),()=>`packed reshape ${u.shape} to ${w.shape} isn't free`);const C=ve({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});y.push(C);const N=ob({a:w,b:C,backend:s,transposeA:p,transposeB:m,bias:r,activation:a,preluActivationWeights:o,leakyreluAlpha:i}),I=s.texData.get(N.dataId);T(I.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=S,I.shape=n.outShape,g=sr({inputs:{x:N},backend:s}),g.shape=n.outShape,y.push(N)}else{const x=n.outHeight*n.outWidth,w=ve({inputs:{x:t},backend:s,attrs:{shape:f?[n.batchSize,x,n.inChannels]:[n.batchSize,n.inChannels,x]}}),S=ve({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),C=ob({a:f?w:S,b:f?S:w,transposeA:!f,transposeB:m,backend:s,bias:r,activation:a,preluActivationWeights:o,leakyreluAlpha:i});g=ve({inputs:{x:C},backend:s,attrs:{shape:n.outShape}}),y.push(w),y.push(S),y.push(C)}for(const x of y)s.disposeIntermediateTensorInfo(x);return g}function fU({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:d,outHeight:h,dataFormat:f}=n,p=f==="channelsLast",m=l*u*c,g=h*d,y=[n.batchSize,m,g],b=!0,v=!1,x=[];if(o!=null){const F=ib(o.shape,p);F!=null&&(o=ve({inputs:{x:o},backend:s,attrs:{shape:F}}),x.push(o))}if(r!=null){const F=ib(r.shape,p);F!=null&&(r=ve({inputs:{x:r},backend:s,attrs:{shape:F}}),x.push(r))}const w=ve({inputs:{x:e},backend:s,attrs:{shape:[1,m,oe(e.shape)/m]}});x.push(w);const S=new oke(y,n),C=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],N=s.runWebGLProgram(S,[t],"float32",C),I=ve({inputs:{x:N},backend:s,attrs:{shape:y}});x.push(N),x.push(I);const E=r!=null,A=o!=null,z=a==="leakyrelu",V=a?wp(a,!0):null,P=new sU(p?I.shape:w.shape,p?w.shape:I.shape,p?[n.batchSize,g,n.outChannels]:[n.batchSize,n.outChannels,g],b,v,E,V,A,z),K=p?[I,w]:[w,I];if(r&&K.push(r),A&&K.push(o),z){const F=s.makeTensorInfo([],"float32",Pi(i,"float32"));K.push(F),x.push(F)}const Y=s.runWebGLProgram(P,K,"float32"),te=ve({inputs:{x:Y},backend:s,attrs:{shape:n.outShape}});x.push(Y);for(const F of x)s.disposeIntermediateTensorInfo(F);return te}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ike(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=s,d=zi(l),h=zn(r.shape,o.shape,i,u,a,c,!1,d);let f;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))f=hU({x:r,filter:o,convInfo:h,backend:n});else if(h.strideWidth<=2&&d==="channelsLast"&&ee().getBool("WEBGL_EXP_CONV")){const m=new dU(h),g=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];f=n.runWebGLProgram(m,[r,o],"float32",g)}else if(ee().getBool("WEBGL_CONV_IM2COL"))f=fU({x:r,filter:o,convInfo:h,backend:n});else{const m=new cU(h);f=n.runWebGLProgram(m,[r,o],"float32")}const p=ve({inputs:{x:f},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(f),p}const ake={kernelName:cm,backendName:"webgl",kernelFunc:ike};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lke{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class uke{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=s-1-e.padInfo.left,u=i?1:2,c=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class cke{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${o};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class dke{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,u=s-1-e.padInfo.top,c=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${o}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=s,d=zi(l),h=zn(r.shape,c,i,1,a,u,!1,d),f=new lke(h);return n.runWebGLProgram(f,[r,o],"float32")}const fke={kernelName:pv,backendName:"webgl",kernelFunc:hke};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pke{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=ds(this.outputShape.length);const n=e.filterHeight,s=e.filterWidth,r=n-1-e.padInfo.top,o=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mke(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=s,d=zi(u),h=zn(i,o.shape,a,1,l,c,!1,d);if(ee().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const f=[[h.strideHeight,h.strideWidth]],p=new pke(h);return n.runWebGLProgram(p,[r,o],"float32",f)}else{const f=new uke(h);return n.runWebGLProgram(f,[r,o],"float32")}}const gke={kernelName:dm,backendName:"webgl",kernelFunc:mke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l}=s,u=el(r.shape,o.shape,i,l,a),c=new rke(u);return n.runWebGLProgram(c,[r,o],"float32")}const bke={kernelName:hm,backendName:"webgl",kernelFunc:yke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,pad:a,filterShape:l}=s,u=el(r.shape,l,i,1,a),c=new cke(u);return n.runWebGLProgram(c,[r,o],"float32")}const xke={kernelName:mv,backendName:"webgl",kernelFunc:vke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wke(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{pad:i,strides:a,inputShape:l}=s,u=el(l,o.shape,a,1,i),c=new dke(u);return n.runWebGLProgram(c,[r,o],"float32")}const Ske={kernelName:gv,backendName:"webgl",kernelFunc:wke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kke=Oh+`
  return cos(x);
`,Cke=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Pu}
  return result;
`,Nke=yt({opSnippet:kke,packedOpSnippet:Cke}),Tke={kernelName:Od,backendName:"webgl",kernelFunc:Nke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ke=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Ike=yt({opSnippet:$ke}),Eke={kernelName:Fd,backendName:"webgl",kernelFunc:Ike};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rke{constructor(e,n,s,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,a,l,u]=e,[c]=n,[d,h]=s;this.outputShape=[c,d,h,u];const f=r==="bilinear"?1:0,[p,m]=[`${a-1}.0`,`${l-1}.0`],[g,y,b]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[v,x,w]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${g});
      const float width_ratio = float(${v});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${y};
        float width_scale = ${x};

        float in_y = ${b};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${o}));
          return;
        }
        float in_x = ${w};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${o}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ke=t=>{const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:u}=s,c=new Rke(r.shape,o.shape,a,l,u);return n.runWebGLProgram(c,[r,o,i],"float32")},Ake={kernelName:bv,backendName:"webgl",kernelFunc:_ke};var kp;(function(t){t.Prod="*",t.Sum="+"})(kp||(kp={}));class P_{constructor(e,n,s,r){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,i=this.op===kp.Prod?"1.0":"0.0",a=s?i:`getX(${M_(o,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";s?(u=r?`end != ${l-1}`:"end != 0",c=r?"end + 1":"end - 1"):(u=r?`end + pow2 < ${l}`:"end >= pow2",c=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${It(o)} coords = getOutputCoords();
        int end = ${z_(o,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${z_(o,"coords",this.op)} = idx;
          val ${this.op}= getX(${M_(o,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function M_(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function z_(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pU(t,e,n,s,r,o){const i=e.shape.length,a=tn([s],i);let l=e;a!=null&&(l=ws({inputs:{x:e},backend:n,attrs:{perm:a}}));const u=pn(1,i)[0];if(u!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const c=l.shape[u];let d=sr({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(c))-1;h++){const f=new P_(t,l.shape,!1,o),p=[[h]],m=d;d=n.runWebGLProgram(f,[d],d.dtype,p),n.disposeIntermediateTensorInfo(m)}if(r){const h=new P_(t,l.shape,r,o),f=d;d=n.runWebGLProgram(h,[d],d.dtype),n.disposeIntermediateTensorInfo(f)}if(a!=null){const h=tl(a),f=ws({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),f}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;return pU(kp.Prod,r,n,o,i,a)}const Oke={kernelName:yv,backendName:"webgl",kernelFunc:Dke};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;return pU(kp.Sum,r,n,o,i,a)}const Lke={kernelName:fm,backendName:"webgl",kernelFunc:Fke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:o}=e,{size:i,binaryOutput:a}=s;if(r.shape.length===1){const l=n.readSync(r.dataId),u=n.readSync(o.dataId),c=KV(l,u,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,c)}else if(r.shape.length===2){const l=n.bufferSync(r),u=n.bufferSync(o),c=Vxe(l,u,i,a);return n.makeTensorInfo(c.shape,o.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const Mke={kernelName:vv,backendName:"webgl",kernelFunc:Pke};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zke{constructor(e,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:o,dataFormat:i}=s,a=r.shape[0],l=i==="NHWC"?r.shape[1]:r.shape[2],u=i==="NHWC"?r.shape[2]:r.shape[3],c=i==="NHWC"?r.shape[3]:r.shape[1],d=l*o,h=u*o,f=c/(o*o),p=i==="NHWC"?[a,d,h,f]:[a,f,d,h],m=new zke(p,o,i);return n.runWebGLProgram(m,[r],r.dtype)}const Vke={kernelName:xv,backendName:"webgl",kernelFunc:Bke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mU{constructor(e,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ds(this.outputShape.length);const i=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let u="",c="";s&&(r?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:u=`
          float activation(float x) {
            ${s}
          }
        `,c="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gU{constructor(e,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ds(this.outputShape.length);const i=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,h=d;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<d;y++)f+=`
          vec4 xTexelC${y*2};
          int xTexelC${y*2}Ready;
          vec4 xTexelC${y*2+1};
          int xTexelC${y*2+1}Ready;
          vec4 xC${y};`;f+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let y=0;y<d;y++)f+=`
          xTexelC${y*2} = vec4(0.0);
          xTexelC${y*2}Ready = 0;
          xTexelC${y*2+1} = vec4(0.0);
          xTexelC${y*2+1}Ready = 0;
          xC${y} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let y=0;y<(h+1)/2;y++){const b=y*2;if(f+=`
          xC = xCCorner + ${b*u};
          `,l===1){if(b<d&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }
              `,u===1&&b>0?f+=`
                xC${b} = vec4(xTexelC${b-2}.zw, xTexelC${b}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${b} = vec4(previous.zw, xTexelC${b}.xy);
                  } else {
                    xC${b} = vec4(0.0, 0.0, xTexelC${b}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xC${b} = xTexelC${b};
                `,b+1<d)){const v=a%2===0?ov(u):u;u%2===0&&a%2===1||u%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${v};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                    xTexelC${b+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${b+1}.zw = vec2(0.0);
                    }
                    xTexelC${b+1}Ready = 1;
                  }
                  `,u>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${b+1} = vec4(previous.zw, xTexelC${b+1}.xy);
                    } else {
                     xC${b+1} = vec4(0.0, 0.0, xTexelC${b+1}.xy);
                    }
                    `:f+=`
                    xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.xy);
                    `):v===1?f+=`
                    xC${b+1} = xTexelC${b};
                    `:f+=`
                    xCOffset = xC + ${v};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                      xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${b+1}.zw = vec2(0.0);
                      }
                      xTexelC${b+1}Ready = 1;
                    }

                    xC${b+1} = xTexelC${b+1};
                    `}}else b<d&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.0);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
              `,b+1<d&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${b+1} = vec4(xTexelC${b+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(
                  xTexelC${b}.xy, xTexelC${b+1}.xy);
              `,b+1<d&&(f+=`
                  xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
                `)));b<d&&(f+=`
            wTexel = getW(r, ${b}, d1, q);
            dotProd += xC${b} * vec4(wTexel.xz, wTexel.xz);
          `,b+1<d&&(f+=`
              wTexel = getW(r, ${b+1}, d1, q);
              dotProd += xC${b+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p="",m="";s&&(r?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:p=`vec4 activation(vec4 x) {
          ${s}
        }`,m="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${g}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:u}=s;let c=l;c==null&&(c=[1,1]),T(Jn(i,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const d=zn(r.shape,o.shape,i,c,a,u,!0);let h;ee().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?h=new gU(d):h=new mU(d);const f=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[r,o],"float32",f)}const Wke={kernelName:pm,backendName:"webgl",kernelFunc:Uke};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jke{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Gke{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=n-1-e.padInfo.top,a=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hke(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=s,d=zn(r.shape,c,i,a,l,u,!0),h=new jke(d);return n.runWebGLProgram(h,[r,o],"float32")}const qke={kernelName:wv,backendName:"webgl",kernelFunc:Hke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kke(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=s,d=zn(c,o.shape,i,a,l,u,!0),h=new Gke(d);return n.runWebGLProgram(h,[r,o],"float32")}const Xke={kernelName:Sv,backendName:"webgl",kernelFunc:Kke};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yke{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qke(t){const{inputs:e,backend:n}=t,{x:s}=e,r=[...s.shape,...s.shape],o=oe(s.shape),i=ve({inputs:{x:s},backend:n,attrs:{shape:[o]}}),a=new Yke(o),l=n.runWebGLProgram(a,[i],i.dtype),u=ve({inputs:{x:l},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),u}const Zke={kernelName:kv,backendName:"webgl",kernelFunc:Qke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jke{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:s,padInfo:r,strideHeight:o,strideWidth:i,filterHeight:a,filterWidth:l,dilationHeight:u,dilationWidth:c}=e,{top:d,left:h}=r;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${i});
      const ivec2 pads = ivec2(${d}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l}=s,u=rg(r.shape,o.shape,i,a,"NHWC",l);let c;const d=new Jke(u);c=n.runWebGLProgram(d,[r,o],"float32");const h=ve({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),h}const tCe={kernelName:mm,backendName:"webgl",kernelFunc:eCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nCe(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,o=e,{allDims:i,summedDims:a,idDims:l}=z$(r,o.length);V$(i.length,l,o);const{path:u,steps:c}=U$(a,l),d=c.length;let h=null,f=i.length;const p=[];for(let m=0;m<d;++m){for(const g of c[m]){const{permutationIndices:y,expandDims:b}=B$(f,l[g]);let v;W$(y)?v=o[g]:(v=ws({inputs:{x:o[g]},backend:n,attrs:{perm:y}}),p.push(v));const x=v.shape.slice();for(let w=0;w<b.length;++w)x.splice(b[w],0,1);ut(v.shape,x)||(v=ve({inputs:{x:v},backend:n,attrs:{shape:x}}),p.push(v)),h===null?h=v:(h=_I({inputs:{a:v,b:h},backend:n}),p.push(h))}m<d-1&&(u[m]>=0&&(h=vw({inputs:{x:h},backend:n,attrs:{axis:u[m]-(i.length-f),keepDims:!1}}),p.push(h)),f--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const sCe={kernelName:Nv,backendName:"webgl",kernelFunc:nCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rCe="return (x >= 0.0) ? x : (exp(x) - 1.0);",oCe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,iCe=yt({opSnippet:rCe,packedOpSnippet:oCe}),aCe={kernelName:Pd,backendName:"webgl",kernelFunc:iCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lCe="return (b >= 0.0) ? a : a * (b + 1.0);",uCe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,cCe=t=>{const{inputs:e,backend:n}=t,{dy:s,y:r}=e,o=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Dh(uCe,s.shape,r.shape):new gu(lCe,s.shape,r.shape);return n.runWebGLProgram(o,[s,r],s.dtype)},dCe={kernelName:Tv,backendName:"webgl",kernelFunc:cCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hCe=`
  return vec4(equal(a, b));
`,fCe="return float(a == b);",pCe=ns({opSnippet:fCe,packedOpSnippet:hCe,dtype:"bool",cpuKernelImpl:Hxe}),mCe={kernelName:gm,backendName:"webgl",kernelFunc:pCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gCe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${A$};
  float a1 = ${D$};
  float a2 = ${O$};
  float a3 = ${F$};
  float a4 = ${L$};
  float a5 = ${P$};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,yCe=yt({opSnippet:gCe}),bCe={kernelName:Md,backendName:"webgl",kernelFunc:yCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vCe=Oh+`
  return exp(x);
`,xCe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,yU=yt({opSnippet:vCe,packedOpSnippet:xCe,cpuKernelImpl:qxe,dtype:"float32"}),wCe={kernelName:zd,backendName:"webgl",kernelFunc:yU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lC(t){const{inputs:e,attrs:n,backend:s}=t,{dim:r}=n,{input:o}=e,i=o.shape.length,a=o.shape.slice();let l=r;return r<0&&(T(-(i+1)<=r,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+r+1),a.splice(l,0,1),ve({inputs:{x:o},backend:s,attrs:{shape:a}})}const SCe={kernelName:ym,backendName:"webgl",kernelFunc:lC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B_="return exp(x) - 1.0;",kCe=yt({opSnippet:B_,packedOpSnippet:B_,cpuKernelImpl:Kxe}),CCe={kernelName:Bd,backendName:"webgl",kernelFunc:kCe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V_{constructor(e,n,s){this.variableNames=["real","imag"];const r=n[1];this.outputShape=n;const o=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=s?`${r}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${o};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bU(t,e,n){const s=n.texData.get(t.dataId),r=oe(t.shape),o=t.shape[t.shape.length-1],i=r/o,a=ve({inputs:{x:t},backend:n,attrs:{shape:[i,o]}}),l=a.shape,u=new V_("real",l,e),c=new V_("imag",l,e),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],h=n.runWebGLProgram(u,d,"float32"),f=n.runWebGLProgram(c,d,"float32"),p=al({inputs:{real:h,imag:f},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f);const m=ve({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NCe(t){const{inputs:e,backend:n}=t,{input:s}=e;return bU(s,!1,n)}const TCe={kernelName:$v,backendName:"webgl",kernelFunc:NCe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Ce{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mg(t){const{backend:e,attrs:n}=t,{shape:s,value:r}=n;let{dtype:o}=n;if(o=o||Cu(r),o==="string"){const i=sn(o,oe(s));return i.fill(r),e.makeTensorInfo(s,o,i)}else{const i=new $Ce(s,r),a=[[r]];return e.runWebGLProgram(i,[],o,a)}}const ICe={kernelName:Iv,backendName:"webgl",kernelFunc:Mg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ECe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RCe={kernelName:Ev,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,r=new ECe(n.shape);return s.runWebGLProgram(r,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U_="return floor(x);",_Ce=yt({opSnippet:U_,packedOpSnippet:U_,cpuKernelImpl:Xxe}),ACe={kernelName:Vd,backendName:"webgl",kernelFunc:_Ce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DCe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,OCe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,FCe=ns({opSnippet:DCe,packedOpSnippet:OCe,dtype:"int32"}),LCe={kernelName:Ud,backendName:"webgl",kernelFunc:FCe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PCe{constructor(e){this.variableNames=["A"];const n=ks(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MCe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=ks(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zCe={kernelName:F0,backendName:"webgl",kernelFunc:BCe};let qu,L1=ee().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function BCe(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:r}=e;const{numChannels:o}=s,i=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,u]=i?[r.videoWidth,r.videoHeight]:[r.width,r.height],c=[u,l],d=[u,l,o];if(a||i){const m=ee().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(qu==null||m!==L1)&&(L1=m,qu=document.createElement("canvas").getContext("2d",{willReadFrequently:L1})),qu.canvas.width=l,qu.canvas.height=u,qu.drawImage(r,0,0,l,u),r=qu.canvas}const h=n.makeTensorInfo(c,"int32");n.texData.get(h.dataId).usage=vr.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),r);const f=ee().getBool("WEBGL_PACK")?new MCe(d):new PCe(d),p=n.runWebGLProgram(f,[h],"int32");return n.disposeData(h.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s,m=zi(c),g=zn(r.shape,o.shape,l,d,u,h,!1,m);let y;const b=[],v=i!=null,x=a!=null,w=f==="leakyrelu",S=()=>{const N=[r,o],I=(E,A)=>{if(A==="NCHW"&&E.shape.length===1&&E.shape[0]!==1){const z=ve({inputs:{x:E},backend:n,attrs:{shape:[E.shape[0],1,1]}});return b.push(z),z}return E};if(v&&N.push(I(i,c)),x&&N.push(I(a,c)),w){const E=n.makeTensorInfo([],"float32",Pi(p,"float32"));N.push(E),b.push(E)}return N};if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))y=hU({x:r,filter:o,convInfo:g,backend:n,bias:i,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else if(g.strideWidth<=2&&m==="channelsLast"&&ee().getBool("WEBGL_EXP_CONV")){const N=f?wp(f,!0):null,I=new dU(g,v,N,x,w),E=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],A=S();y=n.runWebGLProgram(I,A,"float32",E)}else if(ee().getBool("WEBGL_CONV_IM2COL"))y=fU({x:r,filter:o,convInfo:g,backend:n,bias:i,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else{const N=f?wp(f,!1):null,I=new cU(g,v,N,x,w),E=S();y=n.runWebGLProgram(I,E,"float32")}const C=ve({inputs:{x:y},backend:n,attrs:{shape:g.outShape}});return b.push(y),b.forEach(N=>n.disposeIntermediateTensorInfo(N)),C}const UCe={kernelName:ip,backendName:"webgl",kernelFunc:VCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WCe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=s,p=[];let m=c;m==null&&(m=[1,1]),T(Jn(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const g=zn(r.shape,o.shape,l,m,u,d,!0),y=ee().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,b=h?wp(h,y):null,v=[r,o],x=i!=null,w=a!=null,S=h==="leakyrelu";if(x&&v.push(i),w&&v.push(a),S){const E=n.makeTensorInfo([],"float32",Pi(f,"float32"));v.push(E),p.push(E)}let C;y?C=new gU(g,x,b,w,S):C=new mU(g,x,b,w,S);const N=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],I=n.runWebGLProgram(C,v,"float32",N);return p.forEach(E=>n.disposeIntermediateTensorInfo(E)),I}const jCe={kernelName:ap,backendName:"webgl",kernelFunc:WCe};class GCe{constructor(e,n,s,r){this.sliceDim=e,this.strides=n,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const o=It(s.length);let i=`
    int index;`;for(let a=0;a<this.sliceDim;a++)i+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${o} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HCe(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,o=r.shape,i=o[o.length-1],a=oe(s.shape),[l,u,c,d]=Qx(s,r),h=ve({inputs:{x:r},backend:n,attrs:{shape:[u,i]}}),f=ve({inputs:{x:s},backend:n,attrs:{shape:[oe(s.shape)/c,c]}});if(n.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const y=n.readSync(r.dataId),b=n.bufferSync(s),v=Yxe(y,b,s.dtype,u,i,c,d,s.shape,a);return n.makeTensorInfo(l,s.dtype,v.values)}const p=new GCe(i,d,[u,c],s.shape),m=n.runWebGLProgram(p,[f,h],f.dtype),g=ve({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}const qCe={kernelName:Rv,backendName:"webgl",kernelFunc:HCe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KCe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=It(this.rank),r=XCe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function XCe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<t.length;r++)r===2?s.push("index"):s.push(`${n[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vU(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:o}=e,{axis:i,batchDims:a}=s,l=st(i,r.shape)[0];if(ee().get("DEBUG")){const b=n.readSync(o.dataId),v=r.shape[l];for(let x=0;x<b.length;++x){const w=b[x];T(w<=v-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${v-1}]`)}}const u=G$(r,o,l,a),c=oe(o.shape),d=[],h=ve({inputs:{x:r},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),f=ve({inputs:{x:o},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(h),d.push(f);const p=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([r,o])||r.dtype==="string"){const b=n.bufferSync(f),v=n.bufferSync(h),x=Qxe(v,b,p);return d.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.makeTensorInfo(u.outputShape,x.dtype,x.values)}const m=new KCe(h.shape,p),g=n.runWebGLProgram(m,[h,f],h.dtype);d.push(g);const y=ve({inputs:{x:g},backend:n,attrs:{shape:u.outputShape}});return d.forEach(b=>n.disposeIntermediateTensorInfo(b)),y}const YCe={kernelName:vm,backendName:"webgl",kernelFunc:vU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QCe="return float(a > b);",ZCe=`
  return vec4(greaterThan(a, b));
`,JCe=ns({opSnippet:QCe,packedOpSnippet:ZCe,cpuKernelImpl:Zxe,dtype:"bool"}),eNe={kernelName:xm,backendName:"webgl",kernelFunc:JCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tNe="return float(a >= b);",nNe=`
  return vec4(greaterThanEqual(a, b));
`,sNe=ns({opSnippet:tNe,packedOpSnippet:nNe,dtype:"bool",cpuKernelImpl:Jxe}),rNe={kernelName:Wd,backendName:"webgl",kernelFunc:sNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oNe(t){const{inputs:e,backend:n}=t,{input:s}=e;return bU(s,!0,n)}const iNe={kernelName:_v,backendName:"webgl",kernelFunc:oNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aNe="return float(!isnan(x) && !isinf(x));",lNe=yt({opSnippet:aNe,dtype:"bool"}),uNe={kernelName:Gd,backendName:"webgl",kernelFunc:lNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cNe="return float(isinf(x));",dNe=yt({opSnippet:cNe,dtype:"bool"}),hNe={kernelName:Hd,backendName:"webgl",kernelFunc:dNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fNe="return float(isnan(x));",pNe=yt({opSnippet:fNe,dtype:"bool"}),mNe={kernelName:qd,backendName:"webgl",kernelFunc:pNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gNe="return float(a < b);",yNe=`
  return vec4(lessThan(a, b));
`,bNe=ns({opSnippet:gNe,packedOpSnippet:yNe,cpuKernelImpl:ewe,dtype:"bool"}),vNe={kernelName:Sm,backendName:"webgl",kernelFunc:bNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xNe="return float(a <= b);",wNe=`
  return vec4(lessThanEqual(a, b));
`,SNe=ns({opSnippet:xNe,packedOpSnippet:wNe,cpuKernelImpl:twe,dtype:"bool"}),kNe={kernelName:km,backendName:"webgl",kernelFunc:SNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CNe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:o}=n,i=nwe(s,r,o);return e.makeTensorInfo([i.length],"float32",i)}const NNe={kernelName:Dv,backendName:"webgl",kernelFunc:CNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TNe=Oh+`
  return x < 0.0 ? 0./0. : log(x);
`,$Ne=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,INe=yt({opSnippet:TNe,packedOpSnippet:$Ne,cpuKernelImpl:swe}),ENe={kernelName:Kd,backendName:"webgl",kernelFunc:INe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RNe=Oh+`
  return log(1.0 + x);
`,_Ne=yt({opSnippet:RNe}),ANe={kernelName:Xd,backendName:"webgl",kernelFunc:_Ne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DNe="return float(a >= 1.0 && b >= 1.0);",ONe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,FNe=ns({opSnippet:DNe,packedOpSnippet:ONe,dtype:"bool"}),LNe={kernelName:Cm,backendName:"webgl",kernelFunc:FNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PNe="return float(!(x >= 1.0));",MNe=yt({opSnippet:PNe}),zNe={kernelName:Nm,backendName:"webgl",kernelFunc:MNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BNe="return float(a >= 1.0 || b >= 1.0);",VNe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,UNe=ns({opSnippet:BNe,packedOpSnippet:VNe,dtype:"bool"}),WNe={kernelName:Tm,backendName:"webgl",kernelFunc:UNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jNe{constructor(e,n,s,r,o){this.variableNames=["x"],this.outputShape=[];const i=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${s}) + float(${r}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GNe{constructor(e,n,s,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${s}) + float(${r}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HNe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=s,u=ee().getBool("WEBGL_PACK_NORMALIZATION")?new GNe(r.shape,o,i,a,l):new jNe(r.shape,o,i,a,l);return n.runWebGLProgram(u,[r],r.dtype)},qNe={kernelName:$m,backendName:"webgl",kernelFunc:HNe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KNe{constructor(e,n,s,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=s,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${o})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${o});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XNe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=s,d=new KNe(r.shape,a,l,u,c);return n.runWebGLProgram(d,[r,o,i],r.dtype)},YNe={kernelName:Ov,backendName:"webgl",kernelFunc:XNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QNe(t,e,n,s){const r=oe(e),i=oe(t.shape)/r,a=ve({inputs:{x:t},attrs:{shape:[i,r]},backend:s}),l=Mu(a,t.dtype,"max",s),u=ve({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xU(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:o,keepDims:i}=s,a=r.shape.length,l=st(o,r.shape);let u=l;const c=tn(u,a),d=c!=null,h=n.shouldExecuteOnCPU([r]);let f=r;if(d){if(h){const v=n.texData.get(f.dataId).values,x=new Array(a);for(let C=0;C<x.length;C++)x[C]=r.shape[c[C]];const w=EI(v,r.shape,r.dtype,c,x);f=n.makeTensorInfo(x,r.dtype);const S=n.texData.get(f.dataId);S.values=w}else f=bw(r,c,n);u=pn(u.length,a)}es("max",u,a);const[p,m]=Bn(f.shape,u);let g=p;i&&(g=fn(p,l));let y;if(h){const v=n.texData.get(f.dataId).values,x=rwe(v,oe(m),g,r.dtype);y=n.makeTensorInfo(g,r.dtype);const w=n.texData.get(y.dataId);w.values=x}else y=QNe(f,m,g,n);return d&&n.disposeIntermediateTensorInfo(f),y}const ZNe={kernelName:Im,backendName:"webgl",kernelFunc:xU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JNe=RI+`
  return max(a, b);
`,eTe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Pu+`
  return result;
`,tTe=ns({opSnippet:JNe,packedOpSnippet:eTe,cpuKernelImpl:owe}),nTe={kernelName:Yd,backendName:"webgl",kernelFunc:tTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sTe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Fg(r,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,u=1;T(Jn(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=eo(r.shape,o,i,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&ut(c.inShape,c.outShape))return sr({inputs:{x:r},backend:n});const d=new Sp(c,"max",!1);return n.runWebGLProgram(d,[r],r.dtype)}const rTe={kernelName:Em,backendName:"webgl",kernelFunc:sTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oTe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:o,strides:i,pad:a,dataFormat:l,dimRoundingMode:u}=s,c=[1,1,1],d=Mi(r.shape,o,i,c,a,u,l),h=new AI(d,"max",!1);return n.runWebGLProgram(h,[r],r.dtype)}const iTe={kernelName:Rm,backendName:"webgl",kernelFunc:oTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aTe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,l=i-1-e.padInfo.left,u=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class lTe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=l-1-e.padInfo.front,h=u-1-e.padInfo.top,f=c-1-e.padInfo.left,p=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${h}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uTe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=s,d=[1,1,1],h=Mi(i.shape,a,l,d,u,c),f=new AI(h,"max",!0),p=n.runWebGLProgram(f,[i],i.dtype),m=new lTe(h),g=n.runWebGLProgram(m,[r,p],i.dtype);return n.disposeIntermediateTensorInfo(p),g}const cTe={kernelName:Lv,backendName:"webgl",kernelFunc:uTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dTe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o,output:i}=e,a=o;Fg([o,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=s,h=eo(a.shape,l,u,1,c,d),f=!0,p=new Sp(h,"max",f),m=n.runWebGLProgram(p,[a],a.dtype),g=new aTe(h),y=n.runWebGLProgram(g,[r,m],a.dtype);return n.disposeIntermediateTensorInfo(m),y}const hTe={kernelName:Fv,backendName:"webgl",kernelFunc:dTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fTe(t,e,n,s){let r=new Sp(n,"max",!1);const o=s.runWebGLProgram(r,[t],"float32");r=new Sp(n,"max",!0,!0,e);const i=s.runWebGLProgram(r,[t],"float32");return[o,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pTe={kernelName:Pv,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:o,pad:i,includeBatchInIndex:a}=e,l=n;T(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const u=[1,1];T(Jn(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=eo(s.shape,r,o,u,i),[d,h]=fTe(s,a,c,l);return[d,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mTe(t,e,n,s){const r=oe(e),i=oe(t.shape)/r,a=ve({inputs:{x:t},attrs:{shape:[i,r]},backend:s}),l=Mu(a,"float32","mean",s),u=ve({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gTe={kernelName:_m,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:r,axis:o}=e,i=n,a=s.shape.length,l=st(o,s.shape);let u=l;const c=tn(u,a),d=c!=null,h=i.shouldExecuteOnCPU([s]),f=[];let p=s;if(d){if(h){const x=i.texData.get(p.dataId).values,w=new Array(a);for(let N=0;N<w.length;N++)w[N]=s.shape[c[N]];const S=EI(x,s.shape,s.dtype,c,w);p=i.makeTensorInfo(w,s.dtype);const C=i.texData.get(p.dataId);C.values=S}else p=bw(s,c,i);f.push(p),u=pn(u.length,a)}es("sum",u,a);const[m,g]=Bn(p.shape,u);let y=m;r&&(y=fn(m,l));const b=mTe(p,g,y,i);for(const v of f)i.disposeIntermediateTensorInfo(v);return b}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yTe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=st(o,r.shape);let u=l;const c=tn(u,a);let d=r;c!=null&&(d=ws({inputs:{x:r},backend:n,attrs:{perm:c}}),u=pn(u.length,r.shape.length)),es("min",u,a);const[h,f]=Bn(d.shape,u),p=oe(f),m=ve({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),g=Mu(m,m.dtype,"min",n);let y;if(i){const b=fn(h,l);y=ve({inputs:{x:g},backend:n,attrs:{shape:b}})}else y=ve({inputs:{x:g},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),c!=null&&n.disposeIntermediateTensorInfo(d),y}const bTe={kernelName:Am,backendName:"webgl",kernelFunc:yTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vTe=RI+`
  return min(a, b);
`,xTe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Pu+`
  return result;
`,wTe=ns({opSnippet:vTe,packedOpSnippet:xTe,cpuKernelImpl:iwe}),STe={kernelName:Qd,backendName:"webgl",kernelFunc:wTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kTe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=n.map((c,d)=>c[0]+e[d]+c[1]);const r=e.length,o=It(r),i=n.map(c=>c[0]).join(","),a=n.map((c,d)=>c[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),u=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${o} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CTe{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,m)=>p[0]+e[m]+p[1]);const r=e.length,o=It(r),i=n.map(p=>p[0]).join(","),a=n.map((p,m)=>p[0]+e[m]).join(","),l=vs("rc",r),u=vs("source",r),c=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${u.slice(-2).join()})`,h=s==="reflect"?0:1;let f="";if(r===1){const p=`
        ${o} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;f=`
        ${o} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[r-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
      `}else{const p=`
        ${o} source = rc;
        ${o} lt = ${o}(lessThan(source, start));
        ${o} gte = ${o}(greaterThanEqual(source, end));
        ${o} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;f=`
        ${o} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[r-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${p}
          result[2] = getChannel(getX(${u.join()}), ${d});
          ${l[r-1]} += 1;
          if(${c}) {
            ${p}
            result[3] = getChannel(getX(${u.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NTe=({inputs:t,backend:e,attrs:n})=>{const{x:s}=t,{paddings:r,mode:o}=n,i=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new CTe(s.shape,r,o):new kTe(s.shape,r,o);return e.runWebGLProgram(i,[s],s.dtype)},TTe={kernelName:Dm,backendName:"webgl",kernelFunc:NTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Te=`if (b == 0.0) return NAN;
  return mod(a, b);`,ITe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Pu+`
  return result;
`,ETe=ns({opSnippet:$Te,packedOpSnippet:ITe}),RTe={kernelName:Zd,backendName:"webgl",kernelFunc:ETe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Te{constructor(e,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ATe=`
if (a == b) {
  return 1.0;
};
return a / b;`,DTe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,wU=ns({opSnippet:ATe,packedOpSnippet:DTe,checkOutOfBounds:!0}),OTe={kernelName:Ld,backendName:"webgl",kernelFunc:wU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W_="return a - b;",SU=ns({opSnippet:W_,packedOpSnippet:W_,supportsComplex:!0,cpuKernelImpl:$we}),FTe={kernelName:ph,backendName:"webgl",kernelFunc:SU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kU(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:o}=s,i=st([o],r.shape),a=xU({inputs:{x:r},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=fn(a.shape,i),u=ve({inputs:{x:a},backend:n,attrs:{shape:l}}),c=SU({inputs:{a:r,b:u},backend:n}),d=yU({inputs:{x:c},backend:n}),h=vw({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:!1}}),f=ve({inputs:{x:h},backend:n,attrs:{shape:l}}),p=wU({inputs:{a:d,b:f},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}const LTe={kernelName:Qm,backendName:"webgl",kernelFunc:kU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PTe(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:o,seed:i,normalized:a}=s,l=a?r:kU({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new _Te(u,c,o),h=[[i]],f=n.runWebGLProgram(d,[l],"int32",h);return a||n.disposeIntermediateTensorInfo(l),f}const MTe={kernelName:Mv,backendName:"webgl",kernelFunc:PTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zTe=no+`
  return -x;
`,BTe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function VTe(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])){const o=n.texData.get(s.dataId),[i,a]=lwe(o.values,s.shape,s.dtype);return n.makeTensorInfo(a,s.dtype,i)}let r;return ee().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new va(s.shape,BTe):r=new Uo(s.shape,zTe),n.runWebGLProgram(r,[s],s.dtype)}const UTe={kernelName:Om,backendName:"webgl",kernelFunc:VTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WTe=qx;function jTe(t){pr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=s,u=n.readSync(r.dataId),c=n.readSync(o.dataId),{selectedIndices:d}=WTe(u,c,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const GTe={kernelName:zv,backendName:"webgl",kernelFunc:jTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HTe=Kx;function qTe(t){pr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=s,c=n.readSync(r.dataId),d=n.readSync(o.dataId),{selectedIndices:h,validOutputs:f}=HTe(c,d,i,a,l,u);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const KTe={kernelName:Bv,backendName:"webgl",kernelFunc:qTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XTe=Xx;function YTe(t){pr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=s,c=n.readSync(r.dataId),d=n.readSync(o.dataId),h=i,f=a,p=l,m=u,{selectedIndices:g,selectedScores:y}=XTe(c,d,h,f,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const QTe={kernelName:Vv,backendName:"webgl",kernelFunc:YTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZTe{constructor(e,n,s,r){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JTe=t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:o,depth:i,onValue:a,offValue:l}=s,u=oe(r.shape),c=new ZTe(u,i,a,l),d=ve({inputs:{x:r},backend:n,attrs:{shape:[u]}}),h=n.runWebGLProgram(c,[d],o);n.disposeIntermediateTensorInfo(d);const f=[...r.shape,i],p=ve({inputs:{x:h},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(h),p},e$e={kernelName:Pm,backendName:"webgl",kernelFunc:JTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ab(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="complex64"){const r=Pg({inputs:{input:s},backend:n}),o=ab({inputs:{x:r},backend:n}),i=xw({inputs:{input:s},backend:n}),a=ab({inputs:{x:i},backend:n}),l=al({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return Mg({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const t$e={kernelName:tg,backendName:"webgl",kernelFunc:ab};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CU(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=Pg({inputs:{input:s},backend:n}),o=CU({inputs:{x:r},backend:n}),i=xw({inputs:{input:s},backend:n}),a=ab({inputs:{x:i},backend:n}),l=al({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return Mg({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const n$e={kernelName:Lm,backendName:"webgl",kernelFunc:CU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s$e(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return lC({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const o=e[0].shape,i=e[0].dtype;e.forEach(c=>{Zn(o,c.shape,"All tensors passed to stack must have matching shapes"),T(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const d=lC({inputs:{input:c},backend:n,attrs:{dim:r}});return a.push(d),d}),u=uU({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const r$e={kernelName:Mm,backendName:"webgl",kernelFunc:s$e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o$e{constructor(e,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+e[c]+u[1]);const r=e.length,o=It(r),i=n.map(u=>u[0]).join(","),a=n.map((u,c)=>u[0]+e[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${o} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i$e{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((m,g)=>m[0]+e[g]+m[1]);const r=e.length,o=It(r),i=n.map(m=>m[0]).join(","),a=n.map((m,g)=>m[0]+e[g]).join(","),l=vs("rc",r),u=vs("source",r),c=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${u.slice(-2).join()})`,h=[`${o} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${c}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${c}) {`],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let m=0,g=r===1?2:4;m<g;m++)p+=`
        ${h[m]}
        if (${f}) {
          result[${m}] = float(value);
        } else {
          ${o} source = rc - start;
          result[${m}] = getChannel(getX(${u.join()}), ${d});
        }
      `;p+=r===1?"} ":"}}",this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NU=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:o,constantValue:i}=s;if(oe(r.shape)===0){const u=o.map((c,d)=>c[0]+r.shape[d]+c[1]);return Mg({backend:n,attrs:{shape:u,value:i,dtype:r.dtype}})}const a=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new i$e(r.shape,o,i):new o$e(r.shape,o,i),l=[[i]];return n.runWebGLProgram(a,[r],r.dtype,l)},a$e={kernelName:zm,backendName:"webgl",kernelFunc:NU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l$e=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,u$e=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Pu+`
  return result;
`,c$e=ns({opSnippet:l$e,packedOpSnippet:u$e}),d$e={kernelName:eh,backendName:"webgl",kernelFunc:c$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h$e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=[],u=st(o,r.shape);let c=u;const d=tn(c,a);let h=r;d!=null&&(h=ws({inputs:{x:r},backend:n,attrs:{perm:d}}),c=pn(c.length,a),l.push(h)),es("prod",c,a);let f;if(n.shouldExecuteOnCPU([h])){const p=n.texData.get(h.dataId).values,{outVals:m,outShape:g,outDtype:y}=cwe(h.shape,h.dtype,p,c);f=n.makeTensorInfo(g,y,m)}else{const[p,m]=Bn(h.shape,c),g=oe(m),y=ve({inputs:{x:h},backend:n,attrs:{shape:[-1,g]}}),b=fx(r.dtype),v=Mu(y,b,"prod",n);f=ve({inputs:{x:v},backend:n,attrs:{shape:p}}),l.push(y),l.push(v)}if(i){l.push(f);const p=fn(f.shape,u);f=ve({inputs:{x:f},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const f$e={kernelName:Vm,backendName:"webgl",kernelFunc:h$e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p$e(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:a}=s,l=r.map(y=>n.readSync(y.dataId)),u=r.map(y=>y.shape),c=n.readSync(o.dataId),d=n.readSync(i.dataId),[h,f,p]=dwe(l,u,c,o.shape,o.dtype,d,i.shape,a),m=h.map(y=>n.makeTensorInfo([y.length],"int32",y)),g=n.makeTensorInfo(p,o.dtype,f);return m.concat([g])}const m$e={kernelName:Uv,backendName:"webgl",kernelFunc:p$e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g$e(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:o}=e,i=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(o.dataId),[u,c]=hwe(i,s.shape,s.dtype,a,r.shape,l,o.shape),d=n.makeTensorInfo([u.length],"int32",u),h=n.makeTensorInfo([c.length],s.dtype,c);return[d,h]}const y$e={kernelName:Wv,backendName:"webgl",kernelFunc:g$e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b$e(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,u=n.readSync(r.dataId),c=n.readSync(o.dataId),d=n.readSync(i.dataId),h=a.map(g=>n.readSync(g.dataId)),f=a.map(g=>g.shape),[p,m]=fwe(u,r.shape,c,o.shape,o.dtype,d,i.shape,h,f,l);return n.makeTensorInfo(p,o.dtype,m)}const v$e={kernelName:jv,backendName:"webgl",kernelFunc:b$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TU=t=>{const{backend:e,attrs:n}=t,{start:s,stop:r,step:o,dtype:i}=n,a=pwe(s,r,o,i);return e.makeTensorInfo([a.length],i,a)},x$e={kernelName:Gv,backendName:"webgl",kernelFunc:TU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w$e="return 1.0 / x;",S$e=yt({opSnippet:w$e}),k$e={kernelName:th,backendName:"webgl",kernelFunc:S$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C$e=no+`
  return (x < 0.0) ? 0.0 : x;
`,N$e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,T$e=yt({opSnippet:C$e,packedOpSnippet:N$e}),$$e={kernelName:nh,backendName:"webgl",kernelFunc:T$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I$e=no+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,E$e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,R$e=yt({opSnippet:I$e,packedOpSnippet:E$e}),_$e={kernelName:sh,backendName:"webgl",kernelFunc:R$e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A$e{constructor(e,n,s,r,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,s,u];const c=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;o?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D$e{constructor(e,n,s,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,s,u];const c=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;o?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O$e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s,[l,u]=a,c=ee().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new D$e(r.shape,l,u,o,i):new A$e(r.shape,l,u,o,i);return n.runWebGLProgram(c,[r],"float32")}const F$e={kernelName:jm,backendName:"webgl",kernelFunc:O$e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class L$e{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,o]=n,[,i,a]=e,l=[s&&i>1?r-1:r,s&&a>1?o-1:o],u=[s&&i>1?i-1:i,s&&a>1?a-1:a],c=l[0]/u[0],d=l[1]/u[1],h=1/c,f=1/d,p=Math.ceil(h)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${o-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P$e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:o}=e,{alignCorners:i}=s,a=new L$e(o.shape,r.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const M$e={kernelName:Kv,backendName:"webgl",kernelFunc:P$e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z$e{constructor(e,n,s,r,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,s,u];const c=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let f;o?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B$e{constructor(e,n,s,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,s,u];const c=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let f;o?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V$e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s,[l,u]=a,c=ee().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new B$e(r.shape,l,u,o,i):new z$e(r.shape,l,u,o,i);return n.runWebGLProgram(c,[r],r.dtype)}const U$e={kernelName:Wm,backendName:"webgl",kernelFunc:V$e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W$e{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,o]=n,[,i,a]=e,l=[s&&i>1?r-1:r,s&&a>1?o-1:o],u=[s&&i>1?i-1:i,s&&a>1?a-1:a],c=l[0]/u[0],d=l[1]/u[1],h=1/c,f=1/d,p=Math.ceil(h)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${o}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j$e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:o}=e,{alignCorners:i}=s,a=new W$e(o.shape,r.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const G$e={kernelName:qv,backendName:"webgl",kernelFunc:j$e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H$e{constructor(e,n){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,o=e.map((a,l)=>r(l)).join(","),i=It(s);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class q$e{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=vs("rc",s),o=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,i=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,a=It(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${o}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${o}){
            result.g = ${u(r.slice())};
          }
          if(${i}) {
            result.b = ${c(r.slice())};
            if(${o}) {
              result.a = ${d(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return h(p)}function u(p){return p[s-1]="("+p[s-1]+" + 1)",h(p)}function c(p){return p[s-2]="("+p[s-2]+" + 1)",h(p)}function d(p){return p[s-1]="("+p[s-1]+" + 1)",p[s-2]="("+p[s-2]+" + 1)",h(p)}function h(p){const m=e.map((b,v)=>f(v,p)),g=m.join(","),y=m.slice(-2).join(",");return`getChannel(getX(${g}), vec2(${y}))`}function f(p,m){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${m[p]} - 1`:`${m[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K$e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:o}=s,i=r.shape.length,a=st(o,r.shape);if(i===0)return sr({inputs:{x:r},backend:n});const l=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new q$e(r.shape,a):new H$e(r.shape,a);return n.runWebGLProgram(l,[r],r.dtype)}const X$e={kernelName:Gm,backendName:"webgl",kernelFunc:K$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y$e{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let o="";typeof n=="number"?o=`float outputValue = ${n.toFixed(2)};`:o=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${o}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q$e={kernelName:dx,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:o,center:i}=e,a=n,l=new Y$e(s.shape,o),[u,c]=E$(i,s.shape[1],s.shape[2]),d=[[u,c,Math.sin(r),Math.cos(r)]];return a.runWebGLProgram(l,[s],s.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z$e=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,J$e=yt({opSnippet:Z$e}),eIe={kernelName:rh,backendName:"webgl",kernelFunc:J$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tIe="return inversesqrt(x);",nIe=yt({opSnippet:tIe,cpuKernelImpl:mwe}),sIe={kernelName:oh,backendName:"webgl",kernelFunc:nIe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DI{constructor(e,n,s,r,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const u=It(o.length),c=It(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const h=`getIndices(${d})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let m="";l&&(m="coords[0], coords[1]");const g=`getDefaultValue(${m})`,y=n>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${o});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${y};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${g}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rIe{constructor(e,n,s,r,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const u=It(o.length),c=It(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const h=`getIndices(${d})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let m="";l&&(m="coords[0], coords[1]");const g=`getDefaultValue(${m})`,y=n>1?"strides[j]":"strides",b=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${o});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${y};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${b};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${g}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oIe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:o}=e,{shape:i}=s,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=rl(o,r,i),h=[d/u,u];if(d===0)return n.makeTensorInfo(i,r.dtype);const f=ve({inputs:{x:r},backend:n,attrs:{shape:[l,a]}}),p=ve({inputs:{x:o},backend:n,attrs:{shape:[l,u]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let g;ee().getBool("WEBGL_PACK")?g=new rIe(l,a,f.shape.length,p.shape.length,c,h):g=new DI(l,a,f.shape.length,p.shape.length,c,h);const y=n.runWebGLProgram(g,[p,f,m],p.dtype),b=ve({inputs:{x:y},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(m),b}const iIe={kernelName:Xv,backendName:"webgl",kernelFunc:oIe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aIe{constructor(e,n,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const o="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=ee().getNumber("WEBGL_VERSION")===2?o:i,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lIe(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:o}=e,{side:i}=s,a=new aIe(r.shape[0],r.shape[1],o.shape[1],i),l=[[r.shape[1]]];return n.runWebGLProgram(a,[r,o],"int32",l)}const uIe={kernelName:Qv,backendName:"webgl",kernelFunc:lIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cIe{constructor(e,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let r,o;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)o="resRC",r="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${a[c]}`),c<e&&l.push(`${a[c]}`);r=l.join(),o=u.join()}const i=It(s);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${o}));
        } else {
          setOutput(getB(${o}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dIe(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:o}=e,i=new cIe(s.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(i,[s,r,o],As(r.dtype,o.dtype))}const hIe={kernelName:Hm,backendName:"webgl",kernelFunc:dIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fIe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${ew};
  float scale = ${tw};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,pIe=yt({opSnippet:fIe}),mIe={kernelName:ih,backendName:"webgl",kernelFunc:pIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gIe=Oh+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,yIe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,bIe=yt({opSnippet:gIe,packedOpSnippet:yIe,cpuKernelImpl:ywe}),vIe={kernelName:ch,backendName:"webgl",kernelFunc:bIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xIe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,wIe=yt({opSnippet:xIe}),SIe={kernelName:uh,backendName:"webgl",kernelFunc:wIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kIe=Oh+`
  return sin(x);
`,CIe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Pu}
  return result;
`,NIe=yt({opSnippet:kIe,packedOpSnippet:CIe}),TIe={kernelName:ah,backendName:"webgl",kernelFunc:NIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ie=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,IIe=yt({opSnippet:$Ie}),EIe={kernelName:lh,backendName:"webgl",kernelFunc:IIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RIe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,_Ie=yt({opSnippet:RIe}),AIe={kernelName:dh,backendName:"webgl",kernelFunc:_Ie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DIe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:o,paddings:i}=s;T(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((y,b)=>y*b),l=[[0,0]];l.push(...i);for(let y=1+o.length;y<r.shape.length;++y)l.push([0,0]);const u=[],c=NU({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),d=Sg(c.shape,o,a,!1),h=kg(d.length,o.length,!1),f=Cg(c.shape,o,a,!1),p=ve({inputs:{x:c},backend:n,attrs:{shape:d}}),m=ws({inputs:{x:p},backend:n,attrs:{perm:h}}),g=ve({inputs:{x:m},backend:n,attrs:{shape:f}});return u.push(c),u.push(p),u.push(m),u.forEach(y=>n.disposeIntermediateTensorInfo(y)),g},OIe={kernelName:Xm,backendName:"webgl",kernelFunc:DIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FIe(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${o.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.readSync(s.dataId),l=n.readSync(r.dataId),u=n.readSync(o.dataId),c=n.readSync(i.dataId)[0],[d,h,f,p,m]=vwe(a,s.shape,s.dtype,l,r.dtype,u,c);return[n.makeTensorInfo(h,s.dtype,d),n.makeTensorInfo([h[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),n.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}const LIe={kernelName:Zv,backendName:"webgl",kernelFunc:FIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PIe(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:o}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(n.readSync(r.dataId)),a=n.readSync(s.dataId),l=Array.from(n.readSync(o.dataId)),[u,c,d]=xwe(a,s.shape,s.dtype,i,l);return[n.makeTensorInfo(c,s.dtype,u),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}const MIe={kernelName:Jv,backendName:"webgl",kernelFunc:PIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zIe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${o.shape}`);const i=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(o.dataId),[u,c]=YV(i,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(c,s.dtype,u)}const BIe={kernelName:ex,backendName:"webgl",kernelFunc:zIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VIe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${o.shape}`);const i=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(o.dataId),[u,c]=YV(i,s.shape,s.dtype,a,l);return n.makeTensorInfo(c,s.dtype,u)}const UIe={kernelName:tx,backendName:"webgl",kernelFunc:VIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WIe(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:o,defaultValue:i}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:h}=rl(o,r,a),f=!1;if(o.dtype==="string"){const y=n.bufferSync(r),b=n.bufferSync(o),v=$i(n.readSync(i.dataId)[0]),x=gwe(y,b,a,h,c,u,l,d,v,f);return n.makeTensorInfo(a,x.dtype,x.values)}const p=new DI(u,l,r.shape.length,o.shape.length,d,[h,1],f),m=n.runWebGLProgram(p,[o,r,i],o.dtype),g=ve({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(m),g}const jIe={kernelName:nx,backendName:"webgl",kernelFunc:WIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GIe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:o,axis:i}=s,a=st(i,r.shape)[0],l=j$(r,o,a),u=r.shape.length,c=new Array(u).fill(0),d=r.shape.slice();return l.map(h=>{const f=[...d];f[a]=h;const p=Fh({inputs:{x:r},backend:n,attrs:{begin:c,size:f}});return c[a]+=h,p})}const HIe={kernelName:Ym,backendName:"webgl",kernelFunc:GIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j_="return sqrt(x);",qIe=yt({opSnippet:j_,packedOpSnippet:j_,cpuKernelImpl:wwe}),KIe={kernelName:hh,backendName:"webgl",kernelFunc:qIe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XIe="return x * x;",YIe=yt({opSnippet:XIe}),QIe={kernelName:sx,backendName:"webgl",kernelFunc:YIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G_="return (a - b) * (a - b);",ZIe=ns({opSnippet:G_,packedOpSnippet:G_}),JIe={kernelName:fh,backendName:"webgl",kernelFunc:ZIe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const o=n.readSync(r.dataId),i=Ai(o),a=Swe(i,"string",s);return n.makeTensorInfo(r.shape,"string",a)}const tEe={kernelName:Zm,backendName:"webgl",kernelFunc:eEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nEe({inputs:t,attrs:e,backend:n}){const{x:s}=t,r=no+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,o=new Uo(s.shape,r);return n.runWebGLProgram(o,[s],s.dtype)}const sEe={kernelName:bh,backendName:"webgl",kernelFunc:nEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rEe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,o=It(s.length),i=It(s.length);let a="";if(r===1)a="coords * strides + begin";else{let l=0;a=s.map((u,c)=>(l++,s.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${o} begin = ${o}(${e});
      ${o} strides = ${o}(${n});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:h}=s,{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:b,end:v,strides:x}=N$(r.shape,o,i,a,l,u,c,d,h);let w;if(m)w=ve({inputs:{x:r},backend:n,attrs:{shape:p}});else if(g||y){T(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const C=S$(b,v,x),N=Fh({inputs:{x:r},backend:n,attrs:{begin:b,size:C}});w=ve({inputs:{x:N},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(N)}else if(n.shouldExecuteOnCPU([r])){const N=n.readSync(r.dataId),I=Ze(r.shape,r.dtype,N),E=kwe(f,I,x,b);w=n.makeTensorInfo(p,r.dtype,E.values)}else{const N=new rEe(b,x,f);w=n.runWebGLProgram(N,[r],r.dtype)}const S=ve({inputs:{x:w},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(w),S}const iEe={kernelName:rx,backendName:"webgl",kernelFunc:oEe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aEe(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:u}=s,{data:c,dataSplits:d}=e,h=n.readSync(c.dataId),f=n.readSync(d.dataId),[p,m]=Cwe(h,f,r,o,i,a,l,u);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const lEe={kernelName:ox,backendName:"webgl",kernelFunc:aEe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uEe(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.readSync(o.dataId),l=n.readSync(i.dataId)[0],[u,c,d]=Nwe(a,l,r),h=c.length;return[n.makeTensorInfo([h,2],"int32",u),n.makeTensorInfo([h],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const cEe={kernelName:ix,backendName:"webgl",kernelFunc:uEe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dEe(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(o.dataId),a=Twe(i,r);return n.makeTensorInfo(o.shape,"int32",a)}const hEe={kernelName:ax,backendName:"webgl",kernelFunc:dEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fEe="return tan(x);",pEe=yt({opSnippet:fEe}),mEe={kernelName:mh,backendName:"webgl",kernelFunc:pEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gEe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,yEe=yt({opSnippet:gEe}),bEe={kernelName:gh,backendName:"webgl",kernelFunc:yEe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vEe(t){const{inputs:e,backend:n,attrs:s}=t,{tensor:r,indices:o,updates:i}=e,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=rl(i,o,r.shape),h=[d/u,u];if(d===0)return n.makeTensorInfo(r.shape,o.dtype);const f=ve({inputs:{x:o},backend:n,attrs:{shape:[l,a]}}),p=ve({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),m=ve({inputs:{x:r},backend:n,attrs:{shape:h}}),g=new DI(l,a,f.shape.length,p.shape.length,c,h,!1,!0),y=n.runWebGLProgram(g,[p,f,m],m.dtype),b=ve({inputs:{x:y},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),b}const xEe={kernelName:Yv,backendName:"webgl",kernelFunc:vEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wEe{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[i]*n[i];this.outputShape=s,this.rank=s.length;const r=It(this.rank),o=SEe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}}function SEe(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<t.length;r++)s.push(`imod(${n[r]}, ${t[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $U(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:o}=s;if(r.dtype==="string"||r.shape.length>5){const l=n.readSync(r.dataId),u=r.dtype==="string"?l.map(h=>$i(h)):l,c=Ze(r.shape,r.dtype,u),d=Iwe(c,o);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const i=new wEe(r.shape,o);return n.runWebGLProgram(i,[r],r.dtype)}const kEe={kernelName:yh,backendName:"webgl",kernelFunc:$U};class CEe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class NEe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hl(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function H_(t){let e=1;for(;e<t;)e*=2;return e}function TEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:o,sorted:i}=s,a=ee().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=ee().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=r.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([r])||c<a||o>l){const E=n.readSync(r.dataId),[A,z]=Ewe(E,u,r.dtype,o,i);return[n.makeTensorInfo(A.shape,A.dtype,A.values),n.makeTensorInfo(z.shape,z.dtype,z.values)]}if(o===0)return u[u.length-1]=0,[n.makeTensorInfo(u,r.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[r,Mg({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const d=n.texData.get(r.dataId),h=d!==null&&d.isPacked,f=h?n.unpackTensor(r):r,m=oe(u)/c,g=ve({inputs:{x:f},attrs:{shape:[m,c]},backend:n});h&&hl(n,f);const y=H_(o),b=H_(c);let v=null;const x=()=>v===null?[g,g]:[g,v],w=(E,A,z)=>{const V=x(),P=new CEe(z),Y=[[c],[v===null?1:0],[Number.NEGATIVE_INFINITY],[E],[A]],te=v;v=n.runWebGLProgram(P,V,"int32",Y),hl(n,te)};for(let E=1;E<y;E*=2){const A=E*2;for(let z=E;z>=1;z/=2)w(A,z,[m,b])}for(let E=b;E>y;E/=2){const A=x(),z=new NEe([m,E/2]),P=[[c],[v===null?1:0],[y]],K=v;v=n.runWebGLProgram(z,A,"int32",P),hl(n,K);const Y=y/2,te=Y*2;for(let F=Y;F>=1;F/=2)w(te,F,v.shape)}let S=v;v=Fh({inputs:{x:v},backend:n,attrs:{begin:0,size:[m,o]}}),hl(n,S);let C=vU({inputs:{x:g,indices:v},backend:n,attrs:{axis:1,batchDims:1}});hl(n,g);const N=u.slice(0,-1);N.push(o),S=v,v=ve({inputs:{x:v},attrs:{shape:N},backend:n}),hl(n,S);const I=C;return C=ve({inputs:{x:C},attrs:{shape:N},backend:n}),hl(n,I),[C,v]}const $Ee={kernelName:lx,backendName:"webgl",kernelFunc:TEe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IEe{constructor(e,n,s,r,o,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const a=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${o});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${o});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EEe(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:u}=s,[c,d,h,f]=r.shape,[p,m]=u??[d,h],g=[c,p,m,f],y=new IEe(d,h,i,a,l,g);return n.runWebGLProgram(y,[r,o],"float32")}const REe={kernelName:ux,backendName:"webgl",kernelFunc:EEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ee(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:o}=e;Fg(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=s.readSync(o.dataId),{outputValues:a,outputShape:l,indices:u}=Rwe(i,r,o.shape,o.dtype);return[s.makeTensorInfo(l,o.dtype,a),s.makeTensorInfo([u.length],"int32",u)]}const AEe={kernelName:cx,backendName:"webgl",kernelFunc:_Ee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DEe(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:o}=s;o<0&&(o+=r.shape.length);const i=r,a=i.shape.length,l=r.shape[o],u=new Array(a-1);let c=0;for(let m=0;m<a;m++)m!==o&&(u[c++]=i.shape[m]);const d=[],h=new Array(a).fill(0),f=i.shape.slice();f[o]=1;const p=new Array(l);for(let m=0;m<p.length;m++){h[o]=m;const g=Fh({inputs:{x:i},backend:n,attrs:{begin:h,size:f}}),y=ve({inputs:{x:g},backend:n,attrs:{shape:u}});p[m]=y,d.push(g)}return d.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const OEe={kernelName:Jm,backendName:"webgl",kernelFunc:DEe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FEe{constructor(e,n){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/s);this.outputShape=[r,a];const l="0.0",u="sumValue",c=Math.floor(s/4)*4,d=s%4,h=`
        sumValue += dot(values, segFilter);
    `;let f="";o%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `);let p="";o%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:o}=e,{numSegments:i}=s,a=r.shape.length,l=[];let u=0;const c=tn([u],a);let d=r;c!=null&&(d=ws({inputs:{x:r},backend:n,attrs:{perm:c}}),l.push(d),u=pn(1,a)[0]);const h=JM(d.shape,u,i),f=oe([d.shape[u]]),p=ve({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}});l.push(p);const m=fx(r.dtype),g=(x,w,S,C,N)=>{const I=x.shape[0],E=x.shape[1],A=ZM(E,N),z={windowSize:A,inSize:E,batchSize:I,numSegments:N},V=new FEe(z,w),P=n.compileAndRun(V,[x,S],C);if(l.push(P),P.shape[1]===N)return P;const K=TU({backend:n,attrs:{start:0,stop:N,step:1,dtype:"float32"}}),Y=$U({inputs:{x:K},backend:n,attrs:{reps:[E/A]}});return l.push(K),l.push(Y),g(P,w,Y,C,N)},y=g(p,"unsortedSegmentSum",o,m,i),b=ve({inputs:{x:y},backend:n,attrs:{shape:h}});let v=b;if(c!=null){l.push(b);const x=tl(c);v=ws({inputs:{x:v},backend:n,attrs:{perm:x}})}return l.forEach(x=>n.disposeIntermediateTensorInfo(x)),v}const PEe={kernelName:eg,backendName:"webgl",kernelFunc:LEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MEe=[w1e,k1e,T1e,E1e,_1e,O1e,L1e,M1e,U1e,j1e,q1e,Y1e,J1e,sSe,iSe,lSe,cSe,pSe,gSe,bSe,SSe,ESe,_Se,FSe,PSe,WSe,GSe,XSe,r1e,ZSe,ske,ake,fke,gke,bke,xke,Ske,Tke,Eke,Ake,Oke,Lke,Mke,Vke,Wke,qke,Xke,Zke,tCe,sCe,aCe,dCe,mCe,bCe,wCe,SCe,CCe,TCe,ICe,RCe,ACe,LCe,zCe,UCe,jCe,qCe,YCe,eNe,rNe,s1e,iNe,tke,uNe,hNe,mNe,i1e,vNe,kNe,NNe,ENe,ANe,LNe,zNe,WNe,qNe,YNe,ZNe,nTe,rTe,iTe,cTe,hTe,pTe,gTe,bTe,STe,TTe,RTe,MTe,u1e,UTe,GTe,KTe,QTe,zSe,e$e,n$e,r$e,a$e,d$e,l1e,f$e,m$e,y$e,v$e,x$e,BSe,OTe,k$e,$$e,_$e,d1e,F$e,M$e,U$e,G$e,X$e,Q$e,eIe,sIe,iIe,uIe,hIe,mIe,vIe,SIe,TIe,EIe,$Se,LTe,AIe,OIe,LIe,MIe,BIe,UIe,jIe,HIe,KIe,QIe,JIe,tEe,sEe,iEe,lEe,cEe,hEe,FTe,b1e,mEe,bEe,xEe,kEe,$Ee,REe,v1e,AEe,OEe,PEe,t$e];for(const t of MEe)hx(t);const zEe=()=>{const t=R.useRef(null),e=R.useRef(null),[n,s]=R.useState(null);R.useEffect(()=>{(async()=>{const i=await nue();s(i)})()},[]),R.useEffect(()=>{(async()=>{if(t.current)try{const i=await navigator.mediaDevices.getUserMedia({video:!0});t.current.srcObject=i}catch(i){console.error("Error accessing the webcam: ",i)}})()},[t]);const r=async()=>{if(n&&t.current){const i=await(await xfe(t.current)).capture(),a=await n.classify(i);e.current&&(e.current.innerText=`Prediction: ${a[0].className}
Probability: ${a[0].probability}`),i.dispose()}};return se.jsxs(se.Fragment,{children:[se.jsx("div",{ref:e}),se.jsx("video",{autoPlay:!0,playsInline:!0,muted:!0,ref:t,width:"870",height:"534"}),se.jsx("button",{onClick:r,children:"Capture Image"})]})},Ku={main:"/",example:"/example",example2:"/example2",login:"/login",join:"/join",camera:"/camera"},Xu=()=>se.jsx(Q9,{children:se.jsxs(Z9,{children:[se.jsx(V6,{}),se.jsx(uZ,{})]})}),BEe=G6([{element:se.jsx(Xu,{}),children:[{path:Ku.main,element:se.jsx(CY,{}),errorElement:se.jsx(ml,{})},{path:"*",element:se.jsx(Gu,{})}]},{element:se.jsx(Xu,{}),children:[{path:Ku.example,element:se.jsx(pZ,{}),errorElement:se.jsx(ml,{})},{path:"*",element:se.jsx(Gu,{})}]},{element:se.jsx(Xu,{}),children:[{path:Ku.example2,element:se.jsx(gZ,{}),errorElement:se.jsx(ml,{})},{path:"*",element:se.jsx(Gu,{})}]},{element:se.jsx(Xu,{}),children:[{path:Ku.camera,element:se.jsx(zEe,{}),errorElement:se.jsx(ml,{})},{path:"*",element:se.jsx(Gu,{})}]},{element:se.jsx(Xu,{}),children:[{path:Ku.login,element:se.jsx(bZ,{}),errorElement:se.jsx(ml,{})},{path:"*",element:se.jsx(Gu,{})}]},{element:se.jsx(Xu,{}),children:[{path:Ku.join,element:se.jsx(ZZ,{}),errorElement:se.jsx(ml,{})},{path:"*",element:se.jsx(Gu,{})}]}]),VEe=new pW,UEe=!1;async function WEe(){}WEe().then(()=>{X1.createRoot(document.getElementById("root")).render(se.jsx(q9,{children:se.jsxs(vW,{client:VEe,children:[UEe,se.jsx(e5,{router:BEe})]})}))});
